/*! For license information please see main.903fb880.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,n)=>{e.exports=n(202)},153:(e,t,n)=>{var a=n(43),r=Symbol.for("react.element"),s=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,o=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var a,s={},c=null,d=null;for(a in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)i.call(t,a)&&!l.hasOwnProperty(a)&&(s[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===s[a]&&(s[a]=t[a]);return{$$typeof:r,type:e,key:c,ref:d,props:s,_owner:o.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},202:(e,t)=>{var n=Symbol.for("react.element"),a=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||m}function b(){}function y(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||m}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=v.prototype;var x=y.prototype=new b;x.constructor=y,f(x,v.prototype),x.isPureReactComponent=!0;var _=Array.isArray,w=Object.prototype.hasOwnProperty,j={current:null},N={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,a){var r,s={},i=null,o=null;if(null!=t)for(r in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(i=""+t.key),t)w.call(t,r)&&!N.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(1===l)s.children=a;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];s.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===s[r]&&(s[r]=l[r]);return{$$typeof:n,type:e,key:i,ref:o,props:s,_owner:j.current}}function S(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var k=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function A(e,t,r,s,i){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case a:l=!0}}if(l)return i=i(l=e),e=""===s?"."+C(l,0):s,_(i)?(r="",null!=e&&(r=e.replace(k,"$&/")+"/"),A(i,t,r,"",(function(e){return e}))):null!=i&&(S(i)&&(i=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,r+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(k,"$&/")+"/")+e)),t.push(i)),1;if(l=0,s=""===s?".":s+":",_(e))for(var c=0;c<e.length;c++){var d=s+C(o=e[c],c);l+=A(o,t,r,d,i)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(o=e.next()).done;)l+=A(o=o.value,t,r,d=s+C(o,c++),i);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function T(e,t,n){if(null==e)return e;var a=[],r=0;return A(e,a,"","",(function(e){return t.call(n,e,r++)})),a}function P(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var I={current:null},O={transition:null},R={ReactCurrentDispatcher:I,ReactCurrentBatchConfig:O,ReactCurrentOwner:j};function M(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:T,forEach:function(e,t,n){T(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return T(e,(function(){t++})),t},toArray:function(e){return T(e,(function(e){return e}))||[]},only:function(e){if(!S(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=r,t.Profiler=i,t.PureComponent=y,t.StrictMode=s,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,t.act=M,t.cloneElement=function(e,t,a){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=f({},e.props),s=e.key,i=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(i=t.ref,o=j.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)w.call(t,c)&&!N.hasOwnProperty(c)&&(r[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)r.children=a;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:n,type:e.type,key:s,ref:i,props:r,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=E,t.createFactory=function(e){var t=E.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=S,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:P}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=O.transition;O.transition={};try{e()}finally{O.transition=t}},t.unstable_act=M,t.useCallback=function(e,t){return I.current.useCallback(e,t)},t.useContext=function(e){return I.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return I.current.useDeferredValue(e)},t.useEffect=function(e,t){return I.current.useEffect(e,t)},t.useId=function(){return I.current.useId()},t.useImperativeHandle=function(e,t,n){return I.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return I.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return I.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return I.current.useMemo(e,t)},t.useReducer=function(e,t,n){return I.current.useReducer(e,t,n)},t.useRef=function(e){return I.current.useRef(e)},t.useState=function(e){return I.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return I.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return I.current.useTransition()},t.version="18.3.1"},210:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(n(829)),s=a(n(736)),i=n(745);class o{constructor(e){let{headers:t={},schema:n,fetch:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=Object.assign(Object.assign({},i.DEFAULT_HEADERS),t),this.schemaName=n,this.fetch=a}from(e){const t=new URL(`${this.url}/${e}`);return new r.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new o(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{head:a=!1,get:r=!1,count:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=new URL(`${this.url}/rpc/${e}`);let l;a||r?(t=a?"HEAD":"GET",Object.entries(n).filter((e=>{let[t,n]=e;return void 0!==n})).map((e=>{let[t,n]=e;return[t,Array.isArray(n)?`{${n.join(",")}}`:`${n}`]})).forEach((e=>{let[t,n]=e;o.searchParams.append(t,n)}))):(t="POST",l=n);const c=Object.assign({},this.headers);return i&&(c.Prefer=`count=${i}`),new s.default({method:t,url:o,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}}t.default=o},234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var a=n-1>>>1,r=e[a];if(!(0<s(r,t)))break e;e[a]=t,e[n]=r,n=a}}function a(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var a=0,r=e.length,i=r>>>1;a<i;){var o=2*(a+1)-1,l=e[o],c=o+1,d=e[c];if(0>s(l,n))c<r&&0>s(d,l)?(e[a]=d,e[c]=n,a=c):(e[a]=l,e[o]=n,a=o);else{if(!(c<r&&0>s(d,n)))break e;e[a]=d,e[c]=n,a=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,h=null,p=3,m=!1,f=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,y="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=a(d);null!==t;){if(null===t.callback)r(d);else{if(!(t.startTime<=e))break;r(d),t.sortIndex=t.expirationTime,n(c,t)}t=a(d)}}function _(e){if(g=!1,x(e),!f)if(null!==a(c))f=!0,O(w);else{var t=a(d);null!==t&&R(_,t.startTime-e)}}function w(e,n){f=!1,g&&(g=!1,b(S),S=-1),m=!0;var s=p;try{for(x(n),h=a(c);null!==h&&(!(h.expirationTime>n)||e&&!A());){var i=h.callback;if("function"===typeof i){h.callback=null,p=h.priorityLevel;var o=i(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?h.callback=o:h===a(c)&&r(c),x(n)}else r(c);h=a(c)}if(null!==h)var l=!0;else{var u=a(d);null!==u&&R(_,u.startTime-n),l=!1}return l}finally{h=null,p=s,m=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var j,N=!1,E=null,S=-1,k=5,C=-1;function A(){return!(t.unstable_now()-C<k)}function T(){if(null!==E){var e=t.unstable_now();C=e;var n=!0;try{n=E(!0,e)}finally{n?j():(N=!1,E=null)}}else N=!1}if("function"===typeof y)j=function(){y(T)};else if("undefined"!==typeof MessageChannel){var P=new MessageChannel,I=P.port2;P.port1.onmessage=T,j=function(){I.postMessage(null)}}else j=function(){v(T,0)};function O(e){E=e,N||(N=!0,j())}function R(e,n){S=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){f||m||(f=!0,O(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return a(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,r,s){var i=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?i+s:i:s=i,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:u++,callback:r,priorityLevel:e,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>i?(e.sortIndex=s,n(d,e),null===a(c)&&e===a(d)&&(g?(b(S),S=-1):g=!0,R(_,s-i))):(e.sortIndex=o,n(c,e),f||m||(f=!0,O(w))),e},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},286:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(n(630)),s=a(n(611));t.default=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"undefined"===typeof fetch?this.fetch=r.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let n=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then((async e=>{var t,n,a;let r=null,i=null,o=null,l=e.status,c=e.statusText;if(e.ok){if("HEAD"!==this.method){const t=await e.text();""===t||(i="text/csv"===this.headers.Accept||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}const a=null===(t=this.headers.Prefer)||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),s=null===(n=e.headers.get("content-range"))||void 0===n?void 0:n.split("/");a&&s&&s.length>1&&(o=parseInt(s[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(i)&&(i.length>1?(r={code:"PGRST116",details:`Results contain ${i.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},i=null,o=null,l=406,c="Not Acceptable"):i=1===i.length?i[0]:null)}else{const t=await e.text();try{r=JSON.parse(t),Array.isArray(r)&&404===e.status&&(i=[],r=null,l=200,c="OK")}catch(d){404===e.status&&""===t?(l=204,c="No Content"):r={message:t}}if(r&&this.isMaybeSingle&&(null===(a=null===r||void 0===r?void 0:r.details)||void 0===a?void 0:a.includes("0 rows"))&&(r=null,l=200,c="OK"),r&&this.shouldThrowOnError)throw new s.default(r)}return{error:r,data:i,count:o,status:l,statusText:c}}));return this.shouldThrowOnError||(n=n.catch((e=>{var t,n,a;return{error:{message:`${null!==(t=null===e||void 0===e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null===e||void 0===e?void 0:e.message}`,details:`${null!==(n=null===e||void 0===e?void 0:e.stack)&&void 0!==n?n:""}`,hint:"",code:`${null!==(a=null===e||void 0===e?void 0:e.code)&&void 0!==a?a:""}`},data:null,count:null,status:0,statusText:""}}))),n.then(e,t)}returns(){return this}overrideTypes(){return this}}},374:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(n(286));class s extends r.default{select(e){let t=!1;const n=(null!==e&&void 0!==e?e:"*").split("").map((e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e))).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e){let{ascending:t=!0,nullsFirst:n,foreignTable:a,referencedTable:r=a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=r?`${r}.order`:"order",i=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${i?`${i},`:""}${e}.${t?"asc":"desc"}${void 0===n?"":n?".nullsfirst":".nullslast"}`),this}limit(e){let{foreignTable:t,referencedTable:n=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a="undefined"===typeof n?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${e}`),this}range(e,t){let{foreignTable:n,referencedTable:a=n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r="undefined"===typeof a?"offset":`${a}.offset`,s="undefined"===typeof a?"limit":`${a}.limit`;return this.url.searchParams.set(r,`${e}`),this.url.searchParams.set(s,""+(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain(){let{analyze:e=!1,verbose:t=!1,settings:n=!1,buffers:a=!1,wal:r=!1,format:s="text"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var i;const o=[e?"analyze":null,t?"verbose":null,n?"settings":null,a?"buffers":null,r?"wal":null].filter(Boolean).join("|"),l=null!==(i=this.headers.Accept)&&void 0!==i?i:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${s}; for="${l}"; options=${o};`,this}rollback(){var e;return(null!==(e=this.headers.Prefer)&&void 0!==e?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}t.default=s},391:(e,t,n)=>{var a=n(950);t.createRoot=a.createRoot,t.hydrateRoot=a.hydrateRoot},400:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.version=void 0,t.version="0.0.0-automated"},579:(e,t,n)=>{e.exports=n(153)},611:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});class n extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}t.default=n},630:(e,t,n)=>{n.r(t),n.d(t,{Headers:()=>i,Request:()=>o,Response:()=>l,default:()=>s,fetch:()=>r});var a=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("unable to locate global object")}();const r=a.fetch,s=a.fetch.bind(a),i=a.Headers,o=a.Request,l=a.Response},730:(e,t,n)=>{var a=n(43),r=n(853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)i.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},m={};function f(e,t,n,a,r,s,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=a,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=i}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new f(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new f(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new f(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new f(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new f(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new f(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new f(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new f(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new f(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function b(e){return e[1].toUpperCase()}function y(e,t,n,a){var r=g.hasOwnProperty(t)?g[t]:null;(null!==r?0!==r.type:a||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,a){if(null===t||"undefined"===typeof t||function(e,t,n,a){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!a&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,a))return!0;if(a)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,r,a)&&(n=null),a||null===r?function(e){return!!u.call(m,e)||!u.call(p,e)&&(h.test(e)?m[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=null===n?3!==r.type&&"":n:(t=r.attributeName,a=r.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,a?e.setAttributeNS(a,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,b);g[t]=new f(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,b);g[t]=new f(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,b);g[t]=new f(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new f(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new f("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new f(e,1,!1,e.toLowerCase(),null,!0,!0)}));var x=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_=Symbol.for("react.element"),w=Symbol.for("react.portal"),j=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),k=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),I=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var O=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var R=Symbol.iterator;function M(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=R&&e[R]||e["@@iterator"])?e:null}var D,L=Object.assign;function $(e){if(void 0===D)try{throw Error()}catch(Ju){var t=Ju.stack.trim().match(/\n( *(at )?)/);D=t&&t[1]||""}return"\n"+D+e}var z=!1;function F(e,t){if(!e||z)return"";z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(Vu){var a=Vu}Reflect.construct(e,[],t)}else{try{t.call()}catch(Vu){a=Vu}e.call(t.prototype)}else{try{throw Error()}catch(Vu){a=Vu}e()}}catch(Vu){if(Vu&&a&&"string"===typeof Vu.stack){for(var r=Vu.stack.split("\n"),s=a.stack.split("\n"),i=r.length-1,o=s.length-1;1<=i&&0<=o&&r[i]!==s[o];)o--;for(;1<=i&&0<=o;i--,o--)if(r[i]!==s[o]){if(1!==i||1!==o)do{if(i--,0>--o||r[i]!==s[o]){var l="\n"+r[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=i&&0<=o);break}}}finally{z=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?$(e):""}function B(e){switch(e.tag){case 5:return $(e.type);case 16:return $("Lazy");case 13:return $("Suspense");case 19:return $("SuspenseList");case 0:case 2:case 15:return e=F(e.type,!1);case 11:return e=F(e.type.render,!1);case 1:return e=F(e.type,!0);default:return""}}function U(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case j:return"Fragment";case w:return"Portal";case E:return"Profiler";case N:return"StrictMode";case A:return"Suspense";case T:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case k:return(e.displayName||"Context")+".Consumer";case S:return(e._context.displayName||"Context")+".Provider";case C:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case P:return null!==(t=e.displayName||null)?t:U(e.type)||"Memo";case I:t=e._payload,e=e._init;try{return U(e(t))}catch(Ju){}}return null}function W(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U(t);case 8:return t===N?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function V(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function q(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){a=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return a},setValue:function(e){a=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Y(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),a="";return e&&(a=H(e)?e.checked?"true":"false":e.value),(e=a)!==n&&(t.setValue(e),!0)}function J(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function G(e,t){var n=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function X(e,t){var n=null==t.defaultValue?"":t.defaultValue,a=null!=t.checked?t.checked:t.defaultChecked;n=V(null!=t.value?t.value:n),e._wrapperState={initialChecked:a,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function K(e,t){null!=(t=t.checked)&&y(e,"checked",t,!1)}function Q(e,t){K(e,t);var n=V(t.value),a=t.type;if(null!=n)"number"===a?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===a||"reset"===a)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,V(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var a=t.type;if(!("submit"!==a&&"reset"!==a||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&J(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,a){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&a&&(e[n].defaultSelected=!0)}else{for(n=""+V(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(a&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function ae(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:V(n)}}function se(e,t){var n=V(t.value),a=V(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=a&&(e.defaultValue=""+a)}function ie(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de=function(e){return"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,n,a,r){MSApp.execUnsafeLocalFunction((function(){return e(t,n)}))}:e}((function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}}));function ue(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var he={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||he.hasOwnProperty(e)&&he[e]?(""+t).trim():t+"px"}function fe(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var a=0===n.indexOf("--"),r=me(n,t[n],a);"float"===n&&(n="cssFloat"),a?e.setProperty(n,r):e[n]=r}}Object.keys(he).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),he[t]=he[e]}))}));var ge=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(ge[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ye=null;function xe(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var _e=null,we=null,je=null;function Ne(e){if(e=br(e)){if("function"!==typeof _e)throw Error(s(280));var t=e.stateNode;t&&(t=xr(t),_e(e.stateNode,e.type,t))}}function Ee(e){we?je?je.push(e):je=[e]:we=e}function Se(){if(we){var e=we,t=je;if(je=we=null,Ne(e),t)for(e=0;e<t.length;e++)Ne(t[e])}}function ke(e,t){return e(t)}function Ce(){}var Ae=!1;function Te(e,t,n){if(Ae)return e(t,n);Ae=!0;try{return ke(e,t,n)}finally{Ae=!1,(null!==we||null!==je)&&(Ce(),Se())}}function Pe(e,t){var n=e.stateNode;if(null===n)return null;var a=xr(n);if(null===a)return null;n=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(a=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!a;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var Ie=!1;if(d)try{var Oe={};Object.defineProperty(Oe,"passive",{get:function(){Ie=!0}}),window.addEventListener("test",Oe,Oe),window.removeEventListener("test",Oe,Oe)}catch(Hu){Ie=!1}function Re(e,t,n,a,r,s,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(d){this.onError(d)}}var Me=!1,De=null,Le=!1,$e=null,ze={onError:function(e){Me=!0,De=e}};function Fe(e,t,n,a,r,s,i,o,l){Me=!1,De=null,Re.apply(ze,arguments)}function Be(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ue(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(Be(e)!==e)throw Error(s(188))}function Ve(e){return e=function(e){var t=e.alternate;if(!t){if(null===(t=Be(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,a=t;;){var r=n.return;if(null===r)break;var i=r.alternate;if(null===i){if(null!==(a=r.return)){n=a;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===n)return We(r),e;if(i===a)return We(r),t;i=i.sibling}throw Error(s(188))}if(n.return!==a.return)n=r,a=i;else{for(var o=!1,l=r.child;l;){if(l===n){o=!0,n=r,a=i;break}if(l===a){o=!0,a=r,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,a=r;break}if(l===a){o=!0,a=i,n=r;break}l=l.sibling}if(!o)throw Error(s(189))}}if(n.alternate!==a)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e),null!==e?He(e):null}function He(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=He(e);if(null!==t)return t;e=e.sibling}return null}var qe=r.unstable_scheduleCallback,Ye=r.unstable_cancelCallback,Je=r.unstable_shouldYield,Ge=r.unstable_requestPaint,Xe=r.unstable_now,Ke=r.unstable_getCurrentPriorityLevel,Qe=r.unstable_ImmediatePriority,Ze=r.unstable_UserBlockingPriority,et=r.unstable_NormalPriority,tt=r.unstable_LowPriority,nt=r.unstable_IdlePriority,at=null,rt=null;var st=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(it(e)/ot|0)|0},it=Math.log,ot=Math.LN2;var lt=64,ct=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ut(e,t){var n=e.pendingLanes;if(0===n)return 0;var a=0,r=e.suspendedLanes,s=e.pingedLanes,i=268435455&n;if(0!==i){var o=i&~r;0!==o?a=dt(o):0!==(s&=i)&&(a=dt(s))}else 0!==(i=n&~r)?a=dt(i):0!==s&&(a=dt(s));if(0===a)return 0;if(0!==t&&t!==a&&0===(t&r)&&((r=a&-a)>=(s=t&-t)||16===r&&0!==(4194240&s)))return t;if(0!==(4&a)&&(a|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=a;0<t;)r=1<<(n=31-st(t)),a|=e[n],t&=~r;return a}function ht(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=lt;return 0===(4194240&(lt<<=1))&&(lt=64),e}function ft(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function gt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var a=31-st(n),r=1<<a;r&t|e[a]&t&&(e[a]|=t),n&=~r}}var bt=0;function yt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var xt,_t,wt,jt,Nt,Et=!1,St=[],kt=null,Ct=null,At=null,Tt=new Map,Pt=new Map,It=[],Ot="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Rt(e,t){switch(e){case"focusin":case"focusout":kt=null;break;case"dragenter":case"dragleave":Ct=null;break;case"mouseover":case"mouseout":At=null;break;case"pointerover":case"pointerout":Tt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pt.delete(t.pointerId)}}function Mt(e,t,n,a,r,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:a,nativeEvent:s,targetContainers:[r]},null!==t&&(null!==(t=br(t))&&_t(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Dt(e){var t=vr(e.target);if(null!==t){var n=Be(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ue(n)))return e.blockedOn=t,void Nt(e.priority,(function(){wt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Lt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Jt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=br(n))&&_t(t),e.blockedOn=n,!1;var a=new(n=e.nativeEvent).constructor(n.type,n);ye=a,n.target.dispatchEvent(a),ye=null,t.shift()}return!0}function $t(e,t,n){Lt(e)&&n.delete(t)}function zt(){Et=!1,null!==kt&&Lt(kt)&&(kt=null),null!==Ct&&Lt(Ct)&&(Ct=null),null!==At&&Lt(At)&&(At=null),Tt.forEach($t),Pt.forEach($t)}function Ft(e,t){e.blockedOn===t&&(e.blockedOn=null,Et||(Et=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,zt)))}function Bt(e){function t(t){return Ft(t,e)}if(0<St.length){Ft(St[0],e);for(var n=1;n<St.length;n++){var a=St[n];a.blockedOn===e&&(a.blockedOn=null)}}for(null!==kt&&Ft(kt,e),null!==Ct&&Ft(Ct,e),null!==At&&Ft(At,e),Tt.forEach(t),Pt.forEach(t),n=0;n<It.length;n++)(a=It[n]).blockedOn===e&&(a.blockedOn=null);for(;0<It.length&&null===(n=It[0]).blockedOn;)Dt(n),null===n.blockedOn&&It.shift()}var Ut=x.ReactCurrentBatchConfig,Wt=!0;function Vt(e,t,n,a){var r=bt,s=Ut.transition;Ut.transition=null;try{bt=1,qt(e,t,n,a)}finally{bt=r,Ut.transition=s}}function Ht(e,t,n,a){var r=bt,s=Ut.transition;Ut.transition=null;try{bt=4,qt(e,t,n,a)}finally{bt=r,Ut.transition=s}}function qt(e,t,n,a){if(Wt){var r=Jt(e,t,n,a);if(null===r)Wa(e,t,a,Yt,n),Rt(e,a);else if(function(e,t,n,a,r){switch(t){case"focusin":return kt=Mt(kt,e,t,n,a,r),!0;case"dragenter":return Ct=Mt(Ct,e,t,n,a,r),!0;case"mouseover":return At=Mt(At,e,t,n,a,r),!0;case"pointerover":var s=r.pointerId;return Tt.set(s,Mt(Tt.get(s)||null,e,t,n,a,r)),!0;case"gotpointercapture":return s=r.pointerId,Pt.set(s,Mt(Pt.get(s)||null,e,t,n,a,r)),!0}return!1}(r,e,t,n,a))a.stopPropagation();else if(Rt(e,a),4&t&&-1<Ot.indexOf(e)){for(;null!==r;){var s=br(r);if(null!==s&&xt(s),null===(s=Jt(e,t,n,a))&&Wa(e,t,a,Yt,n),s===r)break;r=s}null!==r&&a.stopPropagation()}else Wa(e,t,a,null,n)}}var Yt=null;function Jt(e,t,n,a){if(Yt=null,null!==(e=vr(e=xe(a))))if(null===(t=Be(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ue(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Yt=e,null}function Gt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ke()){case Qe:return 1;case Ze:return 4;case et:case tt:return 16;case nt:return 536870912;default:return 16}default:return 16}}var Xt=null,Kt=null,Qt=null;function Zt(){if(Qt)return Qt;var e,t,n=Kt,a=n.length,r="value"in Xt?Xt.value:Xt.textContent,s=r.length;for(e=0;e<a&&n[e]===r[e];e++);var i=a-e;for(t=1;t<=i&&n[a-t]===r[s-t];t++);return Qt=r.slice(e,1<t?1-t:void 0)}function en(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function tn(){return!0}function nn(){return!1}function an(e){function t(t,n,a,r,s){for(var i in this._reactName=t,this._targetInst=a,this.type=n,this.nativeEvent=r,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(r):r[i]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?tn:nn,this.isPropagationStopped=nn,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=tn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=tn)},persist:function(){},isPersistent:tn}),t}var rn,sn,on,ln={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cn=an(ln),dn=L({},ln,{view:0,detail:0}),un=an(dn),hn=L({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Nn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==on&&(on&&"mousemove"===e.type?(rn=e.screenX-on.screenX,sn=e.screenY-on.screenY):sn=rn=0,on=e),rn)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),pn=an(hn),mn=an(L({},hn,{dataTransfer:0})),fn=an(L({},dn,{relatedTarget:0})),gn=an(L({},ln,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=L({},ln,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=an(vn),yn=an(L({},ln,{data:0})),xn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_n={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=wn[e])&&!!t[e]}function Nn(){return jn}var En=L({},dn,{key:function(e){if(e.key){var t=xn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=en(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?_n[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Nn,charCode:function(e){return"keypress"===e.type?en(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?en(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Sn=an(En),kn=an(L({},hn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Cn=an(L({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Nn})),An=an(L({},ln,{propertyName:0,elapsedTime:0,pseudoElement:0})),Tn=L({},hn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Pn=an(Tn),In=[9,13,27,32],On=d&&"CompositionEvent"in window,Rn=null;d&&"documentMode"in document&&(Rn=document.documentMode);var Mn=d&&"TextEvent"in window&&!Rn,Dn=d&&(!On||Rn&&8<Rn&&11>=Rn),Ln=String.fromCharCode(32),$n=!1;function zn(e,t){switch(e){case"keyup":return-1!==In.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Fn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Bn=!1;var Un={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Un[e.type]:"textarea"===t}function Vn(e,t,n,a){Ee(a),0<(t=Ha(t,"onChange")).length&&(n=new cn("onChange","change",null,n,a),e.push({event:n,listeners:t}))}var Hn=null,qn=null;function Yn(e){La(e,0)}function Jn(e){if(Y(yr(e)))return e}function Gn(e,t){if("change"===e)return t}var Xn=!1;if(d){var Kn;if(d){var Qn="oninput"in document;if(!Qn){var Zn=document.createElement("div");Zn.setAttribute("oninput","return;"),Qn="function"===typeof Zn.oninput}Kn=Qn}else Kn=!1;Xn=Kn&&(!document.documentMode||9<document.documentMode)}function ea(){Hn&&(Hn.detachEvent("onpropertychange",ta),qn=Hn=null)}function ta(e){if("value"===e.propertyName&&Jn(qn)){var t=[];Vn(t,qn,e,xe(e)),Te(Yn,t)}}function na(e,t,n){"focusin"===e?(ea(),qn=n,(Hn=t).attachEvent("onpropertychange",ta)):"focusout"===e&&ea()}function aa(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Jn(qn)}function ra(e,t){if("click"===e)return Jn(t)}function sa(e,t){if("input"===e||"change"===e)return Jn(t)}var ia="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function oa(e,t){if(ia(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(a=0;a<n.length;a++){var r=n[a];if(!u.call(t,r)||!ia(e[r],t[r]))return!1}return!0}function la(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ca(e,t){var n,a=la(e);for(e=0;a;){if(3===a.nodeType){if(n=e+a.textContent.length,e<=t&&n>=t)return{node:a,offset:t-e};e=n}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=la(a)}}function da(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?da(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function ua(){for(var e=window,t=J();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(Qu){n=!1}if(!n)break;t=J((e=t.contentWindow).document)}return t}function ha(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pa(e){var t=ua(),n=e.focusedElem,a=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&da(n.ownerDocument.documentElement,n)){if(null!==a&&ha(n))if(t=a.start,void 0===(e=a.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=n.textContent.length,s=Math.min(a.start,r);a=void 0===a.end?s:Math.min(a.end,r),!e.extend&&s>a&&(r=a,a=s,s=r),r=ca(n,s);var i=ca(n,a);r&&i&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),s>a?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var ma=d&&"documentMode"in document&&11>=document.documentMode,fa=null,ga=null,va=null,ba=!1;function ya(e,t,n){var a=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;ba||null==fa||fa!==J(a)||("selectionStart"in(a=fa)&&ha(a)?a={start:a.selectionStart,end:a.selectionEnd}:a={anchorNode:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset},va&&oa(va,a)||(va=a,0<(a=Ha(ga,"onSelect")).length&&(t=new cn("onSelect","select",null,t,n),e.push({event:t,listeners:a}),t.target=fa)))}function xa(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var _a={animationend:xa("Animation","AnimationEnd"),animationiteration:xa("Animation","AnimationIteration"),animationstart:xa("Animation","AnimationStart"),transitionend:xa("Transition","TransitionEnd")},wa={},ja={};function Na(e){if(wa[e])return wa[e];if(!_a[e])return e;var t,n=_a[e];for(t in n)if(n.hasOwnProperty(t)&&t in ja)return wa[e]=n[t];return e}d&&(ja=document.createElement("div").style,"AnimationEvent"in window||(delete _a.animationend.animation,delete _a.animationiteration.animation,delete _a.animationstart.animation),"TransitionEvent"in window||delete _a.transitionend.transition);var Ea=Na("animationend"),Sa=Na("animationiteration"),ka=Na("animationstart"),Ca=Na("transitionend"),Aa=new Map,Ta="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pa(e,t){Aa.set(e,t),l(t,[e])}for(var Ia=0;Ia<Ta.length;Ia++){var Oa=Ta[Ia];Pa(Oa.toLowerCase(),"on"+(Oa[0].toUpperCase()+Oa.slice(1)))}Pa(Ea,"onAnimationEnd"),Pa(Sa,"onAnimationIteration"),Pa(ka,"onAnimationStart"),Pa("dblclick","onDoubleClick"),Pa("focusin","onFocus"),Pa("focusout","onBlur"),Pa(Ca,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ra="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ma=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ra));function Da(e,t,n){var a=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,a,r,i,o,l,c){if(Fe.apply(this,arguments),Me){if(!Me)throw Error(s(198));var d=De;Me=!1,De=null,Le||(Le=!0,$e=d)}}(a,t,void 0,e),e.currentTarget=null}function La(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var a=e[n],r=a.event;a=a.listeners;e:{var s=void 0;if(t)for(var i=a.length-1;0<=i;i--){var o=a[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&r.isPropagationStopped())break e;Da(r,o,c),s=l}else for(i=0;i<a.length;i++){if(l=(o=a[i]).instance,c=o.currentTarget,o=o.listener,l!==s&&r.isPropagationStopped())break e;Da(r,o,c),s=l}}}if(Le)throw e=$e,Le=!1,$e=null,e}function $a(e,t){var n=t[mr];void 0===n&&(n=t[mr]=new Set);var a=e+"__bubble";n.has(a)||(Ua(t,e,2,!1),n.add(a))}function za(e,t,n){var a=0;t&&(a|=4),Ua(n,e,a,t)}var Fa="_reactListening"+Math.random().toString(36).slice(2);function Ba(e){if(!e[Fa]){e[Fa]=!0,i.forEach((function(t){"selectionchange"!==t&&(Ma.has(t)||za(t,!1,e),za(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Fa]||(t[Fa]=!0,za("selectionchange",!1,t))}}function Ua(e,t,n,a){switch(Gt(t)){case 1:var r=Vt;break;case 4:r=Ht;break;default:r=qt}n=r.bind(null,t,n,e),r=void 0,!Ie||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),a?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Wa(e,t,n,a,r){var s=a;if(0===(1&t)&&0===(2&t)&&null!==a)e:for(;;){if(null===a)return;var i=a.tag;if(3===i||4===i){var o=a.stateNode.containerInfo;if(o===r||8===o.nodeType&&o.parentNode===r)break;if(4===i)for(i=a.return;null!==i;){var l=i.tag;if((3===l||4===l)&&((l=i.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;i=i.return}for(;null!==o;){if(null===(i=vr(o)))return;if(5===(l=i.tag)||6===l){a=s=i;continue e}o=o.parentNode}}a=a.return}Te((function(){var a=s,r=xe(n),i=[];e:{var o=Aa.get(e);if(void 0!==o){var l=cn,c=e;switch(e){case"keypress":if(0===en(n))break e;case"keydown":case"keyup":l=Sn;break;case"focusin":c="focus",l=fn;break;case"focusout":c="blur",l=fn;break;case"beforeblur":case"afterblur":l=fn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Cn;break;case Ea:case Sa:case ka:l=gn;break;case Ca:l=An;break;case"scroll":l=un;break;case"wheel":l=Pn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=kn}var d=0!==(4&t),u=!d&&"scroll"===e,h=d?null!==o?o+"Capture":null:o;d=[];for(var p,m=a;null!==m;){var f=(p=m).stateNode;if(5===p.tag&&null!==f&&(p=f,null!==h&&(null!=(f=Pe(m,h))&&d.push(Va(m,f,p)))),u)break;m=m.return}0<d.length&&(o=new l(o,c,null,n,r),i.push({event:o,listeners:d}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===ye||!(c=n.relatedTarget||n.fromElement)||!vr(c)&&!c[pr])&&(l||o)&&(o=r.window===r?r:(o=r.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=a,null!==(c=(c=n.relatedTarget||n.toElement)?vr(c):null)&&(c!==(u=Be(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=a),l!==c)){if(d=pn,f="onMouseLeave",h="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(d=kn,f="onPointerLeave",h="onPointerEnter",m="pointer"),u=null==l?o:yr(l),p=null==c?o:yr(c),(o=new d(f,m+"leave",l,n,r)).target=u,o.relatedTarget=p,f=null,vr(r)===a&&((d=new d(h,m+"enter",c,n,r)).target=p,d.relatedTarget=u,f=d),u=f,l&&c)e:{for(h=c,m=0,p=d=l;p;p=qa(p))m++;for(p=0,f=h;f;f=qa(f))p++;for(;0<m-p;)d=qa(d),m--;for(;0<p-m;)h=qa(h),p--;for(;m--;){if(d===h||null!==h&&d===h.alternate)break e;d=qa(d),h=qa(h)}d=null}else d=null;null!==l&&Ya(i,o,l,d,!1),null!==c&&null!==u&&Ya(i,u,c,d,!0)}if("select"===(l=(o=a?yr(a):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Gn;else if(Wn(o))if(Xn)g=sa;else{g=aa;var v=na}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=ra);switch(g&&(g=g(e,a))?Vn(i,g,n,r):(v&&v(e,o,a),"focusout"===e&&(v=o._wrapperState)&&v.controlled&&"number"===o.type&&ee(o,"number",o.value)),v=a?yr(a):window,e){case"focusin":(Wn(v)||"true"===v.contentEditable)&&(fa=v,ga=a,va=null);break;case"focusout":va=ga=fa=null;break;case"mousedown":ba=!0;break;case"contextmenu":case"mouseup":case"dragend":ba=!1,ya(i,n,r);break;case"selectionchange":if(ma)break;case"keydown":case"keyup":ya(i,n,r)}var b;if(On)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else Bn?zn(e,n)&&(y="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(y="onCompositionStart");y&&(Dn&&"ko"!==n.locale&&(Bn||"onCompositionStart"!==y?"onCompositionEnd"===y&&Bn&&(b=Zt()):(Kt="value"in(Xt=r)?Xt.value:Xt.textContent,Bn=!0)),0<(v=Ha(a,y)).length&&(y=new yn(y,e,null,n,r),i.push({event:y,listeners:v}),b?y.data=b:null!==(b=Fn(n))&&(y.data=b))),(b=Mn?function(e,t){switch(e){case"compositionend":return Fn(t);case"keypress":return 32!==t.which?null:($n=!0,Ln);case"textInput":return(e=t.data)===Ln&&$n?null:e;default:return null}}(e,n):function(e,t){if(Bn)return"compositionend"===e||!On&&zn(e,t)?(e=Zt(),Qt=Kt=Xt=null,Bn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Dn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(a=Ha(a,"onBeforeInput")).length&&(r=new yn("onBeforeInput","beforeinput",null,n,r),i.push({event:r,listeners:a}),r.data=b))}La(i,t)}))}function Va(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Ha(e,t){for(var n=t+"Capture",a=[];null!==e;){var r=e,s=r.stateNode;5===r.tag&&null!==s&&(r=s,null!=(s=Pe(e,n))&&a.unshift(Va(e,s,r)),null!=(s=Pe(e,t))&&a.push(Va(e,s,r))),e=e.return}return a}function qa(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Ya(e,t,n,a,r){for(var s=t._reactName,i=[];null!==n&&n!==a;){var o=n,l=o.alternate,c=o.stateNode;if(null!==l&&l===a)break;5===o.tag&&null!==c&&(o=c,r?null!=(l=Pe(n,s))&&i.unshift(Va(n,l,o)):r||null!=(l=Pe(n,s))&&i.push(Va(n,l,o))),n=n.return}0!==i.length&&e.push({event:t,listeners:i})}var Ja=/\r\n?/g,Ga=/\u0000|\uFFFD/g;function Xa(e){return("string"===typeof e?e:""+e).replace(Ja,"\n").replace(Ga,"")}function Ka(e,t,n){if(t=Xa(t),Xa(e)!==t&&n)throw Error(s(425))}function Qa(){}var Za=null,er=null;function tr(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var nr="function"===typeof setTimeout?setTimeout:void 0,ar="function"===typeof clearTimeout?clearTimeout:void 0,rr="function"===typeof Promise?Promise:void 0,sr="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof rr?function(e){return rr.resolve(null).then(e).catch(ir)}:nr;function ir(e){setTimeout((function(){throw e}))}function or(e,t){var n=t,a=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===a)return e.removeChild(r),void Bt(t);a--}else"$"!==n&&"$?"!==n&&"$!"!==n||a++;n=r}while(n);Bt(t)}function lr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function cr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var dr=Math.random().toString(36).slice(2),ur="__reactFiber$"+dr,hr="__reactProps$"+dr,pr="__reactContainer$"+dr,mr="__reactEvents$"+dr,fr="__reactListeners$"+dr,gr="__reactHandles$"+dr;function vr(e){var t=e[ur];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pr]||n[ur]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=cr(e);null!==e;){if(n=e[ur])return n;e=cr(e)}return t}n=(e=n).parentNode}return null}function br(e){return!(e=e[ur]||e[pr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function yr(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function xr(e){return e[hr]||null}var _r=[],wr=-1;function jr(e){return{current:e}}function Nr(e){0>wr||(e.current=_r[wr],_r[wr]=null,wr--)}function Er(e,t){wr++,_r[wr]=e.current,e.current=t}var Sr={},kr=jr(Sr),Cr=jr(!1),Ar=Sr;function Tr(e,t){var n=e.type.contextTypes;if(!n)return Sr;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===t)return a.__reactInternalMemoizedMaskedChildContext;var r,s={};for(r in n)s[r]=t[r];return a&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Pr(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ir(){Nr(Cr),Nr(kr)}function Or(e,t,n){if(kr.current!==Sr)throw Error(s(168));Er(kr,t),Er(Cr,n)}function Rr(e,t,n){var a=e.stateNode;if(t=t.childContextTypes,"function"!==typeof a.getChildContext)return n;for(var r in a=a.getChildContext())if(!(r in t))throw Error(s(108,W(e)||"Unknown",r));return L({},n,a)}function Mr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Sr,Ar=kr.current,Er(kr,e),Er(Cr,Cr.current),!0}function Dr(e,t,n){var a=e.stateNode;if(!a)throw Error(s(169));n?(e=Rr(e,t,Ar),a.__reactInternalMemoizedMergedChildContext=e,Nr(Cr),Nr(kr),Er(kr,e)):Nr(Cr),Er(Cr,n)}var Lr=null,$r=!1,zr=!1;function Fr(e){null===Lr?Lr=[e]:Lr.push(e)}function Br(){if(!zr&&null!==Lr){zr=!0;var e=0,t=bt;try{var n=Lr;for(bt=1;e<n.length;e++){var a=n[e];do{a=a(!0)}while(null!==a)}Lr=null,$r=!1}catch(Uu){throw null!==Lr&&(Lr=Lr.slice(e+1)),qe(Qe,Br),Uu}finally{bt=t,zr=!1}}return null}var Ur=[],Wr=0,Vr=null,Hr=0,qr=[],Yr=0,Jr=null,Gr=1,Xr="";function Kr(e,t){Ur[Wr++]=Hr,Ur[Wr++]=Vr,Vr=e,Hr=t}function Qr(e,t,n){qr[Yr++]=Gr,qr[Yr++]=Xr,qr[Yr++]=Jr,Jr=e;var a=Gr;e=Xr;var r=32-st(a)-1;a&=~(1<<r),n+=1;var s=32-st(t)+r;if(30<s){var i=r-r%5;s=(a&(1<<i)-1).toString(32),a>>=i,r-=i,Gr=1<<32-st(t)+r|n<<r|a,Xr=s+e}else Gr=1<<s|n<<r|a,Xr=e}function Zr(e){null!==e.return&&(Kr(e,1),Qr(e,1,0))}function es(e){for(;e===Vr;)Vr=Ur[--Wr],Ur[Wr]=null,Hr=Ur[--Wr],Ur[Wr]=null;for(;e===Jr;)Jr=qr[--Yr],qr[Yr]=null,Xr=qr[--Yr],qr[Yr]=null,Gr=qr[--Yr],qr[Yr]=null}var ts=null,ns=null,as=!1,rs=null;function ss(e,t){var n=Tc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function is(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ts=e,ns=lr(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ts=e,ns=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Jr?{id:Gr,overflow:Xr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Tc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ts=e,ns=null,!0);default:return!1}}function os(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ls(e){if(as){var t=ns;if(t){var n=t;if(!is(e,t)){if(os(e))throw Error(s(418));t=lr(n.nextSibling);var a=ts;t&&is(e,t)?ss(a,n):(e.flags=-4097&e.flags|2,as=!1,ts=e)}}else{if(os(e))throw Error(s(418));e.flags=-4097&e.flags|2,as=!1,ts=e}}}function cs(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ts=e}function ds(e){if(e!==ts)return!1;if(!as)return cs(e),as=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!tr(e.type,e.memoizedProps)),t&&(t=ns)){if(os(e))throw us(),Error(s(418));for(;t;)ss(e,t),t=lr(t.nextSibling)}if(cs(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ns=lr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ns=null}}else ns=ts?lr(e.stateNode.nextSibling):null;return!0}function us(){for(var e=ns;e;)e=lr(e.nextSibling)}function hs(){ns=ts=null,as=!1}function ps(e){null===rs?rs=[e]:rs.push(e)}var ms=x.ReactCurrentBatchConfig;function fs(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var a=n.stateNode}if(!a)throw Error(s(147,e));var r=a,i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=r.refs;null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function gs(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function vs(e){return(0,e._init)(e._payload)}function bs(e){function t(t,n){if(e){var a=t.deletions;null===a?(t.deletions=[n],t.flags|=16):a.push(n)}}function n(n,a){if(!e)return null;for(;null!==a;)t(n,a),a=a.sibling;return null}function a(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Ic(e,t)).index=0,e.sibling=null,e}function i(t,n,a){return t.index=a,e?null!==(a=t.alternate)?(a=a.index)<n?(t.flags|=2,n):a:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,a){return null===t||6!==t.tag?((t=Dc(n,e.mode,a)).return=e,t):((t=r(t,n)).return=e,t)}function c(e,t,n,a){var s=n.type;return s===j?u(e,t,n.props.children,a,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===I&&vs(s)===t.type)?((a=r(t,n.props)).ref=fs(e,t,n),a.return=e,a):((a=Oc(n.type,n.key,n.props,null,e.mode,a)).ref=fs(e,t,n),a.return=e,a)}function d(e,t,n,a){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Lc(n,e.mode,a)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function u(e,t,n,a,s){return null===t||7!==t.tag?((t=Rc(n,e.mode,a,s)).return=e,t):((t=r(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Dc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case _:return(n=Oc(t.type,t.key,t.props,null,e.mode,n)).ref=fs(e,null,t),n.return=e,n;case w:return(t=Lc(t,e.mode,n)).return=e,t;case I:return h(e,(0,t._init)(t._payload),n)}if(te(t)||M(t))return(t=Rc(t,e.mode,n,null)).return=e,t;gs(e,t)}return null}function p(e,t,n,a){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==r?null:l(e,t,""+n,a);if("object"===typeof n&&null!==n){switch(n.$$typeof){case _:return n.key===r?c(e,t,n,a):null;case w:return n.key===r?d(e,t,n,a):null;case I:return p(e,t,(r=n._init)(n._payload),a)}if(te(n)||M(n))return null!==r?null:u(e,t,n,a,null);gs(e,n)}return null}function m(e,t,n,a,r){if("string"===typeof a&&""!==a||"number"===typeof a)return l(t,e=e.get(n)||null,""+a,r);if("object"===typeof a&&null!==a){switch(a.$$typeof){case _:return c(t,e=e.get(null===a.key?n:a.key)||null,a,r);case w:return d(t,e=e.get(null===a.key?n:a.key)||null,a,r);case I:return m(e,t,n,(0,a._init)(a._payload),r)}if(te(a)||M(a))return u(t,e=e.get(n)||null,a,r,null);gs(t,a)}return null}function f(r,s,o,l){for(var c=null,d=null,u=s,f=s=0,g=null;null!==u&&f<o.length;f++){u.index>f?(g=u,u=null):g=u.sibling;var v=p(r,u,o[f],l);if(null===v){null===u&&(u=g);break}e&&u&&null===v.alternate&&t(r,u),s=i(v,s,f),null===d?c=v:d.sibling=v,d=v,u=g}if(f===o.length)return n(r,u),as&&Kr(r,f),c;if(null===u){for(;f<o.length;f++)null!==(u=h(r,o[f],l))&&(s=i(u,s,f),null===d?c=u:d.sibling=u,d=u);return as&&Kr(r,f),c}for(u=a(r,u);f<o.length;f++)null!==(g=m(u,r,f,o[f],l))&&(e&&null!==g.alternate&&u.delete(null===g.key?f:g.key),s=i(g,s,f),null===d?c=g:d.sibling=g,d=g);return e&&u.forEach((function(e){return t(r,e)})),as&&Kr(r,f),c}function g(r,o,l,c){var d=M(l);if("function"!==typeof d)throw Error(s(150));if(null==(l=d.call(l)))throw Error(s(151));for(var u=d=null,f=o,g=o=0,v=null,b=l.next();null!==f&&!b.done;g++,b=l.next()){f.index>g?(v=f,f=null):v=f.sibling;var y=p(r,f,b.value,c);if(null===y){null===f&&(f=v);break}e&&f&&null===y.alternate&&t(r,f),o=i(y,o,g),null===u?d=y:u.sibling=y,u=y,f=v}if(b.done)return n(r,f),as&&Kr(r,g),d;if(null===f){for(;!b.done;g++,b=l.next())null!==(b=h(r,b.value,c))&&(o=i(b,o,g),null===u?d=b:u.sibling=b,u=b);return as&&Kr(r,g),d}for(f=a(r,f);!b.done;g++,b=l.next())null!==(b=m(f,r,g,b.value,c))&&(e&&null!==b.alternate&&f.delete(null===b.key?g:b.key),o=i(b,o,g),null===u?d=b:u.sibling=b,u=b);return e&&f.forEach((function(e){return t(r,e)})),as&&Kr(r,g),d}return function e(a,s,i,l){if("object"===typeof i&&null!==i&&i.type===j&&null===i.key&&(i=i.props.children),"object"===typeof i&&null!==i){switch(i.$$typeof){case _:e:{for(var c=i.key,d=s;null!==d;){if(d.key===c){if((c=i.type)===j){if(7===d.tag){n(a,d.sibling),(s=r(d,i.props.children)).return=a,a=s;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===I&&vs(c)===d.type){n(a,d.sibling),(s=r(d,i.props)).ref=fs(a,d,i),s.return=a,a=s;break e}n(a,d);break}t(a,d),d=d.sibling}i.type===j?((s=Rc(i.props.children,a.mode,l,i.key)).return=a,a=s):((l=Oc(i.type,i.key,i.props,null,a.mode,l)).ref=fs(a,s,i),l.return=a,a=l)}return o(a);case w:e:{for(d=i.key;null!==s;){if(s.key===d){if(4===s.tag&&s.stateNode.containerInfo===i.containerInfo&&s.stateNode.implementation===i.implementation){n(a,s.sibling),(s=r(s,i.children||[])).return=a,a=s;break e}n(a,s);break}t(a,s),s=s.sibling}(s=Lc(i,a.mode,l)).return=a,a=s}return o(a);case I:return e(a,s,(d=i._init)(i._payload),l)}if(te(i))return f(a,s,i,l);if(M(i))return g(a,s,i,l);gs(a,i)}return"string"===typeof i&&""!==i||"number"===typeof i?(i=""+i,null!==s&&6===s.tag?(n(a,s.sibling),(s=r(s,i)).return=a,a=s):(n(a,s),(s=Dc(i,a.mode,l)).return=a,a=s),o(a)):n(a,s)}}var ys=bs(!0),xs=bs(!1),_s=jr(null),ws=null,js=null,Ns=null;function Es(){Ns=js=ws=null}function Ss(e){var t=_s.current;Nr(_s),e._currentValue=t}function ks(e,t,n){for(;null!==e;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==a&&(a.childLanes|=t)):null!==a&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===n)break;e=e.return}}function Cs(e,t){ws=e,Ns=js=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bo=!0),e.firstContext=null)}function As(e){var t=e._currentValue;if(Ns!==e)if(e={context:e,memoizedValue:t,next:null},null===js){if(null===ws)throw Error(s(308));js=e,ws.dependencies={lanes:0,firstContext:e}}else js=js.next=e;return t}var Ts=null;function Ps(e){null===Ts?Ts=[e]:Ts.push(e)}function Is(e,t,n,a){var r=t.interleaved;return null===r?(n.next=n,Ps(t)):(n.next=r.next,r.next=n),t.interleaved=n,Os(e,a)}function Os(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Rs=!1;function Ms(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ds(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ls(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function $s(e,t,n){var a=e.updateQueue;if(null===a)return null;if(a=a.shared,0!==(2&kl)){var r=a.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),a.pending=t,Os(e,n)}return null===(r=a.interleaved)?(t.next=t,Ps(a)):(t.next=r.next,r.next=t),a.interleaved=t,Os(e,n)}function zs(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var a=t.lanes;n|=a&=e.pendingLanes,t.lanes=n,vt(e,n)}}function Fs(e,t){var n=e.updateQueue,a=e.alternate;if(null!==a&&n===(a=a.updateQueue)){var r=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?r=s=i:s=s.next=i,n=n.next}while(null!==n);null===s?r=s=t:s=s.next=t}else r=s=t;return n={baseState:a.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:a.shared,effects:a.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Bs(e,t,n,a){var r=e.updateQueue;Rs=!1;var s=r.firstBaseUpdate,i=r.lastBaseUpdate,o=r.shared.pending;if(null!==o){r.shared.pending=null;var l=o,c=l.next;l.next=null,null===i?s=c:i.next=c,i=l;var d=e.alternate;null!==d&&((o=(d=d.updateQueue).lastBaseUpdate)!==i&&(null===o?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l))}if(null!==s){var u=r.baseState;for(i=0,d=c=l=null,o=s;;){var h=o.lane,p=o.eventTime;if((a&h)===h){null!==d&&(d=d.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,f=o;switch(h=t,p=n,f.tag){case 1:if("function"===typeof(m=f.payload)){u=m.call(p,u,h);break e}u=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(h="function"===typeof(m=f.payload)?m.call(p,u,h):m)||void 0===h)break e;u=L({},u,h);break e;case 2:Rs=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=r.effects)?r.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===d?(c=d=p,l=u):d=d.next=p,i|=h;if(null===(o=o.next)){if(null===(o=r.shared.pending))break;o=(h=o).next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}if(null===d&&(l=u),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=d,null!==(t=r.shared.interleaved)){r=t;do{i|=r.lane,r=r.next}while(r!==t)}else null===s&&(r.shared.lanes=0);Ml|=i,e.lanes=i,e.memoizedState=u}}function Us(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var a=e[t],r=a.callback;if(null!==r){if(a.callback=null,a=n,"function"!==typeof r)throw Error(s(191,r));r.call(a)}}}var Ws={},Vs=jr(Ws),Hs=jr(Ws),qs=jr(Ws);function Ys(e){if(e===Ws)throw Error(s(174));return e}function Js(e,t){switch(Er(qs,t),Er(Hs,e),Er(Vs,Ws),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Nr(Vs),Er(Vs,t)}function Gs(){Nr(Vs),Nr(Hs),Nr(qs)}function Xs(e){Ys(qs.current);var t=Ys(Vs.current),n=le(t,e.type);t!==n&&(Er(Hs,e),Er(Vs,n))}function Ks(e){Hs.current===e&&(Nr(Vs),Nr(Hs))}var Qs=jr(0);function Zs(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ei=[];function ti(){for(var e=0;e<ei.length;e++)ei[e]._workInProgressVersionPrimary=null;ei.length=0}var ni=x.ReactCurrentDispatcher,ai=x.ReactCurrentBatchConfig,ri=0,si=null,ii=null,oi=null,li=!1,ci=!1,di=0,ui=0;function hi(){throw Error(s(321))}function pi(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ia(e[n],t[n]))return!1;return!0}function mi(e,t,n,a,r,i){if(ri=i,si=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ni.current=null===e||null===e.memoizedState?Ki:Qi,e=n(a,r),ci){i=0;do{if(ci=!1,di=0,25<=i)throw Error(s(301));i+=1,oi=ii=null,t.updateQueue=null,ni.current=Zi,e=n(a,r)}while(ci)}if(ni.current=Xi,t=null!==ii&&null!==ii.next,ri=0,oi=ii=si=null,li=!1,t)throw Error(s(300));return e}function fi(){var e=0!==di;return di=0,e}function gi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===oi?si.memoizedState=oi=e:oi=oi.next=e,oi}function vi(){if(null===ii){var e=si.alternate;e=null!==e?e.memoizedState:null}else e=ii.next;var t=null===oi?si.memoizedState:oi.next;if(null!==t)oi=t,ii=e;else{if(null===e)throw Error(s(310));e={memoizedState:(ii=e).memoizedState,baseState:ii.baseState,baseQueue:ii.baseQueue,queue:ii.queue,next:null},null===oi?si.memoizedState=oi=e:oi=oi.next=e}return oi}function bi(e,t){return"function"===typeof t?t(e):t}function yi(e){var t=vi(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var a=ii,r=a.baseQueue,i=n.pending;if(null!==i){if(null!==r){var o=r.next;r.next=i.next,i.next=o}a.baseQueue=r=i,n.pending=null}if(null!==r){i=r.next,a=a.baseState;var l=o=null,c=null,d=i;do{var u=d.lane;if((ri&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),a=d.hasEagerState?d.eagerState:e(a,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(l=c=h,o=a):c=c.next=h,si.lanes|=u,Ml|=u}d=d.next}while(null!==d&&d!==i);null===c?o=a:c.next=l,ia(a,t.memoizedState)||(bo=!0),t.memoizedState=a,t.baseState=o,t.baseQueue=c,n.lastRenderedState=a}if(null!==(e=n.interleaved)){r=e;do{i=r.lane,si.lanes|=i,Ml|=i,r=r.next}while(r!==e)}else null===r&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function xi(e){var t=vi(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var a=n.dispatch,r=n.pending,i=t.memoizedState;if(null!==r){n.pending=null;var o=r=r.next;do{i=e(i,o.action),o=o.next}while(o!==r);ia(i,t.memoizedState)||(bo=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,a]}function _i(){}function wi(e,t){var n=si,a=vi(),r=t(),i=!ia(a.memoizedState,r);if(i&&(a.memoizedState=r,bo=!0),a=a.queue,Ri(Ei.bind(null,n,a,e),[e]),a.getSnapshot!==t||i||null!==oi&&1&oi.memoizedState.tag){if(n.flags|=2048,Ai(9,Ni.bind(null,n,a,r,t),void 0,null),null===Cl)throw Error(s(349));0!==(30&ri)||ji(n,t,r)}return r}function ji(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=si.updateQueue)?(t={lastEffect:null,stores:null},si.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ni(e,t,n,a){t.value=n,t.getSnapshot=a,Si(t)&&ki(e)}function Ei(e,t,n){return n((function(){Si(t)&&ki(e)}))}function Si(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ia(e,n)}catch(Qu){return!0}}function ki(e){var t=Os(e,1);null!==t&&tc(t,e,1,-1)}function Ci(e){var t=gi();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bi,lastRenderedState:e},t.queue=e,e=e.dispatch=qi.bind(null,si,e),[t.memoizedState,e]}function Ai(e,t,n,a){return e={tag:e,create:t,destroy:n,deps:a,next:null},null===(t=si.updateQueue)?(t={lastEffect:null,stores:null},si.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(a=n.next,n.next=e,e.next=a,t.lastEffect=e),e}function Ti(){return vi().memoizedState}function Pi(e,t,n,a){var r=gi();si.flags|=e,r.memoizedState=Ai(1|t,n,void 0,void 0===a?null:a)}function Ii(e,t,n,a){var r=vi();a=void 0===a?null:a;var s=void 0;if(null!==ii){var i=ii.memoizedState;if(s=i.destroy,null!==a&&pi(a,i.deps))return void(r.memoizedState=Ai(t,n,s,a))}si.flags|=e,r.memoizedState=Ai(1|t,n,s,a)}function Oi(e,t){return Pi(8390656,8,e,t)}function Ri(e,t){return Ii(2048,8,e,t)}function Mi(e,t){return Ii(4,2,e,t)}function Di(e,t){return Ii(4,4,e,t)}function Li(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function $i(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ii(4,4,Li.bind(null,t,e),n)}function zi(){}function Fi(e,t){var n=vi();t=void 0===t?null:t;var a=n.memoizedState;return null!==a&&null!==t&&pi(t,a[1])?a[0]:(n.memoizedState=[e,t],e)}function Bi(e,t){var n=vi();t=void 0===t?null:t;var a=n.memoizedState;return null!==a&&null!==t&&pi(t,a[1])?a[0]:(e=e(),n.memoizedState=[e,t],e)}function Ui(e,t,n){return 0===(21&ri)?(e.baseState&&(e.baseState=!1,bo=!0),e.memoizedState=n):(ia(n,t)||(n=mt(),si.lanes|=n,Ml|=n,e.baseState=!0),t)}function Wi(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var a=ai.transition;ai.transition={};try{e(!1),t()}finally{bt=n,ai.transition=a}}function Vi(){return vi().memoizedState}function Hi(e,t,n){var a=ec(e);if(n={lane:a,action:n,hasEagerState:!1,eagerState:null,next:null},Yi(e))Ji(t,n);else if(null!==(n=Is(e,t,n,a))){tc(n,e,a,Zl()),Gi(n,t,a)}}function qi(e,t,n){var a=ec(e),r={lane:a,action:n,hasEagerState:!1,eagerState:null,next:null};if(Yi(e))Ji(t,r);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var i=t.lastRenderedState,o=s(i,n);if(r.hasEagerState=!0,r.eagerState=o,ia(o,i)){var l=t.interleaved;return null===l?(r.next=r,Ps(t)):(r.next=l.next,l.next=r),void(t.interleaved=r)}}catch(Vu){}null!==(n=Is(e,t,r,a))&&(tc(n,e,a,r=Zl()),Gi(n,t,a))}}function Yi(e){var t=e.alternate;return e===si||null!==t&&t===si}function Ji(e,t){ci=li=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Gi(e,t,n){if(0!==(4194240&n)){var a=t.lanes;n|=a&=e.pendingLanes,t.lanes=n,vt(e,n)}}var Xi={readContext:As,useCallback:hi,useContext:hi,useEffect:hi,useImperativeHandle:hi,useInsertionEffect:hi,useLayoutEffect:hi,useMemo:hi,useReducer:hi,useRef:hi,useState:hi,useDebugValue:hi,useDeferredValue:hi,useTransition:hi,useMutableSource:hi,useSyncExternalStore:hi,useId:hi,unstable_isNewReconciler:!1},Ki={readContext:As,useCallback:function(e,t){return gi().memoizedState=[e,void 0===t?null:t],e},useContext:As,useEffect:Oi,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Pi(4194308,4,Li.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Pi(4194308,4,e,t)},useInsertionEffect:function(e,t){return Pi(4,2,e,t)},useMemo:function(e,t){var n=gi();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var a=gi();return t=void 0!==n?n(t):t,a.memoizedState=a.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},a.queue=e,e=e.dispatch=Hi.bind(null,si,e),[a.memoizedState,e]},useRef:function(e){return e={current:e},gi().memoizedState=e},useState:Ci,useDebugValue:zi,useDeferredValue:function(e){return gi().memoizedState=e},useTransition:function(){var e=Ci(!1),t=e[0];return e=Wi.bind(null,e[1]),gi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var a=si,r=gi();if(as){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Cl)throw Error(s(349));0!==(30&ri)||ji(a,t,n)}r.memoizedState=n;var i={value:n,getSnapshot:t};return r.queue=i,Oi(Ei.bind(null,a,i,e),[e]),a.flags|=2048,Ai(9,Ni.bind(null,a,i,n,t),void 0,null),n},useId:function(){var e=gi(),t=Cl.identifierPrefix;if(as){var n=Xr;t=":"+t+"R"+(n=(Gr&~(1<<32-st(Gr)-1)).toString(32)+n),0<(n=di++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=ui++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Qi={readContext:As,useCallback:Fi,useContext:As,useEffect:Ri,useImperativeHandle:$i,useInsertionEffect:Mi,useLayoutEffect:Di,useMemo:Bi,useReducer:yi,useRef:Ti,useState:function(){return yi(bi)},useDebugValue:zi,useDeferredValue:function(e){return Ui(vi(),ii.memoizedState,e)},useTransition:function(){return[yi(bi)[0],vi().memoizedState]},useMutableSource:_i,useSyncExternalStore:wi,useId:Vi,unstable_isNewReconciler:!1},Zi={readContext:As,useCallback:Fi,useContext:As,useEffect:Ri,useImperativeHandle:$i,useInsertionEffect:Mi,useLayoutEffect:Di,useMemo:Bi,useReducer:xi,useRef:Ti,useState:function(){return xi(bi)},useDebugValue:zi,useDeferredValue:function(e){var t=vi();return null===ii?t.memoizedState=e:Ui(t,ii.memoizedState,e)},useTransition:function(){return[xi(bi)[0],vi().memoizedState]},useMutableSource:_i,useSyncExternalStore:wi,useId:Vi,unstable_isNewReconciler:!1};function eo(e,t){if(e&&e.defaultProps){for(var n in t=L({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function to(e,t,n,a){n=null===(n=n(a,t=e.memoizedState))||void 0===n?t:L({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var no={isMounted:function(e){return!!(e=e._reactInternals)&&Be(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var a=Zl(),r=ec(e),s=Ls(a,r);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=$s(e,s,r))&&(tc(t,e,r,a),zs(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var a=Zl(),r=ec(e),s=Ls(a,r);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=$s(e,s,r))&&(tc(t,e,r,a),zs(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Zl(),a=ec(e),r=Ls(n,a);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=$s(e,r,a))&&(tc(t,e,a,n),zs(t,e,a))}};function ao(e,t,n,a,r,s,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(a,s,i):!t.prototype||!t.prototype.isPureReactComponent||(!oa(n,a)||!oa(r,s))}function ro(e,t,n){var a=!1,r=Sr,s=t.contextType;return"object"===typeof s&&null!==s?s=As(s):(r=Pr(t)?Ar:kr.current,s=(a=null!==(a=t.contextTypes)&&void 0!==a)?Tr(e,r):Sr),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=no,e.stateNode=t,t._reactInternals=e,a&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=s),t}function so(e,t,n,a){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,a),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,a),t.state!==e&&no.enqueueReplaceState(t,t.state,null)}function io(e,t,n,a){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs={},Ms(e);var s=t.contextType;"object"===typeof s&&null!==s?r.context=As(s):(s=Pr(t)?Ar:kr.current,r.context=Tr(e,s)),r.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(to(e,t,s,n),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&no.enqueueReplaceState(r,r.state,null),Bs(e,n,r,a),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}function oo(e,t){try{var n="",a=t;do{n+=B(a),a=a.return}while(a);var r=n}catch(Zu){r="\nError generating stack: "+Zu.message+"\n"+Zu.stack}return{value:e,source:t,stack:r,digest:null}}function lo(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function co(e,t){try{console.error(t.value)}catch(Ju){setTimeout((function(){throw Ju}))}}var uo="function"===typeof WeakMap?WeakMap:Map;function ho(e,t,n){(n=Ls(-1,n)).tag=3,n.payload={element:null};var a=t.value;return n.callback=function(){Wl||(Wl=!0,Vl=a),co(0,t)},n}function po(e,t,n){(n=Ls(-1,n)).tag=3;var a=e.type.getDerivedStateFromError;if("function"===typeof a){var r=t.value;n.payload=function(){return a(r)},n.callback=function(){co(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){co(0,t),"function"!==typeof a&&(null===Hl?Hl=new Set([this]):Hl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function mo(e,t,n){var a=e.pingCache;if(null===a){a=e.pingCache=new uo;var r=new Set;a.set(t,r)}else void 0===(r=a.get(t))&&(r=new Set,a.set(t,r));r.has(n)||(r.add(n),e=Nc.bind(null,e,t,n),t.then(e,e))}function fo(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function go(e,t,n,a,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Ls(-1,1)).tag=2,$s(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var vo=x.ReactCurrentOwner,bo=!1;function yo(e,t,n,a){t.child=null===e?xs(t,null,n,a):ys(t,e.child,n,a)}function xo(e,t,n,a,r){n=n.render;var s=t.ref;return Cs(t,r),a=mi(e,t,n,a,s,r),n=fi(),null===e||bo?(as&&n&&Zr(t),t.flags|=1,yo(e,t,a,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Wo(e,t,r))}function _o(e,t,n,a,r){if(null===e){var s=n.type;return"function"!==typeof s||Pc(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Oc(n.type,null,a,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,wo(e,t,s,a,r))}if(s=e.child,0===(e.lanes&r)){var i=s.memoizedProps;if((n=null!==(n=n.compare)?n:oa)(i,a)&&e.ref===t.ref)return Wo(e,t,r)}return t.flags|=1,(e=Ic(s,a)).ref=t.ref,e.return=t,t.child=e}function wo(e,t,n,a,r){if(null!==e){var s=e.memoizedProps;if(oa(s,a)&&e.ref===t.ref){if(bo=!1,t.pendingProps=a=s,0===(e.lanes&r))return t.lanes=e.lanes,Wo(e,t,r);0!==(131072&e.flags)&&(bo=!0)}}return Eo(e,t,n,a,r)}function jo(e,t,n){var a=t.pendingProps,r=a.children,s=null!==e?e.memoizedState:null;if("hidden"===a.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Er(Il,Pl),Pl|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Er(Il,Pl),Pl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=null!==s?s.baseLanes:n,Er(Il,Pl),Pl|=a}else null!==s?(a=s.baseLanes|n,t.memoizedState=null):a=n,Er(Il,Pl),Pl|=a;return yo(e,t,r,n),t.child}function No(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Eo(e,t,n,a,r){var s=Pr(n)?Ar:kr.current;return s=Tr(t,s),Cs(t,r),n=mi(e,t,n,a,s,r),a=fi(),null===e||bo?(as&&a&&Zr(t),t.flags|=1,yo(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Wo(e,t,r))}function So(e,t,n,a,r){if(Pr(n)){var s=!0;Mr(t)}else s=!1;if(Cs(t,r),null===t.stateNode)Uo(e,t),ro(t,n,a),io(t,n,a,r),a=!0;else if(null===e){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,c=n.contextType;"object"===typeof c&&null!==c?c=As(c):c=Tr(t,c=Pr(n)?Ar:kr.current);var d=n.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof i.getSnapshotBeforeUpdate;u||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(o!==a||l!==c)&&so(t,i,a,c),Rs=!1;var h=t.memoizedState;i.state=h,Bs(t,a,i,r),l=t.memoizedState,o!==a||h!==l||Cr.current||Rs?("function"===typeof d&&(to(t,n,d,a),l=t.memoizedState),(o=Rs||ao(t,n,o,a,h,l,c))?(u||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||("function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"===typeof i.componentDidMount&&(t.flags|=4194308)):("function"===typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=l),i.props=a,i.state=l,i.context=c,a=o):("function"===typeof i.componentDidMount&&(t.flags|=4194308),a=!1)}else{i=t.stateNode,Ds(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:eo(t.type,o),i.props=c,u=t.pendingProps,h=i.context,"object"===typeof(l=n.contextType)&&null!==l?l=As(l):l=Tr(t,l=Pr(n)?Ar:kr.current);var p=n.getDerivedStateFromProps;(d="function"===typeof p||"function"===typeof i.getSnapshotBeforeUpdate)||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(o!==u||h!==l)&&so(t,i,a,l),Rs=!1,h=t.memoizedState,i.state=h,Bs(t,a,i,r);var m=t.memoizedState;o!==u||h!==m||Cr.current||Rs?("function"===typeof p&&(to(t,n,p,a),m=t.memoizedState),(c=Rs||ao(t,n,c,a,h,m,l)||!1)?(d||"function"!==typeof i.UNSAFE_componentWillUpdate&&"function"!==typeof i.componentWillUpdate||("function"===typeof i.componentWillUpdate&&i.componentWillUpdate(a,m,l),"function"===typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(a,m,l)),"function"===typeof i.componentDidUpdate&&(t.flags|=4),"function"===typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof i.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=m),i.props=a,i.state=m,i.context=l,a=c):("function"!==typeof i.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),a=!1)}return ko(e,t,n,a,s,r)}function ko(e,t,n,a,r,s){No(e,t);var i=0!==(128&t.flags);if(!a&&!i)return r&&Dr(t,n,!1),Wo(e,t,s);a=t.stateNode,vo.current=t;var o=i&&"function"!==typeof n.getDerivedStateFromError?null:a.render();return t.flags|=1,null!==e&&i?(t.child=ys(t,e.child,null,s),t.child=ys(t,null,o,s)):yo(e,t,o,s),t.memoizedState=a.state,r&&Dr(t,n,!0),t.child}function Co(e){var t=e.stateNode;t.pendingContext?Or(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Or(0,t.context,!1),Js(e,t.containerInfo)}function Ao(e,t,n,a,r){return hs(),ps(r),t.flags|=256,yo(e,t,n,a),t.child}var To,Po,Io,Oo,Ro={dehydrated:null,treeContext:null,retryLane:0};function Mo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Do(e,t,n){var a,r=t.pendingProps,i=Qs.current,o=!1,l=0!==(128&t.flags);if((a=l)||(a=(null===e||null!==e.memoizedState)&&0!==(2&i)),a?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(i|=1),Er(Qs,1&i),null===e)return ls(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=r.children,e=r.fallback,o?(r=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&r)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Mc(l,r,0,null),e=Rc(e,r,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Mo(n),t.memoizedState=Ro,e):Lo(t,l));if(null!==(i=e.memoizedState)&&null!==(a=i.dehydrated))return function(e,t,n,a,r,i,o){if(n)return 256&t.flags?(t.flags&=-257,$o(e,t,o,a=lo(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(i=a.fallback,r=t.mode,a=Mc({mode:"visible",children:a.children},r,0,null),(i=Rc(i,r,o,null)).flags|=2,a.return=t,i.return=t,a.sibling=i,t.child=a,0!==(1&t.mode)&&ys(t,e.child,null,o),t.child.memoizedState=Mo(o),t.memoizedState=Ro,i);if(0===(1&t.mode))return $o(e,t,o,null);if("$!"===r.data){if(a=r.nextSibling&&r.nextSibling.dataset)var l=a.dgst;return a=l,$o(e,t,o,a=lo(i=Error(s(419)),a,void 0))}if(l=0!==(o&e.childLanes),bo||l){if(null!==(a=Cl)){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(a.suspendedLanes|o))?0:r)&&r!==i.retryLane&&(i.retryLane=r,Os(e,r),tc(a,e,r,-1))}return mc(),$o(e,t,o,a=lo(Error(s(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=Sc.bind(null,e),r._reactRetry=t,null):(e=i.treeContext,ns=lr(r.nextSibling),ts=t,as=!0,rs=null,null!==e&&(qr[Yr++]=Gr,qr[Yr++]=Xr,qr[Yr++]=Jr,Gr=e.id,Xr=e.overflow,Jr=t),t=Lo(t,a.children),t.flags|=4096,t)}(e,t,l,r,a,i,n);if(o){o=r.fallback,l=t.mode,a=(i=e.child).sibling;var c={mode:"hidden",children:r.children};return 0===(1&l)&&t.child!==i?((r=t.child).childLanes=0,r.pendingProps=c,t.deletions=null):(r=Ic(i,c)).subtreeFlags=14680064&i.subtreeFlags,null!==a?o=Ic(a,o):(o=Rc(o,l,n,null)).flags|=2,o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,l=null===(l=e.child.memoizedState)?Mo(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=Ro,r}return e=(o=e.child).sibling,r=Ic(o,{mode:"visible",children:r.children}),0===(1&t.mode)&&(r.lanes=n),r.return=t,r.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Lo(e,t){return(t=Mc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function $o(e,t,n,a){return null!==a&&ps(a),ys(t,e.child,null,n),(e=Lo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function zo(e,t,n){e.lanes|=t;var a=e.alternate;null!==a&&(a.lanes|=t),ks(e.return,t,n)}function Fo(e,t,n,a,r){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:n,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=a,s.tail=n,s.tailMode=r)}function Bo(e,t,n){var a=t.pendingProps,r=a.revealOrder,s=a.tail;if(yo(e,t,a.children,n),0!==(2&(a=Qs.current)))a=1&a|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&zo(e,n,t);else if(19===e.tag)zo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}if(Er(Qs,a),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===Zs(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),Fo(t,!1,r,n,s);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===Zs(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}Fo(t,!0,n,null,s);break;case"together":Fo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Uo(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Wo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ml|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Ic(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Ic(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Vo(e,t){if(!as)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var a=null;null!==n;)null!==n.alternate&&(a=n),n=n.sibling;null===a?t||null===e.tail?e.tail=null:e.tail.sibling=null:a.sibling=null}}function Ho(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,a=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,a|=14680064&r.subtreeFlags,a|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,a|=r.subtreeFlags,a|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=a,e.childLanes=n,t}function qo(e,t,n){var a=t.pendingProps;switch(es(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ho(t),null;case 1:case 17:return Pr(t.type)&&Ir(),Ho(t),null;case 3:return a=t.stateNode,Gs(),Nr(Cr),Nr(kr),ti(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),null!==e&&null!==e.child||(ds(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==rs&&(sc(rs),rs=null))),Po(e,t),Ho(t),null;case 5:Ks(t);var r=Ys(qs.current);if(n=t.type,null!==e&&null!=t.stateNode)Io(e,t,n,a,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!a){if(null===t.stateNode)throw Error(s(166));return Ho(t),null}if(e=Ys(Vs.current),ds(t)){a=t.stateNode,n=t.type;var i=t.memoizedProps;switch(a[ur]=t,a[hr]=i,e=0!==(1&t.mode),n){case"dialog":$a("cancel",a),$a("close",a);break;case"iframe":case"object":case"embed":$a("load",a);break;case"video":case"audio":for(r=0;r<Ra.length;r++)$a(Ra[r],a);break;case"source":$a("error",a);break;case"img":case"image":case"link":$a("error",a),$a("load",a);break;case"details":$a("toggle",a);break;case"input":X(a,i),$a("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!i.multiple},$a("invalid",a);break;case"textarea":re(a,i),$a("invalid",a)}for(var l in ve(n,i),r=null,i)if(i.hasOwnProperty(l)){var c=i[l];"children"===l?"string"===typeof c?a.textContent!==c&&(!0!==i.suppressHydrationWarning&&Ka(a.textContent,c,e),r=["children",c]):"number"===typeof c&&a.textContent!==""+c&&(!0!==i.suppressHydrationWarning&&Ka(a.textContent,c,e),r=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&$a("scroll",a)}switch(n){case"input":q(a),Z(a,i,!0);break;case"textarea":q(a),ie(a);break;case"select":case"option":break;default:"function"===typeof i.onClick&&(a.onclick=Qa)}a=r,t.updateQueue=a,null!==a&&(t.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof a.is?e=l.createElement(n,{is:a.is}):(e=l.createElement(n),"select"===n&&(l=e,a.multiple?l.multiple=!0:a.size&&(l.size=a.size))):e=l.createElementNS(e,n),e[ur]=t,e[hr]=a,To(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,a),n){case"dialog":$a("cancel",e),$a("close",e),r=a;break;case"iframe":case"object":case"embed":$a("load",e),r=a;break;case"video":case"audio":for(r=0;r<Ra.length;r++)$a(Ra[r],e);r=a;break;case"source":$a("error",e),r=a;break;case"img":case"image":case"link":$a("error",e),$a("load",e),r=a;break;case"details":$a("toggle",e),r=a;break;case"input":X(e,a),r=G(e,a),$a("invalid",e);break;case"option":default:r=a;break;case"select":e._wrapperState={wasMultiple:!!a.multiple},r=L({},a,{value:void 0}),$a("invalid",e);break;case"textarea":re(e,a),r=ae(e,a),$a("invalid",e)}for(i in ve(n,r),c=r)if(c.hasOwnProperty(i)){var d=c[i];"style"===i?fe(e,d):"dangerouslySetInnerHTML"===i?null!=(d=d?d.__html:void 0)&&de(e,d):"children"===i?"string"===typeof d?("textarea"!==n||""!==d)&&ue(e,d):"number"===typeof d&&ue(e,""+d):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(o.hasOwnProperty(i)?null!=d&&"onScroll"===i&&$a("scroll",e):null!=d&&y(e,i,d,l))}switch(n){case"input":q(e),Z(e,a,!1);break;case"textarea":q(e),ie(e);break;case"option":null!=a.value&&e.setAttribute("value",""+V(a.value));break;case"select":e.multiple=!!a.multiple,null!=(i=a.value)?ne(e,!!a.multiple,i,!1):null!=a.defaultValue&&ne(e,!!a.multiple,a.defaultValue,!0);break;default:"function"===typeof r.onClick&&(e.onclick=Qa)}switch(n){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ho(t),null;case 6:if(e&&null!=t.stateNode)Oo(e,t,e.memoizedProps,a);else{if("string"!==typeof a&&null===t.stateNode)throw Error(s(166));if(n=Ys(qs.current),Ys(Vs.current),ds(t)){if(a=t.stateNode,n=t.memoizedProps,a[ur]=t,(i=a.nodeValue!==n)&&null!==(e=ts))switch(e.tag){case 3:Ka(a.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Ka(a.nodeValue,n,0!==(1&e.mode))}i&&(t.flags|=4)}else(a=(9===n.nodeType?n:n.ownerDocument).createTextNode(a))[ur]=t,t.stateNode=a}return Ho(t),null;case 13:if(Nr(Qs),a=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(as&&null!==ns&&0!==(1&t.mode)&&0===(128&t.flags))us(),hs(),t.flags|=98560,i=!1;else if(i=ds(t),null!==a&&null!==a.dehydrated){if(null===e){if(!i)throw Error(s(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(s(317));i[ur]=t}else hs(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ho(t),i=!1}else null!==rs&&(sc(rs),rs=null),i=!0;if(!i)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((a=null!==a)!==(null!==e&&null!==e.memoizedState)&&a&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Qs.current)?0===Ol&&(Ol=3):mc())),null!==t.updateQueue&&(t.flags|=4),Ho(t),null);case 4:return Gs(),Po(e,t),null===e&&Ba(t.stateNode.containerInfo),Ho(t),null;case 10:return Ss(t.type._context),Ho(t),null;case 19:if(Nr(Qs),null===(i=t.memoizedState))return Ho(t),null;if(a=0!==(128&t.flags),null===(l=i.rendering))if(a)Vo(i,!1);else{if(0!==Ol||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=Zs(e))){for(t.flags|=128,Vo(i,!1),null!==(a=l.updateQueue)&&(t.updateQueue=a,t.flags|=4),t.subtreeFlags=0,a=n,n=t.child;null!==n;)e=a,(i=n).flags&=14680066,null===(l=i.alternate)?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Er(Qs,1&Qs.current|2),t.child}e=e.sibling}null!==i.tail&&Xe()>Bl&&(t.flags|=128,a=!0,Vo(i,!1),t.lanes=4194304)}else{if(!a)if(null!==(e=Zs(l))){if(t.flags|=128,a=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Vo(i,!0),null===i.tail&&"hidden"===i.tailMode&&!l.alternate&&!as)return Ho(t),null}else 2*Xe()-i.renderingStartTime>Bl&&1073741824!==n&&(t.flags|=128,a=!0,Vo(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=i.last)?n.sibling=l:t.child=l,i.last=l)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Xe(),t.sibling=null,n=Qs.current,Er(Qs,a?1&n|2:1&n),t):(Ho(t),null);case 22:case 23:return dc(),a=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==a&&(t.flags|=8192),a&&0!==(1&t.mode)?0!==(1073741824&Pl)&&(Ho(t),6&t.subtreeFlags&&(t.flags|=8192)):Ho(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Yo(e,t){switch(es(t),t.tag){case 1:return Pr(t.type)&&Ir(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Gs(),Nr(Cr),Nr(kr),ti(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Ks(t),null;case 13:if(Nr(Qs),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));hs()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Nr(Qs),null;case 4:return Gs(),null;case 10:return Ss(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}To=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Po=function(){},Io=function(e,t,n,a){var r=e.memoizedProps;if(r!==a){e=t.stateNode,Ys(Vs.current);var s,i=null;switch(n){case"input":r=G(e,r),a=G(e,a),i=[];break;case"select":r=L({},r,{value:void 0}),a=L({},a,{value:void 0}),i=[];break;case"textarea":r=ae(e,r),a=ae(e,a),i=[];break;default:"function"!==typeof r.onClick&&"function"===typeof a.onClick&&(e.onclick=Qa)}for(d in ve(n,a),n=null,r)if(!a.hasOwnProperty(d)&&r.hasOwnProperty(d)&&null!=r[d])if("style"===d){var l=r[d];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(o.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in a){var c=a[d];if(l=null!=r?r[d]:void 0,a.hasOwnProperty(d)&&c!==l&&(null!=c||null!=l))if("style"===d)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(i||(i=[]),i.push(d,n)),n=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(i=i||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(i=i||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(o.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&$a("scroll",e),i||l===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(t.updateQueue=d)&&(t.flags|=4)}},Oo=function(e,t,n,a){n!==a&&(t.flags|=4)};var Jo=!1,Go=!1,Xo="function"===typeof WeakSet?WeakSet:Set,Ko=null;function Qo(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(Qu){jc(e,t,Qu)}else n.current=null}function Zo(e,t,n){try{n()}catch(Qu){jc(e,t,Qu)}}var el=!1;function tl(e,t,n){var a=t.updateQueue;if(null!==(a=null!==a?a.lastEffect:null)){var r=a=a.next;do{if((r.tag&e)===e){var s=r.destroy;r.destroy=void 0,void 0!==s&&Zo(t,n,s)}r=r.next}while(r!==a)}}function nl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var a=n.create;n.destroy=a()}n=n.next}while(n!==t)}}function al(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function rl(e){var t=e.alternate;null!==t&&(e.alternate=null,rl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[ur],delete t[hr],delete t[mr],delete t[fr],delete t[gr])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sl(e){return 5===e.tag||3===e.tag||4===e.tag}function il(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||sl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ol(e,t,n){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Qa));else if(4!==a&&null!==(e=e.child))for(ol(e,t,n),e=e.sibling;null!==e;)ol(e,t,n),e=e.sibling}function ll(e,t,n){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==a&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}var cl=null,dl=!1;function ul(e,t,n){for(n=n.child;null!==n;)hl(e,t,n),n=n.sibling}function hl(e,t,n){if(rt&&"function"===typeof rt.onCommitFiberUnmount)try{rt.onCommitFiberUnmount(at,n)}catch(th){}switch(n.tag){case 5:Go||Qo(n,t);case 6:var a=cl,r=dl;cl=null,ul(e,t,n),dl=r,null!==(cl=a)&&(dl?(e=cl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):cl.removeChild(n.stateNode));break;case 18:null!==cl&&(dl?(e=cl,n=n.stateNode,8===e.nodeType?or(e.parentNode,n):1===e.nodeType&&or(e,n),Bt(e)):or(cl,n.stateNode));break;case 4:a=cl,r=dl,cl=n.stateNode.containerInfo,dl=!0,ul(e,t,n),cl=a,dl=r;break;case 0:case 11:case 14:case 15:if(!Go&&(null!==(a=n.updateQueue)&&null!==(a=a.lastEffect))){r=a=a.next;do{var s=r,i=s.destroy;s=s.tag,void 0!==i&&(0!==(2&s)||0!==(4&s))&&Zo(n,t,i),r=r.next}while(r!==a)}ul(e,t,n);break;case 1:if(!Go&&(Qo(n,t),"function"===typeof(a=n.stateNode).componentWillUnmount))try{a.props=n.memoizedProps,a.state=n.memoizedState,a.componentWillUnmount()}catch(th){jc(n,t,th)}ul(e,t,n);break;case 21:ul(e,t,n);break;case 22:1&n.mode?(Go=(a=Go)||null!==n.memoizedState,ul(e,t,n),Go=a):ul(e,t,n);break;default:ul(e,t,n)}}function pl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Xo),t.forEach((function(t){var a=kc.bind(null,e,t);n.has(t)||(n.add(t),t.then(a,a))}))}}function ml(e,t){var n=t.deletions;if(null!==n)for(var a=0;a<n.length;a++){var r=n[a];try{var i=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:cl=l.stateNode,dl=!1;break e;case 3:case 4:cl=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===cl)throw Error(s(160));hl(i,o,r),cl=null,dl=!1;var c=r.alternate;null!==c&&(c.return=null),r.return=null}catch(Vu){jc(r,t,Vu)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)fl(t,e),t=t.sibling}function fl(e,t){var n=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),gl(e),4&a){try{tl(3,e,e.return),nl(3,e)}catch(Wu){jc(e,e.return,Wu)}try{tl(5,e,e.return)}catch(Wu){jc(e,e.return,Wu)}}break;case 1:ml(t,e),gl(e),512&a&&null!==n&&Qo(n,n.return);break;case 5:if(ml(t,e),gl(e),512&a&&null!==n&&Qo(n,n.return),32&e.flags){var r=e.stateNode;try{ue(r,"")}catch(Wu){jc(e,e.return,Wu)}}if(4&a&&null!=(r=e.stateNode)){var i=e.memoizedProps,o=null!==n?n.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===i.type&&null!=i.name&&K(r,i),be(l,o);var d=be(l,i);for(o=0;o<c.length;o+=2){var u=c[o],h=c[o+1];"style"===u?fe(r,h):"dangerouslySetInnerHTML"===u?de(r,h):"children"===u?ue(r,h):y(r,u,h,d)}switch(l){case"input":Q(r,i);break;case"textarea":se(r,i);break;case"select":var p=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!i.multiple;var m=i.value;null!=m?ne(r,!!i.multiple,m,!1):p!==!!i.multiple&&(null!=i.defaultValue?ne(r,!!i.multiple,i.defaultValue,!0):ne(r,!!i.multiple,i.multiple?[]:"",!1))}r[hr]=i}catch(Wu){jc(e,e.return,Wu)}}break;case 6:if(ml(t,e),gl(e),4&a){if(null===e.stateNode)throw Error(s(162));r=e.stateNode,i=e.memoizedProps;try{r.nodeValue=i}catch(Wu){jc(e,e.return,Wu)}}break;case 3:if(ml(t,e),gl(e),4&a&&null!==n&&n.memoizedState.isDehydrated)try{Bt(t.containerInfo)}catch(Wu){jc(e,e.return,Wu)}break;case 4:default:ml(t,e),gl(e);break;case 13:ml(t,e),gl(e),8192&(r=e.child).flags&&(i=null!==r.memoizedState,r.stateNode.isHidden=i,!i||null!==r.alternate&&null!==r.alternate.memoizedState||(Fl=Xe())),4&a&&pl(e);break;case 22:if(u=null!==n&&null!==n.memoizedState,1&e.mode?(Go=(d=Go)||u,ml(t,e),Go=d):ml(t,e),gl(e),8192&a){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for(Ko=e,u=e.child;null!==u;){for(h=Ko=u;null!==Ko;){switch(m=(p=Ko).child,p.tag){case 0:case 11:case 14:case 15:tl(4,p,p.return);break;case 1:Qo(p,p.return);var f=p.stateNode;if("function"===typeof f.componentWillUnmount){a=p,n=p.return;try{t=a,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(Wu){jc(a,n,Wu)}}break;case 5:Qo(p,p.return);break;case 22:if(null!==p.memoizedState){xl(h);continue}}null!==m?(m.return=p,Ko=m):xl(h)}u=u.sibling}e:for(u=null,h=e;;){if(5===h.tag){if(null===u){u=h;try{r=h.stateNode,d?"function"===typeof(i=r.style).setProperty?i.setProperty("display","none","important"):i.display="none":(l=h.stateNode,o=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",o))}catch(Wu){jc(e,e.return,Wu)}}}else if(6===h.tag){if(null===u)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(Wu){jc(e,e.return,Wu)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ml(t,e),gl(e),4&a&&pl(e);case 21:}}function gl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(sl(n)){var a=n;break e}n=n.return}throw Error(s(160))}switch(a.tag){case 5:var r=a.stateNode;32&a.flags&&(ue(r,""),a.flags&=-33),ll(e,il(e),r);break;case 3:case 4:var i=a.stateNode.containerInfo;ol(e,il(e),i);break;default:throw Error(s(161))}}catch(fh){jc(e,e.return,fh)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vl(e,t,n){Ko=e,bl(e,t,n)}function bl(e,t,n){for(var a=0!==(1&e.mode);null!==Ko;){var r=Ko,s=r.child;if(22===r.tag&&a){var i=null!==r.memoizedState||Jo;if(!i){var o=r.alternate,l=null!==o&&null!==o.memoizedState||Go;o=Jo;var c=Go;if(Jo=i,(Go=l)&&!c)for(Ko=r;null!==Ko;)l=(i=Ko).child,22===i.tag&&null!==i.memoizedState?_l(r):null!==l?(l.return=i,Ko=l):_l(r);for(;null!==s;)Ko=s,bl(s,t,n),s=s.sibling;Ko=r,Jo=o,Go=c}yl(e)}else 0!==(8772&r.subtreeFlags)&&null!==s?(s.return=r,Ko=s):yl(e)}}function yl(e){for(;null!==Ko;){var t=Ko;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Go||nl(5,t);break;case 1:var a=t.stateNode;if(4&t.flags&&!Go)if(null===n)a.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:eo(t.type,n.memoizedProps);a.componentDidUpdate(r,n.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;null!==i&&Us(t,i,a);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Us(t,o,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var h=u.dehydrated;null!==h&&Bt(h)}}}break;default:throw Error(s(163))}Go||512&t.flags&&al(t)}catch(p){jc(t,t.return,p)}}if(t===e){Ko=null;break}if(null!==(n=t.sibling)){n.return=t.return,Ko=n;break}Ko=t.return}}function xl(e){for(;null!==Ko;){var t=Ko;if(t===e){Ko=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Ko=n;break}Ko=t.return}}function _l(e){for(;null!==Ko;){var t=Ko;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{nl(4,t)}catch(fh){jc(t,n,fh)}break;case 1:var a=t.stateNode;if("function"===typeof a.componentDidMount){var r=t.return;try{a.componentDidMount()}catch(fh){jc(t,r,fh)}}var s=t.return;try{al(t)}catch(fh){jc(t,s,fh)}break;case 5:var i=t.return;try{al(t)}catch(fh){jc(t,i,fh)}}}catch(fh){jc(t,t.return,fh)}if(t===e){Ko=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Ko=o;break}Ko=t.return}}var wl,jl=Math.ceil,Nl=x.ReactCurrentDispatcher,El=x.ReactCurrentOwner,Sl=x.ReactCurrentBatchConfig,kl=0,Cl=null,Al=null,Tl=0,Pl=0,Il=jr(0),Ol=0,Rl=null,Ml=0,Dl=0,Ll=0,$l=null,zl=null,Fl=0,Bl=1/0,Ul=null,Wl=!1,Vl=null,Hl=null,ql=!1,Yl=null,Jl=0,Gl=0,Xl=null,Kl=-1,Ql=0;function Zl(){return 0!==(6&kl)?Xe():-1!==Kl?Kl:Kl=Xe()}function ec(e){return 0===(1&e.mode)?1:0!==(2&kl)&&0!==Tl?Tl&-Tl:null!==ms.transition?(0===Ql&&(Ql=mt()),Ql):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Gt(e.type)}function tc(e,t,n,a){if(50<Gl)throw Gl=0,Xl=null,Error(s(185));gt(e,n,a),0!==(2&kl)&&e===Cl||(e===Cl&&(0===(2&kl)&&(Dl|=n),4===Ol&&ic(e,Tl)),nc(e,a),1===n&&0===kl&&0===(1&t.mode)&&(Bl=Xe()+500,$r&&Br()))}function nc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,a=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-st(s),o=1<<i,l=r[i];-1===l?0!==(o&n)&&0===(o&a)||(r[i]=ht(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}(e,t);var a=ut(e,e===Cl?Tl:0);if(0===a)null!==n&&Ye(n),e.callbackNode=null,e.callbackPriority=0;else if(t=a&-a,e.callbackPriority!==t){if(null!=n&&Ye(n),1===t)0===e.tag?function(e){$r=!0,Fr(e)}(oc.bind(null,e)):Fr(oc.bind(null,e)),sr((function(){0===(6&kl)&&Br()})),n=null;else{switch(yt(a)){case 1:n=Qe;break;case 4:n=Ze;break;case 16:default:n=et;break;case 536870912:n=nt}n=Cc(n,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ac(e,t){if(Kl=-1,Ql=0,0!==(6&kl))throw Error(s(327));var n=e.callbackNode;if(_c()&&e.callbackNode!==n)return null;var a=ut(e,e===Cl?Tl:0);if(0===a)return null;if(0!==(30&a)||0!==(a&e.expiredLanes)||t)t=fc(e,a);else{t=a;var r=kl;kl|=2;var i=pc();for(Cl===e&&Tl===t||(Ul=null,Bl=Xe()+500,uc(e,t));;)try{vc();break}catch(th){hc(e,th)}Es(),Nl.current=i,kl=r,null!==Al?t=0:(Cl=null,Tl=0,t=Ol)}if(0!==t){if(2===t&&(0!==(r=pt(e))&&(a=r,t=rc(e,r))),1===t)throw n=Rl,uc(e,0),ic(e,a),nc(e,Xe()),n;if(6===t)ic(e,a);else{if(r=e.current.alternate,0===(30&a)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var a=0;a<n.length;a++){var r=n[a],s=r.getSnapshot;r=r.value;try{if(!ia(s(),r))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=fc(e,a))&&(0!==(i=pt(e))&&(a=i,t=rc(e,i))),1===t))throw n=Rl,uc(e,0),ic(e,a),nc(e,Xe()),n;switch(e.finishedWork=r,e.finishedLanes=a,t){case 0:case 1:throw Error(s(345));case 2:case 5:xc(e,zl,Ul);break;case 3:if(ic(e,a),(130023424&a)===a&&10<(t=Fl+500-Xe())){if(0!==ut(e,0))break;if(((r=e.suspendedLanes)&a)!==a){Zl(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=nr(xc.bind(null,e,zl,Ul),t);break}xc(e,zl,Ul);break;case 4:if(ic(e,a),(4194240&a)===a)break;for(t=e.eventTimes,r=-1;0<a;){var o=31-st(a);i=1<<o,(o=t[o])>r&&(r=o),a&=~i}if(a=r,10<(a=(120>(a=Xe()-a)?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*jl(a/1960))-a)){e.timeoutHandle=nr(xc.bind(null,e,zl,Ul),a);break}xc(e,zl,Ul);break;default:throw Error(s(329))}}}return nc(e,Xe()),e.callbackNode===n?ac.bind(null,e):null}function rc(e,t){var n=$l;return e.current.memoizedState.isDehydrated&&(uc(e,t).flags|=256),2!==(e=fc(e,t))&&(t=zl,zl=n,null!==t&&sc(t)),e}function sc(e){null===zl?zl=e:zl.push.apply(zl,e)}function ic(e,t){for(t&=~Ll,t&=~Dl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-st(t),a=1<<n;e[n]=-1,t&=~a}}function oc(e){if(0!==(6&kl))throw Error(s(327));_c();var t=ut(e,0);if(0===(1&t))return nc(e,Xe()),null;var n=fc(e,t);if(0!==e.tag&&2===n){var a=pt(e);0!==a&&(t=a,n=rc(e,a))}if(1===n)throw n=Rl,uc(e,0),ic(e,t),nc(e,Xe()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,xc(e,zl,Ul),nc(e,Xe()),null}function lc(e,t){var n=kl;kl|=1;try{return e(t)}finally{0===(kl=n)&&(Bl=Xe()+500,$r&&Br())}}function cc(e){null!==Yl&&0===Yl.tag&&0===(6&kl)&&_c();var t=kl;kl|=1;var n=Sl.transition,a=bt;try{if(Sl.transition=null,bt=1,e)return e()}finally{bt=a,Sl.transition=n,0===(6&(kl=t))&&Br()}}function dc(){Pl=Il.current,Nr(Il)}function uc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ar(n)),null!==Al)for(n=Al.return;null!==n;){var a=n;switch(es(a),a.tag){case 1:null!==(a=a.type.childContextTypes)&&void 0!==a&&Ir();break;case 3:Gs(),Nr(Cr),Nr(kr),ti();break;case 5:Ks(a);break;case 4:Gs();break;case 13:case 19:Nr(Qs);break;case 10:Ss(a.type._context);break;case 22:case 23:dc()}n=n.return}if(Cl=e,Al=e=Ic(e.current,null),Tl=Pl=t,Ol=0,Rl=null,Ll=Dl=Ml=0,zl=$l=null,null!==Ts){for(t=0;t<Ts.length;t++)if(null!==(a=(n=Ts[t]).interleaved)){n.interleaved=null;var r=a.next,s=n.pending;if(null!==s){var i=s.next;s.next=r,a.next=i}n.pending=a}Ts=null}return e}function hc(e,t){for(;;){var n=Al;try{if(Es(),ni.current=Xi,li){for(var a=si.memoizedState;null!==a;){var r=a.queue;null!==r&&(r.pending=null),a=a.next}li=!1}if(ri=0,oi=ii=si=null,ci=!1,di=0,El.current=null,null===n||null===n.return){Ol=1,Rl=t,Al=null;break}e:{var i=e,o=n.return,l=n,c=t;if(t=Tl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,u=l,h=u.tag;if(0===(1&u.mode)&&(0===h||11===h||15===h)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=fo(o);if(null!==m){m.flags&=-257,go(m,o,l,0,t),1&m.mode&&mo(i,d,t),c=d;var f=(t=m).updateQueue;if(null===f){var g=new Set;g.add(c),t.updateQueue=g}else f.add(c);break e}if(0===(1&t)){mo(i,d,t),mc();break e}c=Error(s(426))}else if(as&&1&l.mode){var v=fo(o);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),go(v,o,l,0,t),ps(oo(c,l));break e}}i=c=oo(c,l),4!==Ol&&(Ol=2),null===$l?$l=[i]:$l.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t,Fs(i,ho(0,c,t));break e;case 1:l=c;var b=i.type,y=i.stateNode;if(0===(128&i.flags)&&("function"===typeof b.getDerivedStateFromError||null!==y&&"function"===typeof y.componentDidCatch&&(null===Hl||!Hl.has(y)))){i.flags|=65536,t&=-t,i.lanes|=t,Fs(i,po(i,l,t));break e}}i=i.return}while(null!==i)}yc(n)}catch(x){t=x,Al===n&&null!==n&&(Al=n=n.return);continue}break}}function pc(){var e=Nl.current;return Nl.current=Xi,null===e?Xi:e}function mc(){0!==Ol&&3!==Ol&&2!==Ol||(Ol=4),null===Cl||0===(268435455&Ml)&&0===(268435455&Dl)||ic(Cl,Tl)}function fc(e,t){var n=kl;kl|=2;var a=pc();for(Cl===e&&Tl===t||(Ul=null,uc(e,t));;)try{gc();break}catch(Uu){hc(e,Uu)}if(Es(),kl=n,Nl.current=a,null!==Al)throw Error(s(261));return Cl=null,Tl=0,Ol}function gc(){for(;null!==Al;)bc(Al)}function vc(){for(;null!==Al&&!Je();)bc(Al)}function bc(e){var t=wl(e.alternate,e,Pl);e.memoizedProps=e.pendingProps,null===t?yc(e):Al=t,El.current=null}function yc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=qo(n,t,Pl)))return void(Al=n)}else{if(null!==(n=Yo(n,t)))return n.flags&=32767,void(Al=n);if(null===e)return Ol=6,void(Al=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Al=t);Al=t=e}while(null!==t);0===Ol&&(Ol=5)}function xc(e,t,n){var a=bt,r=Sl.transition;try{Sl.transition=null,bt=1,function(e,t,n,a){do{_c()}while(null!==Yl);if(0!==(6&kl))throw Error(s(327));n=e.finishedWork;var r=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var a=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-st(n),s=1<<r;t[r]=0,a[r]=-1,e[r]=-1,n&=~s}}(e,i),e===Cl&&(Al=Cl=null,Tl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||ql||(ql=!0,Cc(et,(function(){return _c(),null}))),i=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||i){i=Sl.transition,Sl.transition=null;var o=bt;bt=1;var l=kl;kl|=4,El.current=null,function(e,t){if(Za=Wt,ha(e=ua())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var a=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(a&&0!==a.rangeCount){n=a.anchorNode;var r=a.anchorOffset,i=a.focusNode;a=a.focusOffset;try{n.nodeType,i.nodeType}catch(rh){n=null;break e}var o=0,l=-1,c=-1,d=0,u=0,h=e,p=null;t:for(;;){for(var m;h!==n||0!==r&&3!==h.nodeType||(l=o+r),h!==i||0!==a&&3!==h.nodeType||(c=o+a),3===h.nodeType&&(o+=h.nodeValue.length),null!==(m=h.firstChild);)p=h,h=m;for(;;){if(h===e)break t;if(p===n&&++d===r&&(l=o),p===i&&++u===a&&(c=o),null!==(m=h.nextSibling))break;p=(h=p).parentNode}h=m}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(er={focusedElem:e,selectionRange:n},Wt=!1,Ko=t;null!==Ko;)if(e=(t=Ko).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Ko=e;else for(;null!==Ko;){t=Ko;try{var f=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==f){var g=f.memoizedProps,v=f.memoizedState,b=t.stateNode,y=b.getSnapshotBeforeUpdate(t.elementType===t.type?g:eo(t.type,g),v);b.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(s(163))}}catch(rh){jc(t,t.return,rh)}if(null!==(e=t.sibling)){e.return=t.return,Ko=e;break}Ko=t.return}f=el,el=!1}(e,n),fl(n,e),pa(er),Wt=!!Za,er=Za=null,e.current=n,vl(n,e,r),Ge(),kl=l,bt=o,Sl.transition=i}else e.current=n;if(ql&&(ql=!1,Yl=e,Jl=r),i=e.pendingLanes,0===i&&(Hl=null),function(e){if(rt&&"function"===typeof rt.onCommitFiberRoot)try{rt.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),nc(e,Xe()),null!==t)for(a=e.onRecoverableError,n=0;n<t.length;n++)r=t[n],a(r.value,{componentStack:r.stack,digest:r.digest});if(Wl)throw Wl=!1,e=Vl,Vl=null,e;0!==(1&Jl)&&0!==e.tag&&_c(),i=e.pendingLanes,0!==(1&i)?e===Xl?Gl++:(Gl=0,Xl=e):Gl=0,Br()}(e,t,n,a)}finally{Sl.transition=r,bt=a}return null}function _c(){if(null!==Yl){var e=yt(Jl),t=Sl.transition,n=bt;try{if(Sl.transition=null,bt=16>e?16:e,null===Yl)var a=!1;else{if(e=Yl,Yl=null,Jl=0,0!==(6&kl))throw Error(s(331));var r=kl;for(kl|=4,Ko=e.current;null!==Ko;){var i=Ko,o=i.child;if(0!==(16&Ko.flags)){var l=i.deletions;if(null!==l){for(var c=0;c<l.length;c++){var d=l[c];for(Ko=d;null!==Ko;){var u=Ko;switch(u.tag){case 0:case 11:case 15:tl(8,u,i)}var h=u.child;if(null!==h)h.return=u,Ko=h;else for(;null!==Ko;){var p=(u=Ko).sibling,m=u.return;if(rl(u),u===d){Ko=null;break}if(null!==p){p.return=m,Ko=p;break}Ko=m}}}var f=i.alternate;if(null!==f){var g=f.child;if(null!==g){f.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Ko=i}}if(0!==(2064&i.subtreeFlags)&&null!==o)o.return=i,Ko=o;else e:for(;null!==Ko;){if(0!==(2048&(i=Ko).flags))switch(i.tag){case 0:case 11:case 15:tl(9,i,i.return)}var b=i.sibling;if(null!==b){b.return=i.return,Ko=b;break e}Ko=i.return}}var y=e.current;for(Ko=y;null!==Ko;){var x=(o=Ko).child;if(0!==(2064&o.subtreeFlags)&&null!==x)x.return=o,Ko=x;else e:for(o=y;null!==Ko;){if(0!==(2048&(l=Ko).flags))try{switch(l.tag){case 0:case 11:case 15:nl(9,l)}}catch(w){jc(l,l.return,w)}if(l===o){Ko=null;break e}var _=l.sibling;if(null!==_){_.return=l.return,Ko=_;break e}Ko=l.return}}if(kl=r,Br(),rt&&"function"===typeof rt.onPostCommitFiberRoot)try{rt.onPostCommitFiberRoot(at,e)}catch(w){}a=!0}return a}finally{bt=n,Sl.transition=t}}return!1}function wc(e,t,n){e=$s(e,t=ho(0,t=oo(n,t),1),1),t=Zl(),null!==e&&(gt(e,1,t),nc(e,t))}function jc(e,t,n){if(3===e.tag)wc(e,e,n);else for(;null!==t;){if(3===t.tag){wc(t,e,n);break}if(1===t.tag){var a=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof a.componentDidCatch&&(null===Hl||!Hl.has(a))){t=$s(t,e=po(t,e=oo(n,e),1),1),e=Zl(),null!==t&&(gt(t,1,e),nc(t,e));break}}t=t.return}}function Nc(e,t,n){var a=e.pingCache;null!==a&&a.delete(t),t=Zl(),e.pingedLanes|=e.suspendedLanes&n,Cl===e&&(Tl&n)===n&&(4===Ol||3===Ol&&(130023424&Tl)===Tl&&500>Xe()-Fl?uc(e,0):Ll|=n),nc(e,t)}function Ec(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ct,0===(130023424&(ct<<=1))&&(ct=4194304)));var n=Zl();null!==(e=Os(e,t))&&(gt(e,t,n),nc(e,n))}function Sc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ec(e,n)}function kc(e,t){var n=0;switch(e.tag){case 13:var a=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:a=e.stateNode;break;default:throw Error(s(314))}null!==a&&a.delete(t),Ec(e,n)}function Cc(e,t){return qe(e,t)}function Ac(e,t,n,a){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Tc(e,t,n,a){return new Ac(e,t,n,a)}function Pc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ic(e,t){var n=e.alternate;return null===n?((n=Tc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Oc(e,t,n,a,r,i){var o=2;if(a=e,"function"===typeof e)Pc(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case j:return Rc(n.children,r,i,t);case N:o=8,r|=8;break;case E:return(e=Tc(12,n,t,2|r)).elementType=E,e.lanes=i,e;case A:return(e=Tc(13,n,t,r)).elementType=A,e.lanes=i,e;case T:return(e=Tc(19,n,t,r)).elementType=T,e.lanes=i,e;case O:return Mc(n,r,i,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case S:o=10;break e;case k:o=9;break e;case C:o=11;break e;case P:o=14;break e;case I:o=16,a=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Tc(o,n,t,r)).elementType=e,t.type=a,t.lanes=i,t}function Rc(e,t,n,a){return(e=Tc(7,e,a,t)).lanes=n,e}function Mc(e,t,n,a){return(e=Tc(22,e,a,t)).elementType=O,e.lanes=n,e.stateNode={isHidden:!1},e}function Dc(e,t,n){return(e=Tc(6,e,null,t)).lanes=n,e}function Lc(e,t,n){return(t=Tc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function $c(e,t,n,a,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ft(0),this.expirationTimes=ft(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ft(0),this.identifierPrefix=a,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function zc(e,t,n,a,r,s,i,o,l){return e=new $c(e,t,n,o,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Tc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:a,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ms(s),e}function Fc(e){if(!e)return Sr;e:{if(Be(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Pr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Pr(n))return Rr(e,n,t)}return t}function Bc(e,t,n,a,r,s,i,o,l){return(e=zc(n,a,!0,e,0,s,0,o,l)).context=Fc(null),n=e.current,(s=Ls(a=Zl(),r=ec(n))).callback=void 0!==t&&null!==t?t:null,$s(n,s,r),e.current.lanes=r,gt(e,r,a),nc(e,a),e}function Uc(e,t,n,a){var r=t.current,s=Zl(),i=ec(r);return n=Fc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Ls(s,i)).payload={element:e},null!==(a=void 0===a?null:a)&&(t.callback=a),null!==(e=$s(r,t,i))&&(tc(e,r,i,s),zs(e,r,i)),i}function Wc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Vc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Hc(e,t){Vc(e,t),(e=e.alternate)&&Vc(e,t)}wl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Cr.current)bo=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return bo=!1,function(e,t,n){switch(t.tag){case 3:Co(t),hs();break;case 5:Xs(t);break;case 1:Pr(t.type)&&Mr(t);break;case 4:Js(t,t.stateNode.containerInfo);break;case 10:var a=t.type._context,r=t.memoizedProps.value;Er(_s,a._currentValue),a._currentValue=r;break;case 13:if(null!==(a=t.memoizedState))return null!==a.dehydrated?(Er(Qs,1&Qs.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Do(e,t,n):(Er(Qs,1&Qs.current),null!==(e=Wo(e,t,n))?e.sibling:null);Er(Qs,1&Qs.current);break;case 19:if(a=0!==(n&t.childLanes),0!==(128&e.flags)){if(a)return Bo(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Er(Qs,Qs.current),a)break;return null;case 22:case 23:return t.lanes=0,jo(e,t,n)}return Wo(e,t,n)}(e,t,n);bo=0!==(131072&e.flags)}else bo=!1,as&&0!==(1048576&t.flags)&&Qr(t,Hr,t.index);switch(t.lanes=0,t.tag){case 2:var a=t.type;Uo(e,t),e=t.pendingProps;var r=Tr(t,kr.current);Cs(t,n),r=mi(null,t,a,e,r,n);var i=fi();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Pr(a)?(i=!0,Mr(t)):i=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Ms(t),r.updater=no,t.stateNode=r,r._reactInternals=t,io(t,a,e,n),t=ko(null,t,a,!0,i,n)):(t.tag=0,as&&i&&Zr(t),yo(null,t,r,n),t=t.child),t;case 16:a=t.elementType;e:{switch(Uo(e,t),e=t.pendingProps,a=(r=a._init)(a._payload),t.type=a,r=t.tag=function(e){if("function"===typeof e)return Pc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===C)return 11;if(e===P)return 14}return 2}(a),e=eo(a,e),r){case 0:t=Eo(null,t,a,e,n);break e;case 1:t=So(null,t,a,e,n);break e;case 11:t=xo(null,t,a,e,n);break e;case 14:t=_o(null,t,a,eo(a.type,e),n);break e}throw Error(s(306,a,""))}return t;case 0:return a=t.type,r=t.pendingProps,Eo(e,t,a,r=t.elementType===a?r:eo(a,r),n);case 1:return a=t.type,r=t.pendingProps,So(e,t,a,r=t.elementType===a?r:eo(a,r),n);case 3:e:{if(Co(t),null===e)throw Error(s(387));a=t.pendingProps,r=(i=t.memoizedState).element,Ds(e,t),Bs(t,a,null,n);var o=t.memoizedState;if(a=o.element,i.isDehydrated){if(i={element:a,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=Ao(e,t,a,n,r=oo(Error(s(423)),t));break e}if(a!==r){t=Ao(e,t,a,n,r=oo(Error(s(424)),t));break e}for(ns=lr(t.stateNode.containerInfo.firstChild),ts=t,as=!0,rs=null,n=xs(t,null,a,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(hs(),a===r){t=Wo(e,t,n);break e}yo(e,t,a,n)}t=t.child}return t;case 5:return Xs(t),null===e&&ls(t),a=t.type,r=t.pendingProps,i=null!==e?e.memoizedProps:null,o=r.children,tr(a,r)?o=null:null!==i&&tr(a,i)&&(t.flags|=32),No(e,t),yo(e,t,o,n),t.child;case 6:return null===e&&ls(t),null;case 13:return Do(e,t,n);case 4:return Js(t,t.stateNode.containerInfo),a=t.pendingProps,null===e?t.child=ys(t,null,a,n):yo(e,t,a,n),t.child;case 11:return a=t.type,r=t.pendingProps,xo(e,t,a,r=t.elementType===a?r:eo(a,r),n);case 7:return yo(e,t,t.pendingProps,n),t.child;case 8:case 12:return yo(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(a=t.type._context,r=t.pendingProps,i=t.memoizedProps,o=r.value,Er(_s,a._currentValue),a._currentValue=o,null!==i)if(ia(i.value,o)){if(i.children===r.children&&!Cr.current){t=Wo(e,t,n);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var l=i.dependencies;if(null!==l){o=i.child;for(var c=l.firstContext;null!==c;){if(c.context===a){if(1===i.tag){(c=Ls(-1,n&-n)).tag=2;var d=i.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=n,null!==(c=i.alternate)&&(c.lanes|=n),ks(i.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===i.tag)o=i.type===t.type?null:i.child;else if(18===i.tag){if(null===(o=i.return))throw Error(s(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),ks(o,n,t),o=i.sibling}else o=i.child;if(null!==o)o.return=i;else for(o=i;null!==o;){if(o===t){o=null;break}if(null!==(i=o.sibling)){i.return=o.return,o=i;break}o=o.return}i=o}yo(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,a=t.pendingProps.children,Cs(t,n),a=a(r=As(r)),t.flags|=1,yo(e,t,a,n),t.child;case 14:return r=eo(a=t.type,t.pendingProps),_o(e,t,a,r=eo(a.type,r),n);case 15:return wo(e,t,t.type,t.pendingProps,n);case 17:return a=t.type,r=t.pendingProps,r=t.elementType===a?r:eo(a,r),Uo(e,t),t.tag=1,Pr(a)?(e=!0,Mr(t)):e=!1,Cs(t,n),ro(t,a,r),io(t,a,r,n),ko(null,t,a,!0,e,n);case 19:return Bo(e,t,n);case 22:return jo(e,t,n)}throw Error(s(156,t.tag))};var qc="function"===typeof reportError?reportError:function(e){console.error(e)};function Yc(e){this._internalRoot=e}function Jc(e){this._internalRoot=e}function Gc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Kc(){}function Qc(e,t,n,a,r){var s=n._reactRootContainer;if(s){var i=s;if("function"===typeof r){var o=r;r=function(){var e=Wc(i);o.call(e)}}Uc(t,i,e,r)}else i=function(e,t,n,a,r){if(r){if("function"===typeof a){var s=a;a=function(){var e=Wc(i);s.call(e)}}var i=Bc(t,a,e,0,null,!1,0,"",Kc);return e._reactRootContainer=i,e[pr]=i.current,Ba(8===e.nodeType?e.parentNode:e),cc(),i}for(;r=e.lastChild;)e.removeChild(r);if("function"===typeof a){var o=a;a=function(){var e=Wc(l);o.call(e)}}var l=zc(e,0,!1,null,0,!1,0,"",Kc);return e._reactRootContainer=l,e[pr]=l.current,Ba(8===e.nodeType?e.parentNode:e),cc((function(){Uc(t,l,n,a)})),l}(n,t,e,r,a);return Wc(i)}Jc.prototype.render=Yc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Uc(e,t,null,null)},Jc.prototype.unmount=Yc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;cc((function(){Uc(null,e,null,null)})),t[pr]=null}},Jc.prototype.unstable_scheduleHydration=function(e){if(e){var t=jt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<It.length&&0!==t&&t<It[n].priority;n++);It.splice(n,0,e),0===n&&Dt(e)}},xt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(vt(t,1|n),nc(t,Xe()),0===(6&kl)&&(Bl=Xe()+500,Br()))}break;case 13:cc((function(){var t=Os(e,1);if(null!==t){var n=Zl();tc(t,e,1,n)}})),Hc(e,1)}},_t=function(e){if(13===e.tag){var t=Os(e,134217728);if(null!==t)tc(t,e,134217728,Zl());Hc(e,134217728)}},wt=function(e){if(13===e.tag){var t=ec(e),n=Os(e,t);if(null!==n)tc(n,e,t,Zl());Hc(e,t)}},jt=function(){return bt},Nt=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},_e=function(e,t,n){switch(t){case"input":if(Q(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var a=n[t];if(a!==e&&a.form===e.form){var r=xr(a);if(!r)throw Error(s(90));Y(a),Q(a,r)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},ke=lc,Ce=cc;var Zc={usingClientEntryPoint:!1,Events:[br,yr,xr,Ee,Se,lc]},ed={findFiberByHostInstance:vr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},td={bundleType:ed.bundleType,version:ed.version,rendererPackageName:ed.rendererPackageName,rendererConfig:ed.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ve(e))?null:e.stateNode},findFiberByHostInstance:ed.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var nd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nd.isDisabled&&nd.supportsFiber)try{at=nd.inject(td),rt=nd}catch(Hu){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Zc,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Gc(t))throw Error(s(200));return function(e,t,n){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==a?null:""+a,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Gc(e))throw Error(s(299));var n=!1,a="",r=qc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(a=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=zc(e,1,!1,null,0,n,0,a,r),e[pr]=t.current,Ba(8===e.nodeType?e.parentNode:e),new Yc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=Ve(t))?null:e.stateNode},t.flushSync=function(e){return cc(e)},t.hydrate=function(e,t,n){if(!Xc(t))throw Error(s(200));return Qc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Gc(e))throw Error(s(405));var a=null!=n&&n.hydratedSources||null,r=!1,i="",o=qc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=Bc(t,null,e,1,null!=n?n:null,r,0,i,o),e[pr]=t.current,Ba(e),a)for(e=0;e<a.length;e++)r=(r=(n=a[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new Jc(t)},t.render=function(e,t,n){if(!Xc(t))throw Error(s(200));return Qc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Xc(e))throw Error(s(40));return!!e._reactRootContainer&&(cc((function(){Qc(null,null,e,!1,(function(){e._reactRootContainer=null,e[pr]=null}))})),!0)},t.unstable_batchedUpdates=lc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,a){if(!Xc(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return Qc(e,t,n,!1,a)},t.version="18.3.1-next-f1338f8080-20240426"},736:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(n(374));class s extends r.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const n=Array.from(new Set(t)).map((e=>"string"===typeof e&&new RegExp("[,()]").test(e)?`"${e}"`:`${e}`)).join(",");return this.url.searchParams.append(e,`in.(${n})`),this}contains(e,t){return"string"===typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"===typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"===typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t){let{config:n,type:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r="";"plain"===a?r="pl":"phrase"===a?r="ph":"websearch"===a&&(r="w");const s=void 0===n?"":`(${n})`;return this.url.searchParams.append(e,`${r}fts${s}.${t}`),this}match(e){return Object.entries(e).forEach((e=>{let[t,n]=e;this.url.searchParams.append(t,`eq.${n}`)})),this}not(e,t,n){return this.url.searchParams.append(e,`not.${t}.${n}`),this}or(e){let{foreignTable:t,referencedTable:n=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=n?`${n}.or`:"or";return this.url.searchParams.append(a,`(${e})`),this}filter(e,t,n){return this.url.searchParams.append(e,`${t}.${n}`),this}}t.default=s},745:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_HEADERS=void 0;const a=n(400);t.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${a.version}`}},823:(e,t,n)=>{n.r(t),n.d(t,{APPLICATION_TYPE:()=>a,APPLICATION_TYPE_LABELS:()=>r});let a=function(e){return e.AUTO_LOAN="AUTO_LOAN",e.CAR_BACKED_LOAN="CAR_BACKED_LOAN",e.PERSONAL_LOAN="PERSONAL_LOAN",e.CASH_ADVANCE="CASH_ADVANCE",e.SELECTED_PLANS="selected_plans",e.PRODUCT_SIMULATIONS="product_simulations",e.CASH_REQUESTS="cash_requests",e}({});const r={[a.AUTO_LOAN]:"Cr\xe9dito Automotriz",[a.CAR_BACKED_LOAN]:"Cr\xe9dito con Garant\xeda Automotriz",[a.PERSONAL_LOAN]:"Pr\xe9stamo Personal",[a.CASH_ADVANCE]:"Adelanto de Efectivo",[a.SELECTED_PLANS]:"Planes Seleccionados",[a.PRODUCT_SIMULATIONS]:"Simulaci\xf3n de Producto",[a.CASH_REQUESTS]:"Solicitud de Efectivo"}},829:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(n(736));t.default=class{constructor(e,t){let{headers:n={},schema:a,fetch:r}=t;this.url=e,this.headers=n,this.schema=a,this.fetch=r}select(e){let{head:t=!1,count:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=t?"HEAD":"GET";let s=!1;const i=(null!==e&&void 0!==e?e:"*").split("").map((e=>/\s/.test(e)&&!s?"":('"'===e&&(s=!s),e))).join("");return this.url.searchParams.set("select",i),n&&(this.headers.Prefer=`count=${n}`),new r.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e){let{count:t,defaultToNull:n=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=[];if(this.headers.Prefer&&a.push(this.headers.Prefer),t&&a.push(`count=${t}`),n||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>`"${e}"`));this.url.searchParams.set("columns",e.join(","))}}return new r.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e){let{onConflict:t,ignoreDuplicates:n=!1,count:a,defaultToNull:s=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=[`resolution=${n?"ignore":"merge"}-duplicates`];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&i.push(this.headers.Prefer),a&&i.push(`count=${a}`),s||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>`"${e}"`));this.url.searchParams.set("columns",e.join(","))}}return new r.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e){let{count:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=[];return this.headers.Prefer&&n.push(this.headers.Prefer),t&&n.push(`count=${t}`),this.headers.Prefer=n.join(","),new r.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete(){let{count:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new r.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}},853:(e,t,n)=>{e.exports=n(234)},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)},980:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PostgrestError=t.PostgrestBuilder=t.PostgrestTransformBuilder=t.PostgrestFilterBuilder=t.PostgrestQueryBuilder=t.PostgrestClient=void 0;const r=a(n(210));t.PostgrestClient=r.default;const s=a(n(829));t.PostgrestQueryBuilder=s.default;const i=a(n(736));t.PostgrestFilterBuilder=i.default;const o=a(n(374));t.PostgrestTransformBuilder=o.default;const l=a(n(286));t.PostgrestBuilder=l.default;const c=a(n(611));t.PostgrestError=c.default,t.default={PostgrestClient:r.default,PostgrestQueryBuilder:s.default,PostgrestFilterBuilder:i.default,PostgrestTransformBuilder:o.default,PostgrestBuilder:l.default,PostgrestError:c.default}}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var s=t[a]={exports:{}};return e[a].call(s.exports,s,s.exports,n),s.exports}n.m=e,(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(a,r){if(1&r&&(a=this(a)),8&r)return a;if("object"===typeof a&&a){if(4&r&&a.__esModule)return a;if(16&r&&"function"===typeof a.then)return a}var s=Object.create(null);n.r(s);var i={};e=e||[null,t({}),t([]),t(t)];for(var o=2&r&&a;"object"==typeof o&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach((e=>i[e]=()=>a[e]));return i.default=()=>a,n.d(s,i),s}})(),n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,a)=>(n.f[a](e,t),t)),[])),n.u=e=>"static/js/"+e+"."+{198:"f77ab7e2",453:"42e6a660"}[e]+".chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(Uu){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="fincentiva-crm:";n.l=(a,r,s,i)=>{if(e[a])e[a].push(r);else{var o,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==a||u.getAttribute("data-webpack")==t+s){o=u;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+s),o.src=a),e[a]=[r];var h=(t,n)=>{o.onerror=o.onload=null,clearTimeout(p);var r=e[a];if(delete e[a],o.parentNode&&o.parentNode.removeChild(o),r&&r.forEach((e=>e(n))),t)return t(n)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=h.bind(null,o.onerror),o.onload=h.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/",(()=>{var e={792:0};n.f.j=(t,a)=>{var r=n.o(e,t)?e[t]:void 0;if(0!==r)if(r)a.push(r[2]);else{var s=new Promise(((n,a)=>r=e[t]=[n,a]));a.push(r[2]=s);var i=n.p+n.u(t),o=new Error;n.l(i,(a=>{if(n.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var s=a&&("load"===a.type?"missing":a.type),i=a&&a.target&&a.target.src;o.message="Loading chunk "+t+" failed.\n("+s+": "+i+")",o.name="ChunkLoadError",o.type=s,o.request=i,r[1](o)}}),"chunk-"+t,t)}};var t=(t,a)=>{var r,s,i=a[0],o=a[1],l=a[2],c=0;if(i.some((t=>0!==e[t]))){for(r in o)n.o(o,r)&&(n.m[r]=o[r]);if(l)l(n)}for(t&&t(a);c<i.length;c++)s=i[c],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0},a=self.webpackChunkfincentiva_crm=self.webpackChunkfincentiva_crm||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var a,r=n(43),s=n.t(r,2),i=n(391),o=n(950),l=n.t(o,2);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},c.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(a||(a={}));const d="popstate";function u(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function h(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(Uu){}}}function p(e,t){return{usr:e.state,key:e.key,idx:t}}function m(e,t,n,a){return void 0===n&&(n=null),c({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?g(t):t,{state:n,key:t&&t.key||a||Math.random().toString(36).substr(2,8)})}function f(e){let{pathname:t="/",search:n="",hash:a=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),a&&"#"!==a&&(t+="#"===a.charAt(0)?a:"#"+a),t}function g(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let a=e.indexOf("?");a>=0&&(t.search=e.substr(a),e=e.substr(0,a)),e&&(t.pathname=e)}return t}function v(e,t,n,r){void 0===r&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,l=a.Pop,h=null,g=v();function v(){return(o.state||{idx:null}).idx}function b(){l=a.Pop;let e=v(),t=null==e?null:e-g;g=e,h&&h({action:l,location:x.location,delta:t})}function y(e){let t="null"!==s.location.origin?s.location.origin:s.location.href,n="string"===typeof e?e:f(e);return n=n.replace(/ $/,"%20"),u(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==g&&(g=0,o.replaceState(c({},o.state,{idx:g}),""));let x={get action(){return l},get location(){return e(s,o)},listen(e){if(h)throw new Error("A history only accepts one active listener");return s.addEventListener(d,b),h=e,()=>{s.removeEventListener(d,b),h=null}},createHref:e=>t(s,e),createURL:y,encodeLocation(e){let t=y(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){l=a.Push;let r=m(x.location,e,t);n&&n(r,e),g=v()+1;let c=p(r,g),d=x.createHref(r);try{o.pushState(c,"",d)}catch(u){if(u instanceof DOMException&&"DataCloneError"===u.name)throw u;s.location.assign(d)}i&&h&&h({action:l,location:x.location,delta:1})},replace:function(e,t){l=a.Replace;let r=m(x.location,e,t);n&&n(r,e),g=v();let s=p(r,g),c=x.createHref(r);o.replaceState(s,"",c),i&&h&&h({action:l,location:x.location,delta:0})},go:e=>o.go(e)};return x}var b;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(b||(b={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function y(e,t,n){return void 0===n&&(n="/"),x(e,t,n,!1)}function x(e,t,n,a){let r=R(("string"===typeof t?g(t):t).pathname||"/",n);if(null==r)return null;let s=_(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every(((e,n)=>e===t[n]));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(s);let i=null;for(let o=0;null==i&&o<s.length;++o){let e=O(r);i=P(s[o],e,a)}return i}function _(e,t,n,a){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===a&&(a="");let r=(e,r,s)=>{let i={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:r,route:e};i.relativePath.startsWith("/")&&(u(i.relativePath.startsWith(a),'Absolute route path "'+i.relativePath+'" nested under path "'+a+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),i.relativePath=i.relativePath.slice(a.length));let o=z([a,i.relativePath]),l=n.concat(i);e.children&&e.children.length>0&&(u(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+o+'".'),_(e.children,t,l,o)),(null!=e.path||e.index)&&t.push({path:o,score:T(o,e.index),routesMeta:l})};return e.forEach(((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let a of w(e.path))r(e,t,a);else r(e,t)})),t}function w(e){let t=e.split("/");if(0===t.length)return[];let[n,...a]=t,r=n.endsWith("?"),s=n.replace(/\?$/,"");if(0===a.length)return r?[s,""]:[s];let i=w(a.join("/")),o=[];return o.push(...i.map((e=>""===e?s:[s,e].join("/")))),r&&o.push(...i),o.map((t=>e.startsWith("/")&&""===t?"/":t))}const j=/^:[\w-]+$/,N=3,E=2,S=1,k=10,C=-2,A=e=>"*"===e;function T(e,t){let n=e.split("/"),a=n.length;return n.some(A)&&(a+=C),t&&(a+=E),n.filter((e=>!A(e))).reduce(((e,t)=>e+(j.test(t)?N:""===t?S:k)),a)}function P(e,t,n){void 0===n&&(n=!1);let{routesMeta:a}=e,r={},s="/",i=[];for(let o=0;o<a.length;++o){let e=a[o],l=o===a.length-1,c="/"===s?t:t.slice(s.length)||"/",d=I({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),u=e.route;if(!d&&l&&n&&!a[a.length-1].route.index&&(d=I({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!d)return null;Object.assign(r,d.params),i.push({params:r,pathname:z([s,d.pathname]),pathnameBase:F(z([s,d.pathnameBase])),route:u}),"/"!==d.pathnameBase&&(s=z([s,d.pathnameBase]))}return i}function I(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,a]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);h("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let a=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,n)=>(a.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(a.push({paramName:"*"}),r+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":""!==e&&"/"!==e&&(r+="(?:(?=\\/|$))");let s=new RegExp(r,t?void 0:"i");return[s,a]}(e.path,e.caseSensitive,e.end),r=t.match(n);if(!r)return null;let s=r[0],i=s.replace(/(.)\/+$/,"$1"),o=r.slice(1),l=a.reduce(((e,t,n)=>{let{paramName:a,isOptional:r}=t;if("*"===a){let e=o[n]||"";i=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[n];return e[a]=r&&!l?void 0:(l||"").replace(/%2F/g,"/"),e}),{});return{params:l,pathname:s,pathnameBase:i,pattern:e}}function O(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return h(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function R(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,a=e.charAt(n);return a&&"/"!==a?null:e.slice(n)||"/"}function M(e,t,n,a){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(a)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function D(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function L(e,t){let n=D(e);return t?n.map(((e,t)=>t===n.length-1?e.pathname:e.pathnameBase)):n.map((e=>e.pathnameBase))}function $(e,t,n,a){let r;void 0===a&&(a=!1),"string"===typeof e?r=g(e):(r=c({},e),u(!r.pathname||!r.pathname.includes("?"),M("?","pathname","search",r)),u(!r.pathname||!r.pathname.includes("#"),M("#","pathname","hash",r)),u(!r.search||!r.search.includes("#"),M("#","search","hash",r)));let s,i=""===e||""===r.pathname,o=i?"/":r.pathname;if(null==o)s=n;else{let e=t.length-1;if(!a&&o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}s=e>=0?t[e]:"/"}let l=function(e,t){void 0===t&&(t="/");let{pathname:n,search:a="",hash:r=""}="string"===typeof e?g(e):e,s=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:s,search:B(a),hash:U(r)}}(r,s),d=o&&"/"!==o&&o.endsWith("/"),h=(i||"."===o)&&n.endsWith("/");return l.pathname.endsWith("/")||!d&&!h||(l.pathname+="/"),l}const z=e=>e.join("/").replace(/\/\/+/g,"/"),F=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),B=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",U=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function W(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const V=["post","put","patch","delete"],H=(new Set(V),["get",...V]);new Set(H),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function q(){return q=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},q.apply(this,arguments)}const Y=r.createContext(null);const J=r.createContext(null);const G=r.createContext(null);const X=r.createContext(null);const K=r.createContext({outlet:null,matches:[],isDataRoute:!1});const Q=r.createContext(null);function Z(){return null!=r.useContext(X)}function ee(){return Z()||u(!1),r.useContext(X).location}function te(e){r.useContext(G).static||r.useLayoutEffect(e)}function ne(){let{isDataRoute:e}=r.useContext(K);return e?function(){let{router:e}=pe(ue.UseNavigateStable),t=fe(he.UseNavigateStable),n=r.useRef(!1);te((()=>{n.current=!0}));let a=r.useCallback((function(a,r){void 0===r&&(r={}),n.current&&("number"===typeof a?e.navigate(a):e.navigate(a,q({fromRouteId:t},r)))}),[e,t]);return a}():function(){Z()||u(!1);let e=r.useContext(Y),{basename:t,future:n,navigator:a}=r.useContext(G),{matches:s}=r.useContext(K),{pathname:i}=ee(),o=JSON.stringify(L(s,n.v7_relativeSplatPath)),l=r.useRef(!1);te((()=>{l.current=!0}));let c=r.useCallback((function(n,r){if(void 0===r&&(r={}),!l.current)return;if("number"===typeof n)return void a.go(n);let s=$(n,JSON.parse(o),i,"path"===r.relative);null==e&&"/"!==t&&(s.pathname="/"===s.pathname?t:z([t,s.pathname])),(r.replace?a.replace:a.push)(s,r.state,r)}),[t,a,o,i,e]);return c}()}function ae(){let{matches:e}=r.useContext(K),t=e[e.length-1];return t?t.params:{}}function re(e,t){let{relative:n}=void 0===t?{}:t,{future:a}=r.useContext(G),{matches:s}=r.useContext(K),{pathname:i}=ee(),o=JSON.stringify(L(s,a.v7_relativeSplatPath));return r.useMemo((()=>$(e,JSON.parse(o),i,"path"===n)),[e,o,i,n])}function se(e,t,n,s){Z()||u(!1);let{navigator:i,static:o}=r.useContext(G),{matches:l}=r.useContext(K),c=l[l.length-1],d=c?c.params:{},h=(c&&c.pathname,c?c.pathnameBase:"/");c&&c.route;let p,m=ee();if(t){var f;let e="string"===typeof t?g(t):t;"/"===h||(null==(f=e.pathname)?void 0:f.startsWith(h))||u(!1),p=e}else p=m;let v=p.pathname||"/",b=v;if("/"!==h){let e=h.replace(/^\//,"").split("/");b="/"+v.replace(/^\//,"").split("/").slice(e.length).join("/")}let x=!o&&n&&n.matches&&n.matches.length>0?n.matches:y(e,{pathname:b});let _=de(x&&x.map((e=>Object.assign({},e,{params:Object.assign({},d,e.params),pathname:z([h,i.encodeLocation?i.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?h:z([h,i.encodeLocation?i.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),l,n,s);return t&&_?r.createElement(X.Provider,{value:{location:q({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:a.Pop}},_):_}function ie(){let e=function(){var e;let t=r.useContext(Q),n=me(he.UseRouteError),a=fe(he.UseRouteError);if(void 0!==t)return t;return null==(e=n.errors)?void 0:e[a]}(),t=W(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,a="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:a};return r.createElement(r.Fragment,null,r.createElement("h2",null,"Unexpected Application Error!"),r.createElement("h3",{style:{fontStyle:"italic"}},t),n?r.createElement("pre",{style:s},n):null,null)}const oe=r.createElement(ie,null);class le extends r.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?r.createElement(K.Provider,{value:this.props.routeContext},r.createElement(Q.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ce(e){let{routeContext:t,match:n,children:a}=e,s=r.useContext(Y);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),r.createElement(K.Provider,{value:t},a)}function de(e,t,n,a){var s;if(void 0===t&&(t=[]),void 0===n&&(n=null),void 0===a&&(a=null),null==e){var i;if(!n)return null;if(n.errors)e=n.matches;else{if(!(null!=(i=a)&&i.v7_partialHydration&&0===t.length&&!n.initialized&&n.matches.length>0))return null;e=n.matches}}let o=e,l=null==(s=n)?void 0:s.errors;if(null!=l){let e=o.findIndex((e=>e.route.id&&void 0!==(null==l?void 0:l[e.route.id])));e>=0||u(!1),o=o.slice(0,Math.min(o.length,e+1))}let c=!1,d=-1;if(n&&a&&a.v7_partialHydration)for(let r=0;r<o.length;r++){let e=o[r];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(d=r),e.route.id){let{loaderData:t,errors:a}=n,r=e.route.loader&&void 0===t[e.route.id]&&(!a||void 0===a[e.route.id]);if(e.route.lazy||r){c=!0,o=d>=0?o.slice(0,d+1):[o[0]];break}}}return o.reduceRight(((e,a,s)=>{let i,u=!1,h=null,p=null;var m;n&&(i=l&&a.route.id?l[a.route.id]:void 0,h=a.route.errorElement||oe,c&&(d<0&&0===s?(m="route-fallback",!1||ge[m]||(ge[m]=!0),u=!0,p=null):d===s&&(u=!0,p=a.route.hydrateFallbackElement||null)));let f=t.concat(o.slice(0,s+1)),g=()=>{let t;return t=i?h:u?p:a.route.Component?r.createElement(a.route.Component,null):a.route.element?a.route.element:e,r.createElement(ce,{match:a,routeContext:{outlet:e,matches:f,isDataRoute:null!=n},children:t})};return n&&(a.route.ErrorBoundary||a.route.errorElement||0===s)?r.createElement(le,{location:n.location,revalidation:n.revalidation,component:h,error:i,children:g(),routeContext:{outlet:null,matches:f,isDataRoute:!0}}):g()}),null)}var ue=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(ue||{}),he=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(he||{});function pe(e){let t=r.useContext(Y);return t||u(!1),t}function me(e){let t=r.useContext(J);return t||u(!1),t}function fe(e){let t=function(){let e=r.useContext(K);return e||u(!1),e}(),n=t.matches[t.matches.length-1];return n.route.id||u(!1),n.route.id}const ge={};function ve(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}s.startTransition;function be(e){let{to:t,replace:n,state:a,relative:s}=e;Z()||u(!1);let{future:i,static:o}=r.useContext(G),{matches:l}=r.useContext(K),{pathname:c}=ee(),d=ne(),h=$(t,L(l,i.v7_relativeSplatPath),c,"path"===s),p=JSON.stringify(h);return r.useEffect((()=>d(JSON.parse(p),{replace:n,state:a,relative:s})),[d,p,s,n,a]),null}function ye(e){u(!1)}function xe(e){let{basename:t="/",children:n=null,location:s,navigationType:i=a.Pop,navigator:o,static:l=!1,future:c}=e;Z()&&u(!1);let d=t.replace(/^\/*/,"/"),h=r.useMemo((()=>({basename:d,navigator:o,static:l,future:q({v7_relativeSplatPath:!1},c)})),[d,c,o,l]);"string"===typeof s&&(s=g(s));let{pathname:p="/",search:m="",hash:f="",state:v=null,key:b="default"}=s,y=r.useMemo((()=>{let e=R(p,d);return null==e?null:{location:{pathname:e,search:m,hash:f,state:v,key:b},navigationType:i}}),[d,p,m,f,v,b,i]);return null==y?null:r.createElement(G.Provider,{value:h},r.createElement(X.Provider,{children:n,value:y}))}function _e(e){let{children:t,location:n}=e;return se(we(t),n)}new Promise((()=>{}));r.Component;function we(e,t){void 0===t&&(t=[]);let n=[];return r.Children.forEach(e,((e,a)=>{if(!r.isValidElement(e))return;let s=[...t,a];if(e.type===r.Fragment)return void n.push.apply(n,we(e.props.children,s));e.type!==ye&&u(!1),e.props.index&&e.props.children&&u(!1);let i={id:e.props.id||s.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(i.children=we(e.props.children,s)),n.push(i)})),n}function je(){return je=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},je.apply(this,arguments)}function Ne(e,t){if(null==e)return{};var n,a,r={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const Ee=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(Uu){}new Map;const Se=s.startTransition;l.flushSync,s.useId;function ke(e){let{basename:t,children:n,future:a,window:s}=e,i=r.useRef();var o;null==i.current&&(i.current=(void 0===(o={window:s,v5Compat:!0})&&(o={}),v((function(e,t){let{pathname:n,search:a,hash:r}=e.location;return m("",{pathname:n,search:a,hash:r},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:f(t)}),null,o)));let l=i.current,[c,d]=r.useState({action:l.action,location:l.location}),{v7_startTransition:u}=a||{},h=r.useCallback((e=>{u&&Se?Se((()=>d(e))):d(e)}),[d,u]);return r.useLayoutEffect((()=>l.listen(h)),[l,h]),r.useEffect((()=>ve(a)),[a]),r.createElement(xe,{basename:t,children:n,location:c.location,navigationType:c.action,navigator:l,future:a})}const Ce="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,Ae=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Te=r.forwardRef((function(e,t){let n,{onClick:a,relative:s,reloadDocument:i,replace:o,state:l,target:c,to:d,preventScrollReset:h,viewTransition:p}=e,m=Ne(e,Ee),{basename:g}=r.useContext(G),v=!1;if("string"===typeof d&&Ae.test(d)&&(n=d,Ce))try{let e=new URL(window.location.href),t=d.startsWith("//")?new URL(e.protocol+d):new URL(d),n=R(t.pathname,g);t.origin===e.origin&&null!=n?d=n+t.search+t.hash:v=!0}catch(Uu){}let b=function(e,t){let{relative:n}=void 0===t?{}:t;Z()||u(!1);let{basename:a,navigator:s}=r.useContext(G),{hash:i,pathname:o,search:l}=re(e,{relative:n}),c=o;return"/"!==a&&(c="/"===o?a:z([a,o])),s.createHref({pathname:c,search:l,hash:i})}(d,{relative:s}),y=function(e,t){let{target:n,replace:a,state:s,preventScrollReset:i,relative:o,viewTransition:l}=void 0===t?{}:t,c=ne(),d=ee(),u=re(e,{relative:o});return r.useCallback((t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,n)){t.preventDefault();let n=void 0!==a?a:f(d)===f(u);c(e,{replace:n,state:s,preventScrollReset:i,relative:o,viewTransition:l})}}),[d,c,u,a,s,n,e,i,o,l])}(d,{replace:o,state:l,target:c,preventScrollReset:h,relative:s,viewTransition:p});return r.createElement("a",je({},m,{href:n||b,onClick:v||i?a:function(e){a&&a(e),e.defaultPrevented||y(e)},ref:t,target:c}))}));var Pe,Ie;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Pe||(Pe={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Ie||(Ie={}));const Oe="SUPERADMIN",Re="ADVISOR",Me="COMPANY_ADMIN",De={[Oe]:"Administrador",[Re]:"Asesor",[Me]:"Admin de Empresa"};var Le=n(579);const $e="crm_user",ze="crm_token",Fe="crm_token_exp",Be=(0,r.createContext)(void 0),Ue=()=>{const e=(0,r.useContext)(Be);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e},We=e=>{let{children:t}=e;const[n,a]=(0,r.useState)(null),[s,i]=(0,r.useState)(null),[o,l]=(0,r.useState)(!0),c=()=>`${Math.random().toString(36).substring(2,15)}${Date.now().toString(36)}`,d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;const n=new Date;n.setHours(n.getHours()+t),localStorage.setItem(ze,e),localStorage.setItem(Fe,n.toISOString())};(0,r.useEffect)((()=>{(()=>{try{const e=localStorage.getItem(ze);if(e&&!(()=>{const e=localStorage.getItem(Fe);if(!e)return!0;const t=new Date(e);return new Date>t})()){const e=localStorage.getItem($e);e&&a(JSON.parse(e))}else e&&(console.log("La sesi\xf3n ha expirado"),localStorage.removeItem(ze),localStorage.removeItem(Fe),localStorage.removeItem($e))}catch(e){console.error("Error checking stored session:",e)}finally{l(!1)}})();const e=e=>{e.key===$e&&(e.newValue?a(JSON.parse(e.newValue)):(a(null),i(null)))};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}}),[]);const u={user:n,session:s,loading:o,signIn:async(e,t)=>{try{if(l(!0),"admin@fincentiva.com"===e&&"admin123"===t){const e={id:"1",email:"admin@fincentiva.com",name:"Administrador",role:"SUPERADMIN"},t=c();return d(t),localStorage.setItem($e,JSON.stringify(e)),a(e),{data:{user:e},error:null}}return{data:null,error:"Credenciales inv\xe1lidas"}}catch(n){return console.error("Error signing in:",n),{error:n,data:null}}finally{l(!1)}},signInWithCode:async(e,t)=>{try{l(!0);let n="http://localhost:3100/query",r={};if(t===Re)r={query:`SELECT * FROM advisors WHERE access_code = '${e}' LIMIT 1`};else{if(t!==Me)return{data:null,error:"Tipo de usuario no v\xe1lido"};r={query:`SELECT * FROM company_admins WHERE access_code = '${e}' LIMIT 1`}}const s=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),i=await s.json();if(i.error)return console.error("Database error:",i.error),{data:null,error:"Error de base de datos"};if(i.data&&i.data.length>0){const e=i.data[0],n={id:e.id,email:e.email,name:e.name,role:t,entityId:t===Me?e.company_id:e.id},r=c();return d(r),localStorage.setItem($e,JSON.stringify(n)),a(n),{data:{user:n},error:null}}return{data:null,error:"C\xf3digo de acceso inv\xe1lido"}}catch(n){return console.error("Error signing in with code:",n),{error:n instanceof Error?n.message:"Error al iniciar sesi\xf3n",data:null}}finally{l(!1)}},signOut:async()=>{try{localStorage.removeItem($e),localStorage.removeItem(ze),localStorage.removeItem(Fe),a(null),i(null)}catch(e){console.error("Error signing out:",e)}},setUser:a};return(0,Le.jsx)(Be.Provider,{value:u,children:t})};let Ve=function(e){return e.VIEW_APPLICATIONS="VIEW_APPLICATIONS",e.CREATE_APPLICATION="CREATE_APPLICATION",e.EDIT_APPLICATION="EDIT_APPLICATION",e.CHANGE_APPLICATION_STATUS="CHANGE_APPLICATION_STATUS",e.ASSIGN_APPLICATION="ASSIGN_APPLICATION",e.DELETE_APPLICATION="DELETE_APPLICATION",e.VIEW_COMPANIES="VIEW_COMPANIES",e.CREATE_COMPANY="CREATE_COMPANY",e.EDIT_COMPANY="EDIT_COMPANY",e.DELETE_COMPANY="DELETE_COMPANY",e.ASSIGN_COMPANY_ADMIN="ASSIGN_COMPANY_ADMIN",e.VIEW_CLIENTS="VIEW_CLIENTS",e.CREATE_CLIENT="CREATE_CLIENT",e.EDIT_CLIENT="EDIT_CLIENT",e.DELETE_CLIENT="DELETE_CLIENT",e.VIEW_ADVISORS="VIEW_ADVISORS",e.CREATE_ADVISOR="CREATE_ADVISOR",e.EDIT_ADVISOR="EDIT_ADVISOR",e.DELETE_ADVISOR="DELETE_ADVISOR",e.VIEW_DASHBOARD="VIEW_DASHBOARD",e.VIEW_REPORTS="VIEW_REPORTS",e}({});const He={[Oe]:Object.values(Ve),[Re]:[Ve.VIEW_APPLICATIONS,Ve.CREATE_APPLICATION,Ve.EDIT_APPLICATION,Ve.CHANGE_APPLICATION_STATUS,Ve.VIEW_COMPANIES,Ve.VIEW_CLIENTS,Ve.CREATE_CLIENT,Ve.EDIT_CLIENT,Ve.VIEW_DASHBOARD],[Me]:[Ve.VIEW_APPLICATIONS,Ve.VIEW_COMPANIES,Ve.VIEW_CLIENTS,Ve.VIEW_DASHBOARD,Ve.CHANGE_APPLICATION_STATUS]};function qe(e,t){var n;return e&&t&&(null===(n=He[e])||void 0===n?void 0:n.includes(t))||!1}const Ye=(0,r.createContext)(void 0),Je=()=>{const e=(0,r.useContext)(Ye);if(void 0===e)throw new Error("usePermissions must be used within a PermissionsProvider");return e},Ge=e=>{let{children:t}=e;const{user:n}=Ue(),[a,s]=(0,r.useState)([]),i={userCan:e=>!(!n||!n.role)&&(n.role===Oe||qe(n.role,e)),userCanAll:e=>!(!n||!n.role)&&(n.role===Oe||function(e,t){return!(!e||!t.length)&&t.every((t=>qe(e,t)))}(n.role,e)),userCanAny:e=>!(!n||!n.role)&&(n.role===Oe||function(e,t){return!(!e||!t.length)&&t.some((t=>qe(e,t)))}(n.role,e)),shouldFilterByEntity:()=>!(!n||!n.role)&&(n.role===Re||n.role===Me),getEntityFilter:()=>n&&n.role&&n.entityId?n.role===Oe?null:n.role===Re?{advisor_id:n.entityId}:n.role===Me?{company_id:n.entityId}:null:null,isAdmin:()=>(null===n||void 0===n?void 0:n.role)===Oe,isAdvisor:()=>(null===n||void 0===n?void 0:n.role)===Re,isCompanyAdmin:()=>(null===n||void 0===n?void 0:n.role)===Me,loadPermissions:async()=>{}};return(0,Le.jsx)(Ye.Provider,{value:i,children:t})};function Xe(e,t){let{title:n,titleId:a,...s}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},s),n?r.createElement("title",{id:a},n):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const Ke=r.forwardRef(Xe),Qe={};if("undefined"!==typeof window){const e=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;try{const a=new Audio(t);a.volume=.2,a.addEventListener("canplaythrough",(()=>{Qe[t]=a,console.log(`Successfully preloaded sound: ${t}`)})),a.addEventListener("error",(a=>{console.warn(`Error preloading sound ${t}:`,a),n<2&&setTimeout((()=>e(t,n+1)),1e3)})),a.load()}catch(a){console.error(`Failed to preload sound ${t}:`,a)}};["/sounds/clean-notification.mp3","/sounds/notification-simple.mp3","/sounds/triple-tone.mp3","/sounds/beep.mp3","/sounds/alert.mp3","/sounds/approval.mp3"].forEach((t=>e(t)))}if("undefined"!==typeof window&&!document.documentElement.hasAttribute("data-listeners-added")){document.documentElement.setAttribute("data-listeners-added","true");const e=["click","touchstart","keydown"],t=()=>{document.documentElement.setAttribute("data-user-interacted","true"),e.forEach((e=>{document.removeEventListener(e,t)}));try{const e=new Audio;e.volume=.01,e.play().catch((()=>{}))}catch(Uu){}};e.forEach((e=>{document.addEventListener(e,t)})),console.log("User interaction listeners added for sound enablement")}const Ze=e=>{let{title:t,message:n,type:a="info",duration:s=5e3,onClose:i,playSound:o=!0,soundType:l="notification",customSound:c,centerScreen:d=!1,relatedItemId:u}=e;const[h,p]=(0,r.useState)(!0),[m,f]=(0,r.useState)(!1),[g,v]=(0,r.useState)(!1),b=()=>{f(!0),setTimeout((()=>{p(!1),i&&i()}),300)};(0,r.useEffect)((()=>{if(s>0){const e=setTimeout((()=>{b()}),s);return()=>clearTimeout(e)}}),[s]),(0,r.useEffect)((()=>{o&&!g&&(v(!0),y())}),[o,c,l,g]);const y=()=>{try{const e=[c||"/sounds/clean-notification.mp3","/sounds/notification-simple.mp3","/sounds/triple-tone.mp3","/sounds/beep.mp3","/sounds/alert.mp3"],t=e=>new Promise(((t,n)=>{try{if(Qe[e]){const a=Qe[e];return a.currentTime=0,void a.play().then((()=>{console.log(`Successfully played preloaded sound: ${e}`),t()})).catch((t=>{console.warn(`Failed to play preloaded sound ${e}:`,t),n(t)}))}const a=new Audio(e);a.volume=.2,a.oncanplaythrough=()=>{a.play().then((()=>{console.log(`Successfully played sound: ${e}`),t()})).catch((t=>{console.warn(`Failed to play sound ${e}:`,t),n(t)}))},a.onerror=t=>{console.warn(`Error loading sound ${e}:`,t),n(t)},a.load(),setTimeout((()=>{n(new Error(`Timeout loading sound ${e}`))}),1500)}catch(a){console.warn(`Exception while trying to play ${e}:`,a),n(a)}})),n=a=>{if(a>=e.length)return void console.error("All sound playback attempts failed");const r=e[a];t(r).catch((()=>{n(a+1)}))};n(0)}catch(e){console.error("Failed to play notification sound:",e)}};if(!h)return null;const x={info:{bg:"bg-blue-50",border:"border-blue-200",text:"text-blue-800",title:"text-blue-900"},success:{bg:"bg-green-50",border:"border-green-200",text:"text-green-800",title:"text-green-900"},warning:{bg:"bg-yellow-50",border:"border-yellow-200",text:"text-yellow-800",title:"text-yellow-900"},error:{bg:"bg-red-50",border:"border-red-200",text:"text-red-800",title:"text-red-900"}},_=(e=>{switch(e){case"info":case"new_application":case"new_message":default:return"info";case"success":case"approval_required":case"application_status_updated":return"success";case"warning":return"warning";case"error":case"application_comment":return"error"}})(a),w=x[_]||x.info,j=d?"fixed inset-0 flex items-center justify-center z-50":"fixed top-5 right-5 z-50 max-w-md w-full",N=d?"w-full max-w-xl mx-4":"w-full",E=n&&n.trim().startsWith("<");return(0,Le.jsx)("div",{className:j,children:(0,Le.jsx)("div",{className:`${w.bg} ${w.border} ${w.text} rounded-lg shadow-lg p-4 border ${m?"animate-popup-exit":"animate-popup-entry"} ${N}`,children:(0,Le.jsxs)("div",{className:"flex justify-between items-start",children:[(0,Le.jsxs)("div",{className:"flex-1",children:[(0,Le.jsx)("h3",{className:`text-base font-semibold ${w.title}`,children:t}),(()=>{if(!E)return(0,Le.jsx)("div",{className:"mt-1 text-sm",children:n});const e=(new DOMParser).parseFromString(n,"text/html").body,t=e.querySelector("div");t&&t.className.includes("grid")&&(t.className="grid grid-cols-2 gap-2 text-sm mt-2");e.querySelectorAll(".font-semibold").forEach((e=>{e.className="font-semibold text-gray-700"}));const a=Array.from(e.querySelectorAll(".text-gray-900")).find((e=>{var t,n;return null===(t=e.previousElementSibling)||void 0===t||null===(n=t.textContent)||void 0===n?void 0:n.includes("Tipo:")}));if(a){var r;const t=null===(r=a.textContent)||void 0===r?void 0:r.trim().toLowerCase();if(t)if(t.includes("planes seleccionados")){const t=Array.from(e.querySelectorAll(".text-gray-900")).find((e=>{var t,n;return null===(t=e.previousElementSibling)||void 0===t||null===(n=t.textContent)||void 0===n?void 0:n.includes("Pago mensual:")}));t&&(t.className="text-gray-900 font-bold text-blue-600")}else if(t.includes("solicitud de efectivo")){const t=Array.from(e.querySelectorAll(".text-gray-900")).find((e=>{var t,n;return null===(t=e.previousElementSibling)||void 0===t||null===(n=t.textContent)||void 0===n?void 0:n.includes("Monto solicitado:")}));t&&(t.className="text-gray-900 font-bold text-green-600")}else if(t.includes("simulaci\xf3n de producto")){const t=Array.from(e.querySelectorAll(".text-gray-900")).find((e=>{var t,n;return null===(t=e.previousElementSibling)||void 0===t||null===(n=t.textContent)||void 0===n?void 0:n.includes("Monto:")}));t&&(t.className="text-gray-900 font-bold text-purple-600")}else if(t.includes("pr\xe9stamo")){const t=Array.from(e.querySelectorAll(".text-gray-900")).find((e=>{var t,n;return null===(t=e.previousElementSibling)||void 0===t||null===(n=t.textContent)||void 0===n?void 0:n.includes("Monto del pr\xe9stamo:")}));t&&(t.className="text-gray-900 font-bold text-orange-600")}}return Array.from(e.querySelectorAll("div")).filter((e=>e.previousElementSibling&&e.previousElementSibling.className.includes("font-semibold"))).forEach((e=>{e.className.includes("font-bold")||(e.className="text-gray-900")})),(0,Le.jsx)("div",{className:"mt-2 notification-content prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:e.innerHTML}})})()]}),(0,Le.jsx)("button",{onClick:b,className:"flex-shrink-0 ml-2 text-gray-400 hover:text-gray-500 focus:outline-none",children:(0,Le.jsx)(Ke,{className:"h-5 w-5"})})]})})})};let et=function(e){return e.INFO="info",e.SUCCESS="success",e.WARNING="warning",e.ERROR="error",e.NEW_APPLICATION="new_application",e.APPROVAL_REQUIRED="approval_required",e.NEW_MESSAGE="new_message",e.APPLICATION_STATUS_UPDATED="application_status_updated",e.APPLICATION_COMMENT="application_comment",e}({});const tt=(0,r.createContext)(void 0),nt=()=>{const e=(0,r.useContext)(tt);if(void 0===e)throw new Error("useNotifications must be used within a NotificationProvider");return e},at=e=>{let{children:t}=e;const{user:n}=Ue(),[a,s]=(0,r.useState)([]),[i,o]=(0,r.useState)(0),[l,c]=(0,r.useState)(!0),[d,u]=(0,r.useState)(null),h=(0,r.useRef)(null),[p,m]=(0,r.useState)(new Map),f=(0,r.useRef)(!1),g=(0,r.useRef)(new Date),v=(0,r.useRef)(new Date);(0,r.useEffect)((()=>{if(n){y();try{const e=localStorage.getItem("notified_application_ids");if(e){const t=JSON.parse(e);if(Array.isArray(t)){const e=new Map,n=Date.now();t.forEach((t=>{e.set(t,n)})),m(e),x(e),console.log(`Converted ${e.size} notified application IDs from old format to new format`)}else if("object"===typeof t){const e=new Map;Object.entries(t).forEach((t=>{let[n,a]=t;e.set(n,a)})),m(e),console.log(`Loaded ${e.size} notified application IDs from localStorage`)}}else console.log("No previously notified applications found in localStorage");_()}catch(e){console.error("Error loading notified applications:",e),m(new Map)}v.current=new Date,g.current=new Date(Date.now()-1e4);const t=setTimeout((()=>{b(),h.current=setInterval((()=>{const e=new Date,t=e.getTime()-v.current.getTime(),n=e.getTime()-g.current.getTime();t>15e3&&n>5e3?N():console.log(`Skipping notification check (last check: ${(t/1e3).toFixed(1)}s ago, last notification: ${(n/1e3).toFixed(1)}s ago)`)}),2e4)}),5e3);return()=>{h.current&&clearInterval(h.current),clearTimeout(t)}}}),[n]);const b=async()=>{try{const e=await fetch("http://localhost:3100/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:"\n            SELECT id, created_at, application_type, client_name, company_name, status, amount\n            FROM applications \n            ORDER BY created_at DESC\n            LIMIT 1\n          "})});if(!e.ok)throw new Error("Error querying most recent application");const t=await e.json();if(t.data&&t.data.length>0){const e=t.data[0],n=e.id,a=new Date(e.created_at);if(console.log(`System initialized with reference to last application: ${n} created at ${a.toISOString()}`),!p.has(n)){const t={notifiedAt:(new Date).toISOString(),notificationType:"initialization",applicationType:e.application_type,amount:e.amount,clientName:e.client_name,companyName:e.company_name,status:e.status};w(n,e.created_at,t)}}N()}catch(e){console.error("Error initializing with last application timestamp:",e),N()}};(0,r.useEffect)((()=>{const e=a.filter((e=>!e.read)).length;o(e)}),[a]);const y=async()=>{try{const e=localStorage.getItem("notifications");if(e){const t=JSON.parse(e);s(t.map((e=>({...e,createdAt:new Date(e.createdAt)}))))}}catch(e){console.error("Error loading notifications:",e)}},x=e=>{try{const t={};e.forEach(((e,n)=>{t[n]=e})),localStorage.setItem("notified_application_ids",JSON.stringify(t)),console.log(`Saved ${e.size} notified application IDs to localStorage`)}catch(t){console.error("Error saving notified applications:",t)}},_=()=>{try{const e=Date.now()-864e5;let t=0,n=0;const a=new Map;p.forEach(((r,s)=>{t++,r>e?a.set(s,r):n++})),n>0?(console.log(`Cleaned up ${n} old notification records (${t-n} retained)`),m(a),x(a)):t>0&&console.log(`No old notifications to clean up (${t} notifications are all within 24 hours)`)}catch(e){console.error("Error cleaning up old notifications:",e)}},w=(e,t,n)=>{if(p.has(e))console.log(`Application ${e} already marked as notified (duplicate protection)`);else try{let r;if(t)try{const e=new Date(t);r=e.getTime()+1e3,console.log(`Using application creation time for notification: ${e.toISOString()}`)}catch(a){console.warn(`Error parsing creation timestamp "${t}":`,a),r=Date.now()}else r=Date.now();const s=n||{notifiedAt:new Date(r).toISOString(),notificationType:"application"},i=new Map(p);i.set(e,r),m(i);try{const t=`notification_metadata_${e}`;localStorage.setItem(t,JSON.stringify(s))}catch(a){console.warn("Error saving notification metadata:",a)}x(i),g.current=new Date,console.log(`Marked application ${e} as notified at ${new Date(r).toISOString()}`)}catch(a){console.error("Error marking application as notified:",a)}},j=()=>"\n      SELECT id, client_name, application_type, company_name, created_at, status, \n             amount, term, interest_rate, monthly_payment, client_email, client_phone\n      FROM applications \n      WHERE created_at > NOW() - INTERVAL '30 seconds'\n      ORDER BY created_at DESC\n      LIMIT 5\n    ",N=async()=>{if(!f.current&&n){f.current=!0,v.current=new Date;try{console.log("Checking for new notifications..."),console.log(`${p.size} already notified application IDs: `,Array.from(p.keys()).slice(0,3).join(", "));let t="";try{t=await(async()=>{try{const e=await fetch("http://localhost:3100/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:"\n            SELECT application_type\n            FROM applications \n            ORDER BY created_at DESC\n            LIMIT 1\n          "})});if(!e.ok)return console.warn("Error checking latest application type, using default query"),j();const t=await e.json();if(!t.data||0===t.data.length)return console.log("No applications found, using default query"),j();const n=t.data[0].application_type;console.log(`Latest application type: ${n}`);let a="";return a="",`\n        SELECT id, client_name, application_type, company_name, created_at, status, \n               amount, term, interest_rate, monthly_payment, client_email, client_phone ${a}\n        FROM applications \n        WHERE created_at > NOW() - INTERVAL '30 seconds'\n        ORDER BY created_at DESC\n        LIMIT 5\n      `}catch(e){return console.error("Error building optimized query:",e),j()}})(),console.log("Using optimized query for latest application type");const e=await fetch("http://localhost:3100/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:t})});if(e.ok){const t=await e.json();if(t.data&&t.data.length>0){console.log(`Received ${t.data.length} applications from the last 30 seconds`);const e=t.data.filter((e=>{if(p.has(e.id))return console.log(`Skipping already notified application: ${e.id}`),!1;const t=new Date(e.created_at);if((new Date).getTime()-t.getTime()>6e4){console.log(`Skipping too old application: ${e.id} created at ${t.toISOString()}`);const n={notifiedAt:(new Date).toISOString(),notificationType:"application",applicationType:e.application_type,amount:e.amount,clientName:e.client_name,companyName:e.company_name,status:e.status};return w(e.id,e.created_at,n),!1}return!0}));if(console.log(`Found ${e.length} new applications after filtering`),0===e.length)return console.log("No truly new applications found (already notified or too old)"),void(f.current=!1);const n=e[0],a=n.id;if(d&&d.relatedItemId===a)return console.log(`Already showing notification for application ${a} - skipping`),void(f.current=!1);console.log(`New application detected: ${a} (created ${new Date(n.created_at).toISOString()})`);const r={notifiedAt:(new Date).toISOString(),notificationType:"application",applicationType:n.application_type,amount:n.amount,clientName:n.client_name,companyName:n.company_name,status:n.status};w(a,n.created_at,r);const s=new Date(n.created_at),i=new Intl.DateTimeFormat("es-MX",{day:"2-digit",month:"2-digit",year:"numeric"}).format(s),o=new Intl.DateTimeFormat("es-MX",{hour:"2-digit",minute:"2-digit",hour12:!0}).format(s),c=new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:2}).format(Number(n.amount||0)),u=null!==n.interest_rate&&void 0!==n.interest_rate?`${n.interest_rate}%`:"N/A",h=null!==n.monthly_payment&&void 0!==n.monthly_payment?new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:2}).format(Number(n.monthly_payment)):"N/A";let m="No especificado";if(n.application_type){const e=n.application_type.replace(/\/$/,"");m="selected_plans"===e?"Planes seleccionados":"product_simulations"===e?"Simulaci\xf3n de producto":"cash_requests"===e?"Solicitud de efectivo":"car_backed_loan_applications"===e?"Pr\xe9stamo con garant\xeda de auto":"auto_loan_applications"===e?"Pr\xe9stamo para auto":e.split("_").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" ")}const v=(e,t)=>{const n=`\n                <div class="font-semibold text-gray-700">Cliente:</div>\n                <div class="text-gray-900">${t.client_name||"Sin nombre"}</div>\n                \n                <div class="font-semibold text-gray-700">Empresa:</div>\n                <div class="text-gray-900">${t.company_name||"No especificada"}</div>\n                \n                <div class="font-semibold text-gray-700">Tipo:</div>\n                <div class="text-gray-900">${e}</div>\n              `;let a="";a="selected_plans"===t.application_type?`\n                  <div class="font-semibold text-gray-700">Monto:</div>\n                  <div class="text-gray-900">${c}</div>\n                  \n                  <div class="font-semibold text-gray-700">Plazo:</div>\n                  <div class="text-gray-900">${t.term||"N/A"} ${1===t.term?"mes":"meses"}</div>\n                  \n                  <div class="font-semibold text-gray-700">Tasa:</div>\n                  <div class="text-gray-900">${u}</div>\n                  \n                  <div class="font-semibold text-gray-700">Pago mensual:</div>\n                  <div class="text-gray-900">${h}</div>\n                `:"product_simulations"===t.application_type?`\n                  <div class="font-semibold text-gray-700">Monto:</div>\n                  <div class="text-gray-900 font-bold">${c}</div>\n                  \n                  <div class="font-semibold text-gray-700">Plazo:</div>\n                  <div class="text-gray-900">${t.term&&t.term>0?t.term+(1===t.term?" mes":" meses"):"N/A"}</div>\n                  \n                  <div class="font-semibold text-gray-700">Tasa:</div>\n                  <div class="text-gray-900">${u}</div>\n                `:"cash_requests"===t.application_type?`\n                  <div class="font-semibold text-gray-700">Monto solicitado:</div>\n                  <div class="text-gray-900 font-bold">${c}</div>\n                  \n                  <div class="font-semibold text-gray-700">Plazo:</div>\n                  <div class="text-gray-900">${t.term&&t.term>0?t.term+(1===t.term?" mes":" meses"):"N/A"}</div>\n                  \n                  <div class="font-semibold text-gray-700">Tasa:</div>\n                  <div class="text-gray-900">${u}</div>\n                `:"car_backed_loan_applications"===t.application_type||"auto_loan_applications"===t.application_type?`\n                  <div class="font-semibold text-gray-700">Monto del pr\xe9stamo:</div>\n                  <div class="text-gray-900 font-bold">${c}</div>\n                  \n                  <div class="font-semibold text-gray-700">Plazo:</div>\n                  <div class="text-gray-900">${t.term&&t.term>0?t.term+(1===t.term?" mes":" meses"):"N/A"}</div>\n                  \n                  <div class="font-semibold text-gray-700">Tasa:</div>\n                  <div class="text-gray-900">${u}</div>\n                  \n                  <div class="font-semibold text-gray-700">Pago mensual:</div>\n                  <div class="text-gray-900">${h}</div>\n                `:`\n                  <div class="font-semibold text-gray-700">Monto:</div>\n                  <div class="text-gray-900">${c}</div>\n                  \n                  <div class="font-semibold text-gray-700">Plazo:</div>\n                  <div class="text-gray-900">${t.term&&t.term>0?t.term+(1===t.term?" mes":" meses"):"N/A"}</div>\n                  \n                  <div class="font-semibold text-gray-700">Tasa:</div>\n                  <div class="text-gray-900">${u}</div>\n                  \n                  <div class="font-semibold text-gray-700">Pago mensual:</div>\n                  <div class="text-gray-900">${h}</div>\n                `;return`\n                <div class="grid grid-cols-2 gap-2 text-sm mt-2">\n                  ${n}\n                  ${a}\n                  ${`\n                <div class="font-semibold text-gray-700">Email:</div>\n                <div class="text-gray-900">${t.client_email||"No especificado"}</div>\n                \n                <div class="font-semibold text-gray-700">Tel\xe9fono:</div>\n                <div class="text-gray-900">${t.client_phone||"No especificado"}</div>\n                \n                <div class="font-semibold text-gray-700">Fecha:</div>\n                <div class="text-gray-900">${i} ${o}</div>\n              `}\n                </div>\n              `},b=v(m,n),y="\ud83d\udcbc Nueva solicitud recibida",x={title:y,message:`Cliente: ${n.client_name||"Sin nombre"} - ${n.company_name||"Empresa no especificada"}`,type:et.NEW_APPLICATION,relatedItemType:"application",relatedItemId:a};E(x),S({title:y,message:b,type:et.NEW_APPLICATION,playSound:l,soundType:"notification",duration:1e4,customSound:"/sounds/clean-notification.mp3",centerScreen:!0,relatedItemId:a}),g.current=new Date}else console.log("No new applications found in the past 30 seconds")}else console.warn("Failed to fetch notifications: server returned an error status")}catch(e){console.warn("Connection to database failed, skipping notification check")}}catch(t){console.error("Error checking for new notifications:",t)}finally{f.current=!1}}},E=e=>{const t={...e,id:"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})),createdAt:new Date,read:!1,timestamp:new Date};s((e=>{const n=[t,...e];return localStorage.setItem("notifications",JSON.stringify(n)),n}))},S=e=>{d&&(d.title===e.title&&d.message===e.message||e.relatedItemId&&d.relatedItemId===e.relatedItemId)?console.log(`Ignoring duplicate popup: ${e.relatedItemId||"unknown ID"}`):(k(),console.log(`Showing popup: ${e.title} ${e.relatedItemId?`(ID: ${e.relatedItemId})`:""}`),setTimeout((()=>{u(e),setTimeout((()=>{u(null)}),e.duration||5e3)}),50))},k=()=>{d&&(console.log("Clearing existing popup"),u(null))},C={notifications:a,unreadCount:i,addNotification:E,markAsRead:e=>{s((t=>{const n=t.map((t=>t.id===e?{...t,read:!0,isRead:!0}:t));return localStorage.setItem("notifications",JSON.stringify(n)),n}))},markAllAsRead:()=>{s((e=>{const t=e.map((e=>({...e,read:!0,isRead:!0})));return localStorage.setItem("notifications",JSON.stringify(t)),t}))},clearNotifications:()=>{s([]),localStorage.setItem("notifications",JSON.stringify([]))},showPopup:S,soundEnabled:l,toggleSound:()=>{const e=!l;c(e),localStorage.setItem("notification_sound_enabled",e.toString())},setSoundEnabled:c};return(0,Le.jsxs)(tt.Provider,{value:C,children:[t,d&&(0,Le.jsx)(Ze,{title:d.title,message:d.message,type:d.type,duration:d.duration,playSound:d.playSound,soundType:d.soundType,customSound:d.customSound,onClose:()=>u(null),centerScreen:d.centerScreen})]})},rt=e=>{let{children:t}=e;const{user:n,loading:a}=Ue(),r=ee();if(a)return(0,Le.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-base-200",children:[(0,Le.jsx)("span",{className:"loading loading-spinner loading-lg text-primary"}),(0,Le.jsx)("p",{className:"mt-3 text-base-content",children:"Verificando sesi\xf3n..."})]});if(!n){const e="default"!==r.key;return(0,Le.jsx)(be,{to:"/login",state:{from:r,sessionExpired:e},replace:!0})}return(0,Le.jsx)(Le.Fragment,{children:t})},st=e=>{let{children:t,variant:n="primary",size:a="md",isLoading:r=!1,isDisabled:s=!1,isOutlined:i=!1,leftIcon:o,rightIcon:l,className:c="",...d}=e;const u=["btn",i?`btn-outline btn-${n}`:`btn-${n}`,"md"!==a?`btn-${a}`:"",r?"loading":"",s?"btn-disabled":"",c].filter(Boolean).join(" ");return(0,Le.jsxs)("button",{className:u,disabled:s||r,...d,children:[!r&&o&&(0,Le.jsx)("span",{className:"mr-2",children:o}),t,!r&&l&&(0,Le.jsx)("span",{className:"ml-2",children:l})]})},it=()=>{var e;const[t,n]=(0,r.useState)("code"),[a,s]=(0,r.useState)(""),[i,o]=(0,r.useState)(""),[l,c]=(0,r.useState)(""),[d,u]=(0,r.useState)(Re),[h,p]=(0,r.useState)(null),[m,f]=(0,r.useState)(!1),[g,v]=(0,r.useState)(null),{signIn:b,signInWithCode:y}=Ue(),x=ne(),_=ee().state,w=(null===_||void 0===_||null===(e=_.from)||void 0===e?void 0:e.pathname)||"/dashboard";(0,r.useEffect)((()=>{if(null!==_&&void 0!==_&&_.sessionExpired){v("Su sesi\xf3n ha expirado. Por favor, inicie sesi\xf3n nuevamente.");const e=setTimeout((()=>{v(null)}),5e3);return()=>clearTimeout(e)}}),[_]);return(0,Le.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-base-200",children:(0,Le.jsx)("div",{className:"card flex-shrink-0 w-full max-w-sm shadow-2xl bg-base-100",children:(0,Le.jsxs)("div",{className:"card-body",children:[(0,Le.jsxs)("div",{className:"text-center mb-4",children:[(0,Le.jsx)("h1",{className:"text-4xl font-bold text-primary",children:"Fincentiva"}),(0,Le.jsx)("p",{className:"text-sm opacity-70 mt-1",children:"CRM"})]}),(0,Le.jsxs)("div",{className:"tabs tabs-boxed mb-4",children:[(0,Le.jsx)("a",{className:"tab "+("code"===t?"tab-active":""),onClick:()=>n("code"),children:"C\xf3digo de Acceso"}),(0,Le.jsx)("a",{className:"tab "+("admin"===t?"tab-active":""),onClick:()=>n("admin"),children:"Administrador"})]}),g&&(0,Le.jsxs)("div",{className:"alert alert-warning mb-4",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,Le.jsx)("span",{children:g})]}),(0,Le.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),p(null),v(null),f(!0);try{if("admin"===t){const{data:e,error:t}=await b(a,i);if(t)return p("Credenciales inv\xe1lidas"),void f(!1);e&&x(w,{replace:!0})}else{if(!l.trim())return p("Debe ingresar un c\xf3digo de acceso"),void f(!1);const{data:e,error:t}=await y(l,d);if(t)return p(t instanceof Error?t.message:String(t)),void f(!1);e&&x(w,{replace:!0})}}catch(n){p("Error al iniciar sesi\xf3n"),console.error(n)}finally{f(!1)}},children:[h&&(0,Le.jsxs)("div",{className:"alert alert-error mb-4",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,Le.jsx)("span",{children:h})]}),"admin"===t?(0,Le.jsxs)(Le.Fragment,{children:[(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Correo electr\xf3nico"})}),(0,Le.jsx)("input",{type:"email",placeholder:"correo@ejemplo.com",className:"input input-bordered",value:a,onChange:e=>s(e.target.value),required:!0})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Contrase\xf1a"})}),(0,Le.jsx)("input",{type:"password",placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",className:"input input-bordered",value:i,onChange:e=>o(e.target.value),required:!0})]})]}):(0,Le.jsxs)(Le.Fragment,{children:[(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Tipo de Usuario"})}),(0,Le.jsxs)("select",{className:"select select-bordered w-full",value:d,onChange:e=>u(e.target.value),children:[(0,Le.jsx)("option",{value:Re,children:De[Re]}),(0,Le.jsx)("option",{value:Me,children:De[Me]})]})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"C\xf3digo de Acceso"})}),(0,Le.jsx)("input",{type:"text",placeholder:"Ingrese su c\xf3digo de acceso",className:"input input-bordered",value:l,onChange:e=>c(e.target.value),required:!0})]})]}),(0,Le.jsx)("div",{className:"form-control mt-6",children:(0,Le.jsx)(st,{type:"submit",variant:"primary",isLoading:m,className:"w-full",children:"Iniciar Sesi\xf3n"})})]})]})})})};function ot(e,t){let{title:n,titleId:a,...s}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},s),n?r.createElement("title",{id:a},n):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const lt=r.forwardRef(ot);function ct(e,t){let{title:n,titleId:a,...s}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},s),n?r.createElement("title",{id:a},n):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.35 3.836c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75 2.25 2.25 0 0 0-.1-.664m-5.8 0A2.251 2.251 0 0 1 13.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m8.9-4.414c.376.023.75.05 1.124.08 1.131.094 1.976 1.057 1.976 2.192V16.5A2.25 2.25 0 0 1 18 18.75h-2.25m-7.5-10.5H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V18.75m-7.5-10.5h6.375c.621 0 1.125.504 1.125 1.125v9.375m-8.25-3 1.5 1.5 3-3.75"}))}const dt=r.forwardRef(ct);function ut(e,t){let{title:n,titleId:a,...s}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},s),n?r.createElement("title",{id:a},n):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const ht=r.forwardRef(ut);function pt(e,t){let{title:n,titleId:a,...s}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},s),n?r.createElement("title",{id:a},n):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"}))}const mt=r.forwardRef(pt);var ft=n(823);const gt=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(void 0===e||null===e)return"$0.00";const{currency:n="MXN",maximumFractionDigits:a=2,minimumFractionDigits:r=2}=t;return new Intl.NumberFormat("es-MX",{style:"currency",currency:n,maximumFractionDigits:a,minimumFractionDigits:r}).format(e)},vt=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"short";if(!e)return"N/A";try{const n=new Date(e);if(isNaN(n.getTime()))return"Fecha inv\xe1lida";if("short"===t)return n.toLocaleDateString("es-MX",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"});if("datetime"===t)return n.toLocaleDateString("es-MX",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"});if("long"===t)return n.toLocaleDateString("es-MX",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"});if("relative"===t){const e=(new Date).getTime()-n.getTime(),t=Math.floor(e/1e3),a=Math.floor(t/60),r=Math.floor(a/60),s=Math.floor(r/24);return t<60?"Hace unos segundos":a<60?`Hace ${a} min${a>1?"s":""}`:r<24?`Hace ${r} hora${r>1?"s":""}`:s<7?`Hace ${s} d\xeda${s>1?"s":""}`:n.toLocaleDateString("es-MX",{year:"numeric",month:"short",day:"numeric"})}return e}catch(n){return console.error("Error formateando fecha:",n),e}},bt=()=>{const[e,t]=(0,r.useState)(!1),{notifications:n,unreadCount:a,markAsRead:s,markAllAsRead:i,clearNotifications:o,soundEnabled:l,toggleSound:c}=nt(),d=()=>{t(!e),!e&&a>0&&i()},u=e=>{switch(e){case et.SUCCESS:return(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-success",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Le.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})});case et.ERROR:return(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-error",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Le.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})});case et.WARNING:return(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-warning",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Le.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})});case et.NEW_APPLICATION:return(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-info",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Le.jsx)("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})});case et.APPROVAL_REQUIRED:return(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-primary",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Le.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})});default:return(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-info",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Le.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}},h=e=>{const t=(new Date).getTime()-new Date(e).getTime();if(t<864e5){const e=Math.floor(t/36e5);if(e<1){const e=Math.floor(t/6e4);return e<=0?"Ahora":`Hace ${e} min`}return`Hace ${e} ${1===e?"hora":"horas"}`}if(t<6048e5){return["Dom","Lun","Mar","Mi\xe9","Jue","Vie","S\xe1b"][new Date(e).getDay()]}const n=new Date(e);return`${n.getDate()}/${n.getMonth()+1}`};return(0,Le.jsxs)("div",{className:"relative",children:[(0,Le.jsxs)("div",{className:"dropdown dropdown-end",children:[(0,Le.jsx)("button",{onClick:d,className:"btn btn-ghost btn-circle","aria-label":"Notificaciones",children:(0,Le.jsxs)("div",{className:"indicator",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),a>0&&(0,Le.jsx)("span",{className:"badge badge-xs badge-primary indicator-item",children:a>9?"9+":a})]})}),e&&(0,Le.jsxs)("div",{className:"dropdown-content bg-base-100 shadow-xl rounded-box mt-4",style:{width:"350px",maxHeight:"calc(100vh - 200px)",overflowY:"auto",position:"absolute",right:0,zIndex:50},children:[(0,Le.jsx)("div",{className:"p-3 border-b border-base-200",children:(0,Le.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Le.jsx)("h3",{className:"font-bold",children:"Notificaciones"}),(0,Le.jsxs)("div",{className:"flex gap-2",children:[(0,Le.jsx)("button",{onClick:c,className:"btn btn-xs btn-ghost","aria-label":l?"Desactivar sonido":"Activar sonido",children:l?(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Le.jsx)("path",{fillRule:"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM14.657 2.929a1 1 0 011.414 0A9.972 9.972 0 0119 10a9.972 9.972 0 01-2.929 7.071 1 1 0 01-1.414-1.414A7.971 7.971 0 0017 10c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 10a5.984 5.984 0 01-1.757 4.243 1 1 0 01-1.415-1.415A3.984 3.984 0 0013 10a3.983 3.983 0 00-1.172-2.828 1 1 0 010-1.415z",clipRule:"evenodd"})}):(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Le.jsx)("path",{fillRule:"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM12.293 7.293a1 1 0 011.414 0L15 8.586l1.293-1.293a1 1 0 111.414 1.414L16.414 10l1.293 1.293a1 1 0 01-1.414 1.414L15 11.414l-1.293 1.293a1 1 0 01-1.414-1.414L13.586 10l-1.293-1.293a1 1 0 010-1.414z",clipRule:"evenodd"})})}),n.length>0&&(0,Le.jsx)("button",{onClick:o,className:"btn btn-xs btn-ghost","aria-label":"Limpiar notificaciones",children:(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Le.jsx)("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})]})]})}),(0,Le.jsx)("div",{children:0===n.length?(0,Le.jsxs)("div",{className:"p-6 text-center text-gray-500",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 mx-auto mb-2 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),(0,Le.jsx)("p",{children:"No tienes notificaciones."})]}):(0,Le.jsx)("div",{children:n.map((e=>(0,Le.jsx)("div",{className:"border-b border-base-200 hover:bg-base-200 transition-colors "+(e.read?"":"bg-base-200"),children:(e.type===et.APPROVAL_REQUIRED||e.type===et.NEW_APPLICATION)&&e.relatedItemId&&"application"===e.relatedItemType?/^app-\d+$/.test(e.relatedItemId)?(0,Le.jsxs)("div",{className:"flex items-start p-3 gap-3",children:[(0,Le.jsx)("div",{className:"mt-1",children:u(e.type)}),(0,Le.jsxs)("div",{className:"flex-1",children:[(0,Le.jsxs)("div",{className:"flex justify-between items-start",children:[(0,Le.jsx)("p",{className:"font-semibold text-sm",children:e.title}),(0,Le.jsx)("span",{className:"text-xs text-gray-500",children:h(e.timestamp||e.createdAt)})]}),(0,Le.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.message})]})]}):(0,Le.jsxs)(Te,{to:`/applications/${e.relatedItemId}`,className:"flex items-start p-3 gap-3",onClick:()=>s(e.id),children:[(0,Le.jsx)("div",{className:"mt-1",children:u(e.type)}),(0,Le.jsxs)("div",{className:"flex-1",children:[(0,Le.jsxs)("div",{className:"flex justify-between items-start",children:[(0,Le.jsx)("p",{className:"font-semibold text-sm",children:e.title}),(0,Le.jsx)("span",{className:"text-xs text-gray-500",children:h(e.timestamp||e.createdAt)})]}),(0,Le.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.message})]})]}):(0,Le.jsxs)("div",{className:"flex items-start p-3 gap-3",children:[(0,Le.jsx)("div",{className:"mt-1",children:u(e.type)}),(0,Le.jsxs)("div",{className:"flex-1",children:[(0,Le.jsxs)("div",{className:"flex justify-between items-start",children:[(0,Le.jsx)("p",{className:"font-semibold text-sm",children:e.title}),(0,Le.jsx)("span",{className:"text-xs text-gray-500",children:h(e.timestamp||e.createdAt)})]}),(0,Le.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.message})]})]})},e.id)))})})]})]}),e&&(0,Le.jsx)("div",{className:"fixed inset-0 z-40",onClick:d,"aria-hidden":"true"})]})},yt=e=>{var t;let{toggleSidebar:n}=e;const{user:a,signOut:s}=Ue(),[i,o]=(0,r.useState)(!1);return(0,Le.jsxs)("div",{className:"navbar bg-base-100 border-b",children:[(0,Le.jsxs)("div",{className:"flex-1",children:[(0,Le.jsx)("button",{className:"btn btn-ghost lg:hidden","aria-label":"Toggle sidebar",onClick:n,children:(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h8m-8 6h16"})})}),(0,Le.jsx)("span",{className:"text-xl font-bold text-primary",children:"Fincentiva CRM"})]}),(0,Le.jsxs)("div",{className:"flex-none gap-2",children:[(0,Le.jsx)(bt,{}),(0,Le.jsxs)("div",{className:"dropdown dropdown-end",children:[(0,Le.jsx)("button",{tabIndex:0,className:"btn btn-ghost btn-circle avatar",onClick:()=>{o(!i)},"aria-label":"User menu",children:(0,Le.jsx)("div",{className:"bg-primary text-primary-content rounded-full w-10 h-10 flex items-center justify-center",children:(0,Le.jsx)("span",{className:"text-lg font-bold",children:null!==a&&void 0!==a&&a.name?a.name.charAt(0).toUpperCase():null===a||void 0===a||null===(t=a.email)||void 0===t?void 0:t.charAt(0).toUpperCase()})})}),i&&(0,Le.jsxs)("ul",{tabIndex:0,className:"mt-3 z-[1] p-2 shadow menu menu-sm dropdown-content bg-base-100 rounded-box w-52",children:[(0,Le.jsxs)("li",{className:"p-3 border-b",children:[(0,Le.jsx)("span",{className:"font-bold",children:(null===a||void 0===a?void 0:a.name)||(null===a||void 0===a?void 0:a.email)}),(0,Le.jsx)("span",{className:"text-xs opacity-70 block",children:null!==a&&void 0!==a&&a.role&&De[a.role]||"Usuario"})]}),(0,Le.jsx)("li",{children:(0,Le.jsx)(Te,{to:"/profile",className:"justify-between",children:"Mi Perfil"})}),(0,Le.jsx)("li",{children:(0,Le.jsx)("button",{onClick:async()=>{await s()},children:"Cerrar Sesi\xf3n"})})]})]})]})]})},xt=e=>{let{isOpen:t}=e;const n=ee(),{userCan:a}=Je(),{user:r}=Ue(),s=[{label:"Dashboard",path:"/dashboard",icon:(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),permission:Ve.VIEW_DASHBOARD},{label:"Solicitudes",path:"/applications",icon:(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),permission:Ve.VIEW_APPLICATIONS},{label:"Empresas",path:"/companies",icon:(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),permission:Ve.VIEW_COMPANIES,visibleFor:[Oe,Re]},{label:"Asesores",path:"/advisors",icon:(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),permission:Ve.VIEW_ADVISORS},{label:"Clientes",path:"/clients",icon:(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),permission:Ve.VIEW_CLIENTS},{label:"Mensajes",path:"/messages",icon:(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})}].filter((e=>(!e.permission||a(e.permission))&&(!e.visibleFor||!(null!==r&&void 0!==r&&r.role)||e.visibleFor.includes(r.role))));return(0,Le.jsxs)("div",{className:`lg:block fixed top-0 bottom-0 lg:left-0 w-64 bg-base-200 pt-4 transition-all duration-300 ${t?"left-0":"-left-64"} z-20 lg:z-0 shadow-lg`,children:[(0,Le.jsx)("div",{className:"px-6 pb-4 flex items-center border-b border-gray-200",children:(0,Le.jsx)("div",{className:"text-primary text-2xl font-bold",children:"Fincentiva"})}),(0,Le.jsx)("ul",{className:"menu p-2 pt-4",children:s.map((e=>(0,Le.jsx)("li",{children:(0,Le.jsxs)(Te,{to:e.path,className:n.pathname===e.path?"active":"",children:[e.icon,e.label]})},e.path)))})]})},_t=e=>{let{children:t}=e;const[n,a]=(0,r.useState)(!1),s=()=>{a(!n)};return(0,Le.jsxs)("div",{className:"min-h-screen bg-base-200",children:[(0,Le.jsx)(xt,{isOpen:n}),(0,Le.jsxs)("div",{className:"lg:ml-64 flex flex-col min-h-screen",children:[(0,Le.jsx)(yt,{toggleSidebar:s}),(0,Le.jsx)("main",{className:"flex-grow p-4",children:t})]}),n&&(0,Le.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-10 lg:hidden",onClick:s})]})};function wt(e,t){let{title:n,titleId:a,...s}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},s),n?r.createElement("title",{id:a},n):null,r.createElement("path",{fillRule:"evenodd",d:"M11.47 2.47a.75.75 0 0 1 1.06 0l7.5 7.5a.75.75 0 1 1-1.06 1.06l-6.22-6.22V21a.75.75 0 0 1-1.5 0V4.81l-6.22 6.22a.75.75 0 1 1-1.06-1.06l7.5-7.5Z",clipRule:"evenodd"}))}const jt=r.forwardRef(wt);function Nt(e,t){let{title:n,titleId:a,...s}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},s),n?r.createElement("title",{id:a},n):null,r.createElement("path",{fillRule:"evenodd",d:"M12 2.25a.75.75 0 0 1 .75.75v16.19l6.22-6.22a.75.75 0 1 1 1.06 1.06l-7.5 7.5a.75.75 0 0 1-1.06 0l-7.5-7.5a.75.75 0 1 1 1.06-1.06l6.22 6.22V3a.75.75 0 0 1 .75-.75Z",clipRule:"evenodd"}))}const Et=r.forwardRef(Nt),St=e=>{let{title:t,value:n,previousValue:a,formatValue:r=e=>e.toString(),icon:s,color:i="blue",isPercentage:o=!1,isLoading:l=!1,className:c=""}=e;const d=void 0===a||"number"!==typeof n?null:0===a?n>0?100:0:(n-a)/Math.abs(a)*100,u=null!==d&&d>0,h=null!==d&&d<0,p={blue:"bg-blue-50 text-blue-700 border-blue-200",green:"bg-green-50 text-green-700 border-green-200",red:"bg-red-50 text-red-700 border-red-200",yellow:"bg-yellow-50 text-yellow-700 border-yellow-200",purple:"bg-purple-50 text-purple-700 border-purple-200",indigo:"bg-indigo-50 text-indigo-700 border-indigo-200",gray:"bg-gray-50 text-gray-700 border-gray-200"},m=p[i]||p.blue,f=u?"text-green-600 bg-green-50":h?"text-red-600 bg-red-50":"text-gray-600 bg-gray-50";return(0,Le.jsx)("div",{className:`border rounded-lg shadow-sm overflow-hidden ${c}`,children:(0,Le.jsxs)("div",{className:"p-4",children:[(0,Le.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,Le.jsx)("h3",{className:"text-sm font-medium text-gray-600",children:t}),s&&(0,Le.jsx)("div",{className:`p-2 rounded-full ${m}`,children:s})]}),l?(0,Le.jsx)("div",{className:"animate-pulse h-8 bg-gray-200 rounded w-3/4 my-2"}):(0,Le.jsxs)("div",{className:"flex items-end",children:[(0,Le.jsxs)("span",{className:"text-2xl font-semibold",children:[r(n),o&&"%"]}),null!==d&&(0,Le.jsxs)("div",{className:`ml-2 px-2 py-0.5 rounded-md text-xs flex items-center ${f}`,children:[u?(0,Le.jsx)(jt,{className:"h-3 w-3 mr-1"}):h?(0,Le.jsx)(Et,{className:"h-3 w-3 mr-1"}):null,Math.abs(d).toFixed(1),"%"]})]})]})})};function kt(e){return e+.5|0}const Ct=(e,t,n)=>Math.max(Math.min(e,n),t);function At(e){return Ct(kt(2.55*e),0,255)}function Tt(e){return Ct(kt(255*e),0,255)}function Pt(e){return Ct(kt(e/2.55)/100,0,1)}function It(e){return Ct(kt(100*e),0,100)}const Ot={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Rt=[..."0123456789ABCDEF"],Mt=e=>Rt[15&e],Dt=e=>Rt[(240&e)>>4]+Rt[15&e],Lt=e=>(240&e)>>4===(15&e);function $t(e){var t=(e=>Lt(e.r)&&Lt(e.g)&&Lt(e.b)&&Lt(e.a))(e)?Mt:Dt;return e?"#"+t(e.r)+t(e.g)+t(e.b)+((e,t)=>e<255?t(e):"")(e.a,t):void 0}const zt=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Ft(e,t,n){const a=t*Math.min(n,1-n),r=function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t+e/30)%12;return n-a*Math.max(Math.min(r-3,9-r,1),-1)};return[r(0),r(8),r(4)]}function Bt(e,t,n){const a=function(a){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(a+e/60)%6;return n-n*t*Math.max(Math.min(r,4-r,1),0)};return[a(5),a(3),a(1)]}function Ut(e,t,n){const a=Ft(e,1,.5);let r;for(t+n>1&&(r=1/(t+n),t*=r,n*=r),r=0;r<3;r++)a[r]*=1-t-n,a[r]+=t;return a}function Wt(e){const t=e.r/255,n=e.g/255,a=e.b/255,r=Math.max(t,n,a),s=Math.min(t,n,a),i=(r+s)/2;let o,l,c;return r!==s&&(c=r-s,l=i>.5?c/(2-r-s):c/(r+s),o=function(e,t,n,a,r){return e===r?(t-n)/a+(t<n?6:0):t===r?(n-e)/a+2:(e-t)/a+4}(t,n,a,c,r),o=60*o+.5),[0|o,l||0,i]}function Vt(e,t,n,a){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,n,a)).map(Tt)}function Ht(e,t,n){return Vt(Ft,e,t,n)}function qt(e){return(e%360+360)%360}function Yt(e){const t=zt.exec(e);let n,a=255;if(!t)return;t[5]!==n&&(a=t[6]?At(+t[5]):Tt(+t[5]));const r=qt(+t[2]),s=+t[3]/100,i=+t[4]/100;return n="hwb"===t[1]?function(e,t,n){return Vt(Ut,e,t,n)}(r,s,i):"hsv"===t[1]?function(e,t,n){return Vt(Bt,e,t,n)}(r,s,i):Ht(r,s,i),{r:n[0],g:n[1],b:n[2],a:a}}const Jt={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Gt={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let Xt;function Kt(e){Xt||(Xt=function(){const e={},t=Object.keys(Gt),n=Object.keys(Jt);let a,r,s,i,o;for(a=0;a<t.length;a++){for(i=o=t[a],r=0;r<n.length;r++)s=n[r],o=o.replace(s,Jt[s]);s=parseInt(Gt[i],16),e[o]=[s>>16&255,s>>8&255,255&s]}return e}(),Xt.transparent=[0,0,0,0]);const t=Xt[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:4===t.length?t[3]:255}}const Qt=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;const Zt=e=>e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055,en=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function tn(e,t,n){if(e){let a=Wt(e);a[t]=Math.max(0,Math.min(a[t]+a[t]*n,0===t?360:1)),a=Ht(a),e.r=a[0],e.g=a[1],e.b=a[2]}}function nn(e,t){return e?Object.assign(t||{},e):e}function an(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=Tt(e[3]))):(t=nn(e,{r:0,g:0,b:0,a:1})).a=Tt(t.a),t}function rn(e){return"r"===e.charAt(0)?function(e){const t=Qt.exec(e);let n,a,r,s=255;if(t){if(t[7]!==n){const e=+t[7];s=t[8]?At(e):Ct(255*e,0,255)}return n=+t[1],a=+t[3],r=+t[5],n=255&(t[2]?At(n):Ct(n,0,255)),a=255&(t[4]?At(a):Ct(a,0,255)),r=255&(t[6]?At(r):Ct(r,0,255)),{r:n,g:a,b:r,a:s}}}(e):Yt(e)}class sn{constructor(e){if(e instanceof sn)return e;const t=typeof e;let n;"object"===t?n=an(e):"string"===t&&(n=function(e){var t,n=e.length;return"#"===e[0]&&(4===n||5===n?t={r:255&17*Ot[e[1]],g:255&17*Ot[e[2]],b:255&17*Ot[e[3]],a:5===n?17*Ot[e[4]]:255}:7!==n&&9!==n||(t={r:Ot[e[1]]<<4|Ot[e[2]],g:Ot[e[3]]<<4|Ot[e[4]],b:Ot[e[5]]<<4|Ot[e[6]],a:9===n?Ot[e[7]]<<4|Ot[e[8]]:255})),t}(e)||Kt(e)||rn(e)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var e=nn(this._rgb);return e&&(e.a=Pt(e.a)),e}set rgb(e){this._rgb=an(e)}rgbString(){return this._valid?(e=this._rgb)&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${Pt(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`):void 0;var e}hexString(){return this._valid?$t(this._rgb):void 0}hslString(){return this._valid?function(e){if(!e)return;const t=Wt(e),n=t[0],a=It(t[1]),r=It(t[2]);return e.a<255?`hsla(${n}, ${a}%, ${r}%, ${Pt(e.a)})`:`hsl(${n}, ${a}%, ${r}%)`}(this._rgb):void 0}mix(e,t){if(e){const n=this.rgb,a=e.rgb;let r;const s=t===r?.5:t,i=2*s-1,o=n.a-a.a,l=((i*o===-1?i:(i+o)/(1+i*o))+1)/2;r=1-l,n.r=255&l*n.r+r*a.r+.5,n.g=255&l*n.g+r*a.g+.5,n.b=255&l*n.b+r*a.b+.5,n.a=s*n.a+(1-s)*a.a,this.rgb=n}return this}interpolate(e,t){return e&&(this._rgb=function(e,t,n){const a=en(Pt(e.r)),r=en(Pt(e.g)),s=en(Pt(e.b));return{r:Tt(Zt(a+n*(en(Pt(t.r))-a))),g:Tt(Zt(r+n*(en(Pt(t.g))-r))),b:Tt(Zt(s+n*(en(Pt(t.b))-s))),a:e.a+n*(t.a-e.a)}}(this._rgb,e._rgb,t)),this}clone(){return new sn(this.rgb)}alpha(e){return this._rgb.a=Tt(e),this}clearer(e){return this._rgb.a*=1-e,this}greyscale(){const e=this._rgb,t=kt(.3*e.r+.59*e.g+.11*e.b);return e.r=e.g=e.b=t,this}opaquer(e){return this._rgb.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return tn(this._rgb,2,e),this}darken(e){return tn(this._rgb,2,-e),this}saturate(e){return tn(this._rgb,1,e),this}desaturate(e){return tn(this._rgb,1,-e),this}rotate(e){return function(e,t){var n=Wt(e);n[0]=qt(n[0]+t),n=Ht(n),e.r=n[0],e.g=n[1],e.b=n[2]}(this._rgb,e),this}}function on(){}const ln=(()=>{let e=0;return()=>e++})();function cn(e){return null===e||void 0===e}function dn(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return"[object"===t.slice(0,7)&&"Array]"===t.slice(-6)}function un(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)}function hn(e){return("number"===typeof e||e instanceof Number)&&isFinite(+e)}function pn(e,t){return hn(e)?e:t}function mn(e,t){return"undefined"===typeof e?t:e}const fn=(e,t)=>"string"===typeof e&&e.endsWith("%")?parseFloat(e)/100*t:+e;function gn(e,t,n){if(e&&"function"===typeof e.call)return e.apply(n,t)}function vn(e,t,n,a){let r,s,i;if(dn(e))if(s=e.length,a)for(r=s-1;r>=0;r--)t.call(n,e[r],r);else for(r=0;r<s;r++)t.call(n,e[r],r);else if(un(e))for(i=Object.keys(e),s=i.length,r=0;r<s;r++)t.call(n,e[i[r]],i[r])}function bn(e,t){let n,a,r,s;if(!e||!t||e.length!==t.length)return!1;for(n=0,a=e.length;n<a;++n)if(r=e[n],s=t[n],r.datasetIndex!==s.datasetIndex||r.index!==s.index)return!1;return!0}function yn(e){if(dn(e))return e.map(yn);if(un(e)){const t=Object.create(null),n=Object.keys(e),a=n.length;let r=0;for(;r<a;++r)t[n[r]]=yn(e[n[r]]);return t}return e}function xn(e){return-1===["__proto__","prototype","constructor"].indexOf(e)}function _n(e,t,n,a){if(!xn(e))return;const r=t[e],s=n[e];un(r)&&un(s)?wn(r,s,a):t[e]=yn(s)}function wn(e,t,n){const a=dn(t)?t:[t],r=a.length;if(!un(e))return e;const s=(n=n||{}).merger||_n;let i;for(let o=0;o<r;++o){if(i=a[o],!un(i))continue;const t=Object.keys(i);for(let a=0,r=t.length;a<r;++a)s(t[a],e,i,n)}return e}function jn(e,t){return wn(e,t,{merger:Nn})}function Nn(e,t,n){if(!xn(e))return;const a=t[e],r=n[e];un(a)&&un(r)?jn(a,r):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=yn(r))}const En={"":e=>e,x:e=>e.x,y:e=>e.y};function Sn(e,t){const n=En[t]||(En[t]=function(e){const t=function(e){const t=e.split("."),n=[];let a="";for(const r of t)a+=r,a.endsWith("\\")?a=a.slice(0,-1)+".":(n.push(a),a="");return n}(e);return e=>{for(const n of t){if(""===n)break;e=e&&e[n]}return e}}(t));return n(e)}function kn(e){return e.charAt(0).toUpperCase()+e.slice(1)}const Cn=e=>"undefined"!==typeof e,An=e=>"function"===typeof e,Tn=(e,t)=>{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0};const Pn=Math.PI,In=2*Pn,On=In+Pn,Rn=Number.POSITIVE_INFINITY,Mn=Pn/180,Dn=Pn/2,Ln=Pn/4,$n=2*Pn/3,zn=Math.log10,Fn=Math.sign;function Bn(e,t,n){return Math.abs(e-t)<n}function Un(e){const t=Math.round(e);e=Bn(e,t,e/1e3)?t:e;const n=Math.pow(10,Math.floor(zn(e))),a=e/n;return(a<=1?1:a<=2?2:a<=5?5:10)*n}function Wn(e){return!function(e){return"symbol"===typeof e||"object"===typeof e&&null!==e&&!(Symbol.toPrimitive in e||"toString"in e||"valueOf"in e)}(e)&&!isNaN(parseFloat(e))&&isFinite(e)}function Vn(e,t,n){let a,r,s;for(a=0,r=e.length;a<r;a++)s=e[a][n],isNaN(s)||(t.min=Math.min(t.min,s),t.max=Math.max(t.max,s))}function Hn(e){return e*(Pn/180)}function qn(e){return e*(180/Pn)}function Yn(e){if(!hn(e))return;let t=1,n=0;for(;Math.round(e*t)/t!==e;)t*=10,n++;return n}function Jn(e,t){const n=t.x-e.x,a=t.y-e.y,r=Math.sqrt(n*n+a*a);let s=Math.atan2(a,n);return s<-.5*Pn&&(s+=In),{angle:s,distance:r}}function Gn(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function Xn(e,t){return(e-t+On)%In-Pn}function Kn(e){return(e%In+In)%In}function Qn(e,t,n,a){const r=Kn(e),s=Kn(t),i=Kn(n),o=Kn(s-r),l=Kn(i-r),c=Kn(r-s),d=Kn(r-i);return r===s||r===i||a&&s===i||o>l&&c<d}function Zn(e,t,n){return Math.max(t,Math.min(n,e))}function ea(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-6;return e>=Math.min(t,n)-a&&e<=Math.max(t,n)+a}function ta(e,t,n){n=n||(n=>e[n]<t);let a,r=e.length-1,s=0;for(;r-s>1;)a=s+r>>1,n(a)?s=a:r=a;return{lo:s,hi:r}}const na=(e,t,n,a)=>ta(e,n,a?a=>{const r=e[a][t];return r<n||r===n&&e[a+1][t]===n}:a=>e[a][t]<n),aa=(e,t,n)=>ta(e,n,(a=>e[a][t]>=n));const ra=["push","pop","shift","splice","unshift"];function sa(e,t){const n=e._chartjs;if(!n)return;const a=n.listeners,r=a.indexOf(t);-1!==r&&a.splice(r,1),a.length>0||(ra.forEach((t=>{delete e[t]})),delete e._chartjs)}function ia(e){const t=new Set(e);return t.size===e.length?e:Array.from(t)}const oa="undefined"===typeof window?function(e){return e()}:window.requestAnimationFrame;function la(e,t){let n=[],a=!1;return function(){for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];n=s,a||(a=!0,oa.call(window,(()=>{a=!1,e.apply(t,n)})))}}const ca=e=>"start"===e?"left":"end"===e?"right":"center",da=(e,t,n)=>"start"===e?t:"end"===e?n:(t+n)/2;function ua(e,t,n){const a=t.length;let r=0,s=a;if(e._sorted){const{iScale:i,vScale:o,_parsed:l}=e,c=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null,d=i.axis,{min:u,max:h,minDefined:p,maxDefined:m}=i.getUserBounds();if(p){if(r=Math.min(na(l,d,u).lo,n?a:na(t,d,i.getPixelForValue(u)).lo),c){const e=l.slice(0,r+1).reverse().findIndex((e=>!cn(e[o.axis])));r-=Math.max(0,e)}r=Zn(r,0,a-1)}if(m){let e=Math.max(na(l,i.axis,h,!0).hi+1,n?0:na(t,d,i.getPixelForValue(h),!0).hi+1);if(c){const t=l.slice(e-1).findIndex((e=>!cn(e[o.axis])));e+=Math.max(0,t)}s=Zn(e,r,a)-r}else s=a-r}return{start:r,count:s}}function ha(e){const{xScale:t,yScale:n,_scaleRanges:a}=e,r={xmin:t.min,xmax:t.max,ymin:n.min,ymax:n.max};if(!a)return e._scaleRanges=r,!0;const s=a.xmin!==t.min||a.xmax!==t.max||a.ymin!==n.min||a.ymax!==n.max;return Object.assign(a,r),s}const pa=e=>0===e||1===e,ma=(e,t,n)=>-Math.pow(2,10*(e-=1))*Math.sin((e-t)*In/n),fa=(e,t,n)=>Math.pow(2,-10*e)*Math.sin((e-t)*In/n)+1,ga={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>1-Math.cos(e*Dn),easeOutSine:e=>Math.sin(e*Dn),easeInOutSine:e=>-.5*(Math.cos(Pn*e)-1),easeInExpo:e=>0===e?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>1===e?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>pa(e)?e:e<.5?.5*Math.pow(2,10*(2*e-1)):.5*(2-Math.pow(2,-10*(2*e-1))),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>pa(e)?e:ma(e,.075,.3),easeOutElastic:e=>pa(e)?e:fa(e,.075,.3),easeInOutElastic(e){const t=.1125;return pa(e)?e:e<.5?.5*ma(2*e,t,.45):.5+.5*fa(2*e-1,t,.45)},easeInBack(e){const t=1.70158;return e*e*((t+1)*e-t)},easeOutBack(e){const t=1.70158;return(e-=1)*e*((t+1)*e+t)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?e*e*((1+(t*=1.525))*e-t)*.5:.5*((e-=2)*e*((1+(t*=1.525))*e+t)+2)},easeInBounce:e=>1-ga.easeOutBounce(1-e),easeOutBounce(e){const t=7.5625,n=2.75;return e<1/n?t*e*e:e<2/n?t*(e-=1.5/n)*e+.75:e<2.5/n?t*(e-=2.25/n)*e+.9375:t*(e-=2.625/n)*e+.984375},easeInOutBounce:e=>e<.5?.5*ga.easeInBounce(2*e):.5*ga.easeOutBounce(2*e-1)+.5};function va(e){if(e&&"object"===typeof e){const t=e.toString();return"[object CanvasPattern]"===t||"[object CanvasGradient]"===t}return!1}function ba(e){return va(e)?e:new sn(e)}function ya(e){return va(e)?e:new sn(e).saturate(.5).darken(.1).hexString()}const xa=["x","y","borderWidth","radius","tension"],_a=["color","borderColor","backgroundColor"];const wa=new Map;function ja(e,t,n){return function(e,t){t=t||{};const n=e+JSON.stringify(t);let a=wa.get(n);return a||(a=new Intl.NumberFormat(e,t),wa.set(n,a)),a}(t,n).format(e)}const Na={values:e=>dn(e)?e:""+e,numeric(e,t,n){if(0===e)return"0";const a=this.chart.options.locale;let r,s=e;if(n.length>1){const t=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(t<1e-4||t>1e15)&&(r="scientific"),s=function(e,t){let n=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;Math.abs(n)>=1&&e!==Math.floor(e)&&(n=e-Math.floor(e));return n}(e,n)}const i=zn(Math.abs(s)),o=isNaN(i)?1:Math.max(Math.min(-1*Math.floor(i),20),0),l={notation:r,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(l,this.options.ticks.format),ja(e,a,l)},logarithmic(e,t,n){if(0===e)return"0";const a=n[t].significand||e/Math.pow(10,Math.floor(zn(e)));return[1,2,3,5,10,15].includes(a)||t>.8*n.length?Na.numeric.call(this,e,t,n):""}};var Ea={formatters:Na};const Sa=Object.create(null),ka=Object.create(null);function Ca(e,t){if(!t)return e;const n=t.split(".");for(let a=0,r=n.length;a<r;++a){const t=n[a];e=e[t]||(e[t]=Object.create(null))}return e}function Aa(e,t,n){return"string"===typeof t?wn(Ca(e,t),n):wn(Ca(e,""),t)}class Ta{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=e=>e.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(e,t)=>ya(t.backgroundColor),this.hoverBorderColor=(e,t)=>ya(t.borderColor),this.hoverColor=(e,t)=>ya(t.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return Aa(this,e,t)}get(e){return Ca(this,e)}describe(e,t){return Aa(ka,e,t)}override(e,t){return Aa(Sa,e,t)}route(e,t,n,a){const r=Ca(this,e),s=Ca(this,n),i="_"+t;Object.defineProperties(r,{[i]:{value:r[t],writable:!0},[t]:{enumerable:!0,get(){const e=this[i],t=s[a];return un(e)?Object.assign({},t,e):mn(e,t)},set(e){this[i]=e}}})}apply(e){e.forEach((e=>e(this)))}}var Pa=new Ta({_scriptable:e=>!e.startsWith("on"),_indexable:e=>"events"!==e,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>"onProgress"!==e&&"onComplete"!==e&&"fn"!==e}),e.set("animations",{colors:{type:"color",properties:_a},numbers:{type:"number",properties:xa}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>0|e}}}})},function(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Ea.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&"callback"!==e&&"parser"!==e,_indexable:e=>"borderDash"!==e&&"tickBorderDash"!==e&&"dash"!==e}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:e=>"backdropPadding"!==e&&"callback"!==e,_indexable:e=>"backdropPadding"!==e})}]);function Ia(e,t,n,a,r){let s=t[r];return s||(s=t[r]=e.measureText(r).width,n.push(r)),s>a&&(a=s),a}function Oa(e,t,n){const a=e.currentDevicePixelRatio,r=0!==n?Math.max(n/2,.5):0;return Math.round((t-r)*a)/a+r}function Ra(e,t){(t||e)&&((t=t||e.getContext("2d")).save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore())}function Ma(e,t,n,a){Da(e,t,n,a,null)}function Da(e,t,n,a,r){let s,i,o,l,c,d,u,h;const p=t.pointStyle,m=t.rotation,f=t.radius;let g=(m||0)*Mn;if(p&&"object"===typeof p&&(s=p.toString(),"[object HTMLImageElement]"===s||"[object HTMLCanvasElement]"===s))return e.save(),e.translate(n,a),e.rotate(g),e.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),void e.restore();if(!(isNaN(f)||f<=0)){switch(e.beginPath(),p){default:r?e.ellipse(n,a,r/2,f,0,0,In):e.arc(n,a,f,0,In),e.closePath();break;case"triangle":d=r?r/2:f,e.moveTo(n+Math.sin(g)*d,a-Math.cos(g)*f),g+=$n,e.lineTo(n+Math.sin(g)*d,a-Math.cos(g)*f),g+=$n,e.lineTo(n+Math.sin(g)*d,a-Math.cos(g)*f),e.closePath();break;case"rectRounded":c=.516*f,l=f-c,i=Math.cos(g+Ln)*l,u=Math.cos(g+Ln)*(r?r/2-c:l),o=Math.sin(g+Ln)*l,h=Math.sin(g+Ln)*(r?r/2-c:l),e.arc(n-u,a-o,c,g-Pn,g-Dn),e.arc(n+h,a-i,c,g-Dn,g),e.arc(n+u,a+o,c,g,g+Dn),e.arc(n-h,a+i,c,g+Dn,g+Pn),e.closePath();break;case"rect":if(!m){l=Math.SQRT1_2*f,d=r?r/2:l,e.rect(n-d,a-l,2*d,2*l);break}g+=Ln;case"rectRot":u=Math.cos(g)*(r?r/2:f),i=Math.cos(g)*f,o=Math.sin(g)*f,h=Math.sin(g)*(r?r/2:f),e.moveTo(n-u,a-o),e.lineTo(n+h,a-i),e.lineTo(n+u,a+o),e.lineTo(n-h,a+i),e.closePath();break;case"crossRot":g+=Ln;case"cross":u=Math.cos(g)*(r?r/2:f),i=Math.cos(g)*f,o=Math.sin(g)*f,h=Math.sin(g)*(r?r/2:f),e.moveTo(n-u,a-o),e.lineTo(n+u,a+o),e.moveTo(n+h,a-i),e.lineTo(n-h,a+i);break;case"star":u=Math.cos(g)*(r?r/2:f),i=Math.cos(g)*f,o=Math.sin(g)*f,h=Math.sin(g)*(r?r/2:f),e.moveTo(n-u,a-o),e.lineTo(n+u,a+o),e.moveTo(n+h,a-i),e.lineTo(n-h,a+i),g+=Ln,u=Math.cos(g)*(r?r/2:f),i=Math.cos(g)*f,o=Math.sin(g)*f,h=Math.sin(g)*(r?r/2:f),e.moveTo(n-u,a-o),e.lineTo(n+u,a+o),e.moveTo(n+h,a-i),e.lineTo(n-h,a+i);break;case"line":i=r?r/2:Math.cos(g)*f,o=Math.sin(g)*f,e.moveTo(n-i,a-o),e.lineTo(n+i,a+o);break;case"dash":e.moveTo(n,a),e.lineTo(n+Math.cos(g)*(r?r/2:f),a+Math.sin(g)*f);break;case!1:e.closePath()}e.fill(),t.borderWidth>0&&e.stroke()}}function La(e,t,n){return n=n||.5,!t||e&&e.x>t.left-n&&e.x<t.right+n&&e.y>t.top-n&&e.y<t.bottom+n}function $a(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function za(e){e.restore()}function Fa(e,t,n,a,r){if(!t)return e.lineTo(n.x,n.y);if("middle"===r){const a=(t.x+n.x)/2;e.lineTo(a,t.y),e.lineTo(a,n.y)}else"after"===r!==!!a?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y);e.lineTo(n.x,n.y)}function Ba(e,t,n,a){if(!t)return e.lineTo(n.x,n.y);e.bezierCurveTo(a?t.cp1x:t.cp2x,a?t.cp1y:t.cp2y,a?n.cp2x:n.cp1x,a?n.cp2y:n.cp1y,n.x,n.y)}function Ua(e,t,n,a,r){if(r.strikethrough||r.underline){const s=e.measureText(a),i=t-s.actualBoundingBoxLeft,o=t+s.actualBoundingBoxRight,l=n-s.actualBoundingBoxAscent,c=n+s.actualBoundingBoxDescent,d=r.strikethrough?(l+c)/2:c;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=r.decorationWidth||2,e.moveTo(i,d),e.lineTo(o,d),e.stroke()}}function Wa(e,t){const n=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=n}function Va(e,t,n,a,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const i=dn(t)?t:[t],o=s.strokeWidth>0&&""!==s.strokeColor;let l,c;for(e.save(),e.font=r.string,function(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),cn(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}(e,s),l=0;l<i.length;++l)c=i[l],s.backdrop&&Wa(e,s.backdrop),o&&(s.strokeColor&&(e.strokeStyle=s.strokeColor),cn(s.strokeWidth)||(e.lineWidth=s.strokeWidth),e.strokeText(c,n,a,s.maxWidth)),e.fillText(c,n,a,s.maxWidth),Ua(e,n,a,c,s),a+=Number(r.lineHeight);e.restore()}function Ha(e,t){const{x:n,y:a,w:r,h:s,radius:i}=t;e.arc(n+i.topLeft,a+i.topLeft,i.topLeft,1.5*Pn,Pn,!0),e.lineTo(n,a+s-i.bottomLeft),e.arc(n+i.bottomLeft,a+s-i.bottomLeft,i.bottomLeft,Pn,Dn,!0),e.lineTo(n+r-i.bottomRight,a+s),e.arc(n+r-i.bottomRight,a+s-i.bottomRight,i.bottomRight,Dn,0,!0),e.lineTo(n+r,a+i.topRight),e.arc(n+r-i.topRight,a+i.topRight,i.topRight,0,-Dn,!0),e.lineTo(n+i.topLeft,a)}const qa=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Ya=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Ja(e,t){const n=(""+e).match(qa);if(!n||"normal"===n[1])return 1.2*t;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100}return t*e}function Ga(e,t){const n={},a=un(t),r=a?Object.keys(t):t,s=un(e)?a?n=>mn(e[n],e[t[n]]):t=>e[t]:()=>e;for(const i of r)n[i]=+s(i)||0;return n}function Xa(e){return Ga(e,{top:"y",right:"x",bottom:"y",left:"x"})}function Ka(e){return Ga(e,["topLeft","topRight","bottomLeft","bottomRight"])}function Qa(e){const t=Xa(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function Za(e,t){e=e||{},t=t||Pa.font;let n=mn(e.size,t.size);"string"===typeof n&&(n=parseInt(n,10));let a=mn(e.style,t.style);a&&!(""+a).match(Ya)&&(console.warn('Invalid font style specified: "'+a+'"'),a=void 0);const r={family:mn(e.family,t.family),lineHeight:Ja(mn(e.lineHeight,t.lineHeight),n),size:n,style:a,weight:mn(e.weight,t.weight),string:""};return r.string=function(e){return!e||cn(e.size)||cn(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}(r),r}function er(e,t,n,a){let r,s,i,o=!0;for(r=0,s=e.length;r<s;++r)if(i=e[r],void 0!==i&&(void 0!==t&&"function"===typeof i&&(i=i(t),o=!1),void 0!==n&&dn(i)&&(i=i[n%i.length],o=!1),void 0!==i))return a&&!o&&(a.cacheable=!1),i}function tr(e,t){return Object.assign(Object.create(e),t)}function nr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[""],n=arguments.length>3?arguments[3]:void 0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:()=>e[0];const r=(arguments.length>2?arguments[2]:void 0)||e;"undefined"===typeof n&&(n=pr("_fallback",e));const s={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:r,_fallback:n,_getTarget:a,override:a=>nr([a,...e],t,r,n)};return new Proxy(s,{deleteProperty:(t,n)=>(delete t[n],delete t._keys,delete e[0][n],!0),get:(n,a)=>or(n,a,(()=>function(e,t,n,a){let r;for(const s of t)if(r=pr(sr(s,e),n),"undefined"!==typeof r)return ir(e,r)?ur(n,a,e,r):r}(a,t,e,n))),getOwnPropertyDescriptor:(e,t)=>Reflect.getOwnPropertyDescriptor(e._scopes[0],t),getPrototypeOf:()=>Reflect.getPrototypeOf(e[0]),has:(e,t)=>mr(e).includes(t),ownKeys:e=>mr(e),set(e,t,n){const r=e._storage||(e._storage=a());return e[t]=r[t]=n,delete e._keys,!0}})}function ar(e,t,n,a){const r={_cacheable:!1,_proxy:e,_context:t,_subProxy:n,_stack:new Set,_descriptors:rr(e,a),setContext:t=>ar(e,t,n,a),override:r=>ar(e.override(r),t,n,a)};return new Proxy(r,{deleteProperty:(t,n)=>(delete t[n],delete e[n],!0),get:(e,t,n)=>or(e,t,(()=>function(e,t,n){const{_proxy:a,_context:r,_subProxy:s,_descriptors:i}=e;let o=a[t];An(o)&&i.isScriptable(t)&&(o=function(e,t,n,a){const{_proxy:r,_context:s,_subProxy:i,_stack:o}=n;if(o.has(e))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+e);o.add(e);let l=t(s,i||a);o.delete(e),ir(e,l)&&(l=ur(r._scopes,r,e,l));return l}(t,o,e,n));dn(o)&&o.length&&(o=function(e,t,n,a){const{_proxy:r,_context:s,_subProxy:i,_descriptors:o}=n;if("undefined"!==typeof s.index&&a(e))return t[s.index%t.length];if(un(t[0])){const n=t,a=r._scopes.filter((e=>e!==n));t=[];for(const l of n){const n=ur(a,r,e,l);t.push(ar(n,s,i&&i[e],o))}}return t}(t,o,e,i.isIndexable));ir(t,o)&&(o=ar(o,r,s&&s[t],i));return o}(e,t,n))),getOwnPropertyDescriptor:(t,n)=>t._descriptors.allKeys?Reflect.has(e,n)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,n),getPrototypeOf:()=>Reflect.getPrototypeOf(e),has:(t,n)=>Reflect.has(e,n),ownKeys:()=>Reflect.ownKeys(e),set:(t,n,a)=>(e[n]=a,delete t[n],!0)})}function rr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{scriptable:!0,indexable:!0};const{_scriptable:n=t.scriptable,_indexable:a=t.indexable,_allKeys:r=t.allKeys}=e;return{allKeys:r,scriptable:n,indexable:a,isScriptable:An(n)?n:()=>n,isIndexable:An(a)?a:()=>a}}const sr=(e,t)=>e?e+kn(t):t,ir=(e,t)=>un(t)&&"adapters"!==e&&(null===Object.getPrototypeOf(t)||t.constructor===Object);function or(e,t,n){if(Object.prototype.hasOwnProperty.call(e,t)||"constructor"===t)return e[t];const a=n();return e[t]=a,a}function lr(e,t,n){return An(e)?e(t,n):e}const cr=(e,t)=>!0===e?t:"string"===typeof e?Sn(t,e):void 0;function dr(e,t,n,a,r){for(const s of t){const t=cr(n,s);if(t){e.add(t);const s=lr(t._fallback,n,r);if("undefined"!==typeof s&&s!==n&&s!==a)return s}else if(!1===t&&"undefined"!==typeof a&&n!==a)return null}return!1}function ur(e,t,n,a){const r=t._rootScopes,s=lr(t._fallback,n,a),i=[...e,...r],o=new Set;o.add(a);let l=hr(o,i,n,s||n,a);return null!==l&&(("undefined"===typeof s||s===n||(l=hr(o,i,s,l,a),null!==l))&&nr(Array.from(o),[""],r,s,(()=>function(e,t,n){const a=e._getTarget();t in a||(a[t]={});const r=a[t];if(dn(r)&&un(n))return n;return r||{}}(t,n,a))))}function hr(e,t,n,a,r){for(;n;)n=dr(e,t,n,a,r);return n}function pr(e,t){for(const n of t){if(!n)continue;const t=n[e];if("undefined"!==typeof t)return t}}function mr(e){let t=e._keys;return t||(t=e._keys=function(e){const t=new Set;for(const n of e)for(const e of Object.keys(n).filter((e=>!e.startsWith("_"))))t.add(e);return Array.from(t)}(e._scopes)),t}const fr=Number.EPSILON||1e-14,gr=(e,t)=>t<e.length&&!e[t].skip&&e[t],vr=e=>"x"===e?"y":"x";function br(e,t,n,a){const r=e.skip?t:e,s=t,i=n.skip?t:n,o=Gn(s,r),l=Gn(i,s);let c=o/(o+l),d=l/(o+l);c=isNaN(c)?0:c,d=isNaN(d)?0:d;const u=a*c,h=a*d;return{previous:{x:s.x-u*(i.x-r.x),y:s.y-u*(i.y-r.y)},next:{x:s.x+h*(i.x-r.x),y:s.y+h*(i.y-r.y)}}}function yr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"x";const n=vr(t),a=e.length,r=Array(a).fill(0),s=Array(a);let i,o,l,c=gr(e,0);for(i=0;i<a;++i)if(o=l,l=c,c=gr(e,i+1),l){if(c){const e=c[t]-l[t];r[i]=0!==e?(c[n]-l[n])/e:0}s[i]=o?c?Fn(r[i-1])!==Fn(r[i])?0:(r[i-1]+r[i])/2:r[i-1]:r[i]}!function(e,t,n){const a=e.length;let r,s,i,o,l,c=gr(e,0);for(let d=0;d<a-1;++d)l=c,c=gr(e,d+1),l&&c&&(Bn(t[d],0,fr)?n[d]=n[d+1]=0:(r=n[d]/t[d],s=n[d+1]/t[d],o=Math.pow(r,2)+Math.pow(s,2),o<=9||(i=3/Math.sqrt(o),n[d]=r*i*t[d],n[d+1]=s*i*t[d])))}(e,r,s),function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"x";const a=vr(n),r=e.length;let s,i,o,l=gr(e,0);for(let c=0;c<r;++c){if(i=o,o=l,l=gr(e,c+1),!o)continue;const r=o[n],d=o[a];i&&(s=(r-i[n])/3,o[`cp1${n}`]=r-s,o[`cp1${a}`]=d-s*t[c]),l&&(s=(l[n]-r)/3,o[`cp2${n}`]=r+s,o[`cp2${a}`]=d+s*t[c])}}(e,s,t)}function xr(e,t,n){return Math.max(Math.min(e,n),t)}function _r(e,t,n,a,r){let s,i,o,l;if(t.spanGaps&&(e=e.filter((e=>!e.skip))),"monotone"===t.cubicInterpolationMode)yr(e,r);else{let n=a?e[e.length-1]:e[0];for(s=0,i=e.length;s<i;++s)o=e[s],l=br(n,o,e[Math.min(s+1,i-(a?0:1))%i],t.tension),o.cp1x=l.previous.x,o.cp1y=l.previous.y,o.cp2x=l.next.x,o.cp2y=l.next.y,n=o}t.capBezierPoints&&function(e,t){let n,a,r,s,i,o=La(e[0],t);for(n=0,a=e.length;n<a;++n)i=s,s=o,o=n<a-1&&La(e[n+1],t),s&&(r=e[n],i&&(r.cp1x=xr(r.cp1x,t.left,t.right),r.cp1y=xr(r.cp1y,t.top,t.bottom)),o&&(r.cp2x=xr(r.cp2x,t.left,t.right),r.cp2y=xr(r.cp2y,t.top,t.bottom)))}(e,n)}function wr(){return"undefined"!==typeof window&&"undefined"!==typeof document}function jr(e){let t=e.parentNode;return t&&"[object ShadowRoot]"===t.toString()&&(t=t.host),t}function Nr(e,t,n){let a;return"string"===typeof e?(a=parseInt(e,10),-1!==e.indexOf("%")&&(a=a/100*t.parentNode[n])):a=e,a}const Er=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);const Sr=["top","right","bottom","left"];function kr(e,t,n){const a={};n=n?"-"+n:"";for(let r=0;r<4;r++){const s=Sr[r];a[s]=parseFloat(e[t+"-"+s+n])||0}return a.width=a.left+a.right,a.height=a.top+a.bottom,a}function Cr(e,t){if("native"in e)return e;const{canvas:n,currentDevicePixelRatio:a}=t,r=Er(n),s="border-box"===r.boxSizing,i=kr(r,"padding"),o=kr(r,"border","width"),{x:l,y:c,box:d}=function(e,t){const n=e.touches,a=n&&n.length?n[0]:e,{offsetX:r,offsetY:s}=a;let i,o,l=!1;if(((e,t,n)=>(e>0||t>0)&&(!n||!n.shadowRoot))(r,s,e.target))i=r,o=s;else{const e=t.getBoundingClientRect();i=a.clientX-e.left,o=a.clientY-e.top,l=!0}return{x:i,y:o,box:l}}(e,n),u=i.left+(d&&o.left),h=i.top+(d&&o.top);let{width:p,height:m}=t;return s&&(p-=i.width+o.width,m-=i.height+o.height),{x:Math.round((l-u)/p*n.width/a),y:Math.round((c-h)/m*n.height/a)}}const Ar=e=>Math.round(10*e)/10;function Tr(e,t,n,a){const r=Er(e),s=kr(r,"margin"),i=Nr(r.maxWidth,e,"clientWidth")||Rn,o=Nr(r.maxHeight,e,"clientHeight")||Rn,l=function(e,t,n){let a,r;if(void 0===t||void 0===n){const s=e&&jr(e);if(s){const e=s.getBoundingClientRect(),i=Er(s),o=kr(i,"border","width"),l=kr(i,"padding");t=e.width-l.width-o.width,n=e.height-l.height-o.height,a=Nr(i.maxWidth,s,"clientWidth"),r=Nr(i.maxHeight,s,"clientHeight")}else t=e.clientWidth,n=e.clientHeight}return{width:t,height:n,maxWidth:a||Rn,maxHeight:r||Rn}}(e,t,n);let{width:c,height:d}=l;if("content-box"===r.boxSizing){const e=kr(r,"border","width"),t=kr(r,"padding");c-=t.width+e.width,d-=t.height+e.height}c=Math.max(0,c-s.width),d=Math.max(0,a?c/a:d-s.height),c=Ar(Math.min(c,i,l.maxWidth)),d=Ar(Math.min(d,o,l.maxHeight)),c&&!d&&(d=Ar(c/2));return(void 0!==t||void 0!==n)&&a&&l.height&&d>l.height&&(d=l.height,c=Ar(Math.floor(d*a))),{width:c,height:d}}function Pr(e,t,n){const a=t||1,r=Math.floor(e.height*a),s=Math.floor(e.width*a);e.height=Math.floor(e.height),e.width=Math.floor(e.width);const i=e.canvas;return i.style&&(n||!i.style.height&&!i.style.width)&&(i.style.height=`${e.height}px`,i.style.width=`${e.width}px`),(e.currentDevicePixelRatio!==a||i.height!==r||i.width!==s)&&(e.currentDevicePixelRatio=a,i.height=r,i.width=s,e.ctx.setTransform(a,0,0,a,0,0),!0)}const Ir=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};wr()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch(Uu){}return e}();function Or(e,t){const n=function(e,t){return Er(e).getPropertyValue(t)}(e,t),a=n&&n.match(/^(\d+)(\.\d+)?px$/);return a?+a[1]:void 0}function Rr(e,t,n,a){return{x:e.x+n*(t.x-e.x),y:e.y+n*(t.y-e.y)}}function Mr(e,t,n,a){return{x:e.x+n*(t.x-e.x),y:"middle"===a?n<.5?e.y:t.y:"after"===a?n<1?e.y:t.y:n>0?t.y:e.y}}function Dr(e,t,n,a){const r={x:e.cp2x,y:e.cp2y},s={x:t.cp1x,y:t.cp1y},i=Rr(e,r,n),o=Rr(r,s,n),l=Rr(s,t,n),c=Rr(i,o,n),d=Rr(o,l,n);return Rr(c,d,n)}function Lr(e,t,n){return e?function(e,t){return{x:n=>e+e+t-n,setWidth(e){t=e},textAlign:e=>"center"===e?e:"right"===e?"left":"right",xPlus:(e,t)=>e-t,leftForLtr:(e,t)=>e-t}}(t,n):{x:e=>e,setWidth(e){},textAlign:e=>e,xPlus:(e,t)=>e+t,leftForLtr:(e,t)=>e}}function $r(e,t){let n,a;"ltr"!==t&&"rtl"!==t||(n=e.canvas.style,a=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",t,"important"),e.prevTextDirection=a)}function zr(e,t){void 0!==t&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function Fr(e){return"angle"===e?{between:Qn,compare:Xn,normalize:Kn}:{between:ea,compare:(e,t)=>e-t,normalize:e=>e}}function Br(e){let{start:t,end:n,count:a,loop:r,style:s}=e;return{start:t%a,end:n%a,loop:r&&(n-t+1)%a===0,style:s}}function Ur(e,t,n){if(!n)return[e];const{property:a,start:r,end:s}=n,i=t.length,{compare:o,between:l,normalize:c}=Fr(a),{start:d,end:u,loop:h,style:p}=function(e,t,n){const{property:a,start:r,end:s}=n,{between:i,normalize:o}=Fr(a),l=t.length;let c,d,{start:u,end:h,loop:p}=e;if(p){for(u+=l,h+=l,c=0,d=l;c<d&&i(o(t[u%l][a]),r,s);++c)u--,h--;u%=l,h%=l}return h<u&&(h+=l),{start:u,end:h,loop:p,style:e.style}}(e,t,n),m=[];let f,g,v,b=!1,y=null;const x=()=>b||l(r,v,f)&&0!==o(r,v),_=()=>!b||0===o(s,f)||l(s,v,f);for(let w=d,j=d;w<=u;++w)g=t[w%i],g.skip||(f=c(g[a]),f!==v&&(b=l(f,r,s),null===y&&x()&&(y=0===o(f,r)?w:j),null!==y&&_()&&(m.push(Br({start:y,end:w,loop:h,count:i,style:p})),y=null),j=w,v=f));return null!==y&&m.push(Br({start:y,end:u,loop:h,count:i,style:p})),m}function Wr(e,t){const n=[],a=e.segments;for(let r=0;r<a.length;r++){const s=Ur(a[r],e.points,t);s.length&&n.push(...s)}return n}function Vr(e,t,n,a){return a&&a.setContext&&n?function(e,t,n,a){const r=e._chart.getContext(),s=Hr(e.options),{_datasetIndex:i,options:{spanGaps:o}}=e,l=n.length,c=[];let d=s,u=t[0].start,h=u;function p(e,t,a,r){const s=o?-1:1;if(e!==t){for(e+=l;n[e%l].skip;)e-=s;for(;n[t%l].skip;)t+=s;e%l!==t%l&&(c.push({start:e%l,end:t%l,loop:a,style:r}),d=r,u=t%l)}}for(const m of t){u=o?u:m.start;let e,t=n[u%l];for(h=u+1;h<=m.end;h++){const s=n[h%l];e=Hr(a.setContext(tr(r,{type:"segment",p0:t,p1:s,p0DataIndex:(h-1)%l,p1DataIndex:h%l,datasetIndex:i}))),qr(e,d)&&p(u,h-1,m.loop,d),t=s,d=e}u<h-1&&p(u,h-1,m.loop,d)}return c}(e,t,n,a):t}function Hr(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function qr(e,t){if(!t)return!1;const n=[],a=function(e,t){return va(t)?(n.includes(t)||n.push(t),n.indexOf(t)):t};return JSON.stringify(e,a)!==JSON.stringify(t,a)}class Yr{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,n,a){const r=t.listeners[a],s=t.duration;r.forEach((a=>a({chart:e,initial:t.initial,numSteps:s,currentStep:Math.min(n-t.start,s)})))}_refresh(){this._request||(this._running=!0,this._request=oa.call(window,(()=>{this._update(),this._request=null,this._running&&this._refresh()})))}_update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),t=0;this._charts.forEach(((n,a)=>{if(!n.running||!n.items.length)return;const r=n.items;let s,i=r.length-1,o=!1;for(;i>=0;--i)s=r[i],s._active?(s._total>n.duration&&(n.duration=s._total),s.tick(e),o=!0):(r[i]=r[r.length-1],r.pop());o&&(a.draw(),this._notify(a,n,e,"progress")),r.length||(n.running=!1,this._notify(a,n,e,"complete"),n.initial=!1),t+=r.length})),this._lastDate=e,0===t&&(this._running=!1)}_getAnims(e){const t=this._charts;let n=t.get(e);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,n)),n}listen(e,t,n){this._getAnims(e).listeners[t].push(n)}add(e,t){t&&t.length&&this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce(((e,t)=>Math.max(e,t._duration)),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!!(t&&t.running&&t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const n=t.items;let a=n.length-1;for(;a>=0;--a)n[a].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var Jr=new Yr;const Gr="transparent",Xr={boolean:(e,t,n)=>n>.5?t:e,color(e,t,n){const a=ba(e||Gr),r=a.valid&&ba(t||Gr);return r&&r.valid?r.mix(a,n).hexString():t},number:(e,t,n)=>e+(t-e)*n};class Kr{constructor(e,t,n,a){const r=t[n];a=er([e.to,a,r,e.from]);const s=er([e.from,r,a]);this._active=!0,this._fn=e.fn||Xr[e.type||typeof s],this._easing=ga[e.easing]||ga.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=n,this._from=s,this._to=a,this._promises=void 0}active(){return this._active}update(e,t,n){if(this._active){this._notify(!1);const a=this._target[this._prop],r=n-this._start,s=this._duration-r;this._start=n,this._duration=Math.floor(Math.max(s,e.duration)),this._total+=r,this._loop=!!e.loop,this._to=er([e.to,t,a,e.from]),this._from=er([e.from,a,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,n=this._duration,a=this._prop,r=this._from,s=this._loop,i=this._to;let o;if(this._active=r!==i&&(s||t<n),!this._active)return this._target[a]=i,void this._notify(!0);t<0?this._target[a]=r:(o=t/n%2,o=s&&o>1?2-o:o,o=this._easing(Math.min(1,Math.max(0,o))),this._target[a]=this._fn(r,i,o))}wait(){const e=this._promises||(this._promises=[]);return new Promise(((t,n)=>{e.push({res:t,rej:n})}))}_notify(e){const t=e?"res":"rej",n=this._promises||[];for(let a=0;a<n.length;a++)n[a][t]()}}class Qr{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!un(e))return;const t=Object.keys(Pa.animation),n=this._properties;Object.getOwnPropertyNames(e).forEach((a=>{const r=e[a];if(!un(r))return;const s={};for(const e of t)s[e]=r[e];(dn(r.properties)&&r.properties||[a]).forEach((e=>{e!==a&&n.has(e)||n.set(e,s)}))}))}_animateOptions(e,t){const n=t.options,a=function(e,t){if(!t)return;let n=e.options;if(!n)return void(e.options=t);n.$shared&&(e.options=n=Object.assign({},n,{$shared:!1,$animations:{}}));return n}(e,n);if(!a)return[];const r=this._createAnimations(a,n);return n.$shared&&function(e,t){const n=[],a=Object.keys(t);for(let r=0;r<a.length;r++){const t=e[a[r]];t&&t.active()&&n.push(t.wait())}return Promise.all(n)}(e.options.$animations,n).then((()=>{e.options=n}),(()=>{})),r}_createAnimations(e,t){const n=this._properties,a=[],r=e.$animations||(e.$animations={}),s=Object.keys(t),i=Date.now();let o;for(o=s.length-1;o>=0;--o){const l=s[o];if("$"===l.charAt(0))continue;if("options"===l){a.push(...this._animateOptions(e,t));continue}const c=t[l];let d=r[l];const u=n.get(l);if(d){if(u&&d.active()){d.update(u,c,i);continue}d.cancel()}u&&u.duration?(r[l]=d=new Kr(u,e,l,c),a.push(d)):e[l]=c}return a}update(e,t){if(0===this._properties.size)return void Object.assign(e,t);const n=this._createAnimations(e,t);return n.length?(Jr.add(this._chart,n),!0):void 0}}function Zr(e,t){const n=e&&e.options||{},a=n.reverse,r=void 0===n.min?t:0,s=void 0===n.max?t:0;return{start:a?s:r,end:a?r:s}}function es(e,t){const n=[],a=e._getSortedDatasetMetas(t);let r,s;for(r=0,s=a.length;r<s;++r)n.push(a[r].index);return n}function ts(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const r=e.keys,s="single"===a.mode;let i,o,l,c;if(null===t)return;let d=!1;for(i=0,o=r.length;i<o;++i){if(l=+r[i],l===n){if(d=!0,a.all)continue;break}c=e.values[l],hn(c)&&(s||0===t||Fn(t)===Fn(c))&&(t+=c)}return d||a.all?t:0}function ns(e,t){const n=e&&e.options.stacked;return n||void 0===n&&void 0!==t.stack}function as(e,t,n){const a=e[t]||(e[t]={});return a[n]||(a[n]={})}function rs(e,t,n,a){for(const r of t.getMatchingVisibleMetas(a).reverse()){const t=e[r.index];if(n&&t>0||!n&&t<0)return r.index}return null}function ss(e,t){const{chart:n,_cachedMeta:a}=e,r=n._stacks||(n._stacks={}),{iScale:s,vScale:i,index:o}=a,l=s.axis,c=i.axis,d=function(e,t,n){return`${e.id}.${t.id}.${n.stack||n.type}`}(s,i,a),u=t.length;let h;for(let p=0;p<u;++p){const e=t[p],{[l]:n,[c]:s}=e;h=(e._stacks||(e._stacks={}))[c]=as(r,d,n),h[o]=s,h._top=rs(h,i,!0,a.type),h._bottom=rs(h,i,!1,a.type);(h._visualValues||(h._visualValues={}))[o]=s}}function is(e,t){const n=e.scales;return Object.keys(n).filter((e=>n[e].axis===t)).shift()}function os(e,t){const n=e.controller.index,a=e.vScale&&e.vScale.axis;if(a){t=t||e._parsed;for(const e of t){const t=e._stacks;if(!t||void 0===t[a]||void 0===t[a][n])return;delete t[a][n],void 0!==t[a]._visualValues&&void 0!==t[a]._visualValues[n]&&delete t[a]._visualValues[n]}}}const ls=e=>"reset"===e||"none"===e,cs=(e,t)=>t?e:Object.assign({},e);class ds{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=ns(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&os(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,n=this.getDataset(),a=(e,t,n,a)=>"x"===e?t:"r"===e?a:n,r=t.xAxisID=mn(n.xAxisID,is(e,"x")),s=t.yAxisID=mn(n.yAxisID,is(e,"y")),i=t.rAxisID=mn(n.rAxisID,is(e,"r")),o=t.indexAxis,l=t.iAxisID=a(o,r,s,i),c=t.vAxisID=a(o,s,r,i);t.xScale=this.getScaleForId(r),t.yScale=this.getScaleForId(s),t.rScale=this.getScaleForId(i),t.iScale=this.getScaleForId(l),t.vScale=this.getScaleForId(c)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&sa(this._data,this),e._stacked&&os(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),n=this._data;if(un(t)){const e=this._cachedMeta;this._data=function(e,t){const{iScale:n,vScale:a}=t,r="x"===n.axis?"x":"y",s="x"===a.axis?"x":"y",i=Object.keys(e),o=new Array(i.length);let l,c,d;for(l=0,c=i.length;l<c;++l)d=i[l],o[l]={[r]:d,[s]:e[d]};return o}(t,e)}else if(n!==t){if(n){sa(n,this);const e=this._cachedMeta;os(e),e._parsed=[]}t&&Object.isExtensible(t)&&(r=this,(a=t)._chartjs?a._chartjs.listeners.push(r):(Object.defineProperty(a,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[r]}}),ra.forEach((e=>{const t="_onData"+kn(e),n=a[e];Object.defineProperty(a,e,{configurable:!0,enumerable:!1,value(){for(var e=arguments.length,r=new Array(e),s=0;s<e;s++)r[s]=arguments[s];const i=n.apply(this,r);return a._chartjs.listeners.forEach((e=>{"function"===typeof e[t]&&e[t](...r)})),i}})})))),this._syncList=[],this._data=t}var a,r}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,n=this.getDataset();let a=!1;this._dataCheck();const r=t._stacked;t._stacked=ns(t.vScale,t),t.stack!==n.stack&&(a=!0,os(t),t.stack=n.stack),this._resyncElements(e),(a||r!==t._stacked)&&(ss(this,t._parsed),t._stacked=ns(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),n=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:n,_data:a}=this,{iScale:r,_stacked:s}=n,i=r.axis;let o,l,c,d=0===e&&t===a.length||n._sorted,u=e>0&&n._parsed[e-1];if(!1===this._parsing)n._parsed=a,n._sorted=!0,c=a;else{c=dn(a[e])?this.parseArrayData(n,a,e,t):un(a[e])?this.parseObjectData(n,a,e,t):this.parsePrimitiveData(n,a,e,t);const r=()=>null===l[i]||u&&l[i]<u[i];for(o=0;o<t;++o)n._parsed[o+e]=l=c[o],d&&(r()&&(d=!1),u=l);n._sorted=d}s&&ss(this,c)}parsePrimitiveData(e,t,n,a){const{iScale:r,vScale:s}=e,i=r.axis,o=s.axis,l=r.getLabels(),c=r===s,d=new Array(a);let u,h,p;for(u=0,h=a;u<h;++u)p=u+n,d[u]={[i]:c||r.parse(l[p],p),[o]:s.parse(t[p],p)};return d}parseArrayData(e,t,n,a){const{xScale:r,yScale:s}=e,i=new Array(a);let o,l,c,d;for(o=0,l=a;o<l;++o)c=o+n,d=t[c],i[o]={x:r.parse(d[0],c),y:s.parse(d[1],c)};return i}parseObjectData(e,t,n,a){const{xScale:r,yScale:s}=e,{xAxisKey:i="x",yAxisKey:o="y"}=this._parsing,l=new Array(a);let c,d,u,h;for(c=0,d=a;c<d;++c)u=c+n,h=t[u],l[c]={x:r.parse(Sn(h,i),u),y:s.parse(Sn(h,o),u)};return l}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,n){const a=this.chart,r=this._cachedMeta,s=t[e.axis];return ts({keys:es(a,!0),values:t._stacks[e.axis]._visualValues},s,r.index,{mode:n})}updateRangeFromParsed(e,t,n,a){const r=n[t.axis];let s=null===r?NaN:r;const i=a&&n._stacks[t.axis];a&&i&&(a.values=i,s=ts(a,r,this._cachedMeta.index)),e.min=Math.min(e.min,s),e.max=Math.max(e.max,s)}getMinMax(e,t){const n=this._cachedMeta,a=n._parsed,r=n._sorted&&e===n.iScale,s=a.length,i=this._getOtherScale(e),o=((e,t,n)=>e&&!t.hidden&&t._stacked&&{keys:es(n,!0),values:null})(t,n,this.chart),l={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:c,max:d}=function(e){const{min:t,max:n,minDefined:a,maxDefined:r}=e.getUserBounds();return{min:a?t:Number.NEGATIVE_INFINITY,max:r?n:Number.POSITIVE_INFINITY}}(i);let u,h;function p(){h=a[u];const t=h[i.axis];return!hn(h[e.axis])||c>t||d<t}for(u=0;u<s&&(p()||(this.updateRangeFromParsed(l,e,h,o),!r));++u);if(r)for(u=s-1;u>=0;--u)if(!p()){this.updateRangeFromParsed(l,e,h,o);break}return l}getAllParsedValues(e){const t=this._cachedMeta._parsed,n=[];let a,r,s;for(a=0,r=t.length;a<r;++a)s=t[a][e.axis],hn(s)&&n.push(s);return n}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,n=t.iScale,a=t.vScale,r=this.getParsed(e);return{label:n?""+n.getLabelForValue(r[n.axis]):"",value:a?""+a.getLabelForValue(r[a.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=function(e){let t,n,a,r;return un(e)?(t=e.top,n=e.right,a=e.bottom,r=e.left):t=n=a=r=e,{top:t,right:n,bottom:a,left:r,disabled:!1===e}}(mn(this.options.clip,function(e,t,n){if(!1===n)return!1;const a=Zr(e,n),r=Zr(t,n);return{top:r.end,right:a.end,bottom:r.start,left:a.start}}(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,n=this._cachedMeta,a=n.data||[],r=t.chartArea,s=[],i=this._drawStart||0,o=this._drawCount||a.length-i,l=this.options.drawActiveElementsOnTop;let c;for(n.dataset&&n.dataset.draw(e,r,i,o),c=i;c<i+o;++c){const t=a[c];t.hidden||(t.active&&l?s.push(t):t.draw(e,r))}for(c=0;c<s.length;++c)s[c].draw(e,r)}getStyle(e,t){const n=t?"active":"default";return void 0===e&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(e||0,n)}getContext(e,t,n){const a=this.getDataset();let r;if(e>=0&&e<this._cachedMeta.data.length){const t=this._cachedMeta.data[e];r=t.$context||(t.$context=function(e,t,n){return tr(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:n,index:t,mode:"default",type:"data"})}(this.getContext(),e,t)),r.parsed=this.getParsed(e),r.raw=a.data[e],r.index=r.dataIndex=e}else r=this.$context||(this.$context=function(e,t){return tr(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),r.dataset=a,r.index=r.datasetIndex=this.index;return r.active=!!t,r.mode=n,r}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",n=arguments.length>2?arguments[2]:void 0;const a="active"===t,r=this._cachedDataOpts,s=e+"-"+t,i=r[s],o=this.enableOptionSharing&&Cn(n);if(i)return cs(i,o);const l=this.chart.config,c=l.datasetElementScopeKeys(this._type,e),d=a?[`${e}Hover`,"hover",e,""]:[e,""],u=l.getOptionScopes(this.getDataset(),c),h=Object.keys(Pa.elements[e]),p=l.resolveNamedOptions(u,h,(()=>this.getContext(n,a,t)),d);return p.$shared&&(p.$shared=o,r[s]=Object.freeze(cs(p,o))),p}_resolveAnimations(e,t,n){const a=this.chart,r=this._cachedDataOpts,s=`animation-${t}`,i=r[s];if(i)return i;let o;if(!1!==a.options.animation){const a=this.chart.config,r=a.datasetAnimationScopeKeys(this._type,t),s=a.getOptionScopes(this.getDataset(),r);o=a.createResolver(s,this.getContext(e,n,t))}const l=new Qr(a,o&&o.animations);return o&&o._cacheable&&(r[s]=Object.freeze(l)),l}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||ls(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const n=this.resolveDataElementOptions(e,t),a=this._sharedOptions,r=this.getSharedOptions(n),s=this.includeOptions(t,r)||r!==a;return this.updateSharedOptions(r,t,n),{sharedOptions:r,includeOptions:s}}updateElement(e,t,n,a){ls(a)?Object.assign(e,n):this._resolveAnimations(t,a).update(e,n)}updateSharedOptions(e,t,n){e&&!ls(t)&&this._resolveAnimations(void 0,t).update(e,n)}_setStyle(e,t,n,a){e.active=a;const r=this.getStyle(t,a);this._resolveAnimations(t,n,a).update(e,{options:!a&&this.getSharedOptions(r)||r})}removeHoverStyle(e,t,n){this._setStyle(e,n,"active",!1)}setHoverStyle(e,t,n){this._setStyle(e,n,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,n=this._cachedMeta.data;for(const[i,o,l]of this._syncList)this[i](o,l);this._syncList=[];const a=n.length,r=t.length,s=Math.min(r,a);s&&this.parse(0,s),r>a?this._insertElements(a,r-a,e):r<a&&this._removeElements(r,a-r)}_insertElements(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const a=this._cachedMeta,r=a.data,s=e+t;let i;const o=e=>{for(e.length+=t,i=e.length-1;i>=s;i--)e[i]=e[i-t]};for(o(r),i=e;i<s;++i)r[i]=new this.dataElementType;this._parsing&&o(a._parsed),this.parse(e,t),n&&this.updateElements(r,e,t,"reset")}updateElements(e,t,n,a){}_removeElements(e,t){const n=this._cachedMeta;if(this._parsing){const a=n._parsed.splice(e,t);n._stacked&&os(n,a)}n.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,n,a]=e;this[t](n,a)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const n=arguments.length-2;n&&this._sync(["_insertElements",e,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function us(e){const t=e.iScale,n=function(e,t){if(!e._cache.$bar){const n=e.getMatchingVisibleMetas(t);let a=[];for(let t=0,r=n.length;t<r;t++)a=a.concat(n[t].controller.getAllParsedValues(e));e._cache.$bar=ia(a.sort(((e,t)=>e-t)))}return e._cache.$bar}(t,e.type);let a,r,s,i,o=t._length;const l=()=>{32767!==s&&-32768!==s&&(Cn(i)&&(o=Math.min(o,Math.abs(s-i)||o)),i=s)};for(a=0,r=n.length;a<r;++a)s=t.getPixelForValue(n[a]),l();for(i=void 0,a=0,r=t.ticks.length;a<r;++a)s=t.getPixelForTick(a),l();return o}function hs(e,t,n,a){return dn(e)?function(e,t,n,a){const r=n.parse(e[0],a),s=n.parse(e[1],a),i=Math.min(r,s),o=Math.max(r,s);let l=i,c=o;Math.abs(i)>Math.abs(o)&&(l=o,c=i),t[n.axis]=c,t._custom={barStart:l,barEnd:c,start:r,end:s,min:i,max:o}}(e,t,n,a):t[n.axis]=n.parse(e,a),t}function ps(e,t,n,a){const r=e.iScale,s=e.vScale,i=r.getLabels(),o=r===s,l=[];let c,d,u,h;for(c=n,d=n+a;c<d;++c)h=t[c],u={},u[r.axis]=o||r.parse(i[c],c),l.push(hs(h,u,s,c));return l}function ms(e){return e&&void 0!==e.barStart&&void 0!==e.barEnd}function fs(e,t,n,a){let r=t.borderSkipped;const s={};if(!r)return void(e.borderSkipped=s);if(!0===r)return void(e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0});const{start:i,end:o,reverse:l,top:c,bottom:d}=function(e){let t,n,a,r,s;return e.horizontal?(t=e.base>e.x,n="left",a="right"):(t=e.base<e.y,n="bottom",a="top"),t?(r="end",s="start"):(r="start",s="end"),{start:n,end:a,reverse:t,top:r,bottom:s}}(e);"middle"===r&&n&&(e.enableBorderRadius=!0,(n._top||0)===a?r=c:(n._bottom||0)===a?r=d:(s[gs(d,i,o,l)]=!0,r=c)),s[gs(r,i,o,l)]=!0,e.borderSkipped=s}function gs(e,t,n,a){var r,s,i;return a?(i=n,e=vs(e=(r=e)===(s=t)?i:r===i?s:r,n,t)):e=vs(e,t,n),e}function vs(e,t,n){return"start"===e?t:"end"===e?n:e}function bs(e,t,n){let{inflateAmount:a}=t;e.inflateAmount="auto"===a?1===n?.33:0:a}class ys extends ds{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(e,t,n,a){return ps(e,t,n,a)}parseArrayData(e,t,n,a){return ps(e,t,n,a)}parseObjectData(e,t,n,a){const{iScale:r,vScale:s}=e,{xAxisKey:i="x",yAxisKey:o="y"}=this._parsing,l="x"===r.axis?i:o,c="x"===s.axis?i:o,d=[];let u,h,p,m;for(u=n,h=n+a;u<h;++u)m=t[u],p={},p[r.axis]=r.parse(Sn(m,l),u),d.push(hs(Sn(m,c),p,s,u));return d}updateRangeFromParsed(e,t,n,a){super.updateRangeFromParsed(e,t,n,a);const r=n._custom;r&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,r.min),e.max=Math.max(e.max,r.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:n,vScale:a}=t,r=this.getParsed(e),s=r._custom,i=ms(s)?"["+s.start+", "+s.end+"]":""+a.getLabelForValue(r[a.axis]);return{label:""+n.getLabelForValue(r[n.axis]),value:i}}initialize(){this.enableOptionSharing=!0,super.initialize();this._cachedMeta.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,n,a){const r="reset"===a,{index:s,_cachedMeta:{vScale:i}}=this,o=i.getBasePixel(),l=i.isHorizontal(),c=this._getRuler(),{sharedOptions:d,includeOptions:u}=this._getSharedOptions(t,a);for(let h=t;h<t+n;h++){const t=this.getParsed(h),n=r||cn(t[i.axis])?{base:o,head:o}:this._calculateBarValuePixels(h),p=this._calculateBarIndexPixels(h,c),m=(t._stacks||{})[i.axis],f={horizontal:l,base:n.base,enableBorderRadius:!m||ms(t._custom)||s===m._top||s===m._bottom,x:l?n.head:p.center,y:l?p.center:n.head,height:l?p.size:Math.abs(n.size),width:l?Math.abs(n.size):p.size};u&&(f.options=d||this.resolveDataElementOptions(h,e[h].active?"active":a));const g=f.options||e[h].options;fs(f,g,m,s),bs(f,g,c.ratio),this.updateElement(e[h],h,f,a)}}_getStacks(e,t){const{iScale:n}=this._cachedMeta,a=n.getMatchingVisibleMetas(this._type).filter((e=>e.controller.options.grouped)),r=n.options.stacked,s=[],i=this._cachedMeta.controller.getParsed(t),o=i&&i[n.axis],l=e=>{const t=e._parsed.find((e=>e[n.axis]===o)),a=t&&t[e.vScale.axis];if(cn(a)||isNaN(a))return!0};for(const c of a)if((void 0===t||!l(c))&&((!1===r||-1===s.indexOf(c.stack)||void 0===r&&void 0===c.stack)&&s.push(c.stack),c.index===e))break;return s.length||s.push(void 0),s}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,t,n){const a=this._getStacks(e,n),r=void 0!==t?a.indexOf(t):-1;return-1===r?a.length-1:r}_getRuler(){const e=this.options,t=this._cachedMeta,n=t.iScale,a=[];let r,s;for(r=0,s=t.data.length;r<s;++r)a.push(n.getPixelForValue(this.getParsed(r)[n.axis],r));const i=e.barThickness;return{min:i||us(t),pixels:a,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:e.grouped,ratio:i?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:n,index:a},options:{base:r,minBarLength:s}}=this,i=r||0,o=this.getParsed(e),l=o._custom,c=ms(l);let d,u,h=o[t.axis],p=0,m=n?this.applyStack(t,o,n):h;m!==h&&(p=m-h,m=h),c&&(h=l.barStart,m=l.barEnd-l.barStart,0!==h&&Fn(h)!==Fn(l.barEnd)&&(p=0),p+=h);const f=cn(r)||c?p:r;let g=t.getPixelForValue(f);if(d=this.chart.getDataVisibility(e)?t.getPixelForValue(p+m):g,u=d-g,Math.abs(u)<s){u=function(e,t,n){return 0!==e?Fn(e):(t.isHorizontal()?1:-1)*(t.min>=n?1:-1)}(u,t,i)*s,h===i&&(g-=u/2);const e=t.getPixelForDecimal(0),r=t.getPixelForDecimal(1),l=Math.min(e,r),p=Math.max(e,r);g=Math.max(Math.min(g,p),l),d=g+u,n&&!c&&(o._stacks[t.axis]._visualValues[a]=t.getValueForPixel(d)-t.getValueForPixel(g))}if(g===t.getPixelForValue(i)){const e=Fn(u)*t.getLineWidthForValue(i)/2;g+=e,u-=e}return{size:u,base:g,head:d,center:d+u/2}}_calculateBarIndexPixels(e,t){const n=t.scale,a=this.options,r=a.skipNull,s=mn(a.maxBarThickness,1/0);let i,o;if(t.grouped){const n=r?this._getStackCount(e):t.stackCount,l="flex"===a.barThickness?function(e,t,n,a){const r=t.pixels,s=r[e];let i=e>0?r[e-1]:null,o=e<r.length-1?r[e+1]:null;const l=n.categoryPercentage;null===i&&(i=s-(null===o?t.end-t.start:o-s)),null===o&&(o=s+s-i);const c=s-(s-Math.min(i,o))/2*l;return{chunk:Math.abs(o-i)/2*l/a,ratio:n.barPercentage,start:c}}(e,t,a,n):function(e,t,n,a){const r=n.barThickness;let s,i;return cn(r)?(s=t.min*n.categoryPercentage,i=n.barPercentage):(s=r*a,i=1),{chunk:s/a,ratio:i,start:t.pixels[e]-s/2}}(e,t,a,n),c=this._getStackIndex(this.index,this._cachedMeta.stack,r?e:void 0);i=l.start+l.chunk*c+l.chunk/2,o=Math.min(s,l.chunk*l.ratio)}else i=n.getPixelForValue(this.getParsed(e)[n.axis],e),o=Math.min(s,t.min*t.ratio);return{base:i-o/2,head:i+o/2,center:i,size:o}}draw(){const e=this._cachedMeta,t=e.vScale,n=e.data,a=n.length;let r=0;for(;r<a;++r)null===this.getParsed(r)[t.axis]||n[r].hidden||n[r].draw(this._ctx)}}class xs extends ds{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:e=>"spacing"!==e,_indexable:e=>"spacing"!==e&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:n,color:a}}=e.legend.options;return t.labels.map(((t,r)=>{const s=e.getDatasetMeta(0).controller.getStyle(r);return{text:t,fillStyle:s.backgroundColor,strokeStyle:s.borderColor,fontColor:a,lineWidth:s.borderWidth,pointStyle:n,hidden:!e.getDataVisibility(r),index:r}}))}return[]}},onClick(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}}}};constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const n=this.getDataset().data,a=this._cachedMeta;if(!1===this._parsing)a._parsed=n;else{let r,s,i=e=>+n[e];if(un(n[e])){const{key:e="value"}=this._parsing;i=t=>+Sn(n[t],e)}for(r=e,s=e+t;r<s;++r)a._parsed[r]=i(r)}}_getRotation(){return Hn(this.options.rotation-90)}_getCircumference(){return Hn(this.options.circumference)}_getRotationExtents(){let e=In,t=-In;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){const a=this.chart.getDatasetMeta(n).controller,r=a._getRotation(),s=a._getCircumference();e=Math.min(e,r),t=Math.max(t,r+s)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:n}=t,a=this._cachedMeta,r=a.data,s=this.getMaxBorderWidth()+this.getMaxOffset(r)+this.options.spacing,i=Math.max((Math.min(n.width,n.height)-s)/2,0),o=Math.min((l=this.options.cutout,c=i,"string"===typeof l&&l.endsWith("%")?parseFloat(l)/100:+l/c),1);var l,c;const d=this._getRingWeight(this.index),{circumference:u,rotation:h}=this._getRotationExtents(),{ratioX:p,ratioY:m,offsetX:f,offsetY:g}=function(e,t,n){let a=1,r=1,s=0,i=0;if(t<In){const o=e,l=o+t,c=Math.cos(o),d=Math.sin(o),u=Math.cos(l),h=Math.sin(l),p=(e,t,a)=>Qn(e,o,l,!0)?1:Math.max(t,t*n,a,a*n),m=(e,t,a)=>Qn(e,o,l,!0)?-1:Math.min(t,t*n,a,a*n),f=p(0,c,u),g=p(Dn,d,h),v=m(Pn,c,u),b=m(Pn+Dn,d,h);a=(f-v)/2,r=(g-b)/2,s=-(f+v)/2,i=-(g+b)/2}return{ratioX:a,ratioY:r,offsetX:s,offsetY:i}}(h,u,o),v=(n.width-s)/p,b=(n.height-s)/m,y=Math.max(Math.min(v,b)/2,0),x=fn(this.options.radius,y),_=(x-Math.max(x*o,0))/this._getVisibleDatasetWeightTotal();this.offsetX=f*x,this.offsetY=g*x,a.total=this.calculateTotal(),this.outerRadius=x-_*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-_*d,0),this.updateElements(r,0,r.length,e)}_circumference(e,t){const n=this.options,a=this._cachedMeta,r=this._getCircumference();return t&&n.animation.animateRotate||!this.chart.getDataVisibility(e)||null===a._parsed[e]||a.data[e].hidden?0:this.calculateCircumference(a._parsed[e]*r/In)}updateElements(e,t,n,a){const r="reset"===a,s=this.chart,i=s.chartArea,o=s.options.animation,l=(i.left+i.right)/2,c=(i.top+i.bottom)/2,d=r&&o.animateScale,u=d?0:this.innerRadius,h=d?0:this.outerRadius,{sharedOptions:p,includeOptions:m}=this._getSharedOptions(t,a);let f,g=this._getRotation();for(f=0;f<t;++f)g+=this._circumference(f,r);for(f=t;f<t+n;++f){const t=this._circumference(f,r),n=e[f],s={x:l+this.offsetX,y:c+this.offsetY,startAngle:g,endAngle:g+t,circumference:t,outerRadius:h,innerRadius:u};m&&(s.options=p||this.resolveDataElementOptions(f,n.active?"active":a)),g+=t,this.updateElement(n,f,s,a)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let n,a=0;for(n=0;n<t.length;n++){const r=e._parsed[n];null===r||isNaN(r)||!this.chart.getDataVisibility(n)||t[n].hidden||(a+=Math.abs(r))}return a}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?In*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,n=this.chart,a=n.data.labels||[],r=ja(t._parsed[e],n.options.locale);return{label:a[e]||"",value:r}}getMaxBorderWidth(e){let t=0;const n=this.chart;let a,r,s,i,o;if(!e)for(a=0,r=n.data.datasets.length;a<r;++a)if(n.isDatasetVisible(a)){s=n.getDatasetMeta(a),e=s.data,i=s.controller;break}if(!e)return 0;for(a=0,r=e.length;a<r;++a)o=i.resolveDataElementOptions(a),"inner"!==o.borderAlign&&(t=Math.max(t,o.borderWidth||0,o.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let n=0,a=e.length;n<a;++n){const e=this.resolveDataElementOptions(n);t=Math.max(t,e.offset||0,e.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let n=0;n<e;++n)this.chart.isDatasetVisible(n)&&(t+=this._getRingWeight(n));return t}_getRingWeight(e){return Math.max(mn(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class _s extends ds{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:n,data:a=[],_dataset:r}=t,s=this.chart._animationsDisabled;let{start:i,count:o}=ua(t,a,s);this._drawStart=i,this._drawCount=o,ha(t)&&(i=0,o=a.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!r._decimated,n.points=a;const l=this.resolveDatasetElementOptions(e);this.options.showLine||(l.borderWidth=0),l.segment=this.options.segment,this.updateElement(n,void 0,{animated:!s,options:l},e),this.updateElements(a,i,o,e)}updateElements(e,t,n,a){const r="reset"===a,{iScale:s,vScale:i,_stacked:o,_dataset:l}=this._cachedMeta,{sharedOptions:c,includeOptions:d}=this._getSharedOptions(t,a),u=s.axis,h=i.axis,{spanGaps:p,segment:m}=this.options,f=Wn(p)?p:Number.POSITIVE_INFINITY,g=this.chart._animationsDisabled||r||"none"===a,v=t+n,b=e.length;let y=t>0&&this.getParsed(t-1);for(let x=0;x<b;++x){const n=e[x],p=g?n:{};if(x<t||x>=v){p.skip=!0;continue}const b=this.getParsed(x),_=cn(b[h]),w=p[u]=s.getPixelForValue(b[u],x),j=p[h]=r||_?i.getBasePixel():i.getPixelForValue(o?this.applyStack(i,b,o):b[h],x);p.skip=isNaN(w)||isNaN(j)||_,p.stop=x>0&&Math.abs(b[u]-y[u])>f,m&&(p.parsed=b,p.raw=l.data[x]),d&&(p.options=c||this.resolveDataElementOptions(x,n.active?"active":a)),g||this.updateElement(n,x,p,a),y=b}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,n=t.options&&t.options.borderWidth||0,a=e.data||[];if(!a.length)return n;const r=a[0].size(this.resolveDataElementOptions(0)),s=a[a.length-1].size(this.resolveDataElementOptions(a.length-1));return Math.max(n,r,s)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}class ws extends xs{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}function js(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Ns{static override(e){Object.assign(Ns.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return js()}parse(){return js()}format(){return js()}add(){return js()}diff(){return js()}startOf(){return js()}endOf(){return js()}}var Es=Ns;function Ss(e,t,n,a){const{controller:r,data:s,_sorted:i}=e,o=r._cachedMeta.iScale,l=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null;if(o&&t===o.axis&&"r"!==t&&i&&s.length){const i=o._reversePixels?aa:na;if(!a){const a=i(s,t,n);if(l){const{vScale:t}=r._cachedMeta,{_parsed:n}=e,s=n.slice(0,a.lo+1).reverse().findIndex((e=>!cn(e[t.axis])));a.lo-=Math.max(0,s);const i=n.slice(a.hi).findIndex((e=>!cn(e[t.axis])));a.hi+=Math.max(0,i)}return a}if(r._sharedOptions){const e=s[0],a="function"===typeof e.getRange&&e.getRange(t);if(a){const e=i(s,t,n-a),r=i(s,t,n+a);return{lo:e.lo,hi:r.hi}}}}return{lo:0,hi:s.length-1}}function ks(e,t,n,a,r){const s=e.getSortedVisibleDatasetMetas(),i=n[t];for(let o=0,l=s.length;o<l;++o){const{index:e,data:n}=s[o],{lo:l,hi:c}=Ss(s[o],t,i,r);for(let t=l;t<=c;++t){const r=n[t];r.skip||a(r,e,t)}}}function Cs(e,t,n,a,r){const s=[];if(!r&&!e.isPointInArea(t))return s;return ks(e,n,t,(function(n,i,o){(r||La(n,e.chartArea,0))&&n.inRange(t.x,t.y,a)&&s.push({element:n,datasetIndex:i,index:o})}),!0),s}function As(e,t,n,a,r,s){let i=[];const o=function(e){const t=-1!==e.indexOf("x"),n=-1!==e.indexOf("y");return function(e,a){const r=t?Math.abs(e.x-a.x):0,s=n?Math.abs(e.y-a.y):0;return Math.sqrt(Math.pow(r,2)+Math.pow(s,2))}}(n);let l=Number.POSITIVE_INFINITY;return ks(e,n,t,(function(n,c,d){const u=n.inRange(t.x,t.y,r);if(a&&!u)return;const h=n.getCenterPoint(r);if(!(!!s||e.isPointInArea(h))&&!u)return;const p=o(t,h);p<l?(i=[{element:n,datasetIndex:c,index:d}],l=p):p===l&&i.push({element:n,datasetIndex:c,index:d})})),i}function Ts(e,t,n,a,r,s){return s||e.isPointInArea(t)?"r"!==n||a?As(e,t,n,a,r,s):function(e,t,n,a){let r=[];return ks(e,n,t,(function(e,n,s){const{startAngle:i,endAngle:o}=e.getProps(["startAngle","endAngle"],a),{angle:l}=Jn(e,{x:t.x,y:t.y});Qn(l,i,o)&&r.push({element:e,datasetIndex:n,index:s})})),r}(e,t,n,r):[]}function Ps(e,t,n,a,r){const s=[],i="x"===n?"inXRange":"inYRange";let o=!1;return ks(e,n,t,((e,a,l)=>{e[i]&&e[i](t[n],r)&&(s.push({element:e,datasetIndex:a,index:l}),o=o||e.inRange(t.x,t.y,r))})),a&&!o?[]:s}var Is={evaluateInteractionItems:ks,modes:{index(e,t,n,a){const r=Cr(t,e),s=n.axis||"x",i=n.includeInvisible||!1,o=n.intersect?Cs(e,r,s,a,i):Ts(e,r,s,!1,a,i),l=[];return o.length?(e.getSortedVisibleDatasetMetas().forEach((e=>{const t=o[0].index,n=e.data[t];n&&!n.skip&&l.push({element:n,datasetIndex:e.index,index:t})})),l):[]},dataset(e,t,n,a){const r=Cr(t,e),s=n.axis||"xy",i=n.includeInvisible||!1;let o=n.intersect?Cs(e,r,s,a,i):Ts(e,r,s,!1,a,i);if(o.length>0){const t=o[0].datasetIndex,n=e.getDatasetMeta(t).data;o=[];for(let e=0;e<n.length;++e)o.push({element:n[e],datasetIndex:t,index:e})}return o},point:(e,t,n,a)=>Cs(e,Cr(t,e),n.axis||"xy",a,n.includeInvisible||!1),nearest(e,t,n,a){const r=Cr(t,e),s=n.axis||"xy",i=n.includeInvisible||!1;return Ts(e,r,s,n.intersect,a,i)},x:(e,t,n,a)=>Ps(e,Cr(t,e),"x",n.intersect,a),y:(e,t,n,a)=>Ps(e,Cr(t,e),"y",n.intersect,a)}};const Os=["left","top","right","bottom"];function Rs(e,t){return e.filter((e=>e.pos===t))}function Ms(e,t){return e.filter((e=>-1===Os.indexOf(e.pos)&&e.box.axis===t))}function Ds(e,t){return e.sort(((e,n)=>{const a=t?n:e,r=t?e:n;return a.weight===r.weight?a.index-r.index:a.weight-r.weight}))}function Ls(e,t){const n=function(e){const t={};for(const n of e){const{stack:e,pos:a,stackWeight:r}=n;if(!e||!Os.includes(a))continue;const s=t[e]||(t[e]={count:0,placed:0,weight:0,size:0});s.count++,s.weight+=r}return t}(e),{vBoxMaxWidth:a,hBoxMaxHeight:r}=t;let s,i,o;for(s=0,i=e.length;s<i;++s){o=e[s];const{fullSize:i}=o.box,l=n[o.stack],c=l&&o.stackWeight/l.weight;o.horizontal?(o.width=c?c*a:i&&t.availableWidth,o.height=r):(o.width=a,o.height=c?c*r:i&&t.availableHeight)}return n}function $s(e,t,n,a){return Math.max(e[n],t[n])+Math.max(e[a],t[a])}function zs(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function Fs(e,t,n,a){const{pos:r,box:s}=n,i=e.maxPadding;if(!un(r)){n.size&&(e[r]-=n.size);const t=a[n.stack]||{size:0,count:1};t.size=Math.max(t.size,n.horizontal?s.height:s.width),n.size=t.size/t.count,e[r]+=n.size}s.getPadding&&zs(i,s.getPadding());const o=Math.max(0,t.outerWidth-$s(i,e,"left","right")),l=Math.max(0,t.outerHeight-$s(i,e,"top","bottom")),c=o!==e.w,d=l!==e.h;return e.w=o,e.h=l,n.horizontal?{same:c,other:d}:{same:d,other:c}}function Bs(e,t){const n=t.maxPadding;function a(e){const a={left:0,top:0,right:0,bottom:0};return e.forEach((e=>{a[e]=Math.max(t[e],n[e])})),a}return a(e?["left","right"]:["top","bottom"])}function Us(e,t,n,a){const r=[];let s,i,o,l,c,d;for(s=0,i=e.length,c=0;s<i;++s){o=e[s],l=o.box,l.update(o.width||t.w,o.height||t.h,Bs(o.horizontal,t));const{same:i,other:u}=Fs(t,n,o,a);c|=i&&r.length,d=d||u,l.fullSize||r.push(o)}return c&&Us(r,t,n,a)||d}function Ws(e,t,n,a,r){e.top=n,e.left=t,e.right=t+a,e.bottom=n+r,e.width=a,e.height=r}function Vs(e,t,n,a){const r=n.padding;let{x:s,y:i}=t;for(const o of e){const e=o.box,l=a[o.stack]||{count:1,placed:0,weight:1},c=o.stackWeight/l.weight||1;if(o.horizontal){const a=t.w*c,s=l.size||e.height;Cn(l.start)&&(i=l.start),e.fullSize?Ws(e,r.left,i,n.outerWidth-r.right-r.left,s):Ws(e,t.left+l.placed,i,a,s),l.start=i,l.placed+=a,i=e.bottom}else{const a=t.h*c,i=l.size||e.width;Cn(l.start)&&(s=l.start),e.fullSize?Ws(e,s,r.top,i,n.outerHeight-r.bottom-r.top):Ws(e,s,t.top+l.placed,i,a),l.start=s,l.placed+=a,s=e.right}}t.x=s,t.y=i}var Hs={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},e.boxes.push(t)},removeBox(e,t){const n=e.boxes?e.boxes.indexOf(t):-1;-1!==n&&e.boxes.splice(n,1)},configure(e,t,n){t.fullSize=n.fullSize,t.position=n.position,t.weight=n.weight},update(e,t,n,a){if(!e)return;const r=Qa(e.options.layout.padding),s=Math.max(t-r.width,0),i=Math.max(n-r.height,0),o=function(e){const t=function(e){const t=[];let n,a,r,s,i,o;for(n=0,a=(e||[]).length;n<a;++n)r=e[n],({position:s,options:{stack:i,stackWeight:o=1}}=r),t.push({index:n,box:r,pos:s,horizontal:r.isHorizontal(),weight:r.weight,stack:i&&s+i,stackWeight:o});return t}(e),n=Ds(t.filter((e=>e.box.fullSize)),!0),a=Ds(Rs(t,"left"),!0),r=Ds(Rs(t,"right")),s=Ds(Rs(t,"top"),!0),i=Ds(Rs(t,"bottom")),o=Ms(t,"x"),l=Ms(t,"y");return{fullSize:n,leftAndTop:a.concat(s),rightAndBottom:r.concat(l).concat(i).concat(o),chartArea:Rs(t,"chartArea"),vertical:a.concat(r).concat(l),horizontal:s.concat(i).concat(o)}}(e.boxes),l=o.vertical,c=o.horizontal;vn(e.boxes,(e=>{"function"===typeof e.beforeLayout&&e.beforeLayout()}));const d=l.reduce(((e,t)=>t.box.options&&!1===t.box.options.display?e:e+1),0)||1,u=Object.freeze({outerWidth:t,outerHeight:n,padding:r,availableWidth:s,availableHeight:i,vBoxMaxWidth:s/2/d,hBoxMaxHeight:i/2}),h=Object.assign({},r);zs(h,Qa(a));const p=Object.assign({maxPadding:h,w:s,h:i,x:r.left,y:r.top},r),m=Ls(l.concat(c),u);Us(o.fullSize,p,u,m),Us(l,p,u,m),Us(c,p,u,m)&&Us(l,p,u,m),function(e){const t=e.maxPadding;function n(n){const a=Math.max(t[n]-e[n],0);return e[n]+=a,a}e.y+=n("top"),e.x+=n("left"),n("right"),n("bottom")}(p),Vs(o.leftAndTop,p,u,m),p.x+=p.w,p.y+=p.h,Vs(o.rightAndBottom,p,u,m),e.chartArea={left:p.left,top:p.top,right:p.left+p.w,bottom:p.top+p.h,height:p.h,width:p.w},vn(o.chartArea,(t=>{const n=t.box;Object.assign(n,e.chartArea),n.update(p.w,p.h,{left:0,top:0,right:0,bottom:0})}))}};class qs{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,n){}removeEventListener(e,t,n){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,n,a){return t=Math.max(0,t||e.width),n=n||e.height,{width:t,height:Math.max(0,a?Math.floor(t/a):n)}}isAttached(e){return!0}updateConfig(e){}}class Ys extends qs{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const Js="$chartjs",Gs={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Xs=e=>null===e||""===e;const Ks=!!Ir&&{passive:!0};function Qs(e,t,n){e&&e.canvas&&e.canvas.removeEventListener(t,n,Ks)}function Zs(e,t){for(const n of e)if(n===t||n.contains(t))return!0}function ei(e,t,n){const a=e.canvas,r=new MutationObserver((e=>{let t=!1;for(const n of e)t=t||Zs(n.addedNodes,a),t=t&&!Zs(n.removedNodes,a);t&&n()}));return r.observe(document,{childList:!0,subtree:!0}),r}function ti(e,t,n){const a=e.canvas,r=new MutationObserver((e=>{let t=!1;for(const n of e)t=t||Zs(n.removedNodes,a),t=t&&!Zs(n.addedNodes,a);t&&n()}));return r.observe(document,{childList:!0,subtree:!0}),r}const ni=new Map;let ai=0;function ri(){const e=window.devicePixelRatio;e!==ai&&(ai=e,ni.forEach(((t,n)=>{n.currentDevicePixelRatio!==e&&t()})))}function si(e,t,n){const a=e.canvas,r=a&&jr(a);if(!r)return;const s=la(((e,t)=>{const a=r.clientWidth;n(e,t),a<r.clientWidth&&n()}),window),i=new ResizeObserver((e=>{const t=e[0],n=t.contentRect.width,a=t.contentRect.height;0===n&&0===a||s(n,a)}));return i.observe(r),function(e,t){ni.size||window.addEventListener("resize",ri),ni.set(e,t)}(e,s),i}function ii(e,t,n){n&&n.disconnect(),"resize"===t&&function(e){ni.delete(e),ni.size||window.removeEventListener("resize",ri)}(e)}function oi(e,t,n){const a=e.canvas,r=la((t=>{null!==e.ctx&&n(function(e,t){const n=Gs[e.type]||e.type,{x:a,y:r}=Cr(e,t);return{type:n,chart:t,native:e,x:void 0!==a?a:null,y:void 0!==r?r:null}}(t,e))}),e);return function(e,t,n){e&&e.addEventListener(t,n,Ks)}(a,t,r),r}class li extends qs{acquireContext(e,t){const n=e&&e.getContext&&e.getContext("2d");return n&&n.canvas===e?(function(e,t){const n=e.style,a=e.getAttribute("height"),r=e.getAttribute("width");if(e[Js]={initial:{height:a,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",Xs(r)){const t=Or(e,"width");void 0!==t&&(e.width=t)}if(Xs(a))if(""===e.style.height)e.height=e.width/(t||2);else{const t=Or(e,"height");void 0!==t&&(e.height=t)}}(e,t),n):null}releaseContext(e){const t=e.canvas;if(!t[Js])return!1;const n=t[Js].initial;["height","width"].forEach((e=>{const a=n[e];cn(a)?t.removeAttribute(e):t.setAttribute(e,a)}));const a=n.style||{};return Object.keys(a).forEach((e=>{t.style[e]=a[e]})),t.width=t.width,delete t[Js],!0}addEventListener(e,t,n){this.removeEventListener(e,t);const a=e.$proxies||(e.$proxies={}),r={attach:ei,detach:ti,resize:si}[t]||oi;a[t]=r(e,t,n)}removeEventListener(e,t){const n=e.$proxies||(e.$proxies={}),a=n[t];if(!a)return;({attach:ii,detach:ii,resize:ii}[t]||Qs)(e,t,a),n[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,n,a){return Tr(e,t,n,a)}isAttached(e){const t=e&&jr(e);return!(!t||!t.isConnected)}}class ci{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:t,y:n}=this.getProps(["x","y"],e);return{x:t,y:n}}hasValue(){return Wn(this.x)&&Wn(this.y)}getProps(e,t){const n=this.$animations;if(!t||!n)return this;const a={};return e.forEach((e=>{a[e]=n[e]&&n[e].active()?n[e]._to:this[e]})),a}}function di(e,t){const n=e.options.ticks,a=function(e){const t=e.options.offset,n=e._tickSize(),a=e._length/n+(t?0:1),r=e._maxLength/n;return Math.floor(Math.min(a,r))}(e),r=Math.min(n.maxTicksLimit||a,a),s=n.major.enabled?function(e){const t=[];let n,a;for(n=0,a=e.length;n<a;n++)e[n].major&&t.push(n);return t}(t):[],i=s.length,o=s[0],l=s[i-1],c=[];if(i>r)return function(e,t,n,a){let r,s=0,i=n[0];for(a=Math.ceil(a),r=0;r<e.length;r++)r===i&&(t.push(e[r]),s++,i=n[s*a])}(t,c,s,i/r),c;const d=function(e,t,n){const a=function(e){const t=e.length;let n,a;if(t<2)return!1;for(a=e[0],n=1;n<t;++n)if(e[n]-e[n-1]!==a)return!1;return a}(e),r=t.length/n;if(!a)return Math.max(r,1);const s=function(e){const t=[],n=Math.sqrt(e);let a;for(a=1;a<n;a++)e%a===0&&(t.push(a),t.push(e/a));return n===(0|n)&&t.push(n),t.sort(((e,t)=>e-t)).pop(),t}(a);for(let i=0,o=s.length-1;i<o;i++){const e=s[i];if(e>r)return e}return Math.max(r,1)}(s,t,r);if(i>0){let e,n;const a=i>1?Math.round((l-o)/(i-1)):null;for(ui(t,c,d,cn(a)?0:o-a,o),e=0,n=i-1;e<n;e++)ui(t,c,d,s[e],s[e+1]);return ui(t,c,d,l,cn(a)?t.length:l+a),c}return ui(t,c,d),c}function ui(e,t,n,a,r){const s=mn(a,0),i=Math.min(mn(r,e.length),e.length);let o,l,c,d=0;for(n=Math.ceil(n),r&&(o=r-a,n=o/Math.floor(o/n)),c=s;c<0;)d++,c=Math.round(s+d*n);for(l=Math.max(s,0);l<i;l++)l===c&&(t.push(e[l]),d++,c=Math.round(s+d*n))}const hi=(e,t,n)=>"top"===t||"left"===t?e[t]+n:e[t]-n,pi=(e,t)=>Math.min(t||e,e);function mi(e,t){const n=[],a=e.length/t,r=e.length;let s=0;for(;s<r;s+=a)n.push(e[Math.floor(s)]);return n}function fi(e,t,n){const a=e.ticks.length,r=Math.min(t,a-1),s=e._startPixel,i=e._endPixel,o=1e-6;let l,c=e.getPixelForTick(r);if(!(n&&(l=1===a?Math.max(c-s,i-c):0===t?(e.getPixelForTick(1)-c)/2:(c-e.getPixelForTick(r-1))/2,c+=r<t?l:-l,c<s-o||c>i+o)))return c}function gi(e){return e.drawTicks?e.tickLength:0}function vi(e,t){if(!e.display)return 0;const n=Za(e.font,t),a=Qa(e.padding);return(dn(e.text)?e.text.length:1)*n.lineHeight+a.height}function bi(e,t,n){let a=ca(e);return(n&&"right"!==t||!n&&"right"===t)&&(a=(e=>"left"===e?"right":"right"===e?"left":e)(a)),a}class yi extends ci{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:n,_suggestedMax:a}=this;return e=pn(e,Number.POSITIVE_INFINITY),t=pn(t,Number.NEGATIVE_INFINITY),n=pn(n,Number.POSITIVE_INFINITY),a=pn(a,Number.NEGATIVE_INFINITY),{min:pn(e,n),max:pn(t,a),minDefined:hn(e),maxDefined:hn(t)}}getMinMax(e){let t,{min:n,max:a,minDefined:r,maxDefined:s}=this.getUserBounds();if(r&&s)return{min:n,max:a};const i=this.getMatchingVisibleMetas();for(let o=0,l=i.length;o<l;++o)t=i[o].controller.getMinMax(this,e),r||(n=Math.min(n,t.min)),s||(a=Math.max(a,t.max));return n=s&&n>a?a:n,a=r&&n>a?n:a,{min:pn(n,pn(a,n)),max:pn(a,pn(n,a))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chart.chartArea;return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){gn(this.options.beforeUpdate,[this])}update(e,t,n){const{beginAtZero:a,grace:r,ticks:s}=this.options,i=s.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=function(e,t,n){const{min:a,max:r}=e,s=fn(t,(r-a)/2),i=(e,t)=>n&&0===e?0:e+t;return{min:i(a,-Math.abs(s)),max:i(r,s)}}(this,r,a),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const o=i<this.ticks.length;this._convertTicksToLabels(o?mi(this.ticks,i):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),s.display&&(s.autoSkip||"auto"===s.source)&&(this.ticks=di(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),o&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e,t,n=this.options.reverse;this.isHorizontal()?(e=this.left,t=this.right):(e=this.top,t=this.bottom,n=!n),this._startPixel=e,this._endPixel=t,this._reversePixels=n,this._length=t-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){gn(this.options.afterUpdate,[this])}beforeSetDimensions(){gn(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){gn(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),gn(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){gn(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let n,a,r;for(n=0,a=e.length;n<a;n++)r=e[n],r.label=gn(t.callback,[r.value,n,e],this)}afterTickToLabelConversion(){gn(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){gn(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,n=pi(this.ticks.length,e.ticks.maxTicksLimit),a=t.minRotation||0,r=t.maxRotation;let s,i,o,l=a;if(!this._isVisible()||!t.display||a>=r||n<=1||!this.isHorizontal())return void(this.labelRotation=a);const c=this._getLabelSizes(),d=c.widest.width,u=c.highest.height,h=Zn(this.chart.width-d,0,this.maxWidth);s=e.offset?this.maxWidth/n:h/(n-1),d+6>s&&(s=h/(n-(e.offset?.5:1)),i=this.maxHeight-gi(e.grid)-t.padding-vi(e.title,this.chart.options.font),o=Math.sqrt(d*d+u*u),l=qn(Math.min(Math.asin(Zn((c.highest.height+6)/s,-1,1)),Math.asin(Zn(i/o,-1,1))-Math.asin(Zn(u/o,-1,1)))),l=Math.max(a,Math.min(r,l))),this.labelRotation=l}afterCalculateLabelRotation(){gn(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){gn(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:n,title:a,grid:r}}=this,s=this._isVisible(),i=this.isHorizontal();if(s){const s=vi(a,t.options.font);if(i?(e.width=this.maxWidth,e.height=gi(r)+s):(e.height=this.maxHeight,e.width=gi(r)+s),n.display&&this.ticks.length){const{first:t,last:a,widest:r,highest:s}=this._getLabelSizes(),o=2*n.padding,l=Hn(this.labelRotation),c=Math.cos(l),d=Math.sin(l);if(i){const t=n.mirror?0:d*r.width+c*s.height;e.height=Math.min(this.maxHeight,e.height+t+o)}else{const t=n.mirror?0:c*r.width+d*s.height;e.width=Math.min(this.maxWidth,e.width+t+o)}this._calculatePadding(t,a,d,c)}}this._handleMargins(),i?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,n,a){const{ticks:{align:r,padding:s},position:i}=this.options,o=0!==this.labelRotation,l="top"!==i&&"x"===this.axis;if(this.isHorizontal()){const i=this.getPixelForTick(0)-this.left,c=this.right-this.getPixelForTick(this.ticks.length-1);let d=0,u=0;o?l?(d=a*e.width,u=n*t.height):(d=n*e.height,u=a*t.width):"start"===r?u=t.width:"end"===r?d=e.width:"inner"!==r&&(d=e.width/2,u=t.width/2),this.paddingLeft=Math.max((d-i+s)*this.width/(this.width-i),0),this.paddingRight=Math.max((u-c+s)*this.width/(this.width-c),0)}else{let n=t.height/2,a=e.height/2;"start"===r?(n=0,a=e.height):"end"===r&&(n=t.height,a=0),this.paddingTop=n+s,this.paddingBottom=a+s}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){gn(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return"top"===t||"bottom"===t||"x"===e}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){let t,n;for(this.beforeTickToLabelConversion(),this.generateTickLabels(e),t=0,n=e.length;t<n;t++)cn(e[t].label)&&(e.splice(t,1),n--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let n=this.ticks;t<n.length&&(n=mi(n,t)),this._labelSizes=e=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,n){const{ctx:a,_longestTextCache:r}=this,s=[],i=[],o=Math.floor(t/pi(t,n));let l,c,d,u,h,p,m,f,g,v,b,y=0,x=0;for(l=0;l<t;l+=o){if(u=e[l].label,h=this._resolveTickFontOptions(l),a.font=p=h.string,m=r[p]=r[p]||{data:{},gc:[]},f=h.lineHeight,g=v=0,cn(u)||dn(u)){if(dn(u))for(c=0,d=u.length;c<d;++c)b=u[c],cn(b)||dn(b)||(g=Ia(a,m.data,m.gc,g,b),v+=f)}else g=Ia(a,m.data,m.gc,g,u),v=f;s.push(g),i.push(v),y=Math.max(g,y),x=Math.max(v,x)}!function(e,t){vn(e,(e=>{const n=e.gc,a=n.length/2;let r;if(a>t){for(r=0;r<a;++r)delete e.data[n[r]];n.splice(0,a)}}))}(r,t);const _=s.indexOf(y),w=i.indexOf(x),j=e=>({width:s[e]||0,height:i[e]||0});return{first:j(0),last:j(t-1),widest:j(_),highest:j(w),widths:s,heights:i}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return Zn(this._alignToPixels?Oa(this.chart,t,0):t,-32768,32767)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const n=t[e];return n.$context||(n.$context=function(e,t,n){return tr(e,{tick:n,index:t,type:"tick"})}(this.getContext(),e,n))}return this.$context||(this.$context=tr(this.chart.getContext(),{scale:this,type:"scale"}))}_tickSize(){const e=this.options.ticks,t=Hn(this.labelRotation),n=Math.abs(Math.cos(t)),a=Math.abs(Math.sin(t)),r=this._getLabelSizes(),s=e.autoSkipPadding||0,i=r?r.widest.width+s:0,o=r?r.highest.height+s:0;return this.isHorizontal()?o*n>i*a?i/n:o/a:o*a<i*n?o/n:i/a}_isVisible(){const e=this.options.display;return"auto"!==e?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,n=this.chart,a=this.options,{grid:r,position:s,border:i}=a,o=r.offset,l=this.isHorizontal(),c=this.ticks.length+(o?1:0),d=gi(r),u=[],h=i.setContext(this.getContext()),p=h.display?h.width:0,m=p/2,f=function(e){return Oa(n,e,p)};let g,v,b,y,x,_,w,j,N,E,S,k;if("top"===s)g=f(this.bottom),_=this.bottom-d,j=g-m,E=f(e.top)+m,k=e.bottom;else if("bottom"===s)g=f(this.top),E=e.top,k=f(e.bottom)-m,_=g+m,j=this.top+d;else if("left"===s)g=f(this.right),x=this.right-d,w=g-m,N=f(e.left)+m,S=e.right;else if("right"===s)g=f(this.left),N=e.left,S=f(e.right)-m,x=g+m,w=this.left+d;else if("x"===t){if("center"===s)g=f((e.top+e.bottom)/2+.5);else if(un(s)){const e=Object.keys(s)[0],t=s[e];g=f(this.chart.scales[e].getPixelForValue(t))}E=e.top,k=e.bottom,_=g+m,j=_+d}else if("y"===t){if("center"===s)g=f((e.left+e.right)/2);else if(un(s)){const e=Object.keys(s)[0],t=s[e];g=f(this.chart.scales[e].getPixelForValue(t))}x=g-m,w=x-d,N=e.left,S=e.right}const C=mn(a.ticks.maxTicksLimit,c),A=Math.max(1,Math.ceil(c/C));for(v=0;v<c;v+=A){const e=this.getContext(v),t=r.setContext(e),a=i.setContext(e),s=t.lineWidth,c=t.color,d=a.dash||[],h=a.dashOffset,p=t.tickWidth,m=t.tickColor,f=t.tickBorderDash||[],g=t.tickBorderDashOffset;b=fi(this,v,o),void 0!==b&&(y=Oa(n,b,s),l?x=w=N=S=y:_=j=E=k=y,u.push({tx1:x,ty1:_,tx2:w,ty2:j,x1:N,y1:E,x2:S,y2:k,width:s,color:c,borderDash:d,borderDashOffset:h,tickWidth:p,tickColor:m,tickBorderDash:f,tickBorderDashOffset:g}))}return this._ticksLength=c,this._borderValue=g,u}_computeLabelItems(e){const t=this.axis,n=this.options,{position:a,ticks:r}=n,s=this.isHorizontal(),i=this.ticks,{align:o,crossAlign:l,padding:c,mirror:d}=r,u=gi(n.grid),h=u+c,p=d?-c:h,m=-Hn(this.labelRotation),f=[];let g,v,b,y,x,_,w,j,N,E,S,k,C="middle";if("top"===a)_=this.bottom-p,w=this._getXAxisLabelAlignment();else if("bottom"===a)_=this.top+p,w=this._getXAxisLabelAlignment();else if("left"===a){const e=this._getYAxisLabelAlignment(u);w=e.textAlign,x=e.x}else if("right"===a){const e=this._getYAxisLabelAlignment(u);w=e.textAlign,x=e.x}else if("x"===t){if("center"===a)_=(e.top+e.bottom)/2+h;else if(un(a)){const e=Object.keys(a)[0],t=a[e];_=this.chart.scales[e].getPixelForValue(t)+h}w=this._getXAxisLabelAlignment()}else if("y"===t){if("center"===a)x=(e.left+e.right)/2-h;else if(un(a)){const e=Object.keys(a)[0],t=a[e];x=this.chart.scales[e].getPixelForValue(t)}w=this._getYAxisLabelAlignment(u).textAlign}"y"===t&&("start"===o?C="top":"end"===o&&(C="bottom"));const A=this._getLabelSizes();for(g=0,v=i.length;g<v;++g){b=i[g],y=b.label;const e=r.setContext(this.getContext(g));j=this.getPixelForTick(g)+r.labelOffset,N=this._resolveTickFontOptions(g),E=N.lineHeight,S=dn(y)?y.length:1;const t=S/2,n=e.color,o=e.textStrokeColor,c=e.textStrokeWidth;let u,h=w;if(s?(x=j,"inner"===w&&(h=g===v-1?this.options.reverse?"left":"right":0===g?this.options.reverse?"right":"left":"center"),k="top"===a?"near"===l||0!==m?-S*E+E/2:"center"===l?-A.highest.height/2-t*E+E:-A.highest.height+E/2:"near"===l||0!==m?E/2:"center"===l?A.highest.height/2-t*E:A.highest.height-S*E,d&&(k*=-1),0===m||e.showLabelBackdrop||(x+=E/2*Math.sin(m))):(_=j,k=(1-S)*E/2),e.showLabelBackdrop){const t=Qa(e.backdropPadding),n=A.heights[g],a=A.widths[g];let r=k-t.top,s=0-t.left;switch(C){case"middle":r-=n/2;break;case"bottom":r-=n}switch(w){case"center":s-=a/2;break;case"right":s-=a;break;case"inner":g===v-1?s-=a:g>0&&(s-=a/2)}u={left:s,top:r,width:a+t.width,height:n+t.height,color:e.backdropColor}}f.push({label:y,font:N,textOffset:k,options:{rotation:m,color:n,strokeColor:o,strokeWidth:c,textAlign:h,textBaseline:C,translation:[x,_],backdrop:u}})}return f}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-Hn(this.labelRotation))return"top"===e?"left":"right";let n="center";return"start"===t.align?n="left":"end"===t.align?n="right":"inner"===t.align&&(n="inner"),n}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:n,mirror:a,padding:r}}=this.options,s=e+r,i=this._getLabelSizes().widest.width;let o,l;return"left"===t?a?(l=this.right+r,"near"===n?o="left":"center"===n?(o="center",l+=i/2):(o="right",l+=i)):(l=this.right-s,"near"===n?o="right":"center"===n?(o="center",l-=i/2):(o="left",l=this.left)):"right"===t?a?(l=this.left+r,"near"===n?o="right":"center"===n?(o="center",l-=i/2):(o="left",l-=i)):(l=this.left+s,"near"===n?o="left":"center"===n?(o="center",l+=i/2):(o="right",l=this.right)):o="right",{textAlign:o,x:l}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;return"left"===t||"right"===t?{top:0,left:this.left,bottom:e.height,right:this.right}:"top"===t||"bottom"===t?{top:this.top,left:0,bottom:this.bottom,right:e.width}:void 0}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:n,top:a,width:r,height:s}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(n,a,r,s),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const n=this.ticks.findIndex((t=>t.value===e));if(n>=0){return t.setContext(this.getContext(n)).lineWidth}return 0}drawGrid(e){const t=this.options.grid,n=this.ctx,a=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let r,s;const i=(e,t,a)=>{a.width&&a.color&&(n.save(),n.lineWidth=a.width,n.strokeStyle=a.color,n.setLineDash(a.borderDash||[]),n.lineDashOffset=a.borderDashOffset,n.beginPath(),n.moveTo(e.x,e.y),n.lineTo(t.x,t.y),n.stroke(),n.restore())};if(t.display)for(r=0,s=a.length;r<s;++r){const e=a[r];t.drawOnChartArea&&i({x:e.x1,y:e.y1},{x:e.x2,y:e.y2},e),t.drawTicks&&i({x:e.tx1,y:e.ty1},{x:e.tx2,y:e.ty2},{color:e.tickColor,width:e.tickWidth,borderDash:e.tickBorderDash,borderDashOffset:e.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:n,grid:a}}=this,r=n.setContext(this.getContext()),s=n.display?r.width:0;if(!s)return;const i=a.setContext(this.getContext(0)).lineWidth,o=this._borderValue;let l,c,d,u;this.isHorizontal()?(l=Oa(e,this.left,s)-s/2,c=Oa(e,this.right,i)+i/2,d=u=o):(d=Oa(e,this.top,s)-s/2,u=Oa(e,this.bottom,i)+i/2,l=c=o),t.save(),t.lineWidth=r.width,t.strokeStyle=r.color,t.beginPath(),t.moveTo(l,d),t.lineTo(c,u),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const t=this.ctx,n=this._computeLabelArea();n&&$a(t,n);const a=this.getLabelItems(e);for(const r of a){const e=r.options,n=r.font;Va(t,r.label,0,r.textOffset,n,e)}n&&za(t)}drawTitle(){const{ctx:e,options:{position:t,title:n,reverse:a}}=this;if(!n.display)return;const r=Za(n.font),s=Qa(n.padding),i=n.align;let o=r.lineHeight/2;"bottom"===t||"center"===t||un(t)?(o+=s.bottom,dn(n.text)&&(o+=r.lineHeight*(n.text.length-1))):o+=s.top;const{titleX:l,titleY:c,maxWidth:d,rotation:u}=function(e,t,n,a){const{top:r,left:s,bottom:i,right:o,chart:l}=e,{chartArea:c,scales:d}=l;let u,h,p,m=0;const f=i-r,g=o-s;if(e.isHorizontal()){if(h=da(a,s,o),un(n)){const e=Object.keys(n)[0],a=n[e];p=d[e].getPixelForValue(a)+f-t}else p="center"===n?(c.bottom+c.top)/2+f-t:hi(e,n,t);u=o-s}else{if(un(n)){const e=Object.keys(n)[0],a=n[e];h=d[e].getPixelForValue(a)-g+t}else h="center"===n?(c.left+c.right)/2-g+t:hi(e,n,t);p=da(a,i,r),m="left"===n?-Dn:Dn}return{titleX:h,titleY:p,maxWidth:u,rotation:m}}(this,o,t,i);Va(e,n.text,0,0,r,{color:n.color,maxWidth:d,rotation:u,textAlign:bi(i,t,a),textBaseline:"middle",translation:[l,c]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,n=mn(e.grid&&e.grid.z,-1),a=mn(e.border&&e.border.z,0);return this._isVisible()&&this.draw===yi.prototype.draw?[{z:n,draw:e=>{this.drawBackground(),this.drawGrid(e),this.drawTitle()}},{z:a,draw:()=>{this.drawBorder()}},{z:t,draw:e=>{this.drawLabels(e)}}]:[{z:t,draw:e=>{this.draw(e)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",a=[];let r,s;for(r=0,s=t.length;r<s;++r){const s=t[r];s[n]!==this.id||e&&s.type!==e||a.push(s)}return a}_resolveTickFontOptions(e){return Za(this.options.ticks.setContext(this.getContext(e)).font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class xi{constructor(e,t,n){this.type=e,this.scope=t,this.override=n,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let n;(function(e){return"id"in e&&"defaults"in e})(t)&&(n=this.register(t));const a=this.items,r=e.id,s=this.scope+"."+r;if(!r)throw new Error("class does not have id: "+e);return r in a||(a[r]=e,function(e,t,n){const a=wn(Object.create(null),[n?Pa.get(n):{},Pa.get(t),e.defaults]);Pa.set(t,a),e.defaultRoutes&&function(e,t){Object.keys(t).forEach((n=>{const a=n.split("."),r=a.pop(),s=[e].concat(a).join("."),i=t[n].split("."),o=i.pop(),l=i.join(".");Pa.route(s,r,l,o)}))}(t,e.defaultRoutes);e.descriptors&&Pa.describe(t,e.descriptors)}(e,s,n),this.override&&Pa.override(e.id,e.overrides)),s}get(e){return this.items[e]}unregister(e){const t=this.items,n=e.id,a=this.scope;n in t&&delete t[n],a&&n in Pa[a]&&(delete Pa[a][n],this.override&&delete Sa[n])}}class _i{constructor(){this.controllers=new xi(ds,"datasets",!0),this.elements=new xi(ci,"elements"),this.plugins=new xi(Object,"plugins"),this.scales=new xi(yi,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t)}remove(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t)}addControllers(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.controllers)}addElements(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.elements)}addPlugins(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.plugins)}addScales(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.controllers)}removeElements(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.elements)}removePlugins(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.plugins)}removeScales(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.scales)}_each(e,t,n){[...t].forEach((t=>{const a=n||this._getRegistryForType(t);n||a.isForType(t)||a===this.plugins&&t.id?this._exec(e,a,t):vn(t,(t=>{const a=n||this._getRegistryForType(t);this._exec(e,a,t)}))}))}_exec(e,t,n){const a=kn(e);gn(n["before"+a],[],n),t[e](n),gn(n["after"+a],[],n)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const n=this._typedRegistries[t];if(n.isForType(e))return n}return this.plugins}_get(e,t,n){const a=t.get(e);if(void 0===a)throw new Error('"'+e+'" is not a registered '+n+".");return a}}var wi=new _i;class ji{constructor(){this._init=[]}notify(e,t,n,a){"beforeInit"===t&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const r=a?this._descriptors(e).filter(a):this._descriptors(e),s=this._notify(r,e,t,n);return"afterDestroy"===t&&(this._notify(r,e,"stop"),this._notify(this._init,e,"uninstall")),s}_notify(e,t,n,a){a=a||{};for(const r of e){const e=r.plugin;if(!1===gn(e[n],[t,a,r.options],e)&&a.cancelable)return!1}return!0}invalidate(){cn(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const n=e&&e.config,a=mn(n.options&&n.options.plugins,{}),r=function(e){const t={},n=[],a=Object.keys(wi.plugins.items);for(let s=0;s<a.length;s++)n.push(wi.getPlugin(a[s]));const r=e.plugins||[];for(let s=0;s<r.length;s++){const e=r[s];-1===n.indexOf(e)&&(n.push(e),t[e.id]=!0)}return{plugins:n,localIds:t}}(n);return!1!==a||t?function(e,t,n,a){let{plugins:r,localIds:s}=t;const i=[],o=e.getContext();for(const l of r){const t=l.id,r=Ni(n[t],a);null!==r&&i.push({plugin:l,options:Ei(e.config,{plugin:l,local:s[t]},r,o)})}return i}(e,r,a,t):[]}_notifyStateChanges(e){const t=this._oldCache||[],n=this._cache,a=(e,t)=>e.filter((e=>!t.some((t=>e.plugin.id===t.plugin.id))));this._notify(a(t,n),e,"stop"),this._notify(a(n,t),e,"start")}}function Ni(e,t){return t||!1!==e?!0===e?{}:e:null}function Ei(e,t,n,a){let{plugin:r,local:s}=t;const i=e.pluginScopeKeys(r),o=e.getOptionScopes(n,i);return s&&r.defaults&&o.push(r.defaults),e.createResolver(o,a,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Si(e,t){const n=Pa.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||n.indexAxis||"x"}function ki(e){if("x"===e||"y"===e||"r"===e)return e}function Ci(e){if(ki(e))return e;for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];for(const s of n){const t=s.axis||("top"===(r=s.position)||"bottom"===r?"x":"left"===r||"right"===r?"y":void 0)||e.length>1&&ki(e[0].toLowerCase());if(t)return t}var r;throw new Error(`Cannot determine type of '${e}' axis. Please provide 'axis' or 'position' option.`)}function Ai(e,t,n){if(n[t+"AxisID"]===e)return{axis:t}}function Ti(e,t){const n=Sa[e.type]||{scales:{}},a=t.scales||{},r=Si(e.type,t),s=Object.create(null);return Object.keys(a).forEach((t=>{const i=a[t];if(!un(i))return console.error(`Invalid scale configuration for scale: ${t}`);if(i._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${t}`);const o=Ci(t,i,function(e,t){if(t.data&&t.data.datasets){const n=t.data.datasets.filter((t=>t.xAxisID===e||t.yAxisID===e));if(n.length)return Ai(e,"x",n[0])||Ai(e,"y",n[0])}return{}}(t,e),Pa.scales[i.type]),l=function(e,t){return e===t?"_index_":"_value_"}(o,r),c=n.scales||{};s[t]=jn(Object.create(null),[{axis:o},i,c[o],c[l]])})),e.data.datasets.forEach((n=>{const r=n.type||e.type,i=n.indexAxis||Si(r,t),o=(Sa[r]||{}).scales||{};Object.keys(o).forEach((e=>{const t=function(e,t){let n=e;return"_index_"===e?n=t:"_value_"===e&&(n="x"===t?"y":"x"),n}(e,i),r=n[t+"AxisID"]||t;s[r]=s[r]||Object.create(null),jn(s[r],[{axis:t},a[r],o[e]])}))})),Object.keys(s).forEach((e=>{const t=s[e];jn(t,[Pa.scales[t.type],Pa.scale])})),s}function Pi(e){const t=e.options||(e.options={});t.plugins=mn(t.plugins,{}),t.scales=Ti(e,t)}function Ii(e){return(e=e||{}).datasets=e.datasets||[],e.labels=e.labels||[],e}const Oi=new Map,Ri=new Set;function Mi(e,t){let n=Oi.get(e);return n||(n=t(),Oi.set(e,n),Ri.add(n)),n}const Di=(e,t,n)=>{const a=Sn(t,n);void 0!==a&&e.add(a)};class Li{constructor(e){this._config=function(e){return(e=e||{}).data=Ii(e.data),Pi(e),e}(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=Ii(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),Pi(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Mi(e,(()=>[[`datasets.${e}`,""]]))}datasetAnimationScopeKeys(e,t){return Mi(`${e}.transition.${t}`,(()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]]))}datasetElementScopeKeys(e,t){return Mi(`${e}-${t}`,(()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]]))}pluginScopeKeys(e){const t=e.id;return Mi(`${this.type}-plugin-${t}`,(()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]]))}_cachedScopes(e,t){const n=this._scopeCache;let a=n.get(e);return a&&!t||(a=new Map,n.set(e,a)),a}getOptionScopes(e,t,n){const{options:a,type:r}=this,s=this._cachedScopes(e,n),i=s.get(t);if(i)return i;const o=new Set;t.forEach((t=>{e&&(o.add(e),t.forEach((t=>Di(o,e,t)))),t.forEach((e=>Di(o,a,e))),t.forEach((e=>Di(o,Sa[r]||{},e))),t.forEach((e=>Di(o,Pa,e))),t.forEach((e=>Di(o,ka,e)))}));const l=Array.from(o);return 0===l.length&&l.push(Object.create(null)),Ri.has(t)&&s.set(t,l),l}chartOptionScopes(){const{options:e,type:t}=this;return[e,Sa[t]||{},Pa.datasets[t]||{},{type:t},Pa,ka]}resolveNamedOptions(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[""];const r={$shared:!0},{resolver:s,subPrefixes:i}=$i(this._resolverCache,e,a);let o=s;if(function(e,t){const{isScriptable:n,isIndexable:a}=rr(e);for(const r of t){const t=n(r),s=a(r),i=(s||t)&&e[r];if(t&&(An(i)||zi(i))||s&&dn(i))return!0}return!1}(s,t)){r.$shared=!1;o=ar(s,n=An(n)?n():n,this.createResolver(e,n,i))}for(const l of t)r[l]=o[l];return r}createResolver(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[""],a=arguments.length>3?arguments[3]:void 0;const{resolver:r}=$i(this._resolverCache,e,n);return un(t)?ar(r,t,void 0,a):r}}function $i(e,t,n){let a=e.get(t);a||(a=new Map,e.set(t,a));const r=n.join();let s=a.get(r);if(!s){s={resolver:nr(t,n),subPrefixes:n.filter((e=>!e.toLowerCase().includes("hover")))},a.set(r,s)}return s}const zi=e=>un(e)&&Object.getOwnPropertyNames(e).some((t=>An(e[t])));const Fi=["top","bottom","left","right","chartArea"];function Bi(e,t){return"top"===e||"bottom"===e||-1===Fi.indexOf(e)&&"x"===t}function Ui(e,t){return function(n,a){return n[e]===a[e]?n[t]-a[t]:n[e]-a[e]}}function Wi(e){const t=e.chart,n=t.options.animation;t.notifyPlugins("afterRender"),gn(n&&n.onComplete,[e],t)}function Vi(e){const t=e.chart,n=t.options.animation;gn(n&&n.onProgress,[e],t)}function Hi(e){return wr()&&"string"===typeof e?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const qi={},Yi=e=>{const t=Hi(e);return Object.values(qi).filter((e=>e.canvas===t)).pop()};function Ji(e,t,n){const a=Object.keys(e);for(const r of a){const a=+r;if(a>=t){const s=e[r];delete e[r],(n>0||a>t)&&(e[a+n]=s)}}}function Gi(e,t,n){return e.options.clip?e[n]:t[n]}class Xi{static defaults=(()=>Pa)();static instances=(()=>qi)();static overrides=(()=>Sa)();static registry=(()=>wi)();static version="4.4.8";static getChart=(()=>Yi)();static register(){wi.add(...arguments),Ki()}static unregister(){wi.remove(...arguments),Ki()}constructor(e,t){const n=this.config=new Li(t),a=Hi(e),r=Yi(a);if(r)throw new Error("Canvas is already in use. Chart with ID '"+r.id+"' must be destroyed before the canvas with ID '"+r.canvas.id+"' can be reused.");const s=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||function(e){return!wr()||"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas?Ys:li}(a)),this.platform.updateConfig(n);const i=this.platform.acquireContext(a,s.aspectRatio),o=i&&i.canvas,l=o&&o.height,c=o&&o.width;this.id=ln(),this.ctx=i,this.canvas=o,this.width=c,this.height=l,this._options=s,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new ji,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=function(e,t){let n;return function(){for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return t?(clearTimeout(n),n=setTimeout(e,t,r)):e.apply(this,r),t}}((e=>this.update(e)),s.resizeDelay||0),this._dataChanges=[],qi[this.id]=this,i&&o?(Jr.listen(this,"complete",Wi),Jr.listen(this,"progress",Vi),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:n,height:a,_aspectRatio:r}=this;return cn(e)?t&&r?r:a?n/a:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return wi}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Pr(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Ra(this.canvas,this.ctx),this}stop(){return Jr.stop(this),this}resize(e,t){Jr.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const n=this.options,a=this.canvas,r=n.maintainAspectRatio&&this.aspectRatio,s=this.platform.getMaximumSize(a,e,t,r),i=n.devicePixelRatio||this.platform.getDevicePixelRatio(),o=this.width?"resize":"attach";this.width=s.width,this.height=s.height,this._aspectRatio=this.aspectRatio,Pr(this,i,!0)&&(this.notifyPlugins("resize",{size:s}),gn(n.onResize,[this,s],this),this.attached&&this._doResize(o)&&this.render())}ensureScalesHaveIDs(){vn(this.options.scales||{},((e,t)=>{e.id=t}))}buildOrUpdateScales(){const e=this.options,t=e.scales,n=this.scales,a=Object.keys(n).reduce(((e,t)=>(e[t]=!1,e)),{});let r=[];t&&(r=r.concat(Object.keys(t).map((e=>{const n=t[e],a=Ci(e,n),r="r"===a,s="x"===a;return{options:n,dposition:r?"chartArea":s?"bottom":"left",dtype:r?"radialLinear":s?"category":"linear"}})))),vn(r,(t=>{const r=t.options,s=r.id,i=Ci(s,r),o=mn(r.type,t.dtype);void 0!==r.position&&Bi(r.position,i)===Bi(t.dposition)||(r.position=t.dposition),a[s]=!0;let l=null;if(s in n&&n[s].type===o)l=n[s];else{l=new(wi.getScale(o))({id:s,type:o,ctx:this.ctx,chart:this}),n[l.id]=l}l.init(r,e)})),vn(a,((e,t)=>{e||delete n[t]})),vn(n,(e=>{Hs.configure(this,e,e.options),Hs.addBox(this,e)}))}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,n=e.length;if(e.sort(((e,t)=>e.index-t.index)),n>t){for(let e=t;e<n;++e)this._destroyDatasetMeta(e);e.splice(t,n-t)}this._sortedMetasets=e.slice(0).sort(Ui("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach(((e,n)=>{0===t.filter((t=>t===e._dataset)).length&&this._destroyDatasetMeta(n)}))}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let n,a;for(this._removeUnreferencedMetasets(),n=0,a=t.length;n<a;n++){const a=t[n];let r=this.getDatasetMeta(n);const s=a.type||this.config.type;if(r.type&&r.type!==s&&(this._destroyDatasetMeta(n),r=this.getDatasetMeta(n)),r.type=s,r.indexAxis=a.indexAxis||Si(s,this.options),r.order=a.order||0,r.index=n,r.label=""+a.label,r.visible=this.isDatasetVisible(n),r.controller)r.controller.updateIndex(n),r.controller.linkScales();else{const t=wi.getController(s),{datasetElementType:a,dataElementType:i}=Pa.datasets[s];Object.assign(t,{dataElementType:wi.getElement(i),datasetElementType:a&&wi.getElement(a)}),r.controller=new t(this,n),e.push(r.controller)}}return this._updateMetasets(),e}_resetElements(){vn(this.data.datasets,((e,t)=>{this.getDatasetMeta(t).controller.reset()}),this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const n=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),a=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0}))return;const r=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let s=0;for(let l=0,c=this.data.datasets.length;l<c;l++){const{controller:e}=this.getDatasetMeta(l),t=!a&&-1===r.indexOf(e);e.buildOrUpdateElements(t),s=Math.max(+e.getMaxOverflow(),s)}s=this._minPadding=n.layout.autoPadding?s:0,this._updateLayout(s),a||vn(r,(e=>{e.reset()})),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(Ui("z","_idx"));const{_active:i,_lastEvent:o}=this;o?this._eventHandler(o,!0):i.length&&this._updateHoverStyles(i,i,!0),this.render()}_updateScales(){vn(this.scales,(e=>{Hs.removeBox(this,e)})),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),n=new Set(e.events);Tn(t,n)&&!!this._responsiveListeners===e.responsive||(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:n,start:a,count:r}of t){Ji(e,a,"_removeElements"===n?-r:r)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,n=t=>new Set(e.filter((e=>e[0]===t)).map(((e,t)=>t+","+e.splice(1).join(",")))),a=n(0);for(let r=1;r<t;r++)if(!Tn(a,n(r)))return;return Array.from(a).map((e=>e.split(","))).map((e=>({method:e[1],start:+e[2],count:+e[3]})))}_updateLayout(e){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;Hs.update(this,this.width,this.height,e);const t=this.chartArea,n=t.width<=0||t.height<=0;this._layers=[],vn(this.boxes,(e=>{n&&"chartArea"===e.position||(e.configure&&e.configure(),this._layers.push(...e._layers()))}),this),this._layers.forEach(((e,t)=>{e._idx=t})),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})){for(let e=0,t=this.data.datasets.length;e<t;++e)this.getDatasetMeta(e).controller.configure();for(let t=0,n=this.data.datasets.length;t<n;++t)this._updateDataset(t,An(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const n=this.getDatasetMeta(e),a={meta:n,index:e,mode:t,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",a)&&(n.controller._update(t),a.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",a))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(Jr.has(this)?this.attached&&!Jr.running(this)&&Jr.start(this):(this.draw(),Wi({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:e,height:t}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(e,t)}if(this.clear(),this.width<=0||this.height<=0)return;if(!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,n=[];let a,r;for(a=0,r=t.length;a<r;++a){const r=t[a];e&&!r.visible||n.push(r)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,n=e._clip,a=!n.disabled,r=function(e,t){const{xScale:n,yScale:a}=e;return n&&a?{left:Gi(n,t,"left"),right:Gi(n,t,"right"),top:Gi(a,t,"top"),bottom:Gi(a,t,"bottom")}:t}(e,this.chartArea),s={meta:e,index:e.index,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetDraw",s)&&(a&&$a(t,{left:!1===n.left?0:r.left-n.left,right:!1===n.right?this.width:r.right+n.right,top:!1===n.top?0:r.top-n.top,bottom:!1===n.bottom?this.height:r.bottom+n.bottom}),e.controller.draw(),a&&za(t),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(e){return La(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,n,a){const r=Is.modes[t];return"function"===typeof r?r(this,e,n,a):[]}getDatasetMeta(e){const t=this.data.datasets[e],n=this._metasets;let a=n.filter((e=>e&&e._dataset===t)).pop();return a||(a={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},n.push(a)),a}getContext(){return this.$context||(this.$context=tr(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const n=this.getDatasetMeta(e);return"boolean"===typeof n.hidden?!n.hidden:!t.hidden}setDatasetVisibility(e,t){this.getDatasetMeta(e).hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,n){const a=n?"show":"hide",r=this.getDatasetMeta(e),s=r.controller._resolveAnimations(void 0,a);Cn(t)?(r.data[t].hidden=!n,this.update()):(this.setDatasetVisibility(e,n),s.update(r,{visible:n}),this.update((t=>t.datasetIndex===e?a:void 0)))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),Jr.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),Ra(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete qi[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(){return this.canvas.toDataURL(...arguments)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,n=(n,a)=>{t.addEventListener(this,n,a),e[n]=a},a=(e,t,n)=>{e.offsetX=t,e.offsetY=n,this._eventHandler(e)};vn(this.options.events,(e=>n(e,a)))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,n=(n,a)=>{t.addEventListener(this,n,a),e[n]=a},a=(n,a)=>{e[n]&&(t.removeEventListener(this,n,a),delete e[n])},r=(e,t)=>{this.canvas&&this.resize(e,t)};let s;const i=()=>{a("attach",i),this.attached=!0,this.resize(),n("resize",r),n("detach",s)};s=()=>{this.attached=!1,a("resize",r),this._stop(),this._resize(0,0),n("attach",i)},t.isAttached(this.canvas)?i():s()}unbindEvents(){vn(this._listeners,((e,t)=>{this.platform.removeEventListener(this,t,e)})),this._listeners={},vn(this._responsiveListeners,((e,t)=>{this.platform.removeEventListener(this,t,e)})),this._responsiveListeners=void 0}updateHoverStyle(e,t,n){const a=n?"set":"remove";let r,s,i,o;for("dataset"===t&&(r=this.getDatasetMeta(e[0].datasetIndex),r.controller["_"+a+"DatasetHoverStyle"]()),i=0,o=e.length;i<o;++i){s=e[i];const t=s&&this.getDatasetMeta(s.datasetIndex).controller;t&&t[a+"HoverStyle"](s.element,s.datasetIndex,s.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],n=e.map((e=>{let{datasetIndex:t,index:n}=e;const a=this.getDatasetMeta(t);if(!a)throw new Error("No dataset found at index "+t);return{datasetIndex:t,element:a.data[n],index:n}}));!bn(n,t)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,t))}notifyPlugins(e,t,n){return this._plugins.notify(this,e,t,n)}isPluginEnabled(e){return 1===this._plugins._cache.filter((t=>t.plugin.id===e)).length}_updateHoverStyles(e,t,n){const a=this.options.hover,r=(e,t)=>e.filter((e=>!t.some((t=>e.datasetIndex===t.datasetIndex&&e.index===t.index)))),s=r(t,e),i=n?e:r(e,t);s.length&&this.updateHoverStyle(s,a.mode,!1),i.length&&a.mode&&this.updateHoverStyle(i,a.mode,!0)}_eventHandler(e,t){const n={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},a=t=>(t.options.events||this.options.events).includes(e.native.type);if(!1===this.notifyPlugins("beforeEvent",n,a))return;const r=this._handleEvent(e,t,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,a),(r||n.changed)&&this.render(),this}_handleEvent(e,t,n){const{_active:a=[],options:r}=this,s=t,i=this._getActiveElements(e,a,n,s),o=function(e){return"mouseup"===e.type||"click"===e.type||"contextmenu"===e.type}(e),l=function(e,t,n,a){return n&&"mouseout"!==e.type?a?t:e:null}(e,this._lastEvent,n,o);n&&(this._lastEvent=null,gn(r.onHover,[e,i,this],this),o&&gn(r.onClick,[e,i,this],this));const c=!bn(i,a);return(c||t)&&(this._active=i,this._updateHoverStyles(i,a,t)),this._lastEvent=l,c}_getActiveElements(e,t,n,a){if("mouseout"===e.type)return[];if(!n)return t;const r=this.options.hover;return this.getElementsAtEventForMode(e,r.mode,r,a)}}function Ki(){return vn(Xi.instances,(e=>e._plugins.invalidate()))}function Qi(e,t,n,a){const r=Ga(e.options.borderRadius,["outerStart","outerEnd","innerStart","innerEnd"]);const s=(n-t)/2,i=Math.min(s,a*t/2),o=e=>{const t=(n-Math.min(s,e))*a/2;return Zn(e,0,Math.min(s,t))};return{outerStart:o(r.outerStart),outerEnd:o(r.outerEnd),innerStart:Zn(r.innerStart,0,i),innerEnd:Zn(r.innerEnd,0,i)}}function Zi(e,t,n,a){return{x:n+e*Math.cos(t),y:a+e*Math.sin(t)}}function eo(e,t,n,a,r,s){const{x:i,y:o,startAngle:l,pixelMargin:c,innerRadius:d}=t,u=Math.max(t.outerRadius+a+n-c,0),h=d>0?d+a+n+c:0;let p=0;const m=r-l;if(a){const e=((d>0?d-a:0)+(u>0?u-a:0))/2;p=(m-(0!==e?m*e/(e+a):m))/2}const f=(m-Math.max(.001,m*u-n/Pn)/u)/2,g=l+f+p,v=r-f-p,{outerStart:b,outerEnd:y,innerStart:x,innerEnd:_}=Qi(t,h,u,v-g),w=u-b,j=u-y,N=g+b/w,E=v-y/j,S=h+x,k=h+_,C=g+x/S,A=v-_/k;if(e.beginPath(),s){const t=(N+E)/2;if(e.arc(i,o,u,N,t),e.arc(i,o,u,t,E),y>0){const t=Zi(j,E,i,o);e.arc(t.x,t.y,y,E,v+Dn)}const n=Zi(k,v,i,o);if(e.lineTo(n.x,n.y),_>0){const t=Zi(k,A,i,o);e.arc(t.x,t.y,_,v+Dn,A+Math.PI)}const a=(v-_/h+(g+x/h))/2;if(e.arc(i,o,h,v-_/h,a,!0),e.arc(i,o,h,a,g+x/h,!0),x>0){const t=Zi(S,C,i,o);e.arc(t.x,t.y,x,C+Math.PI,g-Dn)}const r=Zi(w,g,i,o);if(e.lineTo(r.x,r.y),b>0){const t=Zi(w,N,i,o);e.arc(t.x,t.y,b,g-Dn,N)}}else{e.moveTo(i,o);const t=Math.cos(N)*u+i,n=Math.sin(N)*u+o;e.lineTo(t,n);const a=Math.cos(E)*u+i,r=Math.sin(E)*u+o;e.lineTo(a,r)}e.closePath()}function to(e,t,n,a,r){const{fullCircles:s,startAngle:i,circumference:o,options:l}=t,{borderWidth:c,borderJoinStyle:d,borderDash:u,borderDashOffset:h}=l,p="inner"===l.borderAlign;if(!c)return;e.setLineDash(u||[]),e.lineDashOffset=h,p?(e.lineWidth=2*c,e.lineJoin=d||"round"):(e.lineWidth=c,e.lineJoin=d||"bevel");let m=t.endAngle;if(s){eo(e,t,n,a,m,r);for(let t=0;t<s;++t)e.stroke();isNaN(o)||(m=i+(o%In||In))}p&&function(e,t,n){const{startAngle:a,pixelMargin:r,x:s,y:i,outerRadius:o,innerRadius:l}=t;let c=r/o;e.beginPath(),e.arc(s,i,o,a-c,n+c),l>r?(c=r/l,e.arc(s,i,l,n+c,a-c,!0)):e.arc(s,i,r,n+Dn,a-Dn),e.closePath(),e.clip()}(e,t,m),s||(eo(e,t,n,a,m,r),e.stroke())}class no extends ci{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:e=>"borderDash"!==e};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,n){const a=this.getProps(["x","y"],n),{angle:r,distance:s}=Jn(a,{x:e,y:t}),{startAngle:i,endAngle:o,innerRadius:l,outerRadius:c,circumference:d}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),u=(this.options.spacing+this.options.borderWidth)/2,h=mn(d,o-i),p=Qn(r,i,o)&&i!==o,m=h>=In||p,f=ea(s,l+u,c+u);return m&&f}getCenterPoint(e){const{x:t,y:n,startAngle:a,endAngle:r,innerRadius:s,outerRadius:i}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:o,spacing:l}=this.options,c=(a+r)/2,d=(s+i+l+o)/2;return{x:t+Math.cos(c)*d,y:n+Math.sin(c)*d}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:t,circumference:n}=this,a=(t.offset||0)/4,r=(t.spacing||0)/2,s=t.circular;if(this.pixelMargin="inner"===t.borderAlign?.33:0,this.fullCircles=n>In?Math.floor(n/In):0,0===n||this.innerRadius<0||this.outerRadius<0)return;e.save();const i=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(i)*a,Math.sin(i)*a);const o=a*(1-Math.sin(Math.min(Pn,n||0)));e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor,function(e,t,n,a,r){const{fullCircles:s,startAngle:i,circumference:o}=t;let l=t.endAngle;if(s){eo(e,t,n,a,l,r);for(let t=0;t<s;++t)e.fill();isNaN(o)||(l=i+(o%In||In))}eo(e,t,n,a,l,r),e.fill()}(e,this,o,r,s),to(e,this,o,r,s),e.restore()}}function ao(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;e.lineCap=mn(n.borderCapStyle,t.borderCapStyle),e.setLineDash(mn(n.borderDash,t.borderDash)),e.lineDashOffset=mn(n.borderDashOffset,t.borderDashOffset),e.lineJoin=mn(n.borderJoinStyle,t.borderJoinStyle),e.lineWidth=mn(n.borderWidth,t.borderWidth),e.strokeStyle=mn(n.borderColor,t.borderColor)}function ro(e,t,n){e.lineTo(n.x,n.y)}function so(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=e.length,{start:r=0,end:s=a-1}=n,{start:i,end:o}=t,l=Math.max(r,i),c=Math.min(s,o),d=r<i&&s<i||r>o&&s>o;return{count:a,start:l,loop:t.loop,ilen:c<l&&!d?a+c-l:c-l}}function io(e,t,n,a){const{points:r,options:s}=t,{count:i,start:o,loop:l,ilen:c}=so(r,n,a),d=function(e){return e.stepped?Fa:e.tension||"monotone"===e.cubicInterpolationMode?Ba:ro}(s);let u,h,p,{move:m=!0,reverse:f}=a||{};for(u=0;u<=c;++u)h=r[(o+(f?c-u:u))%i],h.skip||(m?(e.moveTo(h.x,h.y),m=!1):d(e,p,h,f,s.stepped),p=h);return l&&(h=r[(o+(f?c:0))%i],d(e,p,h,f,s.stepped)),!!l}function oo(e,t,n,a){const r=t.points,{count:s,start:i,ilen:o}=so(r,n,a),{move:l=!0,reverse:c}=a||{};let d,u,h,p,m,f,g=0,v=0;const b=e=>(i+(c?o-e:e))%s,y=()=>{p!==m&&(e.lineTo(g,m),e.lineTo(g,p),e.lineTo(g,f))};for(l&&(u=r[b(0)],e.moveTo(u.x,u.y)),d=0;d<=o;++d){if(u=r[b(d)],u.skip)continue;const t=u.x,n=u.y,a=0|t;a===h?(n<p?p=n:n>m&&(m=n),g=(v*g+t)/++v):(y(),e.lineTo(t,n),h=a,v=0,p=m=n),f=n}y()}function lo(e){const t=e.options,n=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&"monotone"!==t.cubicInterpolationMode&&!t.stepped&&!n?oo:io}const co="function"===typeof Path2D;function uo(e,t,n,a){co&&!t.options.segment?function(e,t,n,a){let r=t._path;r||(r=t._path=new Path2D,t.path(r,n,a)&&r.closePath()),ao(e,t.options),e.stroke(r)}(e,t,n,a):function(e,t,n,a){const{segments:r,options:s}=t,i=lo(t);for(const o of r)ao(e,s,o.style),e.beginPath(),i(e,t,o,{start:n,end:n+a-1})&&e.closePath(),e.stroke()}(e,t,n,a)}class ho extends ci{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:e=>"borderDash"!==e&&"fill"!==e};constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const n=this.options;if((n.tension||"monotone"===n.cubicInterpolationMode)&&!n.stepped&&!this._pointsUpdated){const a=n.spanGaps?this._loop:this._fullLoop;_r(this._points,n,e,a,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=function(e,t){const n=e.points,a=e.options.spanGaps,r=n.length;if(!r)return[];const s=!!e._loop,{start:i,end:o}=function(e,t,n,a){let r=0,s=t-1;if(n&&!a)for(;r<t&&!e[r].skip;)r++;for(;r<t&&e[r].skip;)r++;for(r%=t,n&&(s+=r);s>r&&e[s%t].skip;)s--;return s%=t,{start:r,end:s}}(n,r,s,a);return Vr(e,!0===a?[{start:i,end:o,loop:s}]:function(e,t,n,a){const r=e.length,s=[];let i,o=t,l=e[t];for(i=t+1;i<=n;++i){const n=e[i%r];n.skip||n.stop?l.skip||(a=!1,s.push({start:t%r,end:(i-1)%r,loop:a}),t=o=n.stop?i:null):(o=i,l.skip&&(t=i)),l=n}return null!==o&&s.push({start:t%r,end:o%r,loop:a}),s}(n,i,o<i?o+r:o,!!e._fullLoop&&0===i&&o===r-1),n,t)}(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,n=e.length;return n&&t[e[n-1].end]}interpolate(e,t){const n=this.options,a=e[t],r=this.points,s=Wr(this,{property:t,start:a,end:a});if(!s.length)return;const i=[],o=function(e){return e.stepped?Mr:e.tension||"monotone"===e.cubicInterpolationMode?Dr:Rr}(n);let l,c;for(l=0,c=s.length;l<c;++l){const{start:c,end:d}=s[l],u=r[c],h=r[d];if(u===h){i.push(u);continue}const p=o(u,h,Math.abs((a-u[t])/(h[t]-u[t])),n.stepped);p[t]=e[t],i.push(p)}return 1===i.length?i[0]:i}pathSegment(e,t,n){return lo(this)(e,this,t,n)}path(e,t,n){const a=this.segments,r=lo(this);let s=this._loop;t=t||0,n=n||this.points.length-t;for(const i of a)s&=r(e,this,i,{start:t,end:t+n-1});return!!s}draw(e,t,n,a){const r=this.options||{};(this.points||[]).length&&r.borderWidth&&(e.save(),uo(e,this,n,a),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function po(e,t,n,a){const r=e.options,{[n]:s}=e.getProps([n],a);return Math.abs(t-s)<r.radius+r.hitRadius}class mo extends ci{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,t,n){const a=this.options,{x:r,y:s}=this.getProps(["x","y"],n);return Math.pow(e-r,2)+Math.pow(t-s,2)<Math.pow(a.hitRadius+a.radius,2)}inXRange(e,t){return po(this,e,"x",t)}inYRange(e,t){return po(this,e,"y",t)}getCenterPoint(e){const{x:t,y:n}=this.getProps(["x","y"],e);return{x:t,y:n}}size(e){let t=(e=e||this.options||{}).radius||0;t=Math.max(t,t&&e.hoverRadius||0);return 2*(t+(t&&e.borderWidth||0))}draw(e,t){const n=this.options;this.skip||n.radius<.1||!La(this,t,this.size(n)/2)||(e.strokeStyle=n.borderColor,e.lineWidth=n.borderWidth,e.fillStyle=n.backgroundColor,Ma(e,n,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}function fo(e,t){const{x:n,y:a,base:r,width:s,height:i}=e.getProps(["x","y","base","width","height"],t);let o,l,c,d,u;return e.horizontal?(u=i/2,o=Math.min(n,r),l=Math.max(n,r),c=a-u,d=a+u):(u=s/2,o=n-u,l=n+u,c=Math.min(a,r),d=Math.max(a,r)),{left:o,top:c,right:l,bottom:d}}function go(e,t,n,a){return e?0:Zn(t,n,a)}function vo(e){const t=fo(e),n=t.right-t.left,a=t.bottom-t.top,r=function(e,t,n){const a=e.options.borderWidth,r=e.borderSkipped,s=Xa(a);return{t:go(r.top,s.top,0,n),r:go(r.right,s.right,0,t),b:go(r.bottom,s.bottom,0,n),l:go(r.left,s.left,0,t)}}(e,n/2,a/2),s=function(e,t,n){const{enableBorderRadius:a}=e.getProps(["enableBorderRadius"]),r=e.options.borderRadius,s=Ka(r),i=Math.min(t,n),o=e.borderSkipped,l=a||un(r);return{topLeft:go(!l||o.top||o.left,s.topLeft,0,i),topRight:go(!l||o.top||o.right,s.topRight,0,i),bottomLeft:go(!l||o.bottom||o.left,s.bottomLeft,0,i),bottomRight:go(!l||o.bottom||o.right,s.bottomRight,0,i)}}(e,n/2,a/2);return{outer:{x:t.left,y:t.top,w:n,h:a,radius:s},inner:{x:t.left+r.l,y:t.top+r.t,w:n-r.l-r.r,h:a-r.t-r.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,s.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(r.b,r.r))}}}}function bo(e,t,n,a){const r=null===t,s=null===n,i=e&&!(r&&s)&&fo(e,a);return i&&(r||ea(t,i.left,i.right))&&(s||ea(n,i.top,i.bottom))}function yo(e,t){e.rect(t.x,t.y,t.w,t.h)}function xo(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=e.x!==n.x?-t:0,r=e.y!==n.y?-t:0,s=(e.x+e.w!==n.x+n.w?t:0)-a,i=(e.y+e.h!==n.y+n.h?t:0)-r;return{x:e.x+a,y:e.y+r,w:e.w+s,h:e.h+i,radius:e.radius}}class _o extends ci{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:n,backgroundColor:a}}=this,{inner:r,outer:s}=vo(this),i=(o=s.radius).topLeft||o.topRight||o.bottomLeft||o.bottomRight?Ha:yo;var o;e.save(),s.w===r.w&&s.h===r.h||(e.beginPath(),i(e,xo(s,t,r)),e.clip(),i(e,xo(r,-t,s)),e.fillStyle=n,e.fill("evenodd")),e.beginPath(),i(e,xo(r,t)),e.fillStyle=a,e.fill(),e.restore()}inRange(e,t,n){return bo(this,e,t,n)}inXRange(e,t){return bo(this,e,null,t)}inYRange(e,t){return bo(this,null,e,t)}getCenterPoint(e){const{x:t,y:n,base:a,horizontal:r}=this.getProps(["x","y","base","horizontal"],e);return{x:r?(t+a)/2:t,y:r?n:(n+a)/2}}getRange(e){return"x"===e?this.width/2:this.height/2}}function wo(e,t,n,a){if(a)return;let r=t[e],s=n[e];return"angle"===e&&(r=Kn(r),s=Kn(s)),{property:e,start:r,end:s}}function jo(e,t,n){for(;t>e;t--){const e=n[t];if(!isNaN(e.x)&&!isNaN(e.y))break}return t}function No(e,t,n,a){return e&&t?a(e[n],t[n]):e?e[n]:t?t[n]:0}function Eo(e,t){let n=[],a=!1;return dn(e)?(a=!0,n=e):n=function(e,t){const{x:n=null,y:a=null}=e||{},r=t.points,s=[];return t.segments.forEach((e=>{let{start:t,end:i}=e;i=jo(t,i,r);const o=r[t],l=r[i];null!==a?(s.push({x:o.x,y:a}),s.push({x:l.x,y:a})):null!==n&&(s.push({x:n,y:o.y}),s.push({x:n,y:l.y}))})),s}(e,t),n.length?new ho({points:n,options:{tension:0},_loop:a,_fullLoop:a}):null}function So(e){return e&&!1!==e.fill}function ko(e,t,n){let a=e[t].fill;const r=[t];let s;if(!n)return a;for(;!1!==a&&-1===r.indexOf(a);){if(!hn(a))return a;if(s=e[a],!s)return!1;if(s.visible)return a;r.push(a),a=s.fill}return!1}function Co(e,t,n){const a=function(e){const t=e.options,n=t.fill;let a=mn(n&&n.target,n);void 0===a&&(a=!!t.backgroundColor);if(!1===a||null===a)return!1;if(!0===a)return"origin";return a}(e);if(un(a))return!isNaN(a.value)&&a;let r=parseFloat(a);return hn(r)&&Math.floor(r)===r?function(e,t,n,a){"-"!==e&&"+"!==e||(n=t+n);if(n===t||n<0||n>=a)return!1;return n}(a[0],t,r,n):["origin","start","end","stack","shape"].indexOf(a)>=0&&a}function Ao(e,t,n){const a=[];for(let r=0;r<n.length;r++){const s=n[r],{first:i,last:o,point:l}=To(s,t,"x");if(!(!l||i&&o))if(i)a.unshift(l);else if(e.push(l),!o)break}e.push(...a)}function To(e,t,n){const a=e.interpolate(t,n);if(!a)return{};const r=a[n],s=e.segments,i=e.points;let o=!1,l=!1;for(let c=0;c<s.length;c++){const e=s[c],t=i[e.start][n],a=i[e.end][n];if(ea(r,t,a)){o=r===t,l=r===a;break}}return{first:o,last:l,point:a}}class Po{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,t,n){const{x:a,y:r,radius:s}=this;return t=t||{start:0,end:In},e.arc(a,r,s,t.end,t.start,!0),!n.bounds}interpolate(e){const{x:t,y:n,radius:a}=this,r=e.angle;return{x:t+Math.cos(r)*a,y:n+Math.sin(r)*a,angle:r}}}function Io(e){const{chart:t,fill:n,line:a}=e;if(hn(n))return function(e,t){const n=e.getDatasetMeta(t),a=n&&e.isDatasetVisible(t);return a?n.dataset:null}(t,n);if("stack"===n)return function(e){const{scale:t,index:n,line:a}=e,r=[],s=a.segments,i=a.points,o=function(e,t){const n=[],a=e.getMatchingVisibleMetas("line");for(let r=0;r<a.length;r++){const e=a[r];if(e.index===t)break;e.hidden||n.unshift(e.dataset)}return n}(t,n);o.push(Eo({x:null,y:t.bottom},a));for(let l=0;l<s.length;l++){const e=s[l];for(let t=e.start;t<=e.end;t++)Ao(r,i[t],o)}return new ho({points:r,options:{}})}(e);if("shape"===n)return!0;const r=function(e){const t=e.scale||{};if(t.getPointPositionForValue)return function(e){const{scale:t,fill:n}=e,a=t.options,r=t.getLabels().length,s=a.reverse?t.max:t.min,i=function(e,t,n){let a;return a="start"===e?n:"end"===e?t.options.reverse?t.min:t.max:un(e)?e.value:t.getBaseValue(),a}(n,t,s),o=[];if(a.grid.circular){const e=t.getPointPositionForValue(0,s);return new Po({x:e.x,y:e.y,radius:t.getDistanceFromCenterForValue(i)})}for(let l=0;l<r;++l)o.push(t.getPointPositionForValue(l,i));return o}(e);return function(e){const{scale:t={},fill:n}=e,a=function(e,t){let n=null;return"start"===e?n=t.bottom:"end"===e?n=t.top:un(e)?n=t.getPixelForValue(e.value):t.getBasePixel&&(n=t.getBasePixel()),n}(n,t);if(hn(a)){const e=t.isHorizontal();return{x:e?a:null,y:e?null:a}}return null}(e)}(e);return r instanceof Po?r:Eo(r,a)}function Oo(e,t,n){const a=Io(t),{line:r,scale:s,axis:i}=t,o=r.options,l=o.fill,c=o.backgroundColor,{above:d=c,below:u=c}=l||{};a&&r.points.length&&($a(e,n),function(e,t){const{line:n,target:a,above:r,below:s,area:i,scale:o}=t,l=n._loop?"angle":t.axis;e.save(),"x"===l&&s!==r&&(Ro(e,a,i.top),Mo(e,{line:n,target:a,color:r,scale:o,property:l}),e.restore(),e.save(),Ro(e,a,i.bottom));Mo(e,{line:n,target:a,color:s,scale:o,property:l}),e.restore()}(e,{line:r,target:a,above:d,below:u,area:n,scale:s,axis:i}),za(e))}function Ro(e,t,n){const{segments:a,points:r}=t;let s=!0,i=!1;e.beginPath();for(const o of a){const{start:a,end:l}=o,c=r[a],d=r[jo(a,l,r)];s?(e.moveTo(c.x,c.y),s=!1):(e.lineTo(c.x,n),e.lineTo(c.x,c.y)),i=!!t.pathSegment(e,o,{move:i}),i?e.closePath():e.lineTo(d.x,n)}e.lineTo(t.first().x,n),e.closePath(),e.clip()}function Mo(e,t){const{line:n,target:a,property:r,color:s,scale:i}=t,o=function(e,t,n){const a=e.segments,r=e.points,s=t.points,i=[];for(const o of a){let{start:e,end:a}=o;a=jo(e,a,r);const l=wo(n,r[e],r[a],o.loop);if(!t.segments){i.push({source:o,target:l,start:r[e],end:r[a]});continue}const c=Wr(t,l);for(const t of c){const e=wo(n,s[t.start],s[t.end],t.loop),a=Ur(o,r,e);for(const r of a)i.push({source:r,target:t,start:{[n]:No(l,e,"start",Math.max)},end:{[n]:No(l,e,"end",Math.min)}})}}return i}(n,a,r);for(const{source:l,target:c,start:d,end:u}of o){const{style:{backgroundColor:t=s}={}}=l,o=!0!==a;e.save(),e.fillStyle=t,Do(e,i,o&&wo(r,d,u)),e.beginPath();const h=!!n.pathSegment(e,l);let p;if(o){h?e.closePath():Lo(e,a,u,r);const t=!!a.pathSegment(e,c,{move:h,reverse:!0});p=h&&t,p||Lo(e,a,d,r)}e.closePath(),e.fill(p?"evenodd":"nonzero"),e.restore()}}function Do(e,t,n){const{top:a,bottom:r}=t.chart.chartArea,{property:s,start:i,end:o}=n||{};"x"===s&&(e.beginPath(),e.rect(i,a,o-i,r-a),e.clip())}function Lo(e,t,n,a){const r=t.interpolate(n,a);r&&e.lineTo(r.x,r.y)}var $o={id:"filler",afterDatasetsUpdate(e,t,n){const a=(e.data.datasets||[]).length,r=[];let s,i,o,l;for(i=0;i<a;++i)s=e.getDatasetMeta(i),o=s.dataset,l=null,o&&o.options&&o instanceof ho&&(l={visible:e.isDatasetVisible(i),index:i,fill:Co(o,i,a),chart:e,axis:s.controller.options.indexAxis,scale:s.vScale,line:o}),s.$filler=l,r.push(l);for(i=0;i<a;++i)l=r[i],l&&!1!==l.fill&&(l.fill=ko(r,i,n.propagate))},beforeDraw(e,t,n){const a="beforeDraw"===n.drawTime,r=e.getSortedVisibleDatasetMetas(),s=e.chartArea;for(let i=r.length-1;i>=0;--i){const t=r[i].$filler;t&&(t.line.updateControlPoints(s,t.axis),a&&t.fill&&Oo(e.ctx,t,s))}},beforeDatasetsDraw(e,t,n){if("beforeDatasetsDraw"!==n.drawTime)return;const a=e.getSortedVisibleDatasetMetas();for(let r=a.length-1;r>=0;--r){const t=a[r].$filler;So(t)&&Oo(e.ctx,t,e.chartArea)}},beforeDatasetDraw(e,t,n){const a=t.meta.$filler;So(a)&&"beforeDatasetDraw"===n.drawTime&&Oo(e.ctx,a,e.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const zo=(e,t)=>{let{boxHeight:n=t,boxWidth:a=t}=e;return e.usePointStyle&&(n=Math.min(n,t),a=e.pointStyleWidth||Math.min(a,t)),{boxWidth:a,boxHeight:n,itemHeight:Math.max(t,n)}};class Fo extends ci{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,n){this.maxWidth=e,this.maxHeight=t,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=gn(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter((t=>e.filter(t,this.chart.data)))),e.sort&&(t=t.sort(((t,n)=>e.sort(t,n,this.chart.data)))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display)return void(this.width=this.height=0);const n=e.labels,a=Za(n.font),r=a.size,s=this._computeTitleHeight(),{boxWidth:i,itemHeight:o}=zo(n,r);let l,c;t.font=a.string,this.isHorizontal()?(l=this.maxWidth,c=this._fitRows(s,r,i,o)+10):(c=this.maxHeight,l=this._fitCols(s,a,i,o)+10),this.width=Math.min(l,e.maxWidth||this.maxWidth),this.height=Math.min(c,e.maxHeight||this.maxHeight)}_fitRows(e,t,n,a){const{ctx:r,maxWidth:s,options:{labels:{padding:i}}}=this,o=this.legendHitBoxes=[],l=this.lineWidths=[0],c=a+i;let d=e;r.textAlign="left",r.textBaseline="middle";let u=-1,h=-c;return this.legendItems.forEach(((e,p)=>{const m=n+t/2+r.measureText(e.text).width;(0===p||l[l.length-1]+m+2*i>s)&&(d+=c,l[l.length-(p>0?0:1)]=0,h+=c,u++),o[p]={left:0,top:h,row:u,width:m,height:a},l[l.length-1]+=m+i})),d}_fitCols(e,t,n,a){const{ctx:r,maxHeight:s,options:{labels:{padding:i}}}=this,o=this.legendHitBoxes=[],l=this.columnSizes=[],c=s-e;let d=i,u=0,h=0,p=0,m=0;return this.legendItems.forEach(((e,s)=>{const{itemWidth:f,itemHeight:g}=function(e,t,n,a,r){const s=function(e,t,n,a){let r=e.text;r&&"string"!==typeof r&&(r=r.reduce(((e,t)=>e.length>t.length?e:t)));return t+n.size/2+a.measureText(r).width}(a,e,t,n),i=function(e,t,n){let a=e;"string"!==typeof t.text&&(a=Bo(t,n));return a}(r,a,t.lineHeight);return{itemWidth:s,itemHeight:i}}(n,t,r,e,a);s>0&&h+g+2*i>c&&(d+=u+i,l.push({width:u,height:h}),p+=u+i,m++,u=h=0),o[s]={left:p,top:h,col:m,width:f,height:g},u=Math.max(u,f),h+=g+i})),d+=u,l.push({width:u,height:h}),d}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:n,labels:{padding:a},rtl:r}}=this,s=Lr(r,this.left,this.width);if(this.isHorizontal()){let r=0,i=da(n,this.left+a,this.right-this.lineWidths[r]);for(const o of t)r!==o.row&&(r=o.row,i=da(n,this.left+a,this.right-this.lineWidths[r])),o.top+=this.top+e+a,o.left=s.leftForLtr(s.x(i),o.width),i+=o.width+a}else{let r=0,i=da(n,this.top+e+a,this.bottom-this.columnSizes[r].height);for(const o of t)o.col!==r&&(r=o.col,i=da(n,this.top+e+a,this.bottom-this.columnSizes[r].height)),o.top=i,o.left+=this.left+a,o.left=s.leftForLtr(s.x(o.left),o.width),i+=o.height+a}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const e=this.ctx;$a(e,this),this._draw(),za(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:n,ctx:a}=this,{align:r,labels:s}=e,i=Pa.color,o=Lr(e.rtl,this.left,this.width),l=Za(s.font),{padding:c}=s,d=l.size,u=d/2;let h;this.drawTitle(),a.textAlign=o.textAlign("left"),a.textBaseline="middle",a.lineWidth=.5,a.font=l.string;const{boxWidth:p,boxHeight:m,itemHeight:f}=zo(s,d),g=this.isHorizontal(),v=this._computeTitleHeight();h=g?{x:da(r,this.left+c,this.right-n[0]),y:this.top+c+v,line:0}:{x:this.left+c,y:da(r,this.top+v+c,this.bottom-t[0].height),line:0},$r(this.ctx,e.textDirection);const b=f+c;this.legendItems.forEach(((y,x)=>{a.strokeStyle=y.fontColor,a.fillStyle=y.fontColor;const _=a.measureText(y.text).width,w=o.textAlign(y.textAlign||(y.textAlign=s.textAlign)),j=p+u+_;let N=h.x,E=h.y;o.setWidth(this.width),g?x>0&&N+j+c>this.right&&(E=h.y+=b,h.line++,N=h.x=da(r,this.left+c,this.right-n[h.line])):x>0&&E+b>this.bottom&&(N=h.x=N+t[h.line].width+c,h.line++,E=h.y=da(r,this.top+v+c,this.bottom-t[h.line].height));if(function(e,t,n){if(isNaN(p)||p<=0||isNaN(m)||m<0)return;a.save();const r=mn(n.lineWidth,1);if(a.fillStyle=mn(n.fillStyle,i),a.lineCap=mn(n.lineCap,"butt"),a.lineDashOffset=mn(n.lineDashOffset,0),a.lineJoin=mn(n.lineJoin,"miter"),a.lineWidth=r,a.strokeStyle=mn(n.strokeStyle,i),a.setLineDash(mn(n.lineDash,[])),s.usePointStyle){const i={radius:m*Math.SQRT2/2,pointStyle:n.pointStyle,rotation:n.rotation,borderWidth:r},l=o.xPlus(e,p/2);Da(a,i,l,t+u,s.pointStyleWidth&&p)}else{const s=t+Math.max((d-m)/2,0),i=o.leftForLtr(e,p),l=Ka(n.borderRadius);a.beginPath(),Object.values(l).some((e=>0!==e))?Ha(a,{x:i,y:s,w:p,h:m,radius:l}):a.rect(i,s,p,m),a.fill(),0!==r&&a.stroke()}a.restore()}(o.x(N),E,y),N=((e,t,n,a)=>e===(a?"left":"right")?n:"center"===e?(t+n)/2:t)(w,N+p+u,g?N+j:this.right,e.rtl),function(e,t,n){Va(a,n.text,e,t+f/2,l,{strikethrough:n.hidden,textAlign:o.textAlign(n.textAlign)})}(o.x(N),E,y),g)h.x+=j+c;else if("string"!==typeof y.text){const e=l.lineHeight;h.y+=Bo(y,e)+c}else h.y+=b})),zr(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,n=Za(t.font),a=Qa(t.padding);if(!t.display)return;const r=Lr(e.rtl,this.left,this.width),s=this.ctx,i=t.position,o=n.size/2,l=a.top+o;let c,d=this.left,u=this.width;if(this.isHorizontal())u=Math.max(...this.lineWidths),c=this.top+l,d=da(e.align,d,this.right-u);else{const t=this.columnSizes.reduce(((e,t)=>Math.max(e,t.height)),0);c=l+da(e.align,this.top,this.bottom-t-e.labels.padding-this._computeTitleHeight())}const h=da(i,d,d+u);s.textAlign=r.textAlign(ca(i)),s.textBaseline="middle",s.strokeStyle=t.color,s.fillStyle=t.color,s.font=n.string,Va(s,t.text,h,c,n)}_computeTitleHeight(){const e=this.options.title,t=Za(e.font),n=Qa(e.padding);return e.display?t.lineHeight+n.height:0}_getLegendItemAt(e,t){let n,a,r;if(ea(e,this.left,this.right)&&ea(t,this.top,this.bottom))for(r=this.legendHitBoxes,n=0;n<r.length;++n)if(a=r[n],ea(e,a.left,a.left+a.width)&&ea(t,a.top,a.top+a.height))return this.legendItems[n];return null}handleEvent(e){const t=this.options;if(!function(e,t){if(("mousemove"===e||"mouseout"===e)&&(t.onHover||t.onLeave))return!0;if(t.onClick&&("click"===e||"mouseup"===e))return!0;return!1}(e.type,t))return;const n=this._getLegendItemAt(e.x,e.y);if("mousemove"===e.type||"mouseout"===e.type){const a=this._hoveredItem,r=((e,t)=>null!==e&&null!==t&&e.datasetIndex===t.datasetIndex&&e.index===t.index)(a,n);a&&!r&&gn(t.onLeave,[e,a,this],this),this._hoveredItem=n,n&&!r&&gn(t.onHover,[e,n,this],this)}else n&&gn(t.onClick,[e,n,this],this)}}function Bo(e,t){return t*(e.text?e.text.length:0)}var Uo={id:"legend",_element:Fo,start(e,t,n){const a=e.legend=new Fo({ctx:e.ctx,options:n,chart:e});Hs.configure(e,a,n),Hs.addBox(e,a)},stop(e){Hs.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,n){const a=e.legend;Hs.configure(e,a,n),a.options=n},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,n){const a=t.datasetIndex,r=n.chart;r.isDatasetVisible(a)?(r.hide(a),t.hidden=!0):(r.show(a),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:n,pointStyle:a,textAlign:r,color:s,useBorderRadius:i,borderRadius:o}}=e.legend.options;return e._getSortedDatasetMetas().map((e=>{const l=e.controller.getStyle(n?0:void 0),c=Qa(l.borderWidth);return{text:t[e.index].label,fillStyle:l.backgroundColor,fontColor:s,hidden:!e.visible,lineCap:l.borderCapStyle,lineDash:l.borderDash,lineDashOffset:l.borderDashOffset,lineJoin:l.borderJoinStyle,lineWidth:(c.width+c.height)/4,strokeStyle:l.borderColor,pointStyle:a||l.pointStyle,rotation:l.rotation,textAlign:r||l.textAlign,borderRadius:i&&(o||l.borderRadius),datasetIndex:e.index}}),this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class Wo extends ci{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const n=this.options;if(this.left=0,this.top=0,!n.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=e,this.height=this.bottom=t;const a=dn(n.text)?n.text.length:1;this._padding=Qa(n.padding);const r=a*Za(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=r:this.width=r}isHorizontal(){const e=this.options.position;return"top"===e||"bottom"===e}_drawArgs(e){const{top:t,left:n,bottom:a,right:r,options:s}=this,i=s.align;let o,l,c,d=0;return this.isHorizontal()?(l=da(i,n,r),c=t+e,o=r-n):("left"===s.position?(l=n+e,c=da(i,a,t),d=-.5*Pn):(l=r-e,c=da(i,t,a),d=.5*Pn),o=a-t),{titleX:l,titleY:c,maxWidth:o,rotation:d}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const n=Za(t.font),a=n.lineHeight/2+this._padding.top,{titleX:r,titleY:s,maxWidth:i,rotation:o}=this._drawArgs(a);Va(e,t.text,0,0,n,{color:t.color,maxWidth:i,rotation:o,textAlign:ca(t.align),textBaseline:"middle",translation:[r,s]})}}var Vo={id:"title",_element:Wo,start(e,t,n){!function(e,t){const n=new Wo({ctx:e.ctx,options:t,chart:e});Hs.configure(e,n,t),Hs.addBox(e,n),e.titleBlock=n}(e,n)},stop(e){const t=e.titleBlock;Hs.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,n){const a=e.titleBlock;Hs.configure(e,a,n),a.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};new WeakMap;const Ho={average(e){if(!e.length)return!1;let t,n,a=new Set,r=0,s=0;for(t=0,n=e.length;t<n;++t){const n=e[t].element;if(n&&n.hasValue()){const e=n.tooltipPosition();a.add(e.x),r+=e.y,++s}}if(0===s||0===a.size)return!1;const i=[...a].reduce(((e,t)=>e+t))/a.size;return{x:i,y:r/s}},nearest(e,t){if(!e.length)return!1;let n,a,r,s=t.x,i=t.y,o=Number.POSITIVE_INFINITY;for(n=0,a=e.length;n<a;++n){const a=e[n].element;if(a&&a.hasValue()){const e=Gn(t,a.getCenterPoint());e<o&&(o=e,r=a)}}if(r){const e=r.tooltipPosition();s=e.x,i=e.y}return{x:s,y:i}}};function qo(e,t){return t&&(dn(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function Yo(e){return("string"===typeof e||e instanceof String)&&e.indexOf("\n")>-1?e.split("\n"):e}function Jo(e,t){const{element:n,datasetIndex:a,index:r}=t,s=e.getDatasetMeta(a).controller,{label:i,value:o}=s.getLabelAndValue(r);return{chart:e,label:i,parsed:s.getParsed(r),raw:e.data.datasets[a].data[r],formattedValue:o,dataset:s.getDataset(),dataIndex:r,datasetIndex:a,element:n}}function Go(e,t){const n=e.chart.ctx,{body:a,footer:r,title:s}=e,{boxWidth:i,boxHeight:o}=t,l=Za(t.bodyFont),c=Za(t.titleFont),d=Za(t.footerFont),u=s.length,h=r.length,p=a.length,m=Qa(t.padding);let f=m.height,g=0,v=a.reduce(((e,t)=>e+t.before.length+t.lines.length+t.after.length),0);if(v+=e.beforeBody.length+e.afterBody.length,u&&(f+=u*c.lineHeight+(u-1)*t.titleSpacing+t.titleMarginBottom),v){f+=p*(t.displayColors?Math.max(o,l.lineHeight):l.lineHeight)+(v-p)*l.lineHeight+(v-1)*t.bodySpacing}h&&(f+=t.footerMarginTop+h*d.lineHeight+(h-1)*t.footerSpacing);let b=0;const y=function(e){g=Math.max(g,n.measureText(e).width+b)};return n.save(),n.font=c.string,vn(e.title,y),n.font=l.string,vn(e.beforeBody.concat(e.afterBody),y),b=t.displayColors?i+2+t.boxPadding:0,vn(a,(e=>{vn(e.before,y),vn(e.lines,y),vn(e.after,y)})),b=0,n.font=d.string,vn(e.footer,y),n.restore(),g+=m.width,{width:g,height:f}}function Xo(e,t,n,a){const{x:r,width:s}=n,{width:i,chartArea:{left:o,right:l}}=e;let c="center";return"center"===a?c=r<=(o+l)/2?"left":"right":r<=s/2?c="left":r>=i-s/2&&(c="right"),function(e,t,n,a){const{x:r,width:s}=a,i=n.caretSize+n.caretPadding;return"left"===e&&r+s+i>t.width||"right"===e&&r-s-i<0||void 0}(c,e,t,n)&&(c="center"),c}function Ko(e,t,n){const a=n.yAlign||t.yAlign||function(e,t){const{y:n,height:a}=t;return n<a/2?"top":n>e.height-a/2?"bottom":"center"}(e,n);return{xAlign:n.xAlign||t.xAlign||Xo(e,t,n,a),yAlign:a}}function Qo(e,t,n,a){const{caretSize:r,caretPadding:s,cornerRadius:i}=e,{xAlign:o,yAlign:l}=n,c=r+s,{topLeft:d,topRight:u,bottomLeft:h,bottomRight:p}=Ka(i);let m=function(e,t){let{x:n,width:a}=e;return"right"===t?n-=a:"center"===t&&(n-=a/2),n}(t,o);const f=function(e,t,n){let{y:a,height:r}=e;return"top"===t?a+=n:a-="bottom"===t?r+n:r/2,a}(t,l,c);return"center"===l?"left"===o?m+=c:"right"===o&&(m-=c):"left"===o?m-=Math.max(d,h)+r:"right"===o&&(m+=Math.max(u,p)+r),{x:Zn(m,0,a.width-t.width),y:Zn(f,0,a.height-t.height)}}function Zo(e,t,n){const a=Qa(n.padding);return"center"===t?e.x+e.width/2:"right"===t?e.x+e.width-a.right:e.x+a.left}function el(e){return qo([],Yo(e))}function tl(e,t){const n=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return n?e.override(n):e}const nl={beforeTitle:on,title(e){if(e.length>0){const t=e[0],n=t.chart.data.labels,a=n?n.length:0;if(this&&this.options&&"dataset"===this.options.mode)return t.dataset.label||"";if(t.label)return t.label;if(a>0&&t.dataIndex<a)return n[t.dataIndex]}return""},afterTitle:on,beforeBody:on,beforeLabel:on,label(e){if(this&&this.options&&"dataset"===this.options.mode)return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const n=e.formattedValue;return cn(n)||(t+=n),t},labelColor(e){const t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:on,afterBody:on,beforeFooter:on,footer:on,afterFooter:on};function al(e,t,n,a){const r=e[t].call(n,a);return"undefined"===typeof r?nl[t].call(n,a):r}class rl extends ci{static positioners=(()=>Ho)();constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,n=this.options.setContext(this.getContext()),a=n.enabled&&t.options.animation&&n.animations,r=new Qr(this.chart,a);return a._cacheable&&(this._cachedAnimations=Object.freeze(r)),r}getContext(){return this.$context||(this.$context=(e=this.chart.getContext(),t=this,n=this._tooltipItems,tr(e,{tooltip:t,tooltipItems:n,type:"tooltip"})));var e,t,n}getTitle(e,t){const{callbacks:n}=t,a=al(n,"beforeTitle",this,e),r=al(n,"title",this,e),s=al(n,"afterTitle",this,e);let i=[];return i=qo(i,Yo(a)),i=qo(i,Yo(r)),i=qo(i,Yo(s)),i}getBeforeBody(e,t){return el(al(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:n}=t,a=[];return vn(e,(e=>{const t={before:[],lines:[],after:[]},r=tl(n,e);qo(t.before,Yo(al(r,"beforeLabel",this,e))),qo(t.lines,al(r,"label",this,e)),qo(t.after,Yo(al(r,"afterLabel",this,e))),a.push(t)})),a}getAfterBody(e,t){return el(al(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:n}=t,a=al(n,"beforeFooter",this,e),r=al(n,"footer",this,e),s=al(n,"afterFooter",this,e);let i=[];return i=qo(i,Yo(a)),i=qo(i,Yo(r)),i=qo(i,Yo(s)),i}_createItems(e){const t=this._active,n=this.chart.data,a=[],r=[],s=[];let i,o,l=[];for(i=0,o=t.length;i<o;++i)l.push(Jo(this.chart,t[i]));return e.filter&&(l=l.filter(((t,a,r)=>e.filter(t,a,r,n)))),e.itemSort&&(l=l.sort(((t,a)=>e.itemSort(t,a,n)))),vn(l,(t=>{const n=tl(e.callbacks,t);a.push(al(n,"labelColor",this,t)),r.push(al(n,"labelPointStyle",this,t)),s.push(al(n,"labelTextColor",this,t))})),this.labelColors=a,this.labelPointStyles=r,this.labelTextColors=s,this.dataPoints=l,l}update(e,t){const n=this.options.setContext(this.getContext()),a=this._active;let r,s=[];if(a.length){const e=Ho[n.position].call(this,a,this._eventPosition);s=this._createItems(n),this.title=this.getTitle(s,n),this.beforeBody=this.getBeforeBody(s,n),this.body=this.getBody(s,n),this.afterBody=this.getAfterBody(s,n),this.footer=this.getFooter(s,n);const t=this._size=Go(this,n),i=Object.assign({},e,t),o=Ko(this.chart,n,i),l=Qo(n,i,o,this.chart);this.xAlign=o.xAlign,this.yAlign=o.yAlign,r={opacity:1,x:l.x,y:l.y,width:t.width,height:t.height,caretX:e.x,caretY:e.y}}else 0!==this.opacity&&(r={opacity:0});this._tooltipItems=s,this.$context=void 0,r&&this._resolveAnimations().update(this,r),e&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,n,a){const r=this.getCaretPosition(e,n,a);t.lineTo(r.x1,r.y1),t.lineTo(r.x2,r.y2),t.lineTo(r.x3,r.y3)}getCaretPosition(e,t,n){const{xAlign:a,yAlign:r}=this,{caretSize:s,cornerRadius:i}=n,{topLeft:o,topRight:l,bottomLeft:c,bottomRight:d}=Ka(i),{x:u,y:h}=e,{width:p,height:m}=t;let f,g,v,b,y,x;return"center"===r?(y=h+m/2,"left"===a?(f=u,g=f-s,b=y+s,x=y-s):(f=u+p,g=f+s,b=y-s,x=y+s),v=f):(g="left"===a?u+Math.max(o,c)+s:"right"===a?u+p-Math.max(l,d)-s:this.caretX,"top"===r?(b=h,y=b-s,f=g-s,v=g+s):(b=h+m,y=b+s,f=g+s,v=g-s),x=b),{x1:f,x2:g,x3:v,y1:b,y2:y,y3:x}}drawTitle(e,t,n){const a=this.title,r=a.length;let s,i,o;if(r){const l=Lr(n.rtl,this.x,this.width);for(e.x=Zo(this,n.titleAlign,n),t.textAlign=l.textAlign(n.titleAlign),t.textBaseline="middle",s=Za(n.titleFont),i=n.titleSpacing,t.fillStyle=n.titleColor,t.font=s.string,o=0;o<r;++o)t.fillText(a[o],l.x(e.x),e.y+s.lineHeight/2),e.y+=s.lineHeight+i,o+1===r&&(e.y+=n.titleMarginBottom-i)}}_drawColorBox(e,t,n,a,r){const s=this.labelColors[n],i=this.labelPointStyles[n],{boxHeight:o,boxWidth:l}=r,c=Za(r.bodyFont),d=Zo(this,"left",r),u=a.x(d),h=o<c.lineHeight?(c.lineHeight-o)/2:0,p=t.y+h;if(r.usePointStyle){const t={radius:Math.min(l,o)/2,pointStyle:i.pointStyle,rotation:i.rotation,borderWidth:1},n=a.leftForLtr(u,l)+l/2,c=p+o/2;e.strokeStyle=r.multiKeyBackground,e.fillStyle=r.multiKeyBackground,Ma(e,t,n,c),e.strokeStyle=s.borderColor,e.fillStyle=s.backgroundColor,Ma(e,t,n,c)}else{e.lineWidth=un(s.borderWidth)?Math.max(...Object.values(s.borderWidth)):s.borderWidth||1,e.strokeStyle=s.borderColor,e.setLineDash(s.borderDash||[]),e.lineDashOffset=s.borderDashOffset||0;const t=a.leftForLtr(u,l),n=a.leftForLtr(a.xPlus(u,1),l-2),i=Ka(s.borderRadius);Object.values(i).some((e=>0!==e))?(e.beginPath(),e.fillStyle=r.multiKeyBackground,Ha(e,{x:t,y:p,w:l,h:o,radius:i}),e.fill(),e.stroke(),e.fillStyle=s.backgroundColor,e.beginPath(),Ha(e,{x:n,y:p+1,w:l-2,h:o-2,radius:i}),e.fill()):(e.fillStyle=r.multiKeyBackground,e.fillRect(t,p,l,o),e.strokeRect(t,p,l,o),e.fillStyle=s.backgroundColor,e.fillRect(n,p+1,l-2,o-2))}e.fillStyle=this.labelTextColors[n]}drawBody(e,t,n){const{body:a}=this,{bodySpacing:r,bodyAlign:s,displayColors:i,boxHeight:o,boxWidth:l,boxPadding:c}=n,d=Za(n.bodyFont);let u=d.lineHeight,h=0;const p=Lr(n.rtl,this.x,this.width),m=function(n){t.fillText(n,p.x(e.x+h),e.y+u/2),e.y+=u+r},f=p.textAlign(s);let g,v,b,y,x,_,w;for(t.textAlign=s,t.textBaseline="middle",t.font=d.string,e.x=Zo(this,f,n),t.fillStyle=n.bodyColor,vn(this.beforeBody,m),h=i&&"right"!==f?"center"===s?l/2+c:l+2+c:0,y=0,_=a.length;y<_;++y){for(g=a[y],v=this.labelTextColors[y],t.fillStyle=v,vn(g.before,m),b=g.lines,i&&b.length&&(this._drawColorBox(t,e,y,p,n),u=Math.max(d.lineHeight,o)),x=0,w=b.length;x<w;++x)m(b[x]),u=d.lineHeight;vn(g.after,m)}h=0,u=d.lineHeight,vn(this.afterBody,m),e.y-=r}drawFooter(e,t,n){const a=this.footer,r=a.length;let s,i;if(r){const o=Lr(n.rtl,this.x,this.width);for(e.x=Zo(this,n.footerAlign,n),e.y+=n.footerMarginTop,t.textAlign=o.textAlign(n.footerAlign),t.textBaseline="middle",s=Za(n.footerFont),t.fillStyle=n.footerColor,t.font=s.string,i=0;i<r;++i)t.fillText(a[i],o.x(e.x),e.y+s.lineHeight/2),e.y+=s.lineHeight+n.footerSpacing}}drawBackground(e,t,n,a){const{xAlign:r,yAlign:s}=this,{x:i,y:o}=e,{width:l,height:c}=n,{topLeft:d,topRight:u,bottomLeft:h,bottomRight:p}=Ka(a.cornerRadius);t.fillStyle=a.backgroundColor,t.strokeStyle=a.borderColor,t.lineWidth=a.borderWidth,t.beginPath(),t.moveTo(i+d,o),"top"===s&&this.drawCaret(e,t,n,a),t.lineTo(i+l-u,o),t.quadraticCurveTo(i+l,o,i+l,o+u),"center"===s&&"right"===r&&this.drawCaret(e,t,n,a),t.lineTo(i+l,o+c-p),t.quadraticCurveTo(i+l,o+c,i+l-p,o+c),"bottom"===s&&this.drawCaret(e,t,n,a),t.lineTo(i+h,o+c),t.quadraticCurveTo(i,o+c,i,o+c-h),"center"===s&&"left"===r&&this.drawCaret(e,t,n,a),t.lineTo(i,o+d),t.quadraticCurveTo(i,o,i+d,o),t.closePath(),t.fill(),a.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,n=this.$animations,a=n&&n.x,r=n&&n.y;if(a||r){const n=Ho[e.position].call(this,this._active,this._eventPosition);if(!n)return;const s=this._size=Go(this,e),i=Object.assign({},n,this._size),o=Ko(t,e,i),l=Qo(e,i,o,t);a._to===l.x&&r._to===l.y||(this.xAlign=o.xAlign,this.yAlign=o.yAlign,this.width=s.width,this.height=s.height,this.caretX=n.x,this.caretY=n.y,this._resolveAnimations().update(this,l))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(t);const a={width:this.width,height:this.height},r={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const s=Qa(t.padding),i=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&i&&(e.save(),e.globalAlpha=n,this.drawBackground(r,e,a,t),$r(e,t.textDirection),r.y+=s.top,this.drawTitle(r,e,t),this.drawBody(r,e,t),this.drawFooter(r,e,t),zr(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const n=this._active,a=e.map((e=>{let{datasetIndex:t,index:n}=e;const a=this.chart.getDatasetMeta(t);if(!a)throw new Error("Cannot find a dataset at index "+t);return{datasetIndex:t,element:a.data[n],index:n}})),r=!bn(n,a),s=this._positionChanged(a,t);(r||s)&&(this._active=a,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const a=this.options,r=this._active||[],s=this._getActiveElements(e,r,t,n),i=this._positionChanged(s,e),o=t||!bn(s,r)||i;return o&&(this._active=s,(a.enabled||a.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),o}_getActiveElements(e,t,n,a){const r=this.options;if("mouseout"===e.type)return[];if(!a)return t.filter((e=>this.chart.data.datasets[e.datasetIndex]&&void 0!==this.chart.getDatasetMeta(e.datasetIndex).controller.getParsed(e.index)));const s=this.chart.getElementsAtEventForMode(e,r.mode,r,n);return r.reverse&&s.reverse(),s}_positionChanged(e,t){const{caretX:n,caretY:a,options:r}=this,s=Ho[r.position].call(this,e,t);return!1!==s&&(n!==s.x||a!==s.y)}}var sl={id:"tooltip",_element:rl,positioners:Ho,afterInit(e,t,n){n&&(e.tooltip=new rl({chart:e,options:n}))},beforeUpdate(e,t,n){e.tooltip&&e.tooltip.initialize(n)},reset(e,t,n){e.tooltip&&e.tooltip.initialize(n)},afterDraw(e){const t=e.tooltip;if(t&&t._willRender()){const n={tooltip:t};if(!1===e.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0}))return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",n)}},afterEvent(e,t){if(e.tooltip){const n=t.replay;e.tooltip.handleEvent(t.event,n,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:nl},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>"filter"!==e&&"itemSort"!==e&&"external"!==e,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};function il(e,t,n,a){const r=e.indexOf(t);if(-1===r)return((e,t,n,a)=>("string"===typeof t?(n=e.push(t)-1,a.unshift({index:n,label:t})):isNaN(t)&&(n=null),n))(e,t,n,a);return r!==e.lastIndexOf(t)?n:r}function ol(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}class ll extends yi{static id="category";static defaults=(()=>({ticks:{callback:ol}}))();constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const e=this.getLabels();for(const{index:n,label:a}of t)e[n]===a&&e.splice(n,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(cn(e))return null;const n=this.getLabels();return((e,t)=>null===e?null:Zn(Math.round(e),0,t))(t=isFinite(t)&&n[t]===e?t:il(n,e,mn(t,e),this._addedLabels),n.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:n,max:a}=this.getMinMax(!0);"ticks"===this.options.bounds&&(e||(n=0),t||(a=this.getLabels().length-1)),this.min=n,this.max=a}buildTicks(){const e=this.min,t=this.max,n=this.options.offset,a=[];let r=this.getLabels();r=0===e&&t===r.length-1?r:r.slice(e,t+1),this._valueRange=Math.max(r.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let s=e;s<=t;s++)a.push({value:s});return a}getLabelForValue(e){return ol.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return"number"!==typeof e&&(e=this.parse(e)),null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function cl(e,t){const n=[],{bounds:a,step:r,min:s,max:i,precision:o,count:l,maxTicks:c,maxDigits:d,includeBounds:u}=e,h=r||1,p=c-1,{min:m,max:f}=t,g=!cn(s),v=!cn(i),b=!cn(l),y=(f-m)/(d+1);let x,_,w,j,N=Un((f-m)/p/h)*h;if(N<1e-14&&!g&&!v)return[{value:m},{value:f}];j=Math.ceil(f/N)-Math.floor(m/N),j>p&&(N=Un(j*N/p/h)*h),cn(o)||(x=Math.pow(10,o),N=Math.ceil(N*x)/x),"ticks"===a?(_=Math.floor(m/N)*N,w=Math.ceil(f/N)*N):(_=m,w=f),g&&v&&r&&function(e,t){const n=Math.round(e);return n-t<=e&&n+t>=e}((i-s)/r,N/1e3)?(j=Math.round(Math.min((i-s)/N,c)),N=(i-s)/j,_=s,w=i):b?(_=g?s:_,w=v?i:w,j=l-1,N=(w-_)/j):(j=(w-_)/N,j=Bn(j,Math.round(j),N/1e3)?Math.round(j):Math.ceil(j));const E=Math.max(Yn(N),Yn(_));x=Math.pow(10,cn(o)?E:o),_=Math.round(_*x)/x,w=Math.round(w*x)/x;let S=0;for(g&&(u&&_!==s?(n.push({value:s}),_<s&&S++,Bn(Math.round((_+S*N)*x)/x,s,dl(s,y,e))&&S++):_<s&&S++);S<j;++S){const e=Math.round((_+S*N)*x)/x;if(v&&e>i)break;n.push({value:e})}return v&&u&&w!==i?n.length&&Bn(n[n.length-1].value,i,dl(i,y,e))?n[n.length-1].value=i:n.push({value:i}):v&&w!==i||n.push({value:w}),n}function dl(e,t,n){let{horizontal:a,minRotation:r}=n;const s=Hn(r),i=(a?Math.sin(s):Math.cos(s))||.001,o=.75*t*(""+e).length;return Math.min(t/i,o)}class ul extends yi{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return cn(e)||("number"===typeof e||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:n}=this.getUserBounds();let{min:a,max:r}=this;const s=e=>a=t?a:e,i=e=>r=n?r:e;if(e){const e=Fn(a),t=Fn(r);e<0&&t<0?i(0):e>0&&t>0&&s(0)}if(a===r){let t=0===r?1:Math.abs(.05*r);i(r+t),e||s(a-t)}this.min=a,this.max=r}getTickLimit(){const e=this.options.ticks;let t,{maxTicksLimit:n,stepSize:a}=e;return a?(t=Math.ceil(this.max/a)-Math.floor(this.min/a)+1,t>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${a} would result generating up to ${t} ticks. Limiting to 1000.`),t=1e3)):(t=this.computeTickLimit(),n=n||11),n&&(t=Math.min(n,t)),t}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let n=this.getTickLimit();n=Math.max(2,n);const a=cl({maxTicks:n,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:!1!==t.includeBounds},this._range||this);return"ticks"===e.bounds&&Vn(a,this,"value"),e.reverse?(a.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),a}configure(){const e=this.ticks;let t=this.min,n=this.max;if(super.configure(),this.options.offset&&e.length){const a=(n-t)/Math.max(e.length-1,1)/2;t-=a,n+=a}this._startValue=t,this._endValue=n,this._valueRange=n-t}getLabelForValue(e){return ja(e,this.chart.options.locale,this.options.ticks.format)}}class hl extends ul{static id="linear";static defaults=(()=>({ticks:{callback:Ea.formatters.numeric}}))();determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=hn(e)?e:0,this.max=hn(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,n=Hn(this.options.ticks.minRotation),a=(e?Math.sin(n):Math.cos(n))||.001,r=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,r.lineHeight/a))}getPixelForValue(e){return null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}Ea.formatters.logarithmic;Ea.formatters.numeric;const pl={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},ml=Object.keys(pl);function fl(e,t){return e-t}function gl(e,t){if(cn(t))return null;const n=e._adapter,{parser:a,round:r,isoWeekday:s}=e._parseOpts;let i=t;return"function"===typeof a&&(i=a(i)),hn(i)||(i="string"===typeof a?n.parse(i,a):n.parse(i)),null===i?null:(r&&(i="week"!==r||!Wn(s)&&!0!==s?n.startOf(i,r):n.startOf(i,"isoWeek",s)),+i)}function vl(e,t,n,a){const r=ml.length;for(let s=ml.indexOf(e);s<r-1;++s){const e=pl[ml[s]],r=e.steps?e.steps:Number.MAX_SAFE_INTEGER;if(e.common&&Math.ceil((n-t)/(r*e.size))<=a)return ml[s]}return ml[r-1]}function bl(e,t,n){if(n){if(n.length){const{lo:a,hi:r}=ta(n,t);e[n[a]>=t?n[a]:n[r]]=!0}}else e[t]=!0}function yl(e,t,n){const a=[],r={},s=t.length;let i,o;for(i=0;i<s;++i)o=t[i],r[o]=i,a.push({value:o,major:!1});return 0!==s&&n?function(e,t,n,a){const r=e._adapter,s=+r.startOf(t[0].value,a),i=t[t.length-1].value;let o,l;for(o=s;o<=i;o=+r.add(o,1,a))l=n[o],l>=0&&(t[l].major=!0);return t}(e,a,r,n):a}class xl extends yi{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.time||(e.time={}),a=this._adapter=new Es(e.adapters.date);a.init(t),jn(n.displayFormats,a.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return void 0===e?null:gl(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,n=e.time.unit||"day";let{min:a,max:r,minDefined:s,maxDefined:i}=this.getUserBounds();function o(e){s||isNaN(e.min)||(a=Math.min(a,e.min)),i||isNaN(e.max)||(r=Math.max(r,e.max))}s&&i||(o(this._getLabelBounds()),"ticks"===e.bounds&&"labels"===e.ticks.source||o(this.getMinMax(!1))),a=hn(a)&&!isNaN(a)?a:+t.startOf(Date.now(),n),r=hn(r)&&!isNaN(r)?r:+t.endOf(Date.now(),n)+1,this.min=Math.min(a,r-1),this.max=Math.max(a+1,r)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],n=e[e.length-1]),{min:t,max:n}}buildTicks(){const e=this.options,t=e.time,n=e.ticks,a="labels"===n.source?this.getLabelTimestamps():this._generate();"ticks"===e.bounds&&a.length&&(this.min=this._userMin||a[0],this.max=this._userMax||a[a.length-1]);const r=this.min,s=function(e,t,n){let a=0,r=e.length;for(;a<r&&e[a]<t;)a++;for(;r>a&&e[r-1]>n;)r--;return a>0||r<e.length?e.slice(a,r):e}(a,r,this.max);return this._unit=t.unit||(n.autoSkip?vl(t.minUnit,this.min,this.max,this._getLabelCapacity(r)):function(e,t,n,a,r){for(let s=ml.length-1;s>=ml.indexOf(n);s--){const n=ml[s];if(pl[n].common&&e._adapter.diff(r,a,n)>=t-1)return n}return ml[n?ml.indexOf(n):0]}(this,s.length,t.minUnit,this.min,this.max)),this._majorUnit=n.major.enabled&&"year"!==this._unit?function(e){for(let t=ml.indexOf(e)+1,n=ml.length;t<n;++t)if(pl[ml[t]].common)return ml[t]}(this._unit):void 0,this.initOffsets(a),e.reverse&&s.reverse(),yl(this,s,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map((e=>+e.value)))}initOffsets(){let e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=0,r=0;this.options.offset&&n.length&&(e=this.getDecimalForValue(n[0]),a=1===n.length?1-e:(this.getDecimalForValue(n[1])-e)/2,t=this.getDecimalForValue(n[n.length-1]),r=1===n.length?t:(t-this.getDecimalForValue(n[n.length-2]))/2);const s=n.length<3?.5:.25;a=Zn(a,0,s),r=Zn(r,0,s),this._offsets={start:a,end:r,factor:1/(a+1+r)}}_generate(){const e=this._adapter,t=this.min,n=this.max,a=this.options,r=a.time,s=r.unit||vl(r.minUnit,t,n,this._getLabelCapacity(t)),i=mn(a.ticks.stepSize,1),o="week"===s&&r.isoWeekday,l=Wn(o)||!0===o,c={};let d,u,h=t;if(l&&(h=+e.startOf(h,"isoWeek",o)),h=+e.startOf(h,l?"day":s),e.diff(n,t,s)>1e5*i)throw new Error(t+" and "+n+" are too far apart with stepSize of "+i+" "+s);const p="data"===a.ticks.source&&this.getDataTimestamps();for(d=h,u=0;d<n;d=+e.add(d,i,s),u++)bl(c,d,p);return d!==n&&"ticks"!==a.bounds&&1!==u||bl(c,d,p),Object.keys(c).sort(fl).map((e=>+e))}getLabelForValue(e){const t=this._adapter,n=this.options.time;return n.tooltipFormat?t.format(e,n.tooltipFormat):t.format(e,n.displayFormats.datetime)}format(e,t){const n=this.options.time.displayFormats,a=this._unit,r=t||n[a];return this._adapter.format(e,r)}_tickFormatFunction(e,t,n,a){const r=this.options,s=r.ticks.callback;if(s)return gn(s,[e,t,n],this);const i=r.time.displayFormats,o=this._unit,l=this._majorUnit,c=o&&i[o],d=l&&i[l],u=n[t],h=l&&d&&u&&u.major;return this._adapter.format(e,a||(h?d:c))}generateTickLabels(e){let t,n,a;for(t=0,n=e.length;t<n;++t)a=e[t],a.label=this._tickFormatFunction(a.value,t,e)}getDecimalForValue(e){return null===e?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,n=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+n)*t.factor)}getValueForPixel(e){const t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+n*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,n=this.ctx.measureText(e).width,a=Hn(this.isHorizontal()?t.maxRotation:t.minRotation),r=Math.cos(a),s=Math.sin(a),i=this._resolveTickFontOptions(0).size;return{w:n*r+i*s,h:n*s+i*r}}_getLabelCapacity(e){const t=this.options.time,n=t.displayFormats,a=n[t.unit]||n.millisecond,r=this._tickFormatFunction(e,0,yl(this,[e],this._majorUnit),a),s=this._getLabelSize(r),i=Math.floor(this.isHorizontal()?this.width/s.w:this.height/s.h)-1;return i>0?i:1}getDataTimestamps(){let e,t,n=this._cache.data||[];if(n.length)return n;const a=this.getMatchingVisibleMetas();if(this._normalized&&a.length)return this._cache.data=a[0].controller.getAllParsedValues(this);for(e=0,t=a.length;e<t;++e)n=n.concat(a[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(n)}getLabelTimestamps(){const e=this._cache.labels||[];let t,n;if(e.length)return e;const a=this.getLabels();for(t=0,n=a.length;t<n;++t)e.push(gl(this,a[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return ia(e.sort(fl))}}const _l="label";function wl(e,t){"function"===typeof e?e(t):e&&(e.current=t)}function jl(e,t){e.labels=t}function Nl(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_l;const a=[];e.datasets=t.map((t=>{const r=e.datasets.find((e=>e[n]===t[n]));return r&&t.data&&!a.includes(r)?(a.push(r),Object.assign(r,t),r):{...t}}))}function El(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_l;const n={labels:[],datasets:[]};return jl(n,e.labels),Nl(n,e.datasets,t),n}function Sl(e,t){const{height:n=150,width:a=300,redraw:s=!1,datasetIdKey:i,type:o,data:l,options:c,plugins:d=[],fallbackContent:u,updateMode:h,...p}=e,m=(0,r.useRef)(null),f=(0,r.useRef)(null),g=()=>{m.current&&(f.current=new Xi(m.current,{type:o,data:El(l,i),options:c&&{...c},plugins:d}),wl(t,f.current))},v=()=>{wl(t,null),f.current&&(f.current.destroy(),f.current=null)};return(0,r.useEffect)((()=>{!s&&f.current&&c&&function(e,t){const n=e.options;n&&t&&Object.assign(n,t)}(f.current,c)}),[s,c]),(0,r.useEffect)((()=>{!s&&f.current&&jl(f.current.config.data,l.labels)}),[s,l.labels]),(0,r.useEffect)((()=>{!s&&f.current&&l.datasets&&Nl(f.current.config.data,l.datasets,i)}),[s,l.datasets]),(0,r.useEffect)((()=>{f.current&&(s?(v(),setTimeout(g)):f.current.update(h))}),[s,c,l.labels,l.datasets,h]),(0,r.useEffect)((()=>{f.current&&(v(),setTimeout(g))}),[o]),(0,r.useEffect)((()=>(g(),()=>v())),[]),r.createElement("canvas",{ref:m,role:"img",height:n,width:a,...p},u)}const kl=(0,r.forwardRef)(Sl);function Cl(e,t){return Xi.register(t),(0,r.forwardRef)(((t,n)=>r.createElement(kl,{...t,ref:n,type:e})))}const Al=Cl("line",_s),Tl=Cl("bar",ys),Pl=Cl("pie",ws);Xi.register(no,sl,Uo,Vo);const Il={pending:"#FBBD23",in_review:"#D926AA",approved:"#36D399",rejected:"#F87272",completed:"#570DF8",cancelled:"#6E6E6E",por_dispersar:"#62A0EA",expired:"#FF5757",new:"#3ABFF8",default:"#cccccc"},Ol={pending:"Pendiente",in_review:"En Revisi\xf3n",approved:"Aprobado",rejected:"Rechazado",completed:"Completado",cancelled:"Cancelado",por_dispersar:"Por Dispersar",expired:"Expirado",new:"Nuevo",solicitud:"Pendiente",default:"Desconocido"},Rl=e=>{let{data:t,title:n="Distribuci\xf3n por Estado",height:a=240,showLegend:r=!0,className:s=""}=e;if(!t||0===t.length)return(0,Le.jsx)("div",{className:"flex items-center justify-center h-full bg-base-200 rounded-lg",children:(0,Le.jsx)("p",{className:"text-sm text-gray-500",children:"Sin datos disponibles"})});const i={};t.forEach((e=>{const t=(e=>{const t=e.toLowerCase();return t.includes("pend")||"new"===t||"solicitud"===t?"pending":t.includes("review")||t.includes("revis")?"in_review":t.includes("aprob")||t.includes("aprov")?"approved":t.includes("recha")||t.includes("reject")?"rejected":t.includes("comple")?"completed":t.includes("cancel")?"cancelled":t.includes("disper")?"por_dispersar":t.includes("expir")?"expired":"default"})(e.status);i[t]||(i[t]=0),i[t]+=e.count}));const o=Object.keys(i),l=Object.values(i),c=o.map((e=>Il[e]||Il.default)),d={labels:o.map((e=>Ol[e]||e)),datasets:[{data:l,backgroundColor:c,borderColor:c,borderWidth:1}]},u={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:r,position:"right",labels:{boxWidth:15,padding:15,font:{size:12}}},title:{display:!!n,text:n,font:{size:16}},tooltip:{callbacks:{label:e=>{const t=e.label||"",n=e.raw||0,a=l.reduce(((e,t)=>e+t),0);return`${t}: ${n} (${Math.round(n/a*100)}%)`}}}}};return(0,Le.jsx)("div",{className:`chart-container ${s}`,style:{height:`${a}px`},children:(0,Le.jsx)(Pl,{data:d,options:u})})};Xi.register(ll,hl,mo,ho,Vo,sl,Uo,$o);const Ml=e=>{let{data:t,title:n="Solicitudes por Mes",height:a=300,className:s="",color:i="rgba(53, 162, 235, 0.7)"}=e;const[o,l]=(0,r.useState)({labels:[],datasets:[{label:"Solicitudes",data:[],borderColor:"rgba(53, 162, 235, 0.8)",backgroundColor:"rgba(53, 162, 235, 0.2)",fill:!0,tension:.3}]});(0,r.useEffect)((()=>{if(!t||0===t.length)return;const e=[...t].sort(((e,t)=>e.month.localeCompare(t.month))),n=e.map((e=>{const[t,n]=e.month.split("-");return`${["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][new Date(parseInt(t),parseInt(n)-1,1).getMonth()]} ${t}`})),a=e.map((e=>e.count));l({labels:n,datasets:[{label:"Solicitudes",data:a,borderColor:i,backgroundColor:i.replace("0.7","0.1"),fill:!0,tension:.3}]})}),[t,i]);const c={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!!n,text:n,font:{size:16}},tooltip:{callbacks:{label:e=>`Solicitudes: ${e.parsed.y}`}}},scales:{y:{beginAtZero:!0,ticks:{precision:0}},x:{grid:{display:!1}}}};return(0,Le.jsx)("div",{className:`chart-container ${s}`,style:{height:`${a}px`},children:t&&t.length>0?(0,Le.jsx)(Al,{data:o,options:c}):(0,Le.jsx)("div",{className:"flex items-center justify-center h-full bg-base-200 rounded-lg",children:(0,Le.jsx)("p",{className:"text-sm text-gray-500",children:"Sin datos disponibles"})})})};Xi.register(ll,hl,_o,Vo,sl,Uo);const Dl=e=>{let{data:t,title:n="Distribuci\xf3n por Monto",height:a=300,className:s=""}=e;const[i,o]=(0,r.useState)({labels:[],datasets:[{label:"Solicitudes",data:[],backgroundColor:"rgba(255, 159, 64, 0.8)",borderColor:"rgba(255, 159, 64, 1)",borderWidth:1}]});(0,r.useEffect)((()=>{if(!t||0===t.length)return;const e=[...t].sort(((e,t)=>{const n=e=>{const t=e.match(/(\d+)/);return t?parseInt(t[1],10):0};return n(e.range)-n(t.range)})),n=e.map((e=>e.range)),a=e.map((e=>e.count)),r=e.map(((t,n)=>{const a=n/(e.length-1||1);return`rgba(${Math.round(255-100*a)}, ${Math.round(120+60*a)}, ${Math.round(50+100*a)}, 0.8)`}));o({labels:n,datasets:[{label:"Solicitudes",data:a,backgroundColor:r,borderColor:r.map((e=>e.replace("0.8","1"))),borderWidth:1}]})}),[t]);const l={indexAxis:"y",responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!!n,text:n,font:{size:16}},tooltip:{callbacks:{label:e=>`Solicitudes: ${e.parsed.x}`}}},scales:{x:{beginAtZero:!0,ticks:{precision:0}},y:{grid:{display:!1}}}};return(0,Le.jsx)("div",{className:`chart-container ${s}`,style:{height:`${a}px`},children:t&&t.length>0?(0,Le.jsx)(Tl,{data:i,options:l}):(0,Le.jsx)("div",{className:"flex items-center justify-center h-full bg-base-200 rounded-lg",children:(0,Le.jsx)("p",{className:"text-sm text-gray-500",children:"Sin datos disponibles"})})})};Xi.register(ll,hl,_o,Vo,sl,Uo);const Ll=e=>{let{data:t,title:n="Rendimiento de Asesores",height:a=350,className:s="",maxBars:i=10}=e;const[o,l]=(0,r.useState)({labels:[],datasets:[]}),[c,d]=(0,r.useState)([]);(0,r.useEffect)((()=>{if(!t||0===t.length)return;const e=[...t].sort(((e,t)=>t.total_applications-e.total_applications)),n=e.slice(0,i),a=n.map((e=>e.advisor_name)),r=n.map((e=>e.total_applications)),s=n.map((e=>e.approved_applications||0));d(a),l({labels:a,datasets:[{label:"Total Solicitudes",data:r,backgroundColor:"rgba(53, 162, 235, 0.7)",borderColor:"rgba(53, 162, 235, 1)",borderWidth:1},{label:"Aprobadas",data:s,backgroundColor:"rgba(75, 192, 192, 0.7)",borderColor:"rgba(75, 192, 192, 1)",borderWidth:1}]})}),[t,i]);const u={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:!!n,text:n,font:{size:16}},tooltip:{callbacks:{label:e=>`${e.dataset.label||""}: ${e.parsed.y}`}}},scales:{y:{beginAtZero:!0,ticks:{precision:0}},x:{ticks:{callback:function(e,t){const n=c[t];return(null===n||void 0===n?void 0:n.length)>12?n.substr(0,10)+"...":n}}}}};return(0,Le.jsx)("div",{className:`chart-container ${s}`,style:{height:`${a}px`},children:t&&t.length>0?(0,Le.jsx)(Tl,{data:o,options:u}):(0,Le.jsx)("div",{className:"flex items-center justify-center h-full bg-base-200 rounded-lg",children:(0,Le.jsx)("p",{className:"text-sm text-gray-500",children:"Sin datos disponibles"})})})},$l={APPLICATIONS:"applications",APPLICATION_HISTORY:"application_history",COMPANIES:"companies",CLIENTS:"users",USERS:"users",ADVISORS:"advisors",COMPANY_ADMINS:"company_admins",DOCUMENTS:"documents",COMMENTS:"comments",MESSAGES:"messages"},zl=async e=>{try{const t="http://localhost:3100/query",n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e})});if(!n.ok){const e=await n.text();let t;try{t=JSON.parse(e)}catch{t=e}const a=JSON.stringify(t);if(a.includes("relation")&&a.includes("does not exist"))return console.warn("Tabla no encontrada en la base de datos:",a),[];throw new Error(`Error al ejecutar la consulta: ${n.statusText}. Detalles: ${a}`)}return(await n.json()).data||[]}catch(t){const e=t instanceof Error?t.message:String(t);if(e.includes("relation")&&e.includes("does not exist"))return console.warn("Error ejecutando consulta - tabla no existe:",e),[];throw console.error("Error ejecutando consulta:",t),t}},Fl=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{dateFrom:t,dateTo:n,companyId:a,advisorId:r,includeSimulations:s=!1}=e;let i="";t&&(i+=` AND created_at >= '${t}'`),n&&(i+=` AND created_at <= '${n}'`);let o="";a&&(o=` AND company_id = '${a}'`);let l="";r&&(l=` AND assigned_to = '${r}'`);let c="";s||(c=" AND application_type != 'product_simulations'");try{var d,u,h,p;const e=`\n      SELECT COUNT(*) as total \n      FROM ${$l.APPLICATIONS} \n      WHERE 1=1 ${i} ${o} ${l} ${c}\n    `;let t;try{t=await zl(e)}catch(f){console.error("Error al obtener total de aplicaciones:",f),t=[{total:0}]}const n=(null===(d=t[0])||void 0===d?void 0:d.total)||0,a=`\n      SELECT status, COUNT(*) as count \n      FROM ${$l.APPLICATIONS} \n      WHERE 1=1 ${i} ${o} ${l} ${c}\n      GROUP BY status\n    `;let s;try{s=await zl(a)}catch(f){console.error("Error al obtener aplicaciones por estado:",f),s=[]}const g={};s.forEach((e=>{g[e.status]=parseInt(e.count)}));const v=g.pending||0,b=g.approved||0,y=g.rejected||0,x=`\n      SELECT \n        AVG(amount) as avg_amount, \n        MIN(amount) as min_amount, \n        MAX(amount) as max_amount \n      FROM ${$l.APPLICATIONS} \n      WHERE 1=1 ${i} ${o} ${l} ${c}\n    `;let _;try{_=await zl(x)}catch(f){console.error("Error al obtener estad\xedsticas de montos:",f),_=[{avg_amount:0,min_amount:0,max_amount:0}]}const w=parseFloat(null===(u=_[0])||void 0===u?void 0:u.avg_amount)||0,j=parseFloat(null===(h=_[0])||void 0===h?void 0:h.min_amount)||0,N=parseFloat(null===(p=_[0])||void 0===p?void 0:p.max_amount)||0,E=`\n      SELECT id, client_name, company_name, created_at, status, amount, application_type\n      FROM ${$l.APPLICATIONS} \n      WHERE 1=1 ${i} ${o} ${l} ${c}\n      AND application_type = 'selected_plans'\n      ORDER BY created_at DESC \n      LIMIT 5\n    `;let S;try{S=await zl(E)}catch(f){console.error("Error al obtener aplicaciones recientes:",f),S=[]}const k=`\n      SELECT \n        TO_CHAR(created_at, 'YYYY-MM') as month, \n        COUNT(*) as count \n      FROM ${$l.APPLICATIONS} \n      WHERE 1=1 ${i} ${o} ${l} ${c}\n      GROUP BY month \n      ORDER BY month\n    `;let C;try{C=await zl(k)}catch(f){console.error("Error al obtener aplicaciones por mes:",f),C=[]}const A={};C.forEach((e=>{A[e.month]=parseInt(e.count)}));let T=[];if(!r){const e=`\n        SELECT \n          a.assigned_to as advisor_id, \n          u.name as advisor_name,\n          COUNT(*) as total_applications,\n          SUM(CASE WHEN a.status = 'approved' THEN 1 ELSE 0 END) as approved_applications,\n          SUM(CASE WHEN a.status = 'rejected' THEN 1 ELSE 0 END) as rejected_applications\n        FROM ${$l.APPLICATIONS} a\n        LEFT JOIN ${$l.ADVISORS} u ON a.assigned_to = u.id\n        WHERE 1=1 ${i} ${o} ${c}\n        GROUP BY a.assigned_to, u.name\n        ORDER BY total_applications DESC\n      `;try{T=(await zl(e)).map((e=>({advisorId:e.advisor_id,advisorName:e.advisor_name||"Desconocido",totalApplications:parseInt(e.total_applications)||0,approvedApplications:parseInt(e.approved_applications)||0,rejectedApplications:parseInt(e.rejected_applications)||0,approvalRate:e.total_applications>0?parseInt(e.approved_applications)/parseInt(e.total_applications)*100:0})))}catch(f){console.error("Error al obtener rendimiento de asesores:",f)}}let P=0;const I=`\n      SELECT COUNT(DISTINCT source_id) as total \n      FROM ${$l.APPLICATIONS} \n      WHERE source_id IS NOT NULL ${i} ${o} ${l} ${c}\n    `;try{var m;const e=await zl(I);P=parseInt(null===(m=e[0])||void 0===m?void 0:m.total)||0}catch(f){console.error("Error al obtener total de clientes:",f)}return{totalApplications:parseInt(n),pendingApplications:v,approvedApplications:b,rejectedApplications:y,averageAmount:w,minAmount:j,maxAmount:N,recentApplications:S,applicationsByStatus:g,applicationsByMonth:A,advisorsPerformance:T,totalClients:P}}catch(f){return console.error("Error obteniendo estad\xedsticas del dashboard:",f),{totalApplications:0,pendingApplications:0,approvedApplications:0,rejectedApplications:0,averageAmount:0,minAmount:0,maxAmount:0,recentApplications:[],applicationsByStatus:{},applicationsByMonth:{},totalClients:0}}},Bl=()=>{const e=ne(),{user:t}=Ue(),[n,a]=(0,r.useState)(!0),[s,i]=(0,r.useState)(null),[o,l]=(0,r.useState)(null),[c,d]=(0,r.useState)(!1),u=e=>{const t="string"===typeof e?parseFloat(e):e;return new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:2,maximumFractionDigits:2}).format(t)},h=e=>"conversionRate"in e&&"number"===typeof e.conversionRate;(0,r.useEffect)((()=>{if(!t)return void e("/login");(async()=>{try{let n;a(!0),l(null),d(!1);try{n=t.role===Re?await async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{var n,a,r,s,i,l,c,d,u,h,p,m;let b="";t||(b=" AND application_type != 'product_simulations'");const y=`\n      SELECT COUNT(*) as total \n      FROM ${$l.APPLICATIONS} \n      WHERE assigned_to = '${e}'\n      ${b}\n    `,x=await zl(y),_=parseInt((null===(n=x[0])||void 0===n?void 0:n.total)||"0"),w=`\n      SELECT status, COUNT(*) as count \n      FROM ${$l.APPLICATIONS} \n      WHERE assigned_to = '${e}'\n      ${b}\n      GROUP BY status\n    `,j=(await zl(w)).map((e=>({status:e.status,count:parseInt(e.count)}))),N=`\n      SELECT \n        AVG(amount) as avg_amount, \n        MIN(amount) as min_amount, \n        MAX(amount) as max_amount \n      FROM ${$l.APPLICATIONS} \n      WHERE amount IS NOT NULL\n      AND assigned_to = '${e}'\n      ${b}\n    `,E=await zl(N),S=parseFloat((null===(a=E[0])||void 0===a?void 0:a.avg_amount)||"0"),k=parseFloat((null===(r=E[0])||void 0===r?void 0:r.min_amount)||"0"),C=parseFloat((null===(s=E[0])||void 0===s?void 0:s.max_amount)||"0"),A=`\n      SELECT \n        TO_CHAR(created_at, 'YYYY-MM') as month,\n        COUNT(*) as count\n      FROM ${$l.APPLICATIONS}\n      WHERE assigned_to = '${e}'\n      ${b}\n      GROUP BY TO_CHAR(created_at, 'YYYY-MM')\n      ORDER BY month\n    `;let T=[];try{T=(await zl(A)).map((e=>({month:e.month,count:parseInt(e.count)})))}catch(o){console.error(`Error al obtener aplicaciones por mes para asesor ${e}:`,o),T=[]}let P=0;try{var f;const t=`\n        SELECT COUNT(DISTINCT u.id) as total \n        FROM ${$l.USERS} u\n        JOIN ${$l.APPLICATIONS} a ON a.source_id = u.id\n        WHERE a.assigned_to = '${e}'\n        ${b}\n      `,n=await zl(t);P=parseInt((null===(f=n[0])||void 0===f?void 0:f.total)||"0")}catch(o){try{var g;const t=`\n          SELECT COUNT(DISTINCT client_name) as total \n          FROM ${$l.APPLICATIONS} \n          WHERE assigned_to = '${e}'\n          ${b}\n        `,n=await zl(t);P=parseInt((null===(g=n[0])||void 0===g?void 0:g.total)||"0")}catch(v){console.error(`Error counting clients for advisor ${e}:`,v),P=0}}const I=`\n      SELECT COUNT(DISTINCT company_id) as total \n      FROM ${$l.APPLICATIONS} \n      WHERE assigned_to = '${e}'\n      ${b}\n    `,O=await zl(I),R=parseInt((null===(i=O[0])||void 0===i?void 0:i.total)||"0"),M=`\n      SELECT \n        COUNT(*) FILTER (WHERE status IN ('approved', 'APROBADO', 'completed')) as approved,\n        COUNT(*) as total\n      FROM ${$l.APPLICATIONS} \n      WHERE assigned_to = '${e}'\n      ${b}\n    `,D=await zl(M),L=parseInt((null===(l=D[0])||void 0===l?void 0:l.approved)||"0"),$=parseInt((null===(c=D[0])||void 0===c?void 0:c.total)||"0"),z=$>0?L/$*100:0,F=`\n      SELECT COUNT(*) as count\n      FROM ${$l.APPLICATIONS}\n      WHERE assigned_to = '${e}'\n      AND status IN ('approved', 'APROBADO', 'completed')\n      ${b}\n    `,B=await zl(F),U=parseInt((null===(d=B[0])||void 0===d?void 0:d.count)||"0"),W=`\n      SELECT COUNT(*) as count\n      FROM ${$l.APPLICATIONS}\n      WHERE assigned_to = '${e}'\n      AND status IN ('rejected', 'RECHAZADO')\n      ${b}\n    `,V=await zl(W),H=parseInt((null===(u=V[0])||void 0===u?void 0:u.count)||"0"),q=`\n      SELECT COUNT(*) as count\n      FROM ${$l.APPLICATIONS}\n      WHERE assigned_to = '${e}'\n      AND status IN ('pending', 'PENDIENTE', 'review', 'REVISION')\n      ${b}\n    `,Y=await zl(q),J=parseInt((null===(h=Y[0])||void 0===h?void 0:h.count)||"0"),G=`\n      SELECT \n        COUNT(*) FILTER (WHERE \n          (approved_by_advisor = false AND approved_by_company = false) OR\n          (approved_by_advisor = true AND approved_by_company = false) OR\n          (approved_by_advisor = false AND approved_by_company = true)\n        ) as pending_approval\n      FROM ${$l.APPLICATIONS}\n      WHERE assigned_to = '${e}'\n      ${b}\n    `,X=await zl(G),K=parseInt((null===(p=X[0])||void 0===p?void 0:p.pending_approval)||"0"),Q=`\n      SELECT AVG(EXTRACT(EPOCH FROM (approval_date_advisor - created_at))/86400) as avg_days\n      FROM ${$l.APPLICATIONS} \n      WHERE assigned_to = '${e}'\n      AND approval_date_advisor IS NOT NULL\n      ${b}\n    `,Z=await zl(Q),ee=parseFloat((null===(m=Z[0])||void 0===m?void 0:m.avg_days)||"0");let te=[];try{const t=`\n        SELECT id, created_at, client_name, status, amount, company_name, application_type\n        FROM ${$l.APPLICATIONS}\n        WHERE assigned_to = '${e}'\n        AND application_type = 'selected_plans'\n        ORDER BY created_at DESC\n        LIMIT 10\n      `;te=await zl(t),te=te.map((e=>(e.application_type||(e.status&&e.status.toLowerCase().includes("simul")?e.application_type="product_simulations":e.status&&e.status.toLowerCase().includes("solicit")&&(e.application_type="selected_plans")),e)))}catch(o){console.error(`Error al obtener aplicaciones recientes del asesor ${e}:`,o),te=[]}return{totalApplications:_,applicationsByStatus:j,averageAmount:S,minAmount:k,maxAmount:C,recentApplications:te,applicationsByMonth:T,totalApproved:U,totalRejected:H,totalPending:J,pendingApproval:K,totalClients:P,totalCompanies:R,conversionRate:z,avgTimeToApproval:ee,advisorId:e,advisorName:"",pendingApplications:J,approvedApplications:U,rejectedApplications:H}}catch(o){throw console.error(`Error al obtener estad\xedsticas del asesor ${e}:`,o),o}}(t.id,!1):t.role===Me&&t.entityId?await async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{var n,a,r,s,i;let l="";t||(l=" AND application_type != 'product_simulations'");const c=await Fl({companyId:e,includeSimulations:t}),d=`\n      SELECT COUNT(*) as total \n      FROM ${$l.APPLICATIONS} \n      WHERE company_id = '${e}'\n      ${l}\n    `,u=await zl(d),h=parseInt((null===(n=u[0])||void 0===n?void 0:n.total)||"0"),p=`\n      SELECT status, COUNT(*) as count \n      FROM ${$l.APPLICATIONS} \n      WHERE company_id = '${e}'\n      ${l}\n      GROUP BY status\n    `,m=(await zl(p)).map((e=>({status:e.status,count:parseInt(e.count)}))),f=`\n      SELECT COUNT(DISTINCT assigned_to) as total \n      FROM ${$l.APPLICATIONS} \n      WHERE company_id = '${e}'\n      ${l}\n    `,g=await zl(f),v=parseInt((null===(a=g[0])||void 0===a?void 0:a.total)||"0"),b=`\n      SELECT COUNT(DISTINCT client_name) as total \n      FROM ${$l.APPLICATIONS} \n      WHERE company_id = '${e}'\n      ${l}\n    `,y=await zl(b),x=parseInt((null===(r=y[0])||void 0===r?void 0:r.total)||"0"),_=`\n      SELECT AVG(EXTRACT(EPOCH FROM (approval_date_company - created_at))/86400) as avg_days\n      FROM ${$l.APPLICATIONS} \n      WHERE company_id = '${e}'\n      AND approval_date_company IS NOT NULL\n      ${l}\n    `,w=await zl(_),j=parseFloat((null===(s=w[0])||void 0===s?void 0:s.avg_days)||"0");let N=[];try{const t=`\n        SELECT id, created_at, client_name, status, amount, assigned_to, application_type\n        FROM ${$l.APPLICATIONS}\n        WHERE company_id = '${e}'\n        AND application_type = 'selected_plans'\n        ORDER BY created_at DESC\n        LIMIT 10\n      `;N=await zl(t),N=N.map((e=>(e.application_type||(e.status&&e.status.toLowerCase().includes("simul")?e.application_type="product_simulations":e.status&&e.status.toLowerCase().includes("solicit")&&(e.application_type="selected_plans")),e)))}catch(o){console.error(`Error al obtener aplicaciones recientes de la empresa ${e}:`,o),N=[{id:"1",created_at:(new Date).toISOString(),client_name:"Cliente de Empresa",status:"pending",amount:"15000",assigned_to:"Asesor Asignado",application_type:"selected_plans"}]}return{...c,totalApplications:h,applicationsByStatus:m,recentApplications:N,totalAdvisors:v,totalClientsCompany:x,avgApprovalTime:j,pendingApplications:parseInt((null===(i=c.pendingApplications)||void 0===i?void 0:i.toString())||"0"),applicationsByMonth:Array.isArray(c.applicationsByMonth)?c.applicationsByMonth:Object.entries(c.applicationsByMonth||{}).map((e=>{let[t,n]=e;return{month:t,count:Number(n)}}))}}catch(o){throw console.error(`Error al obtener estad\xedsticas de la empresa ${e}:`,o),o}}(t.entityId,!1):await Fl({includeSimulations:!1})}catch(e){console.error("Error fetching dashboard stats:",e),n={totalApplications:0,pendingApplications:0,approvedApplications:0,rejectedApplications:0,averageAmount:0,minAmount:0,maxAmount:0,recentApplications:[],applicationsByStatus:[{status:"approved",count:9},{status:"pending",count:25},{status:"in_review",count:12},{status:"rejected",count:5},{status:"completed",count:8}],applicationsByMonth:[{month:"2023-01",count:5},{month:"2023-02",count:10},{month:"2023-03",count:15}],totalClients:0}}i(n)}catch(n){console.error("Error al cargar estad\xedsticas:",n),l("Error al cargar las estad\xedsticas del dashboard. Intente refrescar la p\xe1gina.")}finally{a(!1)}})()}),[e,t]);const p=e=>ft.APPLICATION_TYPE_LABELS[e]||e;return n?(0,Le.jsx)(_t,{children:(0,Le.jsx)("div",{className:"flex justify-center items-center h-full p-8",children:(0,Le.jsx)("div",{className:"spinner-border text-primary",role:"status",children:(0,Le.jsx)("span",{className:"loading loading-spinner loading-lg"})})})}):o?(0,Le.jsx)(_t,{children:(0,Le.jsx)("div",{className:"p-8",children:(0,Le.jsx)("div",{className:"alert alert-error",children:(0,Le.jsx)("span",{children:o})})})}):s?(0,Le.jsx)(_t,{children:(0,Le.jsxs)("div",{className:"p-6 space-y-6",children:[(0,Le.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Dashboard"}),c&&(0,Le.jsx)("div",{className:"alert alert-warning mb-4",children:(0,Le.jsx)("span",{children:"Algunos datos no pudieron cargarse completamente. Se muestran datos parciales o de ejemplo."})}),o&&(0,Le.jsx)("div",{className:"alert alert-error mb-4",children:(0,Le.jsx)("span",{children:o})}),(0,Le.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,Le.jsx)(St,{title:"Total de Solicitudes",value:s.totalApplications,icon:(0,Le.jsx)(lt,{className:"h-5 w-5"}),color:"blue"}),(0,Le.jsx)(St,{title:"Solicitudes Aprobadas",value:(h(s),s.approvedApplications),previousValue:0,icon:(0,Le.jsx)(dt,{className:"h-5 w-5"}),color:"green"}),(0,Le.jsx)(St,{title:"Monto Promedio",value:s.averageAmount,formatValue:u,icon:(0,Le.jsx)(ht,{className:"h-5 w-5"}),color:"indigo"}),h(s)?(0,Le.jsx)(St,{title:"Tasa de Conversi\xf3n",value:s.conversionRate,isPercentage:!0,icon:(0,Le.jsx)(mt,{className:"h-5 w-5"}),color:"purple"}):(0,Le.jsx)(St,{title:"Total de Clientes",value:"totalClients"in s&&s.totalClients?Number(s.totalClients):"No clients",icon:(0,Le.jsx)(mt,{className:"h-5 w-5"}),color:"purple"})]}),(0,Le.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mt-6",children:[(0,Le.jsx)("div",{className:"card bg-base-100 shadow-md",children:(0,Le.jsxs)("div",{className:"card-body",children:[(0,Le.jsx)("h2",{className:"card-title text-lg font-semibold",children:"Solicitudes por Mes"}),s.applicationsByMonth&&Array.isArray(s.applicationsByMonth)&&(0,Le.jsx)(Ml,{data:s.applicationsByMonth.map((e=>({month:String(e.month||""),count:Number(e.count||0)}))),height:300,title:""})]})}),(0,Le.jsx)("div",{className:"card bg-base-100 shadow-md",children:(0,Le.jsxs)("div",{className:"card-body",children:[(0,Le.jsx)("h2",{className:"card-title text-lg font-semibold",children:"Distribuci\xf3n por Estado"}),(0,Le.jsx)(Rl,{data:Array.isArray(s.applicationsByStatus)?s.applicationsByStatus.map((e=>({status:String(e.status||""),count:Number(e.count||0)}))):Object.entries(s.applicationsByStatus).map((e=>{let[t,n]=e;return{status:t,count:Number(n)}})),height:300,title:""})]})})]}),(0,Le.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mt-4",children:[(0,Le.jsx)("div",{className:"card bg-base-100 shadow-md",children:(0,Le.jsxs)("div",{className:"card-body",children:[(0,Le.jsx)("h2",{className:"card-title text-lg font-semibold",children:"Distribuci\xf3n por Monto"}),s.amountRanges&&(0,Le.jsx)(Dl,{data:s.amountRanges,height:300,title:""})]})}),(null===t||void 0===t?void 0:t.role)===Oe&&(0,Le.jsx)("div",{className:"card bg-base-100 shadow-md",children:(0,Le.jsxs)("div",{className:"card-body",children:[(0,Le.jsx)("h2",{className:"card-title text-lg font-semibold",children:"Rendimiento de Asesores"}),s.advisorPerformance&&(0,Le.jsx)(Ll,{data:s.advisorPerformance,height:300,title:"",maxBars:8})]})}),h(s)&&(0,Le.jsx)("div",{className:"card bg-base-100 shadow-md",children:(0,Le.jsxs)("div",{className:"card-body",children:[(0,Le.jsx)("h2",{className:"card-title text-lg font-semibold",children:"Resumen de Solicitudes"}),(0,Le.jsxs)("div",{className:"stats stats-vertical shadow",children:[(0,Le.jsxs)("div",{className:"stat",children:[(0,Le.jsx)("div",{className:"stat-title",children:"Solicitudes Aprobadas"}),(0,Le.jsx)("div",{className:"stat-value text-success",children:s.approvedApplications})]}),(0,Le.jsxs)("div",{className:"stat",children:[(0,Le.jsx)("div",{className:"stat-title",children:"Solicitudes Rechazadas"}),(0,Le.jsx)("div",{className:"stat-value text-error",children:s.rejectedApplications})]}),(0,Le.jsxs)("div",{className:"stat",children:[(0,Le.jsx)("div",{className:"stat-title",children:"Solicitudes Pendientes"}),(0,Le.jsx)("div",{className:"stat-value text-warning",children:s.pendingApplications})]})]})]})})]}),(0,Le.jsx)("div",{className:"card bg-base-100 shadow-md mt-6",children:(0,Le.jsxs)("div",{className:"card-body",children:[(0,Le.jsx)("h2",{className:"card-title text-lg font-semibold",children:"Solicitudes Recientes"}),(0,Le.jsx)("div",{className:"overflow-x-auto",children:(0,Le.jsxs)("table",{className:"table table-zebra w-full",children:[(0,Le.jsx)("thead",{children:(0,Le.jsxs)("tr",{children:[(0,Le.jsx)("th",{children:"Cliente"}),(0,Le.jsx)("th",{children:"Empresa"}),(0,Le.jsx)("th",{children:"Tipo"}),(0,Le.jsx)("th",{children:"Monto"}),(0,Le.jsx)("th",{children:"Estado"}),(0,Le.jsx)("th",{children:"Fecha y Hora"})]})}),(0,Le.jsx)("tbody",{children:s.recentApplications&&s.recentApplications.length>0?s.recentApplications.map(((t,n)=>(0,Le.jsxs)("tr",{className:"hover cursor-pointer",onClick:()=>e(`/applications/${t.id}`),children:[(0,Le.jsx)("td",{children:String(t.client_name||"N/A")}),(0,Le.jsx)("td",{children:String(t.company_name||"N/A")}),(0,Le.jsx)("td",{children:"selected_plans"===t.application_type&&t.product_type?p(t.product_type):p(t.application_type)}),(0,Le.jsx)("td",{children:u(Number(t.amount||0))}),(0,Le.jsx)("td",{children:(0,Le.jsx)("span",{className:"badge badge-"+("approved"===String(t.status)?"success":"rejected"===String(t.status)?"error":"pending"===String(t.status)?"warning":"in_review"===String(t.status)?"info":"ghost"),children:String(t.status||"N/A")})}),(0,Le.jsx)("td",{children:t.created_at?vt(String(t.created_at),"datetime"):"N/A"})]},n))):(0,Le.jsx)("tr",{children:(0,Le.jsx)("td",{colSpan:6,className:"text-center",children:"No hay solicitudes recientes"})})})]})})]})})]})}):(0,Le.jsx)(_t,{children:(0,Le.jsx)("div",{className:"p-8",children:(0,Le.jsx)("div",{className:"alert alert-info",children:(0,Le.jsx)("span",{children:"No hay datos disponibles para mostrar en el dashboard."})})})})};let Ul=function(e){return e.NEW="new",e.PENDING="pending",e.IN_REVIEW="in_review",e.APPROVED="approved",e.REJECTED="rejected",e.POR_DISPERSAR="por_dispersar",e.COMPLETED="completed",e.CANCELLED="cancelled",e.EXPIRED="expired",e.SOLICITUD="solicitud",e}({});const Wl={[Ul.NEW]:"Nuevo",[Ul.PENDING]:"Pendiente",[Ul.IN_REVIEW]:"En Revisi\xf3n",[Ul.APPROVED]:"Aprobado",[Ul.REJECTED]:"Rechazado",[Ul.POR_DISPERSAR]:"Por Dispersar",[Ul.COMPLETED]:"Completado",[Ul.CANCELLED]:"Cancelado",[Ul.EXPIRED]:"Expirado",[Ul.SOLICITUD]:"Pendiente"};Ul.NEW,Ul.PENDING,Ul.IN_REVIEW,Ul.APPROVED,Ul.REJECTED,Ul.POR_DISPERSAR,Ul.COMPLETED,Ul.CANCELLED,Ul.EXPIRED,Ul.SOLICITUD,Ul.NEW,Ul.PENDING,Ul.IN_REVIEW,Ul.APPROVED,Ul.REJECTED,Ul.POR_DISPERSAR,Ul.COMPLETED,Ul.CANCELLED,Ul.EXPIRED,Ul.SOLICITUD;let Vl=$l.APPLICATION_HISTORY;Vl||(Vl="application_history");const Hl=async e=>{try{const t=await fetch("http://localhost:3100/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e})}),n=await t.json();if(n.error)throw console.error("Error en la consulta SQL:",n.error),new Error(n.error);return n.data}catch(t){throw console.error("Error ejecutando la consulta:",t),t}},ql=async(e,t)=>{let n=`SELECT * FROM ${$l.APPLICATIONS} WHERE 1=1`;t&&(t.advisor_id&&(n+=` AND assigned_to = '${t.advisor_id}'`),t.company_id&&(n+=` AND company_id = '${t.company_id}'`)),null!==e&&void 0!==e&&e.application_type?"all"!==e.application_type&&(n+=` AND application_type = '${e.application_type}'`):n+=" AND application_type = 'selected_plans'",e&&(e.status&&"all"!==e.status&&(n+=` AND status = '${e.status}'`),e.advisor_id&&(n+=` AND assigned_to = '${e.advisor_id}'`),e.company_id&&(n+=` AND company_id = '${e.company_id}'`),e.dateFrom&&(n+=` AND created_at >= '${e.dateFrom}'`),e.dateTo&&(n+=` AND created_at <= '${e.dateTo}'`),void 0!==e.amountMin&&(n+=` AND amount >= ${e.amountMin}`),void 0!==e.amountMax&&(n+=` AND amount <= ${e.amountMax}`),e.searchQuery&&(n+=` AND (\n        client_name ILIKE '%${e.searchQuery}%' OR \n        client_email ILIKE '%${e.searchQuery}%'\n      )`)),n+=" ORDER BY created_at DESC";try{return(await Hl(n)).map((e=>({id:e.id,client_id:e.source_id||"",company_id:e.company_id||"",assigned_to:e.assigned_to||"",application_type:e.application_type||"",requested_amount:parseFloat(e.amount)||0,status:Yl(e.status),created_at:e.created_at,updated_at:e.updated_at,client_name:e.client_name,client_email:e.client_email,company_name:e.company_name,advisor_name:"",approved_by_advisor:e.approved_by_advisor||!1,approved_by_company:e.approved_by_company||!1,approval_date_advisor:e.approval_date_advisor,approval_date_company:e.approval_date_company,client_phone:e.client_phone,client_address:e.client_address,dni:e.dni,amount:parseFloat(e.amount)||0,term:e.term?parseInt(e.term):void 0,interest_rate:e.interest_rate?parseFloat(e.interest_rate):void 0,monthly_payment:e.monthly_payment?parseFloat(e.monthly_payment):void 0})))}catch(a){throw console.error("Error fetching applications:",a),a}},Yl=e=>{const t=Object.values(Ul).find((t=>t.toLowerCase()===e.toLowerCase()));if(t)return t;const n={Solicitud:Ul.SOLICITUD,Pendiente:Ul.PENDING,"En Revisi\xf3n":Ul.IN_REVIEW,"Revisi\xf3n":Ul.IN_REVIEW,Aprobado:Ul.APPROVED,Rechazado:Ul.REJECTED,"Por Dispersar":Ul.POR_DISPERSAR,Completado:Ul.COMPLETED,Cancelado:Ul.CANCELLED,Expirado:Ul.EXPIRED};return console.log(`Mapeando estado desde BD: "${e}" -> "${n[e]||Ul.PENDING}"`),n[e]||Ul.PENDING},Jl=async(e,t)=>{let n=`SELECT * FROM ${$l.APPLICATIONS} WHERE id = '${e}'`;t&&(t.advisor_id&&(n+=` AND assigned_to = '${t.advisor_id}'`),t.company_id&&(n+=` AND company_id = '${t.company_id}'`));try{const e=await Hl(n);if(e&&e.length>0)return e[0];throw new Error("Application not found")}catch(a){throw console.error(`Error fetching application with ID ${e}:`,a),a}},Gl=async(e,t,n,a,r)=>{let s=`\n    SELECT status FROM ${$l.APPLICATIONS}\n    WHERE id = '${e}'\n  `;r&&(r.advisor_id&&(s+=` AND assigned_to = '${r.advisor_id}'`),r.company_id&&(s+=` AND company_id = '${r.company_id}'`));try{const i=await Hl(s);if(!i||0===i.length)throw new Error("Application not found or you do not have permission to update it");const o=i[0].status;let l=`\n      UPDATE ${$l.APPLICATIONS}\n      SET status = '${t}',\n          status_previous = '${o}'\n    `;"completed"===t&&(l+=", dispersal_date = NOW()"),l+=` WHERE id = '${e}'`,r&&(r.advisor_id&&(l+=` AND assigned_to = '${r.advisor_id}'`),r.company_id&&(l+=` AND company_id = '${r.company_id}'`)),l+=" RETURNING *";const c=await Hl(l);if(!c||0===c.length)throw new Error("Application not found or you do not have permission to update it");const d=`\n      INSERT INTO ${Vl} (application_id, status, comment, created_by)\n      VALUES ('${e}', '${t}', '${o!==t?`${n} (Cambio de estado: ${o} \u2192 ${t})`:n}', '${a}')\n      RETURNING *\n    `;return await Hl(d),console.log(`Estado de aplicaci\xf3n actualizado: ${o} \u2192 ${t}`),c[0]}catch(i){throw console.error(`Error updating status of application ${e}:`,i),i}},Xl=async(e,t,n,a)=>{if(null===a||void 0===a||!a.advisor_id)throw new Error("Solo los asesores pueden realizar esta acci\xf3n");let r=`\n    UPDATE ${$l.APPLICATIONS}\n    SET approved_by_advisor = true, \n        approval_date_advisor = NOW()\n    WHERE id = '${e}' AND assigned_to = '${n}'\n    RETURNING *\n  `;try{const s=await Hl(r);if(!s||0===s.length)throw new Error("Solicitud no encontrada o no tienes permisos para aprobarla");const i=`\n      INSERT INTO ${Vl} (application_id, status, comment, created_by)\n      VALUES ('${e}', 'approved_by_advisor', '${t}', '${n}')\n      RETURNING *\n    `;await Hl(i);const o=s[0];return o.approved_by_advisor&&o.approved_by_company&&"approved"!==o.status?(console.log("Ambas aprobaciones completadas, actualizando estado principal a 'approved'"),await Gl(e,"approved","Aprobaci\xf3n completa: Asesor y Empresa han aprobado esta solicitud",n,a)):o}catch(s){throw console.error(`Error aprobando solicitud ${e} por asesor:`,s),s}},Kl=async(e,t,n,a,r)=>{if(null===r||void 0===r||!r.company_id||r.company_id!==a)throw new Error("Solo los administradores de la empresa pueden realizar esta acci\xf3n");let s=`\n    UPDATE ${$l.APPLICATIONS}\n    SET approved_by_company = true, \n        approval_date_company = NOW()\n    WHERE id = '${e}' AND company_id = '${a}'\n    RETURNING *\n  `;try{const a=await Hl(s);if(!a||0===a.length)throw new Error("Solicitud no encontrada o no tienes permisos para aprobarla");const i=`\n      INSERT INTO ${Vl} (application_id, status, comment, created_by)\n      VALUES ('${e}', 'approved_by_company', '${t}', '${n}')\n      RETURNING *\n    `;await Hl(i);const o=a[0];return o.approved_by_advisor&&o.approved_by_company&&"approved"!==o.status?(console.log("Ambas aprobaciones completadas, actualizando estado principal a 'approved'"),await Gl(e,"approved","Aprobaci\xf3n completa: Asesor y Empresa han aprobado esta solicitud",n,r)):o}catch(i){throw console.error(`Error aprobando solicitud ${e} por empresa:`,i),i}},Ql=async(e,t)=>{let n=`\n    SELECT \n      approved_by_advisor, \n      approved_by_company, \n      approval_date_advisor, \n      approval_date_company\n    FROM ${$l.APPLICATIONS}\n    WHERE id = '${e}'\n  `;t&&(t.advisor_id&&(n+=` AND assigned_to = '${t.advisor_id}'`),t.company_id&&(n+=` AND company_id = '${t.company_id}'`));try{const e=await Hl(n);if(e&&e.length>0)return{approvedByAdvisor:e[0].approved_by_advisor||!1,approvedByCompany:e[0].approved_by_company||!1,approvalDateAdvisor:e[0].approval_date_advisor,approvalDateCompany:e[0].approval_date_company};throw new Error("Solicitud no encontrada")}catch(a){throw console.error(`Error obteniendo estado de aprobaci\xf3n para solicitud ${e}:`,a),a}},Zl=e=>{let{type:t,message:n,onClose:a,autoClose:s=!1,autoCloseTime:i=5e3,className:o=""}=e;const[l,c]=(0,r.useState)(!0);(0,r.useEffect)((()=>{if(s&&l){const e=setTimeout((()=>{d()}),i);return()=>clearTimeout(e)}}),[s,i,l]);const d=()=>{c(!1),a&&a()};if(!l)return null;const u=n instanceof Error?n.message:"object"===typeof n?JSON.stringify(n):String(n);return(0,Le.jsxs)("div",{className:`alert ${(()=>{switch(t){case"error":return"alert-error";case"success":return"alert-success";case"info":default:return"alert-info";case"warning":return"alert-warning"}})()} ${o}`,children:[(()=>{switch(t){case"error":return(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})});case"success":return(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})});case"info":return(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});case"warning":return(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});default:return null}})(),(0,Le.jsx)("span",{children:u}),a&&(0,Le.jsx)("button",{onClick:d,className:"btn btn-sm btn-ghost","aria-label":"Cerrar",children:"\u2715"})]})},ec=()=>{const{userCan:e}=Je(),{user:t}=Ue(),{getEntityFilter:n,shouldFilterByEntity:a}=Je(),s=ne(),[i,o]=(0,r.useState)([]),[l,c]=(0,r.useState)(!0),[d,u]=(0,r.useState)(""),[h,p]=(0,r.useState)("all"),[m,f]=(0,r.useState)("all"),[g,v]=(0,r.useState)(""),[b,y]=(0,r.useState)(""),[x,_]=(0,r.useState)(""),[w,j]=(0,r.useState)(""),[N,E]=(0,r.useState)(!1),[S,k]=(0,r.useState)(null);(0,r.useEffect)((()=>{(async()=>{c(!0),k(null);try{const e=a()?n():null,t={status:"all"!==h?h:void 0,searchQuery:d||void 0,application_type:"all"!==m?m:void 0,dateFrom:g||void 0,dateTo:b||void 0,amountMin:x?parseFloat(x):void 0,amountMax:w?parseFloat(w):void 0},r=await ql(t,e);o(r)}catch(S){console.error("Error fetching applications:",S),k("Error al cargar las solicitudes: "+(S.message||"Error desconocido"))}finally{c(!1)}})()}),[d,h,m,g,b,x,w,a,n]);const C=e=>ft.APPLICATION_TYPE_LABELS[e]||e;return e(Ve.VIEW_APPLICATIONS)?(0,Le.jsx)(_t,{children:(0,Le.jsxs)("div",{className:"p-6",children:[(0,Le.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6",children:[(0,Le.jsx)("h1",{className:"text-2xl font-bold mb-4 md:mb-0",children:"Solicitudes de Cr\xe9dito"}),(0,Le.jsxs)("div",{className:"flex gap-2",children:[(0,Le.jsxs)(Te,{to:"/applications/kanban",className:"btn btn-outline",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})}),"Vista Kanban"]}),e(Ve.CREATE_APPLICATION)&&(0,Le.jsxs)(Te,{to:"/applications/new",className:"btn btn-primary",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Le.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})}),"Nueva Solicitud"]}),(0,Le.jsxs)("button",{className:"btn btn-outline",onClick:()=>{c(!0);const e=a()?n():null,t={status:"all"!==h?h:void 0,searchQuery:d||void 0,application_type:"all"!==m?m:void 0,dateFrom:g||void 0,dateTo:b||void 0,amountMin:x?parseFloat(x):void 0,amountMax:w?parseFloat(w):void 0};ql(t,e).then((e=>{o(e),c(!1)})).catch((e=>{console.error("Error al sincronizar aplicaciones:",e),k("Error al sincronizar: "+(e.message||"Error desconocido")),c(!1)}))},title:"Sincronizar datos",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Sincronizar"]}),(0,Le.jsxs)("button",{className:"btn btn-outline",onClick:()=>{E(!N)},children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),N?"Ocultar Filtros":"Mostrar Filtros"]})]})]}),(0,Le.jsxs)("div",{className:"bg-base-100 shadow-xl rounded-box p-6 mb-6",children:[(0,Le.jsxs)("div",{className:"flex flex-col gap-4 mb-6",children:[(0,Le.jsx)("div",{className:"form-control w-full",children:(0,Le.jsxs)("div",{className:"input-group",children:[(0,Le.jsx)("input",{type:"text",placeholder:"Buscar por nombre, email o tel\xe9fono",className:"input input-bordered w-full",value:d,onChange:e=>u(e.target.value)}),(0,Le.jsx)("button",{className:"btn btn-square",children:(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})}),N&&(0,Le.jsxs)("div",{className:"bg-base-200 p-4 rounded-lg",children:[(0,Le.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Filtros Avanzados"}),(0,Le.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4",children:[(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Estado"})}),(0,Le.jsxs)("select",{className:"select select-bordered w-full",value:h,onChange:e=>p(e.target.value),children:[(0,Le.jsx)("option",{value:"all",children:"Todos los estados"}),Object.entries(Wl).map((e=>{let[t,n]=e;return(0,Le.jsx)("option",{value:t,children:n},t)}))]})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Tipo de Aplicaci\xf3n"})}),(0,Le.jsxs)("select",{className:"select select-bordered w-full",value:m,onChange:e=>f(e.target.value),children:[(0,Le.jsx)("option",{value:"all",children:"Todos los tipos"}),Object.entries(ft.APPLICATION_TYPE_LABELS).map((e=>{let[t,n]=e;return(0,Le.jsx)("option",{value:t,children:n},t)}))]})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Fecha Desde"})}),(0,Le.jsx)("input",{type:"date",className:"input input-bordered w-full",value:g,onChange:e=>v(e.target.value)})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Fecha Hasta"})}),(0,Le.jsx)("input",{type:"date",className:"input input-bordered w-full",value:b,onChange:e=>y(e.target.value)})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Monto M\xednimo"})}),(0,Le.jsx)("input",{type:"number",placeholder:"0",className:"input input-bordered w-full",value:x,onChange:e=>_(e.target.value)})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Monto M\xe1ximo"})}),(0,Le.jsx)("input",{type:"number",placeholder:"0",className:"input input-bordered w-full",value:w,onChange:e=>j(e.target.value)})]})]}),(0,Le.jsx)("div",{className:"flex justify-end",children:(0,Le.jsx)("button",{className:"btn btn-ghost",onClick:()=>{u(""),p("all"),f("all"),v(""),y(""),_(""),j("")},children:"Limpiar Filtros"})})]})]}),S&&(0,Le.jsx)(Zl,{type:"error",message:S,onClose:()=>k(null),className:"mb-6"}),l?(0,Le.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,Le.jsx)("span",{className:"loading loading-spinner loading-lg"})}):0===i.length?(0,Le.jsxs)("div",{className:"text-center py-12",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 mx-auto text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,Le.jsx)("h3",{className:"mt-4 text-xl font-medium text-gray-600",children:"No se encontraron solicitudes"}),(0,Le.jsx)("p",{className:"mt-2 text-gray-500",children:"Intenta cambiar los filtros de b\xfasqueda"})]}):(0,Le.jsx)("div",{className:"overflow-x-auto",children:(0,Le.jsxs)("table",{className:"table table-zebra w-full",children:[(0,Le.jsx)("thead",{children:(0,Le.jsxs)("tr",{children:[(0,Le.jsx)("th",{children:"Cliente"}),(0,Le.jsx)("th",{children:"Empresa"}),(0,Le.jsx)("th",{children:"Tipo"}),(0,Le.jsx)("th",{children:"Monto"}),(0,Le.jsx)("th",{children:"Estado"}),(0,Le.jsx)("th",{children:"Fecha y Hora"}),(0,Le.jsx)("th",{children:"Acciones"})]})}),(0,Le.jsx)("tbody",{children:i.map((e=>{return(0,Le.jsxs)("tr",{className:"hover cursor-pointer",onClick:()=>s(`/applications/${e.id}`),children:[(0,Le.jsx)("td",{children:e.client_name||"N/A"}),(0,Le.jsx)("td",{children:e.company_name||"N/A"}),(0,Le.jsx)("td",{children:"selected_plans"===e.application_type&&e.product_type?C(e.product_type):C(e.application_type)}),(0,Le.jsx)("td",{children:(t=Number(e.amount||0),new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP"}).format(t))}),(0,Le.jsx)("td",{children:(0,Le.jsx)("span",{className:"badge badge-"+("approved"===e.status?"success":"rejected"===e.status?"error":"pending"===e.status?"warning":"in_review"===e.status?"info":"ghost"),children:e.status})}),(0,Le.jsx)("td",{children:e.created_at?vt(e.created_at,"datetime"):"N/A"}),(0,Le.jsx)("td",{children:(0,Le.jsxs)("div",{className:"dropdown dropdown-end",children:[(0,Le.jsx)("label",{tabIndex:0,className:"btn btn-ghost btn-circle",children:(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"})})}),(0,Le.jsx)("ul",{tabIndex:0,className:"dropdown-content menu menu-compact mt-3 p-2 shadow bg-base-100 rounded-box w-52",children:(0,Le.jsx)("li",{children:(0,Le.jsxs)(Te,{to:`/applications/${e.id}`,className:"justify-between",children:["Ver Detalle",(0,Le.jsx)("span",{className:"text-info",children:"\u2318T"})]})})})]})})]},e.id);var t}))})]})})]})]})}):(0,Le.jsx)(_t,{children:(0,Le.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,Le.jsxs)("div",{className:"text-center",children:[(0,Le.jsx)("h2",{className:"text-2xl font-bold text-gray-700",children:"Acceso Restringido"}),(0,Le.jsx)("p",{className:"text-gray-500 mt-2",children:"No tienes permisos para ver esta p\xe1gina."})]})})})},tc=$l.APPLICATION_HISTORY||"application_history";const nc=e=>{let{applications:t,onStatusChange:n}=e;const[a,s]=(0,r.useState)(!1),[i,o]=(0,r.useState)(null),[l,c]=(0,r.useState)([]),[d,u]=(0,r.useState)(null),{shouldFilterByEntity:h,getEntityFilter:p,isAdvisor:m,isCompanyAdmin:f}=Je(),{user:g}=Ue(),v=(0,r.useRef)(null),b=(0,r.useRef)(null),y=(0,r.useRef)(-1),x=(0,r.useRef)(""),[_,w]=(0,r.useState)(null),[j,N]=(0,r.useState)(""),[E,S]=(0,r.useState)("all"),[k,C]=(0,r.useState)("all"),[A,T]=(0,r.useState)(""),[P,I]=(0,r.useState)(""),[O,R]=(0,r.useState)(""),[M,D]=(0,r.useState)(""),[L,$]=(0,r.useState)(!1);(0,r.useEffect)((()=>{(async()=>{if(t&&0!==t.length){s(!0);try{const e=await Promise.all(t.map((async e=>{const t=await Ql(e.id);return{...e,approvalStatus:t||{approvedByAdvisor:!1,approvedByCompany:!1},company_review_status:!!f()&&(e.status===Ul.IN_REVIEW||t&&t.approvedByCompany)}})));c(e)}catch(e){console.error("Error loading approval statuses:",e)}finally{s(!1)}}})()}),[t]),(0,r.useEffect)((()=>{(async()=>{const e=[...await Promise.all(t.map((async e=>{const t=await Ql(e.id);return{...e,approvalStatus:t,isMoving:!1}})))].sort(((e,t)=>{const n=new Date(e.created_at),a=new Date(t.created_at);return n.getTime()-a.getTime()}));c(e)})()}),[t]),(0,r.useEffect)((()=>{const e=t.filter((e=>{const t=!e.status||"pending"===e.status||"solicitud"===e.status,n=new Date(e.created_at);return((new Date).getTime()-n.getTime())/36e5<72&&(t||"new"===e.status)}));if(e.length>0){console.log("Aplicaciones nuevas detectadas:",e);const t=[...l];e.forEach((e=>{const n=t.findIndex((t=>t.id===e.id));-1===n||t[n].status&&"pending"!==t[n].status&&"solicitud"!==t[n].status||(t[n]={...t[n],status:Ul.NEW},console.log(`Aplicaci\xf3n ${e.id} movida a estado NUEVO`))})),c(t)}}),[t]),(0,r.useEffect)((()=>{(async()=>{if(null!==g&&void 0!==g&&g.id)try{if(f()&&t.length>0){const e=new Date;e.setHours(e.getHours()-24);const n=t.filter((t=>new Date(t.created_at)>=e));if(n.length>0){console.log(`Encontradas ${n.length} aplicaciones recientes`);const e=[...l];let t=!1;n.forEach((n=>{const a=e.findIndex((e=>e.id===n.id));-1===a?(console.log(`Agregando aplicaci\xf3n nueva ${n.id} al estado`),e.push({...n,status:n.status||Ul.NEW,approvalStatus:{approvedByAdvisor:n.approved_by_advisor||!1,approvedByCompany:n.approved_by_company||!1}}),t=!0):e[a].status&&"pending"!==e[a].status&&"solicitud"!==e[a].status||(console.log(`Actualizando estado de ${n.id} a NUEVO`),e[a]={...e[a],status:Ul.NEW},t=!0)})),t&&c(e)}}}catch(e){console.error("Error verificando nuevas aplicaciones:",e)}})()}),[t,null===g||void 0===g?void 0:g.id,f]),(0,r.useEffect)((()=>{if(!t||0===t.length)return;console.log("Verificando estado de aplicaciones:",t.map((e=>({id:e.id,status:e.status}))));const e=[...l];let n=!1;t.forEach((t=>{const a=e.findIndex((e=>e.id===t.id)),r=!t.status||"pending"===t.status||"solicitud"===t.status;if(-1!==a&&r)console.log(`Actualizando estado de aplicaci\xf3n ${t.id} de "${t.status}" a "new"`),e[a]={...e[a],status:Ul.NEW},n=!0;else if(-1===a){const a=r?Ul.NEW:t.status;console.log(`Agregando aplicaci\xf3n ${t.id} con estado "${a}"`),e.push({...t,status:a,approvalStatus:{approvedByAdvisor:t.approved_by_advisor||!1,approvedByCompany:t.approved_by_company||!1}}),n=!0}})),n&&(console.log("Actualizando aplicaciones:"),e.forEach((e=>console.log(`- ${e.id}: ${e.status}`))),c(e))}),[t]);r.useMemo((()=>{const e=Object.values(Ul).reduce(((e,t)=>(e[t]=[],e)),{});return f()?l.reduce(((e,t)=>{if(t.isMoving&&t.targetStatus)return e[t.targetStatus]?e[t.targetStatus].push(t):(console.warn(`Estado inv\xe1lido detectado: ${t.targetStatus}, usando NEW como fallback`),e[Ul.NEW].push(t)),e;if(!t.status||"pending"===t.status||"solicitud"===t.status)return e[Ul.NEW].push(t),e;if([Ul.POR_DISPERSAR,Ul.COMPLETED,Ul.EXPIRED,Ul.CANCELLED,Ul.REJECTED].includes(t.status))return e[t.status]?e[t.status].push(t):(console.warn(`Estado compartido inv\xe1lido detectado: ${t.status}, usando NEW como fallback`),e[Ul.NEW].push(t)),e;if(t.status===Ul.APPROVED){var n,a,r;if(null!==(n=t.approvalStatus)&&void 0!==n&&n.approvedByCompany&&!t.approvalStatus.approvedByAdvisor)return e[Ul.APPROVED].push(t),e;if(null!==(a=t.approvalStatus)&&void 0!==a&&a.approvedByCompany&&null!==(r=t.approvalStatus)&&void 0!==r&&r.approvedByAdvisor)return e[Ul.APPROVED].push(t),e}var s,i;return t.status===Ul.IN_REVIEW?null!==(s=t.approvalStatus)&&void 0!==s&&s.approvedByCompany?(e[Ul.APPROVED].push(t),e):(e[Ul.IN_REVIEW].push(t),e):t.status===Ul.NEW?null!==(i=t.approvalStatus)&&void 0!==i&&i.approvedByCompany?(e[Ul.APPROVED].push(t),e):!0===t.company_review_status?(e[Ul.IN_REVIEW].push(t),e):(e[Ul.NEW].push(t),e):(e[t.status]?e[t.status].push(t):(console.warn(`Estado desconocido detectado: ${t.status}, usando NEW como fallback`),e[Ul.NEW].push(t)),e)}),e):l.reduce(((e,t)=>{if(t.isMoving&&t.targetStatus)e[t.targetStatus]?e[t.targetStatus].push(t):(console.warn(`Estado de destino inv\xe1lido: ${t.targetStatus}, usando NEW como fallback`),e[Ul.NEW].push(t));else{let n=t.status||"new";"pending"!==n&&"solicitud"!==n||(n=Ul.NEW),e[n]?e[n].push(t):(console.warn(`Estado inv\xe1lido detectado: ${n}, usando NEW como fallback`),e[Ul.NEW].push(t))}return e}),e)}),[l,f,m]);const z=(0,r.useMemo)((()=>{const e={[Ul.NEW]:[],[Ul.IN_REVIEW]:[],[Ul.APPROVED]:[],[Ul.POR_DISPERSAR]:[],[Ul.COMPLETED]:[],[Ul.EXPIRED]:[],[Ul.REJECTED]:[],[Ul.CANCELLED]:[]};l.forEach((t=>{const n=t.status||Ul.NEW;if(f()){var a,r;if([Ul.POR_DISPERSAR,Ul.COMPLETED,Ul.EXPIRED,Ul.CANCELLED,Ul.REJECTED].includes(n))return console.log(`Mostrando tarjeta ${t.id} en estado avanzado: ${n}`),void e[n].push(t);null!==(a=t.approvalStatus)&&void 0!==a&&a.approvedByCompany?e[Ul.APPROVED].push(t):t.company_review_status?e[Ul.IN_REVIEW].push(t):n!==Ul.NEW&&n!==Ul.PENDING&&(t.company_review_status||null!==(r=t.approvalStatus)&&void 0!==r&&r.approvedByCompany)||e[Ul.NEW].push(t)}else m()?n?e[n]?e[n].push(t):(console.warn(`Estado desconocido en columns para asesor: ${n}, usando NEW como fallback`),e[Ul.NEW].push(t)):e[Ul.NEW].push(t):n?e[n]?e[n].push(t):(console.warn(`Estado desconocido en columns para otros roles: ${n}, usando NEW como fallback`),e[Ul.NEW].push(t)):e[Ul.NEW].push(t)}));return[{id:Ul.NEW,title:"Nuevo",color:"warning",applications:e[Ul.NEW]},{id:Ul.IN_REVIEW,title:"En Revisi\xf3n",color:"info",applications:e[Ul.IN_REVIEW]},{id:Ul.APPROVED,title:"Aprobado por mi",color:"success",applications:e[Ul.APPROVED]},{id:Ul.POR_DISPERSAR,title:"Por Dispersar",color:"accent",applications:e[Ul.POR_DISPERSAR]},{id:Ul.COMPLETED,title:"Completado",color:"primary",applications:e[Ul.COMPLETED]},{id:Ul.EXPIRED,title:"Expirado",color:"error",applications:e[Ul.EXPIRED]},{id:Ul.REJECTED,title:"Rechazado",color:"error",applications:e[Ul.REJECTED]},{id:Ul.CANCELLED,title:"Cancelado",color:"neutral",applications:e[Ul.CANCELLED]}]}),[l,m,f]),F=(e,t,n)=>{console.log(`Actualizando estado de aprobaci\xf3n para ${e}:`,t);const a=[...l],r=a.findIndex((t=>t.id===e));if(-1===r)return void console.warn(`No se encontr\xf3 la aplicaci\xf3n ${e} para actualizar approval status`);const s={...a[r]},i=s.approvalStatus||{approvedByAdvisor:!1,approvedByCompany:!1},o={approvedByAdvisor:void 0!==t.approvedByAdvisor?t.approvedByAdvisor:i.approvedByAdvisor,approvedByCompany:void 0!==t.approvedByCompany?t.approvedByCompany:i.approvedByCompany};console.log(`Approval Status anterior: ${JSON.stringify(i)}`),console.log(`Nuevo Approval Status: ${JSON.stringify(o)}`),s.approvalStatus=o,!1===t.approvedByCompany&&f()&&(console.log("Actualizando company_review_status a true porque estamos quitando aprobaci\xf3n"),s.company_review_status=!0),o.approvedByAdvisor&&o.approvedByCompany&&(console.log("Ambas aprobaciones est\xe1n presentes, verificando si necesita moverse a Por Dispersar"),s.status!==Ul.POR_DISPERSAR&&s.status!==Ul.COMPLETED&&(console.log("Actualizando estado a Por Dispersar debido a doble aprobaci\xf3n"),s.status=Ul.POR_DISPERSAR)),a[r]=s,c(a)},B=e=>{v.current&&(v.current.classList.remove("dragging"),v.current=null),e.currentTarget&&e.currentTarget.classList.remove("dragging"),b.current&&(document.body.removeChild(b.current),b.current=null),y.current=-1,x.current=""},U=e=>{if(!e.status||!e.id)return!1;if(e.isMoving)return!1;if(d===e.id)return!1;if(m()){var t,n;return![Ul.EXPIRED,Ul.CANCELLED,Ul.POR_DISPERSAR].includes(e.status)&&(null===(t=e.approvalStatus)||void 0===t||!t.approvedByAdvisor||null===(n=e.approvalStatus)||void 0===n||!n.approvedByCompany)}if(f()){var a,r;return![Ul.POR_DISPERSAR,Ul.COMPLETED,Ul.EXPIRED,Ul.CANCELLED,Ul.REJECTED].includes(e.status)&&(null===(a=e.approvalStatus)||void 0===a||!a.approvedByAdvisor||null===(r=e.approvalStatus)||void 0===r||!r.approvedByCompany)}return!1},W=async(e,t)=>{e.preventDefault(),e.stopPropagation(),document.querySelectorAll(".kanban-column").forEach((e=>{e.classList.remove("drag-over")}));const a=Object.values(Ul);if(!a.includes(t))return console.error(`Estado inv\xe1lido para drop: ${t}`),void o(`Error: estado "${t}" no es v\xe1lido.`);const r=e.dataTransfer.getData("text/plain");if(!r||null===g||void 0===g||!g.id)return;const s=l.find((e=>e.id===r));if(!s)return;const i=s.status||Ul.NEW;if(i!==t){console.log(`Intentando mover tarjeta ${r} de ${i} a ${t}`),u(r);try{if(f()){if(![Ul.NEW,Ul.IN_REVIEW,Ul.APPROVED].includes(t))return o(`No puedes mover solicitudes al estado "${Wl[t]||t}". Solo puedes mover entre Nuevo, En Revisi\xf3n y Aprobado por m\xed.`),void u(null);if([Ul.POR_DISPERSAR,Ul.COMPLETED,Ul.EXPIRED,Ul.CANCELLED,Ul.REJECTED].includes(i))return o(`No puedes mover solicitudes que est\xe1n en estado "${Wl[i]||i}".`),void u(null);const e=[...l],a=e.findIndex((e=>e.id===r));if(-1!==a){const l={...e[a],isMoving:!0,targetStatus:t};var d;if(t===Ul.NEW){if(l.company_review_status=!1,l.approvalStatus={...l.approvalStatus||{approvedByAdvisor:!1,approvedByCompany:!1},approvedByCompany:!1},null!==(d=l.approvalStatus)&&void 0!==d&&d.approvedByCompany&&null!==g&&void 0!==g&&g.entityId&&s.company_id)try{console.log("Quitando aprobaci\xf3n de empresa en la base de datos");const e=`\n                  UPDATE ${$l.APPLICATIONS}\n                  SET approved_by_company = false, \n                      approval_date_company = NULL\n                  WHERE id = '${r}' AND company_id = '${s.company_id}'\n                  RETURNING *\n                `,t=await fetch("http://localhost:3100/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e})}),n=await t.json();if(n.error)throw new Error(n.error);console.log("\u2705 Aprobaci\xf3n de empresa removida correctamente:",n.data);const a=`\n                  INSERT INTO ${tc} (application_id, status, comment, created_by)\n                  VALUES ('${r}', 'new', 'Regresado a Nuevo por administrador de empresa', '${g.entityId}')\n                  RETURNING *\n                `;await fetch("http://localhost:3100/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:a})}),F(r,{approvedByCompany:!1},Ul.NEW)}catch(p){console.error("\u274c Error al quitar aprobaci\xf3n de empresa:",p),o(`Error al quitar aprobaci\xf3n: ${p.message}`)}}else if(t===Ul.IN_REVIEW){var h;if(l.company_review_status=!0,l.approvalStatus={...l.approvalStatus||{approvedByAdvisor:!1,approvedByCompany:!1},approvedByCompany:!1},i===Ul.APPROVED&&null!==(h=l.approvalStatus)&&void 0!==h&&h.approvedByCompany&&null!==g&&void 0!==g&&g.entityId&&s.company_id)try{console.log("Quitando aprobaci\xf3n de empresa en la base de datos");const e=`\n                  UPDATE ${$l.APPLICATIONS}\n                  SET approved_by_company = false, \n                      approval_date_company = NULL,\n                      status = '${Ul.IN_REVIEW}'\n                  WHERE id = '${r}' AND company_id = '${s.company_id}'\n                  RETURNING *\n                `,t=await fetch("http://localhost:3100/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e})}),a=await t.json();if(a.error)throw new Error(a.error);console.log("\u2705 Aprobaci\xf3n de empresa removida correctamente:",a.data);const i=`\n                  INSERT INTO ${tc} (application_id, status, comment, created_by)\n                  VALUES ('${r}', 'in_review', 'Revisi\xf3n adicional requerida por empresa', '${g.entityId}')\n                  RETURNING *\n                `;if(await fetch("http://localhost:3100/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:i})}),F(r,{approvedByCompany:!1},Ul.IN_REVIEW),n)try{await n(s,Ul.IN_REVIEW),console.log("\u2705 Estado actualizado correctamente a EN REVISI\xd3N")}catch(p){console.error("\u274c Error al actualizar estado:",p)}}catch(p){console.error("\u274c Error al quitar aprobaci\xf3n de empresa:",p),o(`Error al quitar aprobaci\xf3n: ${p.message}`)}else if(n)try{await n(s,Ul.IN_REVIEW),console.log("\u2705 Estado actualizado correctamente a EN REVISI\xd3N")}catch(p){console.error("\u274c Error al actualizar estado:",p)}}else if(t===Ul.APPROVED&&(l.company_review_status=!0,l.approvalStatus={...l.approvalStatus||{approvedByAdvisor:!1,approvedByCompany:!1},approvedByCompany:!0},null!==g&&void 0!==g&&g.entityId&&s.company_id))try{console.log(`Empresa ${g.entityId} est\xe1 aprobando la solicitud ${r}`),e[a]=l,c([...e]);const t=await Kl(r,"Aprobado v\xeda Kanban",g.entityId,s.company_id,{company_id:s.company_id});console.log("\u2705 Aplicaci\xf3n aprobada por empresa:",t),F(r,{approvedByCompany:!0});const i=await Ql(r);console.log("Estado de aprobaci\xf3n actual:",i),null!==i&&void 0!==i&&i.approvedByAdvisor&&(console.log("\u2747\ufe0f Ambas aprobaciones completadas, moviendo a Por Dispersar"),w(`La solicitud ha sido aprobada por asesor y empresa. Moviendo autom\xe1ticamente a "${Wl[Ul.POR_DISPERSAR]||"Por Dispersar"}"`),setTimeout((()=>{n&&n(s,Ul.POR_DISPERSAR),setTimeout((()=>w(null)),3e3)}),500))}catch(p){console.error("\u274c Error al aprobar por empresa:",p),o(`Error al aprobar: ${p.message}`),l.approvalStatus={...l.approvalStatus||{approvedByAdvisor:!1,approvedByCompany:!1},approvedByCompany:!1},e[a]=l,c([...e])}e[a]=l,c(e),setTimeout((()=>{c((e=>e.map((e=>e.id===r?{...e,isMoving:!1,targetStatus:void 0}:e)))),u(null)}),500)}}else if(m()){if(!a.includes(t))return o(`Estado de destino "${t}" no es v\xe1lido.`),void u(null);const e=[...l],d=e.findIndex((e=>e.id===r));if(-1!==d){const a={...e[d],isMoving:!0,targetStatus:t,status:t};if(t===Ul.APPROVED){if(console.log(`Advisor ${null===g||void 0===g?void 0:g.id} est\xe1 aprobando la solicitud ${r}`),a.approvalStatus={...a.approvalStatus||{approvedByAdvisor:!1,approvedByCompany:!1},approvedByAdvisor:!0},e[d]=a,c([...e]),null!==g&&void 0!==g&&g.entityId)try{console.log("Llamando a approveByAdvisor API...");const e=await Xl(r,"Aprobado v\xeda Kanban",g.entityId,{advisor_id:g.entityId});console.log("\u2705 Aplicaci\xf3n aprobada por asesor:",e),F(r,{approvedByAdvisor:!0});const t=await Ql(r);console.log("Estado de aprobaci\xf3n actual:",t),null!==t&&void 0!==t&&t.approvedByCompany&&(w(`La solicitud ha sido aprobada por asesor y empresa. Moviendo autom\xe1ticamente a "${Wl[Ul.POR_DISPERSAR]||"Por Dispersar"}"`),setTimeout((()=>{n&&n(s,Ul.POR_DISPERSAR),setTimeout((()=>w(null)),3e3)}),500))}catch(p){console.error("\u274c Error al aprobar por asesor:",p),o(`Error al aprobar: ${p.message}`);l.find((e=>e.id===r))&&F(r,{approvedByAdvisor:!1})}}else if(i===Ul.APPROVED&&t!==Ul.POR_DISPERSAR&&(console.log("Moviendo de aprobado a otro estado, resetear aprobaci\xf3n de asesor"),a.approvalStatus={...a.approvalStatus||{approvedByAdvisor:!1,approvedByCompany:!1},approvedByAdvisor:!1},null!==g&&void 0!==g&&g.entityId&&t===Ul.IN_REVIEW))try{console.log("Quitando aprobaci\xf3n de asesor en la base de datos");const e=`\n                  UPDATE ${$l.APPLICATIONS}\n                  SET approved_by_advisor = false, \n                      approval_date_advisor = NULL\n                  WHERE id = '${r}' AND assigned_to = '${g.entityId}'\n                  RETURNING *\n                `,t=await fetch("http://localhost:3100/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e})}),n=await t.json();if(n.error)throw new Error(n.error);console.log("\u2705 Aprobaci\xf3n de asesor removida correctamente:",n.data);const a=`\n                  INSERT INTO ${tc} (application_id, status, comment, created_by)\n                  VALUES ('${r}', 'in_review', 'Revisi\xf3n adicional requerida', '${g.entityId}')\n                  RETURNING *\n                `;await fetch("http://localhost:3100/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:a})}),F(r,{approvedByAdvisor:!1})}catch(p){console.error("\u274c Error al quitar aprobaci\xf3n del asesor:",p),o(`Error al quitar aprobaci\xf3n: ${p.message}`)}if(t!==Ul.APPROVED&&(e[d]=a,c(e)),n)try{await n(s,t)}catch(p){console.error("Error updating status:",p),o(`Error al actualizar el estado: ${p.message}`),c((e=>e.map((e=>e.id===r?{...e,status:i,isMoving:!1,targetStatus:void 0}:e))))}setTimeout((()=>{c((e=>e.map((e=>e.id===r?{...e,isMoving:!1,targetStatus:void 0}:e)))),u(null)}),500)}}}catch(p){console.error("Error in handleDrop:",p),o(`Error al actualizar el estado: ${p.message}`),u(null)}}},V=e=>{if(!e.approvalStatus)return null;const{approvedByAdvisor:t,approvedByCompany:n}=e.approvalStatus,a=t&&n;return(0,Le.jsxs)("div",{className:"flex flex-col mt-1 space-y-1",children:[(0,Le.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Le.jsxs)("div",{className:"tooltip tooltip-top flex items-center","data-tip":t?"Aprobado por asesor":"Pendiente de aprobaci\xf3n por asesor",children:[(0,Le.jsx)("span",{className:"text-xs mr-1 whitespace-nowrap",children:"Asesor:"}),(0,Le.jsx)("div",{className:"w-3 h-3 rounded-full "+(t?"bg-success":"bg-warning")}),t&&(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 ml-1 text-success",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})]}),(0,Le.jsxs)("div",{className:"tooltip tooltip-top flex items-center ml-3","data-tip":n?"Aprobado por empresa":"Pendiente de aprobaci\xf3n por empresa",children:[(0,Le.jsx)("span",{className:"text-xs mr-1 whitespace-nowrap",children:"Empresa:"}),(0,Le.jsx)("div",{className:"w-3 h-3 rounded-full "+(n?"bg-success":"bg-warning")}),n&&(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 ml-1 text-success",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})]})]}),a&&(0,Le.jsx)("div",{className:"w-full flex justify-center mt-1",children:(0,Le.jsx)("div",{className:"badge badge-success text-xs px-2 py-1 text-white font-medium",children:"Aprobado Total"})}),f()&&n&&e.status===Ul.APPROVED&&(0,Le.jsx)("div",{className:"w-full flex justify-center mt-1",children:(0,Le.jsx)("button",{onClick:e=>{e.stopPropagation(),W(e,Ul.IN_REVIEW)},className:"btn btn-xs btn-error w-full",children:"Deshacer Aprobaci\xf3n"})})]})},H=e=>({selected_plans:"Cr\xe9dito a Plazos",product_simulations:"Simulaci\xf3n",auto_loan:"Cr\xe9dito Auto",car_backed_loan:"Cr\xe9dito con Garant\xeda",personal_loan:"Pr\xe9stamo Personal",cash_advance:"Adelanto de Efectivo"}[e]||e),q=(e,t)=>(0,Le.jsx)("span",{className:`badge badge-${t} badge-md text-xs px-3 py-1 whitespace-nowrap inline-block`,children:H(e||"")}),Y=e=>{switch((e.status||"").toLowerCase()){case Ul.REJECTED:return"border-error bg-red-50";case Ul.APPROVED:if(e.approvalStatus){const{approvedByAdvisor:t,approvedByCompany:n}=e.approvalStatus;if(t&&n)return"border-success bg-green-100";if(t)return"border-success bg-green-50";if(n)return"border-info bg-blue-50"}return"border-success bg-green-50";case Ul.IN_REVIEW:return"border-info bg-blue-50";case Ul.NEW:return"border-warning bg-yellow-50";case Ul.PENDING:return"border-warning bg-amber-50";case Ul.POR_DISPERSAR:return"border-accent bg-purple-50";case Ul.COMPLETED:return"border-primary bg-indigo-50";case Ul.EXPIRED:return"border-error bg-red-100";case Ul.CANCELLED:return"border-neutral bg-gray-100";default:return`border-${e.status||"neutral"}`}},J=e=>U(e)&&e.id!==d?"cursor-grab kanban-card-draggable":"cursor-not-allowed opacity-80 kanban-card-locked",G=e=>{var t,n;if(e.id===d)return"Esta tarjeta est\xe1 siendo procesada";if(U(e))return"Arrastra para cambiar el estado";if(null!==(t=e.approvalStatus)&&void 0!==t&&t.approvedByAdvisor&&null!==(n=e.approvalStatus)&&void 0!==n&&n.approvedByCompany)return"Esta solicitud ya est\xe1 completamente aprobada y no puede ser movida";const a=e.status||Ul.NEW;if(f()){if(a===Ul.REJECTED)return"Las solicitudes rechazadas solo pueden ser movidas por asesores";if(a===Ul.POR_DISPERSAR)return"Esta solicitud ya est\xe1 lista para dispersi\xf3n y no puede regresar a estados anteriores";if(a===Ul.COMPLETED)return"Esta solicitud ya est\xe1 completada y no puede cambiar de estado";if(a===Ul.EXPIRED)return"Esta solicitud ha expirado y no puede cambiar de estado";if(a===Ul.CANCELLED)return"Esta solicitud fue cancelada y no puede cambiar de estado"}return"No puedes mover esta tarjeta en este momento"};(0,r.useEffect)((()=>{const e=setTimeout((()=>{(async()=>{const e=l.filter((e=>{var t,n;return(null===(t=e.approvalStatus)||void 0===t?void 0:t.approvedByAdvisor)&&(null===(n=e.approvalStatus)||void 0===n?void 0:n.approvedByCompany)&&e.status!==Ul.POR_DISPERSAR&&e.status!==Ul.COMPLETED}));if(e.length>0){console.log(`Encontradas ${e.length} tarjetas con aprobaci\xf3n total, moviendo a Por Dispersar...`);for(const a of e)if(n)try{console.log(`Moviendo tarjeta ${a.id} a Por Dispersar autom\xe1ticamente...`),await n(a,Ul.POR_DISPERSAR)}catch(t){console.error(`Error al mover tarjeta ${a.id} a Por Dispersar:`,t)}}})()}),2e3);return()=>clearTimeout(e)}),[l,n]),(0,r.useEffect)((()=>{(async()=>{if(!f()||0===t.length)return;console.log("Sincronizando tarjetas en estados avanzados para el administrador de empresa...");const e=[Ul.POR_DISPERSAR,Ul.COMPLETED,Ul.EXPIRED,Ul.CANCELLED,Ul.REJECTED],a=t.filter((t=>!e.includes(t.status)&&(t.approved_by_advisor&&t.approved_by_company)));if(a.length>0){console.log(`Encontradas ${a.length} aplicaciones que necesitan actualizaci\xf3n de estado:`);const e=[...l];let t=!1;for(const s of a){console.log(`- Aplicaci\xf3n ${s.id} con ambas aprobaciones, actualizando a Por Dispersar`);const a=e.findIndex((e=>e.id===s.id));if(-1!==a&&(e[a]={...e[a],status:Ul.POR_DISPERSAR},t=!0,n))try{await n(s,Ul.POR_DISPERSAR),console.log(`\u2705 Estado de aplicaci\xf3n ${s.id} actualizado a Por Dispersar`)}catch(r){console.error(`Error al actualizar estado de ${s.id}:`,r)}}t&&(console.log("Actualizando estado local con aplicaciones sincronizadas"),c(e))}})()}),[t,f,n]),(0,r.useEffect)((()=>{(()=>{if(!f()||0===t.length)return;const e=t.filter((e=>![Ul.NEW,Ul.IN_REVIEW,Ul.APPROVED].includes(e.status)));if(e.length>0){console.log(`Sincronizando ${e.length} tarjetas con estados avanzados:`);const t=[...l];let n=!1;e.forEach((e=>{const a=t.findIndex((t=>t.id===e.id));-1!==a&&t[a].status!==e.status&&(console.log(`- Sincronizando aplicaci\xf3n ${e.id} de estado '${t[a].status}' a '${e.status}'`),t[a]={...t[a],status:e.status},n=!0)})),n&&(console.log("Actualizando estado local con aplicaciones sincronizadas"),c(t))}})()}),[t,l,f]),(0,r.useEffect)((()=>{const e=async()=>{if(t&&0!==t.length){console.log("Refrescando estados de aprobaci\xf3n desde la API...");try{const t=[...l];let s=!1;for(const i of t){var e,a;const t=await Ql(i.id);if(t&&(t.approvedByAdvisor!==(null===(e=i.approvalStatus)||void 0===e?void 0:e.approvedByAdvisor)||t.approvedByCompany!==(null===(a=i.approvalStatus)||void 0===a?void 0:a.approvedByCompany))&&(console.log(`Actualizaci\xf3n encontrada para app ${i.id}:`,{actual:i.approvalStatus,nuevo:t}),i.approvalStatus=t,s=!0,t.approvedByAdvisor&&t.approvedByCompany&&i.status!==Ul.POR_DISPERSAR&&i.status!==Ul.COMPLETED&&(console.log(`Aplicaci\xf3n ${i.id} tiene doble aprobaci\xf3n, moviendo a Por Dispersar`),i.status=Ul.POR_DISPERSAR,n)))try{await n(i,Ul.POR_DISPERSAR)}catch(r){console.error("Error actualizando estado a Por Dispersar:",r)}}s&&(console.log("Actualizando aplicaciones con estados de aprobaci\xf3n refrescados"),c(t))}catch(r){console.error("Error al refrescar estados de aprobaci\xf3n:",r)}}};e();const a=setInterval((()=>{e()}),1e4);return()=>{clearInterval(a)}}),[t,l,n]),(0,r.useEffect)((()=>{if(!f()||0===t.length)return;console.log("Verificando y sincronizando estados de tarjetas existentes...");const e=t.filter((e=>![Ul.NEW,Ul.IN_REVIEW,Ul.APPROVED].includes(e.status)));if(e.length>0){console.log(`Encontradas ${e.length} tarjetas que necesitan sincronizaci\xf3n con vista del asesor`);const t=[...l];let n=!1;e.forEach((e=>{const a=t.findIndex((t=>t.id===e.id));-1!==a&&t[a].status!==e.status&&(console.log(`- Actualizando tarjeta ${e.id}: de '${t[a].status}' a '${e.status}'`),t[a]={...t[a],status:e.status},n=!0)})),n&&(console.log("Actualizando estados para sincronizar con vista del asesor"),c(t))}}),[t,l,f]);return 0===t.length?(0,Le.jsxs)("div",{className:"bg-base-200 p-6 rounded-lg",children:[(0,Le.jsx)("h3",{className:"text-xl font-medium text-center",children:"No hay solicitudes para mostrar"}),(0,Le.jsx)("p",{className:"text-center text-gray-500 mt-2",children:"No se encontraron solicitudes en el sistema"})]}):(0,Le.jsxs)("div",{className:"w-full overflow-x-auto custom-scrollbar relative",children:[(0,Le.jsx)("style",{children:"\n    .custom-scrollbar::-webkit-scrollbar {\n      width: 8px;\n      height: 8px;\n    }\n    \n    .custom-scrollbar::-webkit-scrollbar-track {\n      background: #f1f1f1;\n      border-radius: 10px;\n    }\n    \n    .custom-scrollbar::-webkit-scrollbar-thumb {\n      background: #888;\n      border-radius: 10px;\n    }\n    \n    .custom-scrollbar::-webkit-scrollbar-thumb:hover {\n      background: #555;\n    }\n    \n    .kanban-card {\n      transition: transform 0.2s ease-in-out, opacity 0.2s ease-in-out, box-shadow 0.3s ease-in-out, border-color 0.3s ease;\n      touch-action: none;\n      user-select: none;\n      will-change: transform, opacity;\n    }\n    \n    .kanban-card-draggable {\n      cursor: grab !important;\n      position: relative;\n    }\n    \n    .kanban-card-draggable:hover {\n      transform: translateY(-4px);\n      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.15);\n      border-color: #a855f7;\n      z-index: 10;\n    }\n    \n    .kanban-card-draggable:active {\n      cursor: grabbing !important;\n    }\n    \n    /* Indicator for draggable cards */\n    .kanban-card-draggable::after {\n      content: '';\n      position: absolute;\n      top: 8px;\n      right: 8px;\n      width: 20px;\n      height: 20px;\n      background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%23666'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M7 11.5V14m0-2.5v-6a1.5 1.5 0 113 0m-3 6a1.5 1.5 0 00-3 0v2a7.5 7.5 0 0015 0v-5a1.5 1.5 0 013 0m-6-3V11m0-5.5v-1a1.5 1.5 0 013 0v1m0 0V11' /%3E%3C/svg%3E\");\n      background-size: contain;\n      background-repeat: no-repeat;\n      opacity: 0.7;\n      transition: opacity 0.2s ease;\n    }\n    \n    .kanban-card-draggable:hover::after {\n      opacity: 1;\n    }\n    \n    .kanban-card-locked {\n      position: relative;\n      cursor: not-allowed !important;\n      opacity: 0.8;\n    }\n    \n    .kanban-card-locked::after {\n      content: '';\n      position: absolute;\n      top: 8px;\n      right: 8px;\n      width: 20px;\n      height: 20px;\n      background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%23999'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z' /%3E%3C/svg%3E\");\n      background-size: contain;\n      background-repeat: no-repeat;\n      opacity: 0.7;\n    }\n    \n    .kanban-card.dragging {\n      opacity: 0.8;\n      transform: scale(1.03);\n      box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);\n      z-index: 50;\n    }\n    \n    .kanban-column {\n      transition: all 0.2s ease;\n      border-radius: 0.75rem;\n      will-change: transform, background-color;\n    }\n    \n    .kanban-column.drag-over {\n      background-color: rgba(var(--b2, 217 217 217) / 0.5);\n      transform: scale(1.01);\n      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);\n      border: 2px dashed #a855f7 !important;\n    }\n\n    .kanban-container {\n      scroll-behavior: smooth;\n    }\n\n    @media (min-width: 768px) {\n      .kanban-card-draggable:hover {\n        transform: translateY(-4px);\n        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.15);\n      }\n    }\n    \n    /* Animaciones para cambios de estado */\n    @keyframes fadeIn {\n      0% { opacity: 0; }\n      100% { opacity: 1; }\n    }\n    \n    @keyframes slideIn {\n      0% { transform: translateY(10px); opacity: 0; }\n      100% { transform: translateY(0); opacity: 1; }\n    }\n    \n    @keyframes processingPulse {\n      0% { box-shadow: 0 0 0 0 rgba(124, 58, 237, 0.4); }\n      70% { box-shadow: 0 0 0 6px rgba(124, 58, 237, 0); }\n      100% { box-shadow: 0 0 0 0 rgba(124, 58, 237, 0); }\n    }\n    \n    .kanban-card {\n      animation: fadeIn 0.3s ease-out;\n    }\n    \n    .processing-toast {\n      position: fixed;\n      bottom: 20px;\n      left: 50%;\n      transform: translateX(-50%);\n      padding: 10px 20px;\n      background-color: white;\n      border-radius: 8px;\n      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n      z-index: 1000;\n      display: flex;\n      align-items: center;\n      gap: 8px;\n      animation: slideIn 0.3s ease-out;\n    }\n    \n    .auto-transition-toast {\n      position: fixed;\n      bottom: 70px;\n      left: 50%;\n      transform: translateX(-50%);\n      padding: 10px 20px;\n      background-color: #dcfce7;\n      border: 1px solid #86efac;\n      border-radius: 8px;\n      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n      z-index: 1000;\n      display: flex;\n      align-items: center;\n      gap: 8px;\n      animation: slideIn 0.3s ease-out;\n    }\n    \n    /* Pop-up tooltip con instrucciones para arrastrar */\n    .drag-instructions {\n      position: fixed;\n      top: 20px;\n      right: 20px;\n      background-color: white;\n      border-radius: 8px;\n      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n      padding: 12px 16px;\n      z-index: 1000;\n      max-width: 300px;\n      animation: fadeIn 0.3s ease-out;\n    }\n    \n    /* Mejoras para vista mobile */\n    @media (max-width: 640px) {\n      .kanban-column {\n        min-height: 300px;\n      }\n    }\n  "}),d&&(0,Le.jsxs)("div",{className:"processing-toast",children:[(0,Le.jsx)("span",{className:"loading loading-spinner loading-sm text-primary"}),(0,Le.jsx)("p",{className:"font-medium",children:"Actualizando estado..."})]}),_&&(0,Le.jsxs)("div",{className:"auto-transition-toast",children:[(0,Le.jsx)("span",{className:"loading loading-spinner loading-sm text-success"}),(0,Le.jsx)("p",{className:"font-medium",children:_})]}),i&&(0,Le.jsxs)("div",{className:"mb-4 alert alert-error shadow-lg",children:[(0,Le.jsxs)("div",{children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current flex-shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,Le.jsx)("span",{children:i})]}),(0,Le.jsx)("div",{className:"flex-none",children:(0,Le.jsx)("button",{className:"btn btn-sm",onClick:()=>o(null),children:"Cerrar"})})]}),(0,Le.jsx)("div",{className:"mb-6",children:(0,Le.jsxs)("div",{className:"bg-base-100 border border-base-300 rounded-lg shadow-sm",children:[(0,Le.jsxs)("div",{className:"flex justify-between items-center p-4 border-b border-base-300",children:[(0,Le.jsxs)("div",{className:"relative flex-grow mr-4",children:[(0,Le.jsx)("input",{type:"text",placeholder:"Buscar por nombre o email...",className:"input input-bordered w-full pr-10",value:j,onChange:e=>N(e.target.value)}),(0,Le.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:(0,Le.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),(0,Le.jsxs)("button",{className:"btn btn-ghost btn-sm",onClick:()=>$(!L),children:[L?"Ocultar Filtros":"Mostrar Filtros",(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 ml-2 transform "+(L?"rotate-180":""),viewBox:"0 0 20 20",fill:"currentColor",children:(0,Le.jsx)("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]})]}),L&&(0,Le.jsxs)("div",{className:"bg-base-200 p-4 rounded-lg",children:[(0,Le.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Filtros Avanzados"}),(0,Le.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4",children:[(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Estado"})}),(0,Le.jsxs)("select",{className:"select select-bordered w-full",value:E,onChange:e=>S(e.target.value),children:[(0,Le.jsx)("option",{value:"all",children:"Todos los estados"}),Object.entries(Ul).map((e=>{let[t,n]=e;return(0,Le.jsx)("option",{value:n,children:Wl[n]||n},t)}))]})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Tipo de Aplicaci\xf3n"})}),(0,Le.jsxs)("select",{className:"select select-bordered w-full",value:k,onChange:e=>C(e.target.value),children:[(0,Le.jsx)("option",{value:"all",children:"Todos los tipos"}),Object.entries(ft.APPLICATION_TYPE_LABELS).map((e=>{let[t,n]=e;return(0,Le.jsx)("option",{value:t,children:n},t)}))]})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Fecha Desde"})}),(0,Le.jsx)("input",{type:"date",className:"input input-bordered w-full",value:A,onChange:e=>T(e.target.value)})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Fecha Hasta"})}),(0,Le.jsx)("input",{type:"date",className:"input input-bordered w-full",value:P,onChange:e=>I(e.target.value)})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Monto M\xednimo"})}),(0,Le.jsx)("input",{type:"number",placeholder:"0",className:"input input-bordered w-full",value:O,onChange:e=>R(e.target.value)})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Monto M\xe1ximo"})}),(0,Le.jsx)("input",{type:"number",placeholder:"0",className:"input input-bordered w-full",value:M,onChange:e=>D(e.target.value)})]})]}),(0,Le.jsx)("div",{className:"flex justify-end",children:(0,Le.jsx)("button",{className:"btn btn-ghost",onClick:()=>{N(""),S("all"),C("all"),T(""),I(""),R(""),D("")},children:"Limpiar Filtros"})})]})]})}),(0,Le.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 2xl:grid-cols-6 gap-4 pb-4 kanban-container p-4",style:{minWidth:"1000px"},children:z.map((e=>{const t=e.applications.filter((e=>{var t,n;if(j&&!(null!==(t=e.client_name)&&void 0!==t&&t.toLowerCase().includes(j.toLowerCase())||null!==(n=e.client_email)&&void 0!==n&&n.toLowerCase().includes(j.toLowerCase())))return!1;if("all"!==E&&e.status!==E)return!1;if("all"!==k&&e.application_type!==k)return!1;if(A&&new Date(e.created_at)<new Date(A))return!1;if(P){const t=new Date(e.created_at),n=new Date(P);if(n.setHours(23,59,59,999),t>n)return!1}return!(O&&parseFloat(O)>0&&(e.amount||e.requested_amount||0)<parseFloat(O))&&!(M&&parseFloat(M)>0&&(e.amount||e.requested_amount||0)>parseFloat(M))}));return(0,Le.jsxs)("div",{className:`bg-base-100 rounded-xl shadow-md border-t-4 border-${e.color} border-l border-r border-b flex flex-col h-full kanban-column`,onDragOver:t=>{((e,t)=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="move",x.current!==t&&(x.current=t),e.currentTarget.classList.contains("kanban-column")&&(document.querySelectorAll(".kanban-column").forEach((e=>{e.classList.remove("drag-over")})),e.currentTarget.classList.add("drag-over"))})(t,e.id)},onDragLeave:e=>{e.currentTarget.classList.remove("drag-over")},onDrop:t=>{W(t,e.id)},children:[(0,Le.jsxs)("div",{className:`text-center py-3 px-4 font-bold rounded-t-lg flex items-center justify-between bg-${e.color} bg-opacity-10`,children:[(0,Le.jsx)("span",{className:`text-${e.color} font-bold text-lg`,children:e.title}),(0,Le.jsx)("span",{className:`badge badge-${e.color} badge-lg`,children:t.length})]}),(0,Le.jsx)("div",{className:"p-3 space-y-3 min-h-[500px] max-h-[calc(100vh-220px)] overflow-y-auto custom-scrollbar flex-grow",children:0===t.length?(0,Le.jsx)("div",{className:"flex items-center justify-center h-full opacity-50 border-2 border-dashed border-base-300 rounded-lg p-6",children:(0,Le.jsxs)("div",{className:"text-center",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 mx-auto text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,Le.jsx)("p",{className:"text-sm mt-2",children:"No hay solicitudes"})]})}):t.map(((t,a)=>{var r,s;const i=U(t)&&t.id!==d;return(0,Le.jsx)("div",{"data-tip":G(t),className:`card shadow hover:shadow-lg transition-all ${Y(t)} border-l-4 border-t border-r border-b hover:border-primary kanban-card relative ${t.id===d?"processing":""} ${t.isMoving?"opacity-90":""} ${J(t)}`,draggable:i,onDragStart:i?e=>((e,t,n)=>{if(y.current=n,v.current=e.currentTarget,e.dataTransfer.setData("text/plain",t.id),e.dataTransfer.effectAllowed="move",b.current||(b.current=e.currentTarget.cloneNode(!0),b.current.style.position="absolute",b.current.style.top="-1000px",b.current.style.opacity="0.8",b.current.style.transform="scale(0.9)",b.current.style.width=`${e.currentTarget.offsetWidth}px`,document.body.appendChild(b.current)),b.current){const t=e.currentTarget.getBoundingClientRect();e.dataTransfer.setDragImage(b.current,t.width/2,20)}e.currentTarget&&e.currentTarget.classList.add("dragging")})(e,t,a):void 0,onDragEnd:i?B:void 0,style:{animation:t.id===d?"processingPulse 1.5s infinite":""},children:(0,Le.jsxs)("div",{className:"card-body p-4",children:[(0,Le.jsx)("div",{className:"flex justify-between items-start mb-2",children:(0,Le.jsxs)("div",{className:"flex flex-col",children:[(0,Le.jsx)("div",{className:"font-semibold mb-1",children:t.client_name}),q(t.application_type||"",e.color)]})}),(0,Le.jsxs)("div",{className:"mt-1",children:[(0,Le.jsxs)("div",{className:"text-sm text-gray-600 mb-2 flex items-center",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1 inline flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),(0,Le.jsx)("span",{className:"truncate max-w-[180px] font-medium",children:t.company_name||"Sin empresa"})]}),(0,Le.jsxs)("div",{className:"text-xs text-gray-500 mb-2 flex items-center",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1 inline flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,Le.jsx)("span",{children:t.created_at?vt(t.created_at,"datetime"):"N/A"})]}),(0,Le.jsxs)("div",{className:"flex items-center mb-3",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1 text-primary flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,Le.jsx)("span",{className:"text-base font-bold text-primary",children:(l=t.requested_amount||0,new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(l))})]}),V(t),(0,Le.jsxs)("div",{className:"card-actions justify-end mt-3",children:[m()&&t.status===Ul.POR_DISPERSAR&&(0,Le.jsx)("button",{onClick:e=>{e.stopPropagation(),e.preventDefault(),n&&(u(t.id),n(t,Ul.COMPLETED).then((()=>{w(`Solicitud ${t.id} marcada como Completada correctamente`),setTimeout((()=>w(null)),3e3)})).catch((e=>{o(`Error al marcar como completado: ${e.message}`)})).finally((()=>{u(null)})))},className:"btn btn-sm btn-accent w-full mb-2",children:"Marcar como Dispersado"}),m()&&(null===(r=t.approvalStatus)||void 0===r?void 0:r.approvedByAdvisor)&&(null===(s=t.approvalStatus)||void 0===s?void 0:s.approvedByCompany)&&t.status!==Ul.POR_DISPERSAR&&t.status!==Ul.COMPLETED&&(0,Le.jsx)("button",{onClick:e=>{e.stopPropagation(),e.preventDefault(),n&&!d&&(u(t.id),n(t,Ul.POR_DISPERSAR).then((()=>{w("Solicitud movida a Por Dispersar"),setTimeout((()=>w(null)),3e3)})).catch((e=>{console.error("Error al mover a Por Dispersar:",e)})).finally((()=>{setTimeout((()=>u(null)),500)})))},className:"btn btn-xs btn-accent w-full mt-2 mb-2",children:"Mover a Por Dispersar"}),(0,Le.jsx)(Te,{to:`/applications/${t.id}`,className:"btn btn-sm btn-primary w-full",children:"Ver Detalle"})]})]})]})},t.id);var l}))})]},e.id)}))})]})},ac=()=>{const{userCan:e}=Je(),{user:t}=Ue(),{getEntityFilter:n,shouldFilterByEntity:a}=Je(),[s,i]=(0,r.useState)([]),[o,l]=(0,r.useState)(!0),[c,d]=(0,r.useState)(null),[u,h]=(0,r.useState)(null),p=r.useRef(!1),[m,f]=(0,r.useState)(""),[g,v]=(0,r.useState)("all"),[b,y]=(0,r.useState)("all"),[x,_]=(0,r.useState)(""),[w,j]=(0,r.useState)(""),[N,E]=(0,r.useState)(""),[S,k]=(0,r.useState)(""),[C,A]=(0,r.useState)(!1),T=(0,r.useCallback)((async()=>{try{l(!0),d(null);const e=a()?n():null,t={status:"all"!==g?g:void 0,searchQuery:m||void 0,application_type:"all"!==b?b:void 0,dateFrom:x||void 0,dateTo:w||void 0,amountMin:N?parseFloat(N):void 0,amountMax:S?parseFloat(S):void 0},r=await ql(t,e);console.log("Aplicaciones recuperadas:",r);const s=[...r].sort(((e,t)=>{const n=new Date(e.created_at),a=new Date(t.created_at);return n.getTime()-a.getTime()}));i(s),p.current=!1}catch(c){console.error("Error fetching applications:",c),d("Error al cargar las solicitudes: "+(c.message||"Error desconocido"))}finally{l(!1)}}),[a,n,m,g,b,x,w,N,S]);(0,r.useEffect)((()=>{T();const e=setInterval((()=>{p.current&&T()}),5e3);return()=>clearInterval(e)}),[T]);return e(Ve.VIEW_APPLICATIONS)?(0,Le.jsx)(_t,{children:(0,Le.jsxs)("div",{className:"p-6 max-w-[2000px] mx-auto",children:[(0,Le.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 gap-4",children:[(0,Le.jsxs)("div",{children:[(0,Le.jsx)("h1",{className:"text-3xl font-bold text-primary",children:"Tablero Kanban"}),(0,Le.jsx)("p",{className:"text-gray-600 mt-1",children:"Visualiza y gestiona tus solicitudes arrastrando las tarjetas entre columnas"})]}),(0,Le.jsxs)("div",{className:"flex gap-2",children:[(0,Le.jsxs)(Te,{to:"/applications",className:"btn btn-outline btn-md",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})}),"Vista Lista"]}),e(Ve.CREATE_APPLICATION)&&(0,Le.jsxs)(Te,{to:"/applications/new",className:"btn btn-primary btn-md",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Le.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})}),"Nueva Solicitud"]}),(0,Le.jsxs)("button",{onClick:T,className:"btn btn-outline btn-md",title:"Sincronizar datos",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Sincronizar"]}),(0,Le.jsxs)("button",{className:"btn btn-outline btn-md",onClick:()=>{A(!C)},children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"Filtros"]})]})]}),C&&(0,Le.jsxs)("div",{className:"mb-6 bg-base-200 p-4 rounded-lg shadow-sm",children:[(0,Le.jsxs)("div",{className:"mb-2 flex justify-between items-center",children:[(0,Le.jsx)("h3",{className:"font-bold text-lg",children:"Filtros de b\xfasqueda"}),(0,Le.jsx)("button",{onClick:()=>{f(""),v("all"),y("all"),_(""),j(""),E(""),k("")},className:"btn btn-sm btn-ghost",children:"Limpiar filtros"})]}),(0,Le.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Buscar"})}),(0,Le.jsx)("input",{type:"text",className:"input input-bordered w-full",placeholder:"Nombre, email...",value:m,onChange:e=>f(e.target.value)})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Estado"})}),(0,Le.jsxs)("select",{className:"select select-bordered w-full",value:g,onChange:e=>v(e.target.value),children:[(0,Le.jsx)("option",{value:"all",children:"Todos los estados"}),Object.values(Ul).map((e=>(0,Le.jsx)("option",{value:e,children:Wl[e]||e},e)))]})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Tipo"})}),(0,Le.jsxs)("select",{className:"select select-bordered w-full",value:b,onChange:e=>y(e.target.value),children:[(0,Le.jsx)("option",{value:"all",children:"Todos los tipos"}),Object.entries(ft.APPLICATION_TYPE).map((e=>{let[t,n]=e;return(0,Le.jsx)("option",{value:n,children:ft.APPLICATION_TYPE_LABELS[t]||t},t)}))]})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Fecha desde"})}),(0,Le.jsx)("input",{type:"date",className:"input input-bordered w-full",value:x,onChange:e=>_(e.target.value)})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Fecha hasta"})}),(0,Le.jsx)("input",{type:"date",className:"input input-bordered w-full",value:w,onChange:e=>j(e.target.value)})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Monto m\xednimo"})}),(0,Le.jsx)("input",{type:"number",className:"input input-bordered w-full",placeholder:"0",value:N,onChange:e=>E(e.target.value)})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Monto m\xe1ximo"})}),(0,Le.jsx)("input",{type:"number",className:"input input-bordered w-full",placeholder:"1000000",value:S,onChange:e=>k(e.target.value)})]}),(0,Le.jsx)("div",{className:"form-control md:self-end",children:(0,Le.jsx)("button",{className:"btn btn-primary mt-8",onClick:T,children:"Aplicar filtros"})})]})]}),c&&(0,Le.jsx)(Zl,{type:"error",message:c,onClose:()=>d(null),className:"mb-6"}),u&&(0,Le.jsx)(Zl,{type:"success",message:u,onClose:()=>h(null),autoClose:!0,className:"mb-6"}),o&&0===s.length?(0,Le.jsx)("div",{className:"flex justify-center items-center h-96 w-full",children:(0,Le.jsxs)("div",{className:"text-center",children:[(0,Le.jsx)("span",{className:"loading loading-spinner loading-lg text-primary"}),(0,Le.jsx)("p",{className:"mt-4 text-gray-500",children:"Cargando solicitudes..."})]})}):(0,Le.jsx)("div",{className:"bg-base-100 shadow-xl rounded-xl overflow-hidden border border-base-300",children:(0,Le.jsx)(nc,{applications:s,onStatusChange:e(Ve.EDIT_APPLICATION)?async(e,r)=>{var s;if(t)try{const o=a()?n():null,l=`Cambio de estado de ${e.status} a ${r} v\xeda Kanban`;await Gl(e.id,r,l,t.id,o);const c={...e,status:r};s=c,i((e=>e.map((e=>e.id===s.id?s:e)))),p.current=!0,h(`Solicitud de ${e.client_name||"cliente"} actualizada correctamente a "${r}"`),setTimeout((()=>{h(null)}),3e3)}catch(c){throw console.error("Error updating application status:",c),d(`Error al actualizar el estado: ${c.message||"Error desconocido"}`),c}else d("No has iniciado sesi\xf3n. Por favor, inicia sesi\xf3n para realizar esta acci\xf3n.")}:void 0})})]})}):(0,Le.jsx)(_t,{children:(0,Le.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,Le.jsxs)("div",{className:"text-center",children:[(0,Le.jsx)("h2",{className:"text-2xl font-bold text-gray-700",children:"Acceso Restringido"}),(0,Le.jsx)("p",{className:"text-gray-500 mt-2",children:"No tienes permisos para ver esta p\xe1gina."})]})})})},rc=()=>{const{id:e}=ae(),t=ne(),{user:a}=Ue(),{addNotification:s,showPopup:i}=nt(),[o,l]=(0,r.useState)(null),[c,d]=(0,r.useState)(!0),[u,h]=(0,r.useState)(null),[p,m]=(0,r.useState)(null),[f,g]=(0,r.useState)(!1),[v,b]=(0,r.useState)(null),{shouldFilterByEntity:y,getEntityFilter:x,userCan:_,isAdvisor:w,isCompanyAdmin:j}=Je();(0,r.useEffect)((()=>{(async()=>{try{d(!0),h(null);if(!e||!/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e))throw new Error("ID de solicitud inv\xe1lido");const t=await Jl(e);l(t);const n=await Ql(e);m(n)}catch(n){console.error("Error al cargar la solicitud:",n),h(n instanceof Error?n.message:"Error al cargar los datos de la solicitud"),i({title:"Solicitud no encontrada",message:"No se pudo encontrar la solicitud especificada. Es posible que haya sido eliminada o que no tengas permisos para verla.",type:et.ERROR,playSound:!0,soundType:"alert"}),setTimeout((()=>{t("/applications")}),3e3)}finally{d(!1)}})()}),[e,i,t]);const N=async t=>{if(e&&a&&o)try{g(!0),h(null);const n=y()?x():null,r=Wl[t]||t;if(j()&&t===Ul.IN_REVIEW&&null!==p&&void 0!==p&&p.approvedByCompany){console.log("Quitando aprobaci\xf3n de empresa antes de cambiar el estado");const t=`\n          UPDATE ${$l.APPLICATIONS}\n          SET approved_by_company = false, \n              approval_date_company = NULL,\n              status = '${Ul.IN_REVIEW}'\n          WHERE id = '${e}' AND company_id = '${null===n||void 0===n?void 0:n.company_id}'\n          RETURNING *\n        `;try{const a=await fetch("http://localhost:3100/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:t})}),s=await a.json();if(console.log("Resultado de quitar aprobaci\xf3n:",s),s.error)throw new Error(`Error al quitar aprobaci\xf3n: ${s.error}`);console.log("\u2705 Aprobaci\xf3n de empresa removida correctamente");const i=await Ql(e,n);m(i),b(`Aprobaci\xf3n de empresa removida y solicitud actualizada a "${r}"`);const o=await Jl(e,n);return l(o),setTimeout((()=>b(null)),3e3),void g(!1)}catch(u){console.error("Error al quitar aprobaci\xf3n:",u)}}await Gl(e,t,`Cambio de estado a ${r} desde vista detalle`,a.id,n);const s=await Jl(e,n);l(s);const i=await Ql(e,n);m(i),b(`Solicitud actualizada correctamente a "${r}"`),setTimeout((()=>b(null)),3e3)}catch(u){console.error("Error updating application status:",u),h(`Error al actualizar el estado: ${u.message||"Error desconocido"}`)}finally{g(!1)}};return _(Ve.VIEW_APPLICATIONS)?(0,Le.jsx)(_t,{children:(0,Le.jsxs)("div",{className:"p-6",children:[(0,Le.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Le.jsx)("h1",{className:"text-2xl font-bold",children:"Detalle de Solicitud"}),(0,Le.jsxs)("div",{className:"space-x-2",children:[(0,Le.jsx)(Te,{to:"/applications",className:"btn btn-ghost",children:"Volver"}),o&&_(Ve.EDIT_APPLICATION)&&(0,Le.jsx)(Te,{to:`/applications/${e}/edit`,className:"btn btn-primary",children:"Editar"})]})]}),u&&(0,Le.jsx)(Zl,{type:"error",message:u,onClose:()=>h(null),className:"mb-6"}),v&&(0,Le.jsx)(Zl,{type:"success",message:v,onClose:()=>b(null),className:"mb-6"}),c?(0,Le.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,Le.jsx)("span",{className:"loading loading-spinner loading-lg"})}):o?(0,Le.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,Le.jsx)("div",{className:"card bg-base-100 shadow-xl col-span-2",children:(0,Le.jsxs)("div",{className:"card-body",children:[(0,Le.jsx)("h2",{className:"card-title text-lg border-b pb-2 mb-4",children:"Informaci\xf3n de la Solicitud"}),(0,Le.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Le.jsxs)("div",{children:[(0,Le.jsx)("p",{className:"text-sm text-gray-500",children:"ID de Solicitud"}),(0,Le.jsx)("p",{className:"font-medium",children:o.id})]}),(0,Le.jsxs)("div",{children:[(0,Le.jsx)("p",{className:"text-sm text-gray-500",children:"Fecha de Creaci\xf3n"}),(0,Le.jsx)("p",{className:"font-medium",children:vt(o.created_at,"short")})]}),(0,Le.jsxs)("div",{className:"mb-4",children:[(0,Le.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"Tipo de Producto"}),(0,Le.jsx)("p",{className:"text-sm text-gray-900",children:(()=>{const e=o.application_type;if(!e)return"No especificado";if("selected_plans"===e)return"Planes Seleccionados";if("product_simulations"===e)return"Simulaci\xf3n de Producto";if("cash_requests"===e)return"Solicitud de Efectivo";const{APPLICATION_TYPE_LABELS:t}=n(823);return t&&t[e]?t[e]:e.split("_").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" ")})()})]}),(0,Le.jsxs)("div",{children:[(0,Le.jsx)("p",{className:"text-sm text-gray-500",children:"Estado"}),(0,Le.jsx)("p",{children:(0,Le.jsx)("span",{className:`badge ${(e=>{switch(e){case"pending":return"badge-warning";case"in_review":return"badge-info";case"approved":return"badge-success";case"rejected":return"badge-error";default:return"badge-ghost"}})(o.status)}`,children:Wl[o.status]||o.status})})]}),(0,Le.jsxs)("div",{children:[(0,Le.jsx)("p",{className:"text-sm text-gray-500",children:"Monto Solicitado"}),(0,Le.jsx)("p",{className:"font-medium",children:(E=o.requested_amount||o.amount||0,new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:2,maximumFractionDigits:2}).format(E))})]})]}),p&&(0,Le.jsxs)("div",{className:"mt-6 pt-4 border-t",children:[(0,Le.jsx)("h3",{className:"font-semibold mb-4",children:"Estado de Aprobaci\xf3n"}),(0,Le.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Le.jsxs)("div",{className:"border rounded-lg p-3",children:[(0,Le.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Le.jsx)("p",{className:"font-medium",children:"Asesor"}),p.approvedByAdvisor?(0,Le.jsx)("span",{className:"badge badge-success",children:"Aprobado"}):(0,Le.jsx)("span",{className:"badge badge-warning",children:"Pendiente"})]}),p.approvalDateAdvisor&&(0,Le.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Fecha: ",vt(p.approvalDateAdvisor,"short")]}),w()&&!p.approvedByAdvisor&&(0,Le.jsx)("button",{onClick:async()=>{if(e&&a&&o)try{g(!0),h(null);const t=y()?x():null,n=(await Xl(e,"Solicitud aprobada por el asesor",a.id,t),await Jl(e,t));l(n);const r=await Ql(e,t);m(r),b("Solicitud aprobada correctamente como asesor"),r.approvedByAdvisor&&r.approvedByCompany&&b("\xa1Aprobaci\xf3n completa! La solicitud ha sido aprobada por ambas partes."),setTimeout((()=>b(null)),3e3)}catch(u){console.error("Error approving as advisor:",u),h(`Error al aprobar: ${u.message||"Error desconocido"}`)}finally{g(!1)}},disabled:f,className:"btn btn-sm btn-primary mt-2 w-full",children:f?(0,Le.jsx)("span",{className:"loading loading-spinner loading-xs"}):"Aprobar como Asesor"})]}),(0,Le.jsxs)("div",{className:"border rounded-lg p-3",children:[(0,Le.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Le.jsx)("p",{className:"font-medium",children:"Empresa"}),p.approvedByCompany?(0,Le.jsx)("span",{className:"badge badge-success",children:"Aprobado"}):(0,Le.jsx)("span",{className:"badge badge-warning",children:"Pendiente"})]}),p.approvalDateCompany&&(0,Le.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Fecha: ",vt(p.approvalDateCompany,"short")]}),j()&&!p.approvedByCompany&&(0,Le.jsx)("button",{onClick:async()=>{if(e&&a&&o)try{g(!0),h(null);const t=y()?x():null;if(null===t||void 0===t||!t.company_id)throw new Error("No tienes una empresa asociada para realizar esta aprobaci\xf3n");await Kl(e,"Solicitud aprobada por la empresa",a.id,t.company_id,t);const n=await Jl(e,t);l(n);const r=await Ql(e,t);m(r),b("Solicitud aprobada correctamente como empresa"),r.approvedByAdvisor&&r.approvedByCompany&&b("\xa1Aprobaci\xf3n completa! La solicitud ha sido aprobada por ambas partes."),setTimeout((()=>b(null)),3e3)}catch(u){console.error("Error approving as company:",u),h(`Error al aprobar: ${u.message||"Error desconocido"}`)}finally{g(!1)}},disabled:f,className:"btn btn-sm btn-primary mt-2 w-full",children:f?(0,Le.jsx)("span",{className:"loading loading-spinner loading-xs"}):"Aprobar como Empresa"}),j()&&p.approvedByCompany&&(0,Le.jsx)("button",{onClick:async()=>{if(e&&a&&o)try{g(!0),h(null);const t=y()?x():null;if(null===t||void 0===t||!t.company_id)throw new Error("No tienes una empresa asociada para realizar esta acci\xf3n");await(async(e,t,n,a,r)=>{if(null===r||void 0===r||!r.company_id||r.company_id!==a)throw new Error("Solo los administradores de la empresa pueden realizar esta acci\xf3n");let s=`\n    UPDATE ${$l.APPLICATIONS}\n    SET approved_by_company = false, \n        approval_date_company = NULL,\n        status = '${Ul.IN_REVIEW}'\n    WHERE id = '${e}' AND company_id = '${a}'\n    RETURNING *\n  `;try{const a=await Hl(s);if(!a||0===a.length)throw new Error("Solicitud no encontrada o no tienes permisos para cancelar la aprobaci\xf3n");const r=`\n      INSERT INTO ${Vl} (application_id, status, comment, created_by)\n      VALUES ('${e}', '${Ul.IN_REVIEW}', '${t}', '${n}')\n      RETURNING *\n    `;return await Hl(r),a[0]}catch(u){throw console.error(`Error cancelando aprobaci\xf3n de solicitud ${e} por empresa:`,u),u}})(e,"Aprobaci\xf3n cancelada por la empresa",a.id,t.company_id,t);const n=await Jl(e,t);l(n);const r=await Ql(e,t);m(r),b("Aprobaci\xf3n de empresa cancelada correctamente"),setTimeout((()=>b(null)),3e3)}catch(u){console.error("Error canceling company approval:",u),h(`Error al cancelar aprobaci\xf3n: ${u.message||"Error desconocido"}`)}finally{g(!1)}},disabled:f,className:"btn btn-sm btn-warning mt-2 w-full",children:f?(0,Le.jsx)("span",{className:"loading loading-spinner loading-xs"}):"Deshacer Aprobaci\xf3n"})]})]})]})]})}),(0,Le.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,Le.jsxs)("div",{className:"card-body",children:[(0,Le.jsx)("h2",{className:"card-title text-lg border-b pb-2 mb-4",children:"Informaci\xf3n del Cliente"}),(0,Le.jsxs)("div",{className:"space-y-4",children:[(0,Le.jsxs)("div",{children:[(0,Le.jsx)("p",{className:"text-sm text-gray-500",children:"Nombre"}),(0,Le.jsx)("p",{className:"font-medium",children:o.client_name})]}),(0,Le.jsxs)("div",{children:[(0,Le.jsx)("p",{className:"text-sm text-gray-500",children:"Email"}),(0,Le.jsx)("p",{className:"font-medium",children:o.client_email})]})]})]})}),(o.company_id||o.company_name)&&(0,Le.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,Le.jsxs)("div",{className:"card-body",children:[(0,Le.jsx)("h2",{className:"card-title text-lg border-b pb-2 mb-4",children:"Informaci\xf3n de la Empresa"}),(0,Le.jsxs)("div",{className:"space-y-4",children:[o.company_name&&(0,Le.jsxs)("div",{children:[(0,Le.jsx)("p",{className:"text-sm text-gray-500",children:"Nombre de la Empresa"}),(0,Le.jsx)("p",{className:"font-medium",children:o.company_name})]}),o.company_id&&(0,Le.jsxs)("div",{children:[(0,Le.jsx)("p",{className:"text-sm text-gray-500",children:"ID de la Empresa"}),(0,Le.jsx)("p",{className:"font-medium",children:o.company_id})]})]})]})}),o.assigned_to&&(0,Le.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,Le.jsxs)("div",{className:"card-body",children:[(0,Le.jsx)("h2",{className:"card-title text-lg border-b pb-2 mb-4",children:"Asesor Asignado"}),(0,Le.jsxs)("div",{className:"space-y-4",children:[(0,Le.jsxs)("div",{children:[(0,Le.jsx)("p",{className:"text-sm text-gray-500",children:"ID del Asesor"}),(0,Le.jsx)("p",{className:"font-medium",children:o.assigned_to})]}),o.advisor_name&&(0,Le.jsxs)("div",{children:[(0,Le.jsx)("p",{className:"text-sm text-gray-500",children:"Nombre del Asesor"}),(0,Le.jsx)("p",{className:"font-medium",children:o.advisor_name})]})]})]})})]}):(0,Le.jsx)("div",{className:"text-center p-10",children:(0,Le.jsx)("h3",{className:"text-xl text-gray-500",children:"No se encontr\xf3 la solicitud"})}),o&&o.status===Ul.APPROVED&&w()&&(0,Le.jsxs)("div",{className:"mt-4 p-4 bg-base-200 rounded-lg",children:[(0,Le.jsx)("h3",{className:"font-medium mb-2",children:"Acciones disponibles"}),(0,Le.jsx)("div",{className:"flex flex-col space-y-2",children:(0,Le.jsx)("button",{onClick:()=>N(Ul.POR_DISPERSAR),className:"btn btn-accent",disabled:f,children:f?(0,Le.jsx)("span",{className:"loading loading-spinner loading-xs"}):"Marcar como Por Dispersar"})})]}),o&&o.status===Ul.POR_DISPERSAR&&w()&&(0,Le.jsxs)("div",{className:"mt-4 p-4 bg-base-200 rounded-lg",children:[(0,Le.jsx)("h3",{className:"font-medium mb-2",children:"Acciones disponibles"}),(0,Le.jsx)("div",{className:"flex flex-col space-y-2",children:(0,Le.jsx)("button",{onClick:()=>N(Ul.COMPLETED),className:"btn btn-primary",disabled:f,children:f?(0,Le.jsx)("span",{className:"loading loading-spinner loading-xs"}):"Marcar como Completado (Dispersado)"})})]})]})}):(0,Le.jsx)(_t,{children:(0,Le.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,Le.jsxs)("div",{className:"text-center",children:[(0,Le.jsx)("h2",{className:"text-2xl font-bold text-gray-700",children:"Acceso Restringido"}),(0,Le.jsx)("p",{className:"text-gray-500 mt-2",children:"No tienes permisos para ver esta p\xe1gina."})]})})});var E},sc={client_name:"",client_email:"",client_phone:"",client_address:"",dni:"",amount:0,term:12,interest_rate:0,monthly_payment:0,application_type:"personal_loan",status:Ul.PENDING,company_id:"",company_name:"",assigned_to:""},ic=()=>{const{id:e}=ae(),t=ne(),{userCan:n}=Je(),{user:a}=Ue(),{shouldFilterByEntity:s,getEntityFilter:i}=Je(),{addNotification:o,showPopup:l}=nt(),c=!!e,[d,u]=(0,r.useState)(sc),[h,p]=(0,r.useState)(c),[m,f]=(0,r.useState)(!1),[g,v]=(0,r.useState)(null),[b,y]=(0,r.useState)(null);(0,r.useEffect)((()=>{if(c&&e){const t=async()=>{try{p(!0),v(null);const t=s()?i():null,n=await Jl(e,t);u({client_name:n.client_name||"",client_email:n.client_email||"",client_phone:n.client_phone||"",client_address:n.client_address||"",dni:n.dni||"",amount:n.amount||0,term:n.term||12,interest_rate:n.interest_rate||0,monthly_payment:n.monthly_payment||0,application_type:n.application_type||"personal_loan",status:n.status,company_id:n.company_id||"",company_name:n.company_name||"",assigned_to:n.assigned_to||""})}catch(g){console.error("Error fetching application:",g),v(`Error al cargar la solicitud: ${g.message||"Error desconocido"}`)}finally{p(!1)}};t()}else if(!c&&a){const e=s()?i():null;e&&(e.advisor_id&&u((t=>({...t,assigned_to:e.advisor_id}))),e.company_id&&u((t=>({...t,company_id:e.company_id}))))}}),[e,c,a,s,i]);const x=e=>{const{name:t,value:n,type:a}=e.target;u("number"===a?e=>({...e,[t]:parseFloat(n)||0}):e=>({...e,[t]:n}))};return n(c?Ve.EDIT_APPLICATION:Ve.CREATE_APPLICATION)?(0,Le.jsx)(_t,{children:(0,Le.jsxs)("div",{className:"p-6",children:[(0,Le.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Le.jsx)("h1",{className:"text-2xl font-bold",children:c?"Editar Solicitud":"Nueva Solicitud"}),(0,Le.jsx)(Te,{to:c?`/applications/${e}`:"/applications",className:"btn btn-ghost",children:"Cancelar"})]}),g&&(0,Le.jsx)(Zl,{type:"error",message:g,onClose:()=>v(null),className:"mb-6"}),b&&(0,Le.jsx)(Zl,{type:"success",message:b,onClose:()=>y(null),className:"mb-6"}),h?(0,Le.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,Le.jsx)("span",{className:"loading loading-spinner loading-lg"})}):(0,Le.jsxs)("form",{onSubmit:async n=>{n.preventDefault();try{if(f(!0),v(null),!d.client_name)return v("El nombre del cliente es obligatorio"),void f(!1);const n=s()?i():null;if(c&&e){const t={client_name:d.client_name,client_email:d.client_email,client_phone:d.client_phone,client_address:d.client_address,dni:d.dni,amount:d.amount,term:d.term,interest_rate:d.interest_rate,monthly_payment:d.monthly_payment,application_type:d.application_type,status:d.status,company_id:d.company_id,company_name:d.company_name,assigned_to:d.assigned_to};await(async(e,t,n)=>{const a=Object.entries(t).map((e=>{let[t,n]=e;return`${t} = ${"string"===typeof n?`'${n}'`:n}`})).join(", ");let r=`\n    UPDATE ${$l.APPLICATIONS}\n    SET ${a}\n    WHERE id = '${e}'\n  `;n&&(n.advisor_id&&(r+=` AND assigned_to = '${n.advisor_id}'`),n.company_id&&(r+=` AND company_id = '${n.company_id}'`)),r+=" RETURNING *";try{const e=await Hl(r);if(e&&e.length>0)return e[0];throw new Error("Application not found or you do not have permission to update it")}catch(g){throw console.error(`Error updating application with ID ${e}:`,g),g}})(e,t,n),y("Solicitud actualizada con \xe9xito")}else{const e={client_name:d.client_name,client_email:d.client_email,client_phone:d.client_phone,client_address:d.client_address,dni:d.dni,amount:d.amount,term:d.term,interest_rate:d.interest_rate,monthly_payment:d.monthly_payment,application_type:d.application_type,status:d.status,company_id:d.company_id,company_name:d.company_name,assigned_to:d.assigned_to,client_id:"",requested_amount:d.amount,approved_by_advisor:!1,approved_by_company:!1},n=await(async e=>{const t=Object.keys(e).join(", "),n=Object.values(e).map((e=>"string"===typeof e?`'${e}'`:e)).join(", "),a=`\n    INSERT INTO ${$l.APPLICATIONS} (${t})\n    VALUES (${n})\n    RETURNING *\n  `;try{return(await Hl(a))[0]}catch(g){throw console.error("Error creating application:",g),g}})(e);if(y("Solicitud creada con \xe9xito"),n&&n.id){const e={title:"Nueva solicitud creada",message:`Se ha creado una nueva solicitud para ${d.client_name}`,type:et.NEW_APPLICATION,relatedItemType:"application",relatedItemId:n.id};o(e),l({...e,playSound:!0,soundType:"notification",duration:5e3})}setTimeout((()=>{t(`/applications/${n.id}`)}),1500)}}catch(g){console.error("Error saving application:",g),v(`Error al guardar la solicitud: ${g.message||"Error desconocido"}`)}finally{f(!1)}},className:"space-y-6",children:[(0,Le.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,Le.jsxs)("div",{className:"card-body",children:[(0,Le.jsx)("h2",{className:"card-title text-lg border-b pb-2 mb-4",children:"Informaci\xf3n del Cliente"}),(0,Le.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Nombre Completo*"})}),(0,Le.jsx)("input",{type:"text",name:"client_name",value:d.client_name,onChange:x,className:"input input-bordered",required:!0})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Email*"})}),(0,Le.jsx)("input",{type:"email",name:"client_email",value:d.client_email,onChange:x,className:"input input-bordered",required:!0})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Tel\xe9fono*"})}),(0,Le.jsx)("input",{type:"tel",name:"client_phone",value:d.client_phone,onChange:x,className:"input input-bordered",required:!0})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"DNI / Identificaci\xf3n"})}),(0,Le.jsx)("input",{type:"text",name:"dni",value:d.dni,onChange:x,className:"input input-bordered"})]}),(0,Le.jsxs)("div",{className:"form-control md:col-span-2",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Direcci\xf3n"})}),(0,Le.jsx)("input",{type:"text",name:"client_address",value:d.client_address,onChange:x,className:"input input-bordered"})]})]})]})}),(0,Le.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,Le.jsxs)("div",{className:"card-body",children:[(0,Le.jsx)("h2",{className:"card-title text-lg border-b pb-2 mb-4",children:"Informaci\xf3n del Cr\xe9dito"}),(0,Le.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Tipo de Aplicaci\xf3n*"})}),(0,Le.jsx)("select",{name:"application_type",value:d.application_type,onChange:x,className:"select select-bordered",required:!0,children:Object.values(ft.APPLICATION_TYPE).map((e=>(0,Le.jsx)("option",{value:e,children:ft.APPLICATION_TYPE_LABELS[e]},e)))})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Estado*"})}),(0,Le.jsx)("select",{name:"status",value:d.status,onChange:x,className:"select select-bordered",required:!0,children:Object.values(Ul).map((e=>(0,Le.jsx)("option",{value:e,children:Wl[e]},e)))})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Monto*"})}),(0,Le.jsx)("input",{type:"number",name:"amount",value:d.amount,onChange:x,className:"input input-bordered",min:"0",step:"1000",required:!0})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Plazo (meses)"})}),(0,Le.jsx)("input",{type:"number",name:"term",value:d.term,onChange:x,className:"input input-bordered",min:"1"})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Tasa de Inter\xe9s (%)"})}),(0,Le.jsx)("input",{type:"number",name:"interest_rate",value:d.interest_rate,onChange:x,className:"input input-bordered",min:"0",step:"0.01"})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Pago Mensual"})}),(0,Le.jsx)("input",{type:"number",name:"monthly_payment",value:d.monthly_payment,onChange:x,className:"input input-bordered",min:"0"})]})]})]})}),(0,Le.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,Le.jsxs)("div",{className:"card-body",children:[(0,Le.jsx)("h2",{className:"card-title text-lg border-b pb-2 mb-4",children:"Empresa y Asesor"}),(0,Le.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"ID de Empresa"})}),(0,Le.jsx)("input",{type:"text",name:"company_id",value:d.company_id,onChange:x,className:"input input-bordered"})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Nombre de Empresa"})}),(0,Le.jsx)("input",{type:"text",name:"company_name",value:d.company_name,onChange:x,className:"input input-bordered"})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"ID de Asesor Asignado"})}),(0,Le.jsx)("input",{type:"text",name:"assigned_to",value:d.assigned_to,onChange:x,className:"input input-bordered"})]})]})]})}),(0,Le.jsx)("div",{className:"flex justify-end",children:(0,Le.jsx)("button",{type:"submit",className:"btn btn-primary "+(m?"loading":""),disabled:m,children:c?"Actualizar Solicitud":"Crear Solicitud"})})]})]})}):(0,Le.jsx)(_t,{children:(0,Le.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,Le.jsxs)("div",{className:"text-center",children:[(0,Le.jsx)("h2",{className:"text-2xl font-bold text-gray-700",children:"Acceso Restringido"}),(0,Le.jsxs)("p",{className:"text-gray-500 mt-2",children:["No tienes permisos para ",c?"editar":"crear"," solicitudes."]})]})})})};class oc extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"FunctionsError",n=arguments.length>2?arguments[2]:void 0;super(e),this.name=t,this.context=n}}class lc extends oc{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class cc extends oc{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class dc extends oc{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var uc;!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(uc||(uc={}));var hc=function(e,t,n,a){return new(n||(n=Promise))((function(r,s){function i(e){try{l(a.next(e))}catch(Uu){s(Uu)}}function o(e){try{l(a.throw(e))}catch(Uu){s(Uu)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}l((a=a.apply(e,t||[])).next())}))};class pc{constructor(e){let{headers:t={},customFetch:a,region:r=uc.Any}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=t,this.region=r,this.fetch=(e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return Promise.resolve().then(n.bind(n,630)).then((e=>{let{default:n}=e;return n(...t)}))}:fetch),function(){return t(...arguments)}})(a)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;return hc(this,void 0,void 0,(function*(){try{const{headers:a,method:r,body:s}=t;let i,o={},{region:l}=t;l||(l=this.region),l&&"any"!==l&&(o["x-region"]=l),s&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&("undefined"!==typeof Blob&&s instanceof Blob||s instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",i=s):"string"===typeof s?(o["Content-Type"]="text/plain",i=s):"undefined"!==typeof FormData&&s instanceof FormData?i=s:(o["Content-Type"]="application/json",i=JSON.stringify(s)));const c=yield this.fetch(`${this.url}/${e}`,{method:r||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),a),body:i}).catch((e=>{throw new lc(e)})),d=c.headers.get("x-relay-error");if(d&&"true"===d)throw new cc(c);if(!c.ok)throw new dc(c);let u,h=(null!==(n=c.headers.get("Content-Type"))&&void 0!==n?n:"text/plain").split(";")[0].trim();return u="application/json"===h?yield c.json():"application/octet-stream"===h?yield c.blob():"text/event-stream"===h?c:"multipart/form-data"===h?yield c.formData():yield c.text(),{data:u,error:null}}catch(a){return{data:null,error:a}}}))}}var mc=n(980);const{PostgrestClient:fc,PostgrestQueryBuilder:gc,PostgrestFilterBuilder:vc,PostgrestTransformBuilder:bc,PostgrestBuilder:yc,PostgrestError:xc}=mc,_c={"X-Client-Info":"realtime-js/2.11.2"};var wc,jc,Nc,Ec,Sc,kc;!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(wc||(wc={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(jc||(jc={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(Nc||(Nc={})),function(e){e.websocket="websocket"}(Ec||(Ec={})),function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(Sc||(Sc={}));class Cc{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"===typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,t,n)}_decodeBroadcast(e,t,n){const a=t.getUint8(1),r=t.getUint8(2);let s=this.HEADER_LENGTH+2;const i=n.decode(e.slice(s,s+a));s+=a;const o=n.decode(e.slice(s,s+r));s+=r;return{ref:null,topic:i,event:o,payload:JSON.parse(n.decode(e.slice(s,e.byteLength)))}}}class Ac{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout((()=>{this.tries=this.tries+1,this.callback()}),this.timerCalc(this.tries+1))}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(kc||(kc={}));const Tc=function(e,t){var n;const a=null!==(n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipTypes)&&void 0!==n?n:[];return Object.keys(t).reduce(((n,r)=>(n[r]=Pc(r,e,t,a),n)),{})},Pc=(e,t,n,a)=>{const r=t.find((t=>t.name===e)),s=null===r||void 0===r?void 0:r.type,i=n[e];return s&&!a.includes(s)?Ic(s,i):Oc(i)},Ic=(e,t)=>{if("_"===e.charAt(0)){const n=e.slice(1,e.length);return Lc(t,n)}switch(e){case kc.bool:return Rc(t);case kc.float4:case kc.float8:case kc.int2:case kc.int4:case kc.int8:case kc.numeric:case kc.oid:return Mc(t);case kc.json:case kc.jsonb:return Dc(t);case kc.timestamp:return $c(t);case kc.abstime:case kc.date:case kc.daterange:case kc.int4range:case kc.int8range:case kc.money:case kc.reltime:case kc.text:case kc.time:case kc.timestamptz:case kc.timetz:case kc.tsrange:case kc.tstzrange:default:return Oc(t)}},Oc=e=>e,Rc=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Mc=e=>{if("string"===typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Dc=e=>{if("string"===typeof e)try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},Lc=(e,t)=>{if("string"!==typeof e)return e;const n=e.length-1,a=e[n];if("{"===e[0]&&"}"===a){let a;const r=e.slice(1,n);try{a=JSON.parse("["+r+"]")}catch(xh){a=r?r.split(","):[]}return a.map((e=>Ic(t,e)))}return e},$c=e=>"string"===typeof e?e.replace(" ","T"):e,zc=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class Fc{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e4;this.channel=e,this.event=t,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t(null===(n=this.receivedResp)||void 0===n?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},(e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)})),this.timeoutTimer=setTimeout((()=>{this.trigger("timeout",{})}),this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive(e){let{status:t,response:n}=e;this.recHooks.filter((e=>e.status===t)).forEach((e=>e.callback(n)))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Bc,Uc,Wc,Vc;!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(Bc||(Bc={}));class Hc{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(null===t||void 0===t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},(e=>{const{onJoin:t,onLeave:n,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Hc.syncState(this.state,e,t,n),this.pendingDiffs.forEach((e=>{this.state=Hc.syncDiff(this.state,e,t,n)})),this.pendingDiffs=[],a()})),this.channel._on(n.diff,{},(e=>{const{onJoin:t,onLeave:n,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=Hc.syncDiff(this.state,e,t,n),a())})),this.onJoin(((e,t,n)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:n})})),this.onLeave(((e,t,n)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:n})})),this.onSync((()=>{this.channel._trigger("presence",{event:"sync"})}))}static syncState(e,t,n,a){const r=this.cloneDeep(e),s=this.transformState(t),i={},o={};return this.map(r,((e,t)=>{s[e]||(o[e]=t)})),this.map(s,((e,t)=>{const n=r[e];if(n){const a=t.map((e=>e.presence_ref)),r=n.map((e=>e.presence_ref)),s=t.filter((e=>r.indexOf(e.presence_ref)<0)),l=n.filter((e=>a.indexOf(e.presence_ref)<0));s.length>0&&(i[e]=s),l.length>0&&(o[e]=l)}else i[e]=t})),this.syncDiff(r,{joins:i,leaves:o},n,a)}static syncDiff(e,t,n,a){const{joins:r,leaves:s}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(r,((t,a)=>{var r;const s=null!==(r=e[t])&&void 0!==r?r:[];if(e[t]=this.cloneDeep(a),s.length>0){const n=e[t].map((e=>e.presence_ref)),a=s.filter((e=>n.indexOf(e.presence_ref)<0));e[t].unshift(...a)}n(t,s,a)})),this.map(s,((t,n)=>{let r=e[t];if(!r)return;const s=n.map((e=>e.presence_ref));r=r.filter((e=>s.indexOf(e.presence_ref)<0)),e[t]=r,a(t,r,n),0===r.length&&delete e[t]})),e}static map(e,t){return Object.getOwnPropertyNames(e).map((n=>t(n,e[n])))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce(((t,n)=>{const a=e[n];return t[n]="metas"in a?a.metas.map((e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e))):a,t}),{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(Uc||(Uc={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}(Wc||(Wc={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(Vc||(Vc={}));class qc{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}},n=arguments.length>2?arguments[2]:void 0;this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=jc.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Fc(this,Nc.join,this.params,this.timeout),this.rejoinTimer=new Ac((()=>this._rejoinUntilConnected()),this.socket.reconnectAfterMs),this.joinPush.receive("ok",(()=>{this.state=jc.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach((e=>e.send())),this.pushBuffer=[]})),this._onClose((()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=jc.closed,this.socket._remove(this)})),this._onError((e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=jc.errored,this.rejoinTimer.scheduleTimeout())})),this.joinPush.receive("timeout",(()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=jc.errored,this.rejoinTimer.scheduleTimeout())})),this._on(Nc.reply,{},((e,t)=>{this._trigger(this._replyEventName(t),e)})),this.presence=new Hc(this),this.broadcastEndpointURL=zc(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.timeout;var n,a;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:r,presence:s,private:i}}=this.params;this._onError((t=>null===e||void 0===e?void 0:e(Vc.CHANNEL_ERROR,t))),this._onClose((()=>null===e||void 0===e?void 0:e(Vc.CLOSED)));const o={},l={broadcast:r,presence:s,postgres_changes:null!==(a=null===(n=this.bindings.postgres_changes)||void 0===n?void 0:n.map((e=>e.filter)))&&void 0!==a?a:[],private:i};this.socket.accessTokenValue&&(o.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:l},o)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",(async t=>{let{postgres_changes:n}=t;var a;if(this.socket.setAuth(),void 0!==n){const t=this.bindings.postgres_changes,r=null!==(a=null===t||void 0===t?void 0:t.length)&&void 0!==a?a:0,s=[];for(let a=0;a<r;a++){const r=t[a],{filter:{event:i,schema:o,table:l,filter:c}}=r,d=n&&n[a];if(!d||d.event!==i||d.schema!==o||d.table!==l||d.filter!==c)return this.unsubscribe(),void(null===e||void 0===e||e(Vc.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));s.push(Object.assign(Object.assign({},r),{id:d.id}))}return this.bindings.postgres_changes=s,void(e&&e(Vc.SUBSCRIBED))}null===e||void 0===e||e(Vc.SUBSCRIBED)})).receive("error",(t=>{null===e||void 0===e||e(Vc.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))})).receive("timeout",(()=>{null===e||void 0===e||e(Vc.TIMED_OUT)}))}return this}presenceState(){return this.presence.state}async track(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this._on(e,t,n)}async send(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n,a;if(this._canPush()||"broadcast"!==e.type)return new Promise((n=>{var a,r,s;const i=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(s=null===(r=null===(a=this.params)||void 0===a?void 0:a.config)||void 0===r?void 0:r.broadcast)||void 0===s?void 0:s.ack)||n("ok"),i.receive("ok",(()=>n("ok"))),i.receive("error",(()=>n("error"))),i.receive("timeout",(()=>n("timed out")))}));{const{event:s,payload:i}=e,o={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,o,null!==(n=t.timeout)&&void 0!==n?n:this.timeout);return await(null===(a=e.body)||void 0===a?void 0:a.cancel()),e.ok?"ok":"error"}catch(r){return"AbortError"===r.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this.state=jc.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Nc.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise((n=>{const a=new Fc(this,Nc.leave,{},e);a.receive("ok",(()=>{t(),n("ok")})).receive("timeout",(()=>{t(),n("timed out")})).receive("error",(()=>{n("error")})),a.send(),this._canPush()||a.trigger("ok",{})}))}async _fetchWithTimeout(e,t,n){const a=new AbortController,r=setTimeout((()=>a.abort()),n),s=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:a.signal}));return clearTimeout(r),s}_push(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.timeout;if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Fc(this,e,t,n);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var a,r;const s=e.toLocaleLowerCase(),{close:i,error:o,leave:l,join:c}=Nc;if(n&&[i,o,l,c].indexOf(s)>=0&&n!==this._joinRef())return;let d=this._onMessage(s,t,n);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?null===(a=this.bindings.postgres_changes)||void 0===a||a.filter((e=>{var t,n,a;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(a=null===(n=e.filter)||void 0===n?void 0:n.event)||void 0===a?void 0:a.toLocaleLowerCase())===s})).map((e=>e.callback(d,n))):null===(r=this.bindings[s])||void 0===r||r.filter((e=>{var n,a,r,i,o,l;if(["broadcast","presence","postgres_changes"].includes(s)){if("id"in e){const s=e.id,i=null===(n=e.filter)||void 0===n?void 0:n.event;return s&&(null===(a=t.ids)||void 0===a?void 0:a.includes(s))&&("*"===i||(null===i||void 0===i?void 0:i.toLocaleLowerCase())===(null===(r=t.data)||void 0===r?void 0:r.type.toLocaleLowerCase()))}{const n=null===(o=null===(i=null===e||void 0===e?void 0:e.filter)||void 0===i?void 0:i.event)||void 0===o?void 0:o.toLocaleLowerCase();return"*"===n||n===(null===(l=null===t||void 0===t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===s})).map((e=>{if("object"===typeof d&&"ids"in d){const e=d.data,{schema:t,table:n,commit_timestamp:a,type:r,errors:s}=e,i={schema:t,table:n,commit_timestamp:a,eventType:r,new:{},old:{},errors:s};d=Object.assign(Object.assign({},i),this._getPayloadRecords(e))}e.callback(d,n)}))}_isClosed(){return this.state===jc.closed}_isJoined(){return this.state===jc.joined}_isJoining(){return this.state===jc.joining}_isLeaving(){return this.state===jc.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,n){const a=e.toLocaleLowerCase(),r={type:a,filter:t,callback:n};return this.bindings[a]?this.bindings[a].push(r):this.bindings[a]=[r],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter((e=>{var a;return!((null===(a=e.type)||void 0===a?void 0:a.toLocaleLowerCase())===n&&qc.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Nc.close,{},e)}_onError(e){this._on(Nc.error,{},(t=>e(t)))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=jc.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=Tc(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=Tc(e.columns,e.old_record)),t}}const Yc=()=>{},Jc="undefined"!==typeof WebSocket;class Gc{constructor(e,t){var a;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=_c,this.params={},this.timeout=1e4,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Yc,this.conn=null,this.sendBuffer=[],this.serializer=new Cc,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return Promise.resolve().then(n.bind(n,630)).then((e=>{let{default:n}=e;return n(...t)}))}:fetch),function(){return t(...arguments)}},this.endPoint=`${e}/${Ec.websocket}`,this.httpEndpoint=zc(e),(null===t||void 0===t?void 0:t.transport)?this.transport=t.transport:this.transport=null,(null===t||void 0===t?void 0:t.params)&&(this.params=t.params),(null===t||void 0===t?void 0:t.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),(null===t||void 0===t?void 0:t.timeout)&&(this.timeout=t.timeout),(null===t||void 0===t?void 0:t.logger)&&(this.logger=t.logger),(null===t||void 0===t?void 0:t.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const r=null===(a=null===t||void 0===t?void 0:t.params)||void 0===a?void 0:a.apikey;if(r&&(this.accessTokenValue=r,this.apiKey=r),this.reconnectAfterMs=(null===t||void 0===t?void 0:t.reconnectAfterMs)?t.reconnectAfterMs:e=>[1e3,2e3,5e3,1e4][e-1]||1e4,this.encode=(null===t||void 0===t?void 0:t.encode)?t.encode:(e,t)=>t(JSON.stringify(e)),this.decode=(null===t||void 0===t?void 0:t.decode)?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Ac((async()=>{this.disconnect(),this.connect()}),this.reconnectAfterMs),this.fetch=this._resolveFetch(null===t||void 0===t?void 0:t.fetch),null===t||void 0===t?void 0:t.worker){if("undefined"!==typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(null===t||void 0===t?void 0:t.worker)||!1,this.workerUrl=null===t||void 0===t?void 0:t.workerUrl}this.accessToken=(null===t||void 0===t?void 0:t.accessToken)||null}connect(){if(!this.conn)if(this.transport)this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});else{if(Jc)return this.conn=new WebSocket(this.endpointURL()),void this.setupConnection();this.conn=new Xc(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),n.e(198).then(n.t.bind(n,198,23)).then((e=>{let{default:t}=e;this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()}))}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,null!==t&&void 0!==t?t:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map((e=>e.unsubscribe())));return this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case wc.connecting:return Sc.Connecting;case wc.open:return Sc.Open;case wc.closing:return Sc.Closing;default:return Sc.Closed}}isConnected(){return this.connectionState()===Sc.Open}channel(e){const t=new qc(`realtime:${e}`,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}},this);return this.channels.push(t),t}push(e){const{topic:t,event:n,payload:a,ref:r}=e,s=()=>{this.encode(e,(e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)}))};this.log("push",`${t} ${n} (${r})`,a),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(){let e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(e){let n=null;try{n=JSON.parse(atob(e.split(".")[1]))}catch(t){}if(n&&n.exp){if(!(Math.floor(Date.now()/1e3)-n.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`)}this.accessTokenValue=e,this.channels.forEach((t=>{e&&t.updateJoinPayload({access_token:e}),t.joinedOnce&&t._isJoined()&&t._push(Nc.access_token,{access_token:e})}))}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),void(null===(e=this.conn)||void 0===e||e.close(1e3,"hearbeat timeout"));this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach((e=>e())),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find((t=>t.topic===e&&(t._isJoined()||t._isJoining())));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter((t=>t._joinRef()!==e._joinRef()))}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,(e=>{let{topic:t,event:n,payload:a,ref:r}=e;r&&r===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${a.status||""} ${t} ${n} ${r&&"("+r+")"||""}`,a),this.channels.filter((e=>e._isMember(t))).forEach((e=>e._trigger(n,a,r))),this.stateChangeCallbacks.message.forEach((t=>t(e)))}))}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}else this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval((()=>this.sendHeartbeat()),this.heartbeatIntervalMs);this.stateChangeCallbacks.open.forEach((e=>e()))}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach((t=>t(e)))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach((t=>t(e)))}_triggerChanError(){this.channels.forEach((e=>e._trigger(Nc.error)))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const n=e.match(/\?/)?"&":"?";return`${e}${n}${new URLSearchParams(t)}`}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}}class Xc{constructor(e,t,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=wc.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=n.close}}class Kc extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Qc(e){return"object"===typeof e&&null!==e&&"__isStorageError"in e}class Zc extends Kc{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class ed extends Kc{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var td=function(e,t,n,a){return new(n||(n=Promise))((function(r,s){function i(e){try{l(a.next(e))}catch(Uu){s(Uu)}}function o(e){try{l(a.throw(e))}catch(Uu){s(Uu)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}l((a=a.apply(e,t||[])).next())}))};const nd=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return Promise.resolve().then(n.bind(n,630)).then((e=>{let{default:n}=e;return n(...t)}))}:fetch),function(){return t(...arguments)}},ad=e=>{if(Array.isArray(e))return e.map((e=>ad(e)));if("function"===typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach((e=>{let[n,a]=e;const r=n.replace(/([-_][a-z])/gi,(e=>e.toUpperCase().replace(/[-_]/g,"")));t[r]=ad(a)})),t};var rd=function(e,t,n,a){return new(n||(n=Promise))((function(r,s){function i(e){try{l(a.next(e))}catch(Uu){s(Uu)}}function o(e){try{l(a.throw(e))}catch(Uu){s(Uu)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}l((a=a.apply(e,t||[])).next())}))};const sd=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),id=(e,t,a)=>rd(void 0,void 0,void 0,(function*(){const r=yield td(void 0,void 0,void 0,(function*(){return"undefined"===typeof Response?(yield Promise.resolve().then(n.bind(n,630))).Response:Response}));e instanceof r&&!(null===a||void 0===a?void 0:a.noResolveJson)?e.json().then((n=>{t(new Zc(sd(n),e.status||500))})).catch((e=>{t(new ed(sd(e),e))})):t(new ed(sd(e),e))}));function od(e,t,n,a,r,s){return rd(this,void 0,void 0,(function*(){return new Promise(((i,o)=>{e(n,((e,t,n,a)=>{const r={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e?r:(r.headers=Object.assign({"Content-Type":"application/json"},null===t||void 0===t?void 0:t.headers),a&&(r.body=JSON.stringify(a)),Object.assign(Object.assign({},r),n))})(t,a,r,s)).then((e=>{if(!e.ok)throw e;return(null===a||void 0===a?void 0:a.noResolveJson)?e:e.json()})).then((e=>i(e))).catch((e=>id(e,o,a)))}))}))}function ld(e,t,n,a){return rd(this,void 0,void 0,(function*(){return od(e,"GET",t,n,a)}))}function cd(e,t,n,a,r){return rd(this,void 0,void 0,(function*(){return od(e,"POST",t,a,r,n)}))}function dd(e,t,n,a,r){return rd(this,void 0,void 0,(function*(){return od(e,"DELETE",t,a,r,n)}))}var ud=function(e,t,n,a){return new(n||(n=Promise))((function(r,s){function i(e){try{l(a.next(e))}catch(Uu){s(Uu)}}function o(e){try{l(a.throw(e))}catch(Uu){s(Uu)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}l((a=a.apply(e,t||[])).next())}))};const hd={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},pd={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class md{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;this.url=e,this.headers=t,this.bucketId=n,this.fetch=nd(a)}uploadOrUpdate(e,t,n,a){return ud(this,void 0,void 0,(function*(){try{let r;const s=Object.assign(Object.assign({},pd),a);let i=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(s.upsert)});const o=s.metadata;"undefined"!==typeof Blob&&n instanceof Blob?(r=new FormData,r.append("cacheControl",s.cacheControl),o&&r.append("metadata",this.encodeMetadata(o)),r.append("",n)):"undefined"!==typeof FormData&&n instanceof FormData?(r=n,r.append("cacheControl",s.cacheControl),o&&r.append("metadata",this.encodeMetadata(o))):(r=n,i["cache-control"]=`max-age=${s.cacheControl}`,i["content-type"]=s.contentType,o&&(i["x-metadata"]=this.toBase64(this.encodeMetadata(o)))),(null===a||void 0===a?void 0:a.headers)&&(i=Object.assign(Object.assign({},i),a.headers));const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),d=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:r,headers:i},(null===s||void 0===s?void 0:s.duplex)?{duplex:s.duplex}:{})),u=yield d.json();if(d.ok)return{data:{path:l,id:u.Id,fullPath:u.Key},error:null};return{data:null,error:u}}catch(r){if(Qc(r))return{data:null,error:r};throw r}}))}upload(e,t,n){return ud(this,void 0,void 0,(function*(){return this.uploadOrUpdate("POST",e,t,n)}))}uploadToSignedUrl(e,t,n,a){return ud(this,void 0,void 0,(function*(){const r=this._removeEmptyFolders(e),s=this._getFinalPath(r),i=new URL(this.url+`/object/upload/sign/${s}`);i.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:pd.upsert},a),s=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!==typeof Blob&&n instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",n)):"undefined"!==typeof FormData&&n instanceof FormData?(e=n,e.append("cacheControl",t.cacheControl)):(e=n,s["cache-control"]=`max-age=${t.cacheControl}`,s["content-type"]=t.contentType);const o=yield this.fetch(i.toString(),{method:"PUT",body:e,headers:s}),l=yield o.json();if(o.ok)return{data:{path:r,fullPath:l.Key},error:null};return{data:null,error:l}}catch(o){if(Qc(o))return{data:null,error:o};throw o}}))}createSignedUploadUrl(e,t){return ud(this,void 0,void 0,(function*(){try{let n=this._getFinalPath(e);const a=Object.assign({},this.headers);(null===t||void 0===t?void 0:t.upsert)&&(a["x-upsert"]="true");const r=yield cd(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),s=new URL(this.url+r.url),i=s.searchParams.get("token");if(!i)throw new Kc("No token returned by API");return{data:{signedUrl:s.toString(),path:e,token:i},error:null}}catch(n){if(Qc(n))return{data:null,error:n};throw n}}))}update(e,t,n){return ud(this,void 0,void 0,(function*(){return this.uploadOrUpdate("PUT",e,t,n)}))}move(e,t,n){return ud(this,void 0,void 0,(function*(){try{return{data:yield cd(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===n||void 0===n?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(Qc(a))return{data:null,error:a};throw a}}))}copy(e,t,n){return ud(this,void 0,void 0,(function*(){try{return{data:{path:(yield cd(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===n||void 0===n?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(Qc(a))return{data:null,error:a};throw a}}))}createSignedUrl(e,t,n){return ud(this,void 0,void 0,(function*(){try{let a=this._getFinalPath(e),r=yield cd(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:t},(null===n||void 0===n?void 0:n.transform)?{transform:n.transform}:{}),{headers:this.headers});const s=(null===n||void 0===n?void 0:n.download)?`&download=${!0===n.download?"":n.download}`:"";return r={signedUrl:encodeURI(`${this.url}${r.signedURL}${s}`)},{data:r,error:null}}catch(a){if(Qc(a))return{data:null,error:a};throw a}}))}createSignedUrls(e,t,n){return ud(this,void 0,void 0,(function*(){try{const a=yield cd(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),r=(null===n||void 0===n?void 0:n.download)?`&download=${!0===n.download?"":n.download}`:"";return{data:a.map((e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${r}`):null}))),error:null}}catch(a){if(Qc(a))return{data:null,error:a};throw a}}))}download(e,t){return ud(this,void 0,void 0,(function*(){const n="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image/authenticated":"object",a=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{}),r=a?`?${a}`:"";try{const t=this._getFinalPath(e),a=yield ld(this.fetch,`${this.url}/${n}/${t}${r}`,{headers:this.headers,noResolveJson:!0});return{data:yield a.blob(),error:null}}catch(s){if(Qc(s))return{data:null,error:s};throw s}}))}info(e){return ud(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{const e=yield ld(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:ad(e),error:null}}catch(n){if(Qc(n))return{data:null,error:n};throw n}}))}exists(e){return ud(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{return yield function(e,t,n,a){return rd(this,void 0,void 0,(function*(){return od(e,"HEAD",t,Object.assign(Object.assign({},n),{noResolveJson:!0}),a)}))}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Qc(n)&&n instanceof ed){const e=n.originalError;if([400,404].includes(null===e||void 0===e?void 0:e.status))return{data:!1,error:n}}throw n}}))}getPublicUrl(e,t){const n=this._getFinalPath(e),a=[],r=(null===t||void 0===t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==r&&a.push(r);const s="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image":"object",i=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{});""!==i&&a.push(i);let o=a.join("&");return""!==o&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${s}/public/${n}${o}`)}}}remove(e){return ud(this,void 0,void 0,(function*(){try{return{data:yield dd(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(Qc(t))return{data:null,error:t};throw t}}))}list(e,t,n){return ud(this,void 0,void 0,(function*(){try{const a=Object.assign(Object.assign(Object.assign({},hd),t),{prefix:e||""});return{data:yield cd(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(Qc(a))return{data:null,error:a};throw a}}))}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!==typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const fd={"X-Client-Info":"storage-js/2.7.1"};var gd=function(e,t,n,a){return new(n||(n=Promise))((function(r,s){function i(e){try{l(a.next(e))}catch(Uu){s(Uu)}}function o(e){try{l(a.throw(e))}catch(Uu){s(Uu)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}l((a=a.apply(e,t||[])).next())}))};class vd{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;this.url=e,this.headers=Object.assign(Object.assign({},fd),t),this.fetch=nd(n)}listBuckets(){return gd(this,void 0,void 0,(function*(){try{return{data:yield ld(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Qc(e))return{data:null,error:e};throw e}}))}getBucket(e){return gd(this,void 0,void 0,(function*(){try{return{data:yield ld(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(Qc(t))return{data:null,error:t};throw t}}))}createBucket(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{public:!1};return gd(this,void 0,void 0,(function*(){try{return{data:yield cd(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Qc(n))return{data:null,error:n};throw n}}))}updateBucket(e,t){return gd(this,void 0,void 0,(function*(){try{const n=yield function(e,t,n,a,r){return rd(this,void 0,void 0,(function*(){return od(e,"PUT",t,a,r,n)}))}(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers});return{data:n,error:null}}catch(n){if(Qc(n))return{data:null,error:n};throw n}}))}emptyBucket(e){return gd(this,void 0,void 0,(function*(){try{return{data:yield cd(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(Qc(t))return{data:null,error:t};throw t}}))}deleteBucket(e){return gd(this,void 0,void 0,(function*(){try{return{data:yield dd(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(Qc(t))return{data:null,error:t};throw t}}))}}class bd extends vd{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2?arguments[2]:void 0)}from(e){return new md(this.url,this.headers,e,this.fetch)}}let yd="";yd="undefined"!==typeof Deno?"deno":"undefined"!==typeof document?"web":"undefined"!==typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const xd={headers:{"X-Client-Info":`supabase-js-${yd}/2.49.1`}},_d={schema:"public"},wd={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},jd={};var Nd=n(630),Ed=function(e,t,n,a){return new(n||(n=Promise))((function(r,s){function i(e){try{l(a.next(e))}catch(Uu){s(Uu)}}function o(e){try{l(a.throw(e))}catch(Uu){s(Uu)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}l((a=a.apply(e,t||[])).next())}))};const Sd=e=>{let t;return t=e||("undefined"===typeof fetch?Nd.default:fetch),function(){return t(...arguments)}},kd=(e,t,n)=>{const a=Sd(n),r="undefined"===typeof Headers?Nd.Headers:Headers;return(n,s)=>Ed(void 0,void 0,void 0,(function*(){var i;const o=null!==(i=yield t())&&void 0!==i?i:e;let l=new r(null===s||void 0===s?void 0:s.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${o}`),a(n,Object.assign(Object.assign({},s),{headers:l}))}))};var Cd=function(e,t,n,a){return new(n||(n=Promise))((function(r,s){function i(e){try{l(a.next(e))}catch(Uu){s(Uu)}}function o(e){try{l(a.throw(e))}catch(Uu){s(Uu)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}l((a=a.apply(e,t||[])).next())}))};const Ad="2.68.0",Td=3e4,Pd=9e4,Id={"X-Client-Info":`gotrue-js/${Ad}`},Od="X-Supabase-Api-Version",Rd={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"};const Md=()=>"undefined"!==typeof window&&"undefined"!==typeof document,Dd={tested:!1,writable:!1},Ld=()=>{if(!Md())return!1;try{if("object"!==typeof globalThis.localStorage)return!1}catch(Uu){return!1}if(Dd.tested)return Dd.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Dd.tested=!0,Dd.writable=!0}catch(Uu){Dd.tested=!0,Dd.writable=!1}return Dd.writable};const $d=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return Promise.resolve().then(n.bind(n,630)).then((e=>{let{default:n}=e;return n(...t)}))}:fetch),function(){return t(...arguments)}},zd=async(e,t,n)=>{await e.setItem(t,JSON.stringify(n))},Fd=async(e,t)=>{const n=await e.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch(a){return n}},Bd=async(e,t)=>{await e.removeItem(t)};class Ud{constructor(){this.promise=new Ud.promiseConstructor(((e,t)=>{this.resolve=e,this.reject=t}))}}function Wd(e){const t=e.split(".");if(3!==t.length)throw new Error("JWT is not valid: not a JWT structure");if(!/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const n=t[1];return JSON.parse(function(e){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let n,a,r,s,i,o,l,c="",d=0;for(e=e.replace("-","+").replace("_","/");d<e.length;)s=t.indexOf(e.charAt(d++)),i=t.indexOf(e.charAt(d++)),o=t.indexOf(e.charAt(d++)),l=t.indexOf(e.charAt(d++)),n=s<<2|i>>4,a=(15&i)<<4|o>>2,r=(3&o)<<6|l,c+=String.fromCharCode(n),64!=o&&0!=a&&(c+=String.fromCharCode(a)),64!=l&&0!=r&&(c+=String.fromCharCode(r));return c}(n))}function Vd(e){return("0"+e.toString(16)).substr(-2)}async function Hd(e){if(!("undefined"!==typeof crypto&&"undefined"!==typeof crypto.subtle&&"undefined"!==typeof TextEncoder))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await async function(e){const t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t),a=new Uint8Array(n);return Array.from(a).map((e=>String.fromCharCode(e))).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function qd(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a=function(){const e=new Uint32Array(56);if("undefined"===typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let n="";for(let a=0;a<56;a++)n+=e.charAt(Math.floor(Math.random()*t));return n}return crypto.getRandomValues(e),Array.from(e,Vd).join("")}();let r=a;n&&(r+="/PASSWORD_RECOVERY"),await zd(e,`${t}-code-verifier`,r);const s=await Hd(a);return[s,a===s?"plain":"s256"]}Ud.promiseConstructor=Promise;const Yd=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;class Jd extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function Gd(e){return"object"===typeof e&&null!==e&&"__isAuthError"in e}class Xd extends Jd{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}class Kd extends Jd{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Qd extends Jd{constructor(e,t,n,a){super(e,n,a),this.name=t,this.status=n}}class Zd extends Qd{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class eu extends Qd{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class tu extends Qd{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class nu extends Qd{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class au extends Qd{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ru extends Qd{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function su(e){return Gd(e)&&"AuthRetryableFetchError"===e.name}class iu extends Qd{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}var ou=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n};const lu=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),cu=[502,503,504];async function du(e){var t,n;if(!("object"===typeof(n=e)&&null!==n&&"status"in n&&"ok"in n&&"json"in n&&"function"===typeof n.json))throw new ru(lu(e),0);if(cu.includes(e.status))throw new ru(lu(e),e.status);let a,r;try{a=await e.json()}catch(Uu){throw new Kd(lu(Uu),Uu)}const s=function(e){const t=e.headers.get(Od);if(!t)return null;if(!t.match(Yd))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(Uu){return null}}(e);if(s&&s.getTime()>=Rd.timestamp&&"object"===typeof a&&a&&"string"===typeof a.code?r=a.code:"object"===typeof a&&a&&"string"===typeof a.error_code&&(r=a.error_code),r){if("weak_password"===r)throw new iu(lu(a),e.status,(null===(t=a.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===r)throw new Zd}else if("object"===typeof a&&a&&"object"===typeof a.weak_password&&a.weak_password&&Array.isArray(a.weak_password.reasons)&&a.weak_password.reasons.length&&a.weak_password.reasons.reduce(((e,t)=>e&&"string"===typeof t),!0))throw new iu(lu(a),e.status,a.weak_password.reasons);throw new Xd(lu(a),e.status||500,r)}async function uu(e,t,n,a){var r;const s=Object.assign({},null===a||void 0===a?void 0:a.headers);s[Od]||(s[Od]=Rd.name),(null===a||void 0===a?void 0:a.jwt)&&(s.Authorization=`Bearer ${a.jwt}`);const i=null!==(r=null===a||void 0===a?void 0:a.query)&&void 0!==r?r:{};(null===a||void 0===a?void 0:a.redirectTo)&&(i.redirect_to=a.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await async function(e,t,n,a,r,s){const i=((e,t,n,a)=>{const r={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null===t||void 0===t?void 0:t.headers),r.body=JSON.stringify(a),Object.assign(Object.assign({},r),n))})(t,a,r,s);let o;try{o=await e(n,Object.assign({},i))}catch(Uu){throw console.error(Uu),new ru(lu(Uu),0)}o.ok||await du(o);if(null===a||void 0===a?void 0:a.noResolveJson)return o;try{return await o.json()}catch(Uu){await du(Uu)}}(e,t,n+o,{headers:s,noResolveJson:null===a||void 0===a?void 0:a.noResolveJson},{},null===a||void 0===a?void 0:a.body);return(null===a||void 0===a?void 0:a.xform)?null===a||void 0===a?void 0:a.xform(l):{data:Object.assign({},l),error:null}}function hu(e){var t;let n=null;var a;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(n=Object.assign({},e),e.expires_at||(n.expires_at=(a=e.expires_in,Math.round(Date.now()/1e3)+a)));return{data:{session:n,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function pu(e){const t=hu(e);return!t.error&&e.weak_password&&"object"===typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"===typeof e.weak_password.message&&e.weak_password.reasons.reduce(((e,t)=>e&&"string"===typeof t),!0)&&(t.data.weak_password=e.weak_password),t}function mu(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function fu(e){return{data:e,error:null}}function gu(e){const{action_link:t,email_otp:n,hashed_token:a,redirect_to:r,verification_type:s}=e,i=ou(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:n,hashed_token:a,redirect_to:r,verification_type:s},user:Object.assign({},i)},error:null}}function vu(e){return e}var bu=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n};class yu{constructor(e){let{url:t="",headers:n={},fetch:a}=e;this.url=t,this.headers=n,this.fetch=$d(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"global";try{return await uu(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Gd(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await uu(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:mu})}catch(n){if(Gd(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:t}=e,n=bu(e,["options"]),a=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(a.new_email=null===n||void 0===n?void 0:n.newEmail,delete a.newEmail),await uu(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:gu,redirectTo:null===t||void 0===t?void 0:t.redirectTo})}catch(t){if(Gd(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await uu(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:mu})}catch(t){if(Gd(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,a,r,s,i,o;try{const l={nextPage:null,lastPage:0,total:0},c=await uu(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(n=null===(t=null===e||void 0===e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==n?n:"",per_page:null!==(r=null===(a=null===e||void 0===e?void 0:e.perPage)||void 0===a?void 0:a.toString())&&void 0!==r?r:""},xform:vu});if(c.error)throw c.error;const d=await c.json(),u=null!==(s=c.headers.get("x-total-count"))&&void 0!==s?s:0,h=null!==(o=null===(i=c.headers.get("link"))||void 0===i?void 0:i.split(","))&&void 0!==o?o:[];return h.length>0&&(h.forEach((e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),n=JSON.parse(e.split(";")[1].split("=")[1]);l[`${n}Page`]=t})),l.total=parseInt(u)),{data:Object.assign(Object.assign({},d),l),error:null}}catch(l){if(Gd(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){try{return await uu(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:mu})}catch(t){if(Gd(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await uu(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:mu})}catch(n){if(Gd(n))return{data:{user:null},error:n};throw n}}async deleteUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{return await uu(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:mu})}catch(n){if(Gd(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){try{const{data:t,error:n}=await uu(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:n}}catch(t){if(Gd(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await uu(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Gd(t))return{data:null,error:t};throw t}}}const xu={getItem:e=>Ld()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{Ld()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{Ld()&&globalThis.localStorage.removeItem(e)}};function _u(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{getItem:t=>e[t]||null,setItem:(t,n)=>{e[t]=n},removeItem:t=>{delete e[t]}}}const wu=!!(globalThis&&Ld()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class ju extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Nu extends ju{}async function Eu(e,t,n){wu&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const a=new globalThis.AbortController;return t>0&&setTimeout((()=>{a.abort(),wu&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)}),t),await Promise.resolve().then((()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},(async a=>{if(!a){if(0===t)throw wu&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Nu(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(wu)try{const e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(Uu){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",Uu)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}wu&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await n()}finally{wu&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}))))}!function(){if("object"!==typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(Uu){"undefined"!==typeof self&&(self.globalThis=self)}}();const Su={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Id,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function ku(e,t,n){return await n()}class Cu{constructor(e){var t,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Cu.nextInstanceID,Cu.nextInstanceID+=1,this.instanceID>0&&Md()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},Su),e);if(this.logDebugMessages=!!a.debug,"function"===typeof a.debug&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new yu({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=$d(a.fetch),this.lock=a.lock||ku,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:Md()&&(null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=Eu:this.lock=ku,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?a.storage?this.storage=a.storage:Ld()?this.storage=xu:(this.memoryStorage={},this.storage=_u(this.memoryStorage)):(this.memoryStorage={},this.storage=_u(this.memoryStorage)),Md()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(Uu){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",Uu)}null===(n=this.broadcastChannel)||void 0===n||n.addEventListener("message",(async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)}))}this.initialize()}_debug(){if(this.logDebugMessages){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger(`GoTrueClient@${this.instanceID} (${Ad}) ${(new Date).toISOString()}`,...t)}return this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,(async()=>await this._initialize())))()),await this.initializePromise}async _initialize(){var e;try{const t=function(e){const t={},n=new URL(e);if(n.hash&&"#"===n.hash[0])try{new URLSearchParams(n.hash.substring(1)).forEach(((e,n)=>{t[n]=e}))}catch(Uu){}return n.searchParams.forEach(((e,n)=>{t[n]=e})),t}(window.location.href);let n="none";if(this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce"),Md()&&this.detectSessionInUrl&&"none"!==n){const{data:a,error:r}=await this._getSessionFromURL(t,n);if(r){if(this._debug("#_initialize()","error detecting session from URL",r),function(e){return Gd(e)&&"AuthImplicitGrantRedirectError"===e.name}(r)){const t=null===(e=r.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:r}}return await this._removeSession(),{error:r}}const{session:s,redirectType:i}=a;return this._debug("#_initialize()","detected session in URL",s,"redirect type",i),await this._saveSession(s),setTimeout((async()=>{"recovery"===i?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)}),0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Gd(t)?{error:t}:{error:new Kd("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,a;try{const r=await uu(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(n=null===(t=null===e||void 0===e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==n?n:{},gotrue_meta_security:{captcha_token:null===(a=null===e||void 0===e?void 0:e.options)||void 0===a?void 0:a.captchaToken}},xform:hu}),{data:s,error:i}=r;if(i||!s)return{data:{user:null,session:null},error:i};const o=s.session,l=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(r){if(Gd(r))return{data:{user:null,session:null},error:r};throw r}}async signUp(e){var t,n,a;try{let r;if("email"in e){const{email:n,password:a,options:s}=e;let i=null,o=null;"pkce"===this.flowType&&([i,o]=await qd(this.storage,this.storageKey)),r=await uu(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null===s||void 0===s?void 0:s.emailRedirectTo,body:{email:n,password:a,data:null!==(t=null===s||void 0===s?void 0:s.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null===s||void 0===s?void 0:s.captchaToken},code_challenge:i,code_challenge_method:o},xform:hu})}else{if(!("phone"in e))throw new tu("You must provide either an email or phone number and a password");{const{phone:t,password:s,options:i}=e;r=await uu(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:s,data:null!==(n=null===i||void 0===i?void 0:i.data)&&void 0!==n?n:{},channel:null!==(a=null===i||void 0===i?void 0:i.channel)&&void 0!==a?a:"sms",gotrue_meta_security:{captcha_token:null===i||void 0===i?void 0:i.captchaToken}},xform:hu})}}const{data:s,error:i}=r;if(i||!s)return{data:{user:null,session:null},error:i};const o=s.session,l=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(r){if(Gd(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithPassword(e){try{let t;if("email"in e){const{email:n,password:a,options:r}=e;t=await uu(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:n,password:a,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken}},xform:pu})}else{if(!("phone"in e))throw new tu("You must provide either an email or phone number and a password");{const{phone:n,password:a,options:r}=e;t=await uu(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:n,password:a,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken}},xform:pu})}}const{data:n,error:a}=t;return a?{data:{user:null,session:null},error:a}:n&&n.session&&n.user?(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a}):{data:{user:null,session:null},error:new eu}}catch(t){if(Gd(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,n,a,r;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(n=e.options)||void 0===n?void 0:n.scopes,queryParams:null===(a=e.options)||void 0===a?void 0:a.queryParams,skipBrowserRedirect:null===(r=e.options)||void 0===r?void 0:r.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,(async()=>this._exchangeCodeForSession(e)))}async _exchangeCodeForSession(e){const t=await Fd(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(null!==t&&void 0!==t?t:"").split("/");try{const{data:t,error:r}=await uu(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:hu});if(await Bd(this.storage,`${this.storageKey}-code-verifier`),r)throw r;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!==a&&void 0!==a?a:null}),error:r}):{data:{user:null,session:null,redirectType:null},error:new eu}}catch(r){if(Gd(r))return{data:{user:null,session:null,redirectType:null},error:r};throw r}}async signInWithIdToken(e){try{const{options:t,provider:n,token:a,access_token:r,nonce:s}=e,i=await uu(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:r,nonce:s,gotrue_meta_security:{captcha_token:null===t||void 0===t?void 0:t.captchaToken}},xform:hu}),{data:o,error:l}=i;return l?{data:{user:null,session:null},error:l}:o&&o.session&&o.user?(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:o,error:l}):{data:{user:null,session:null},error:new eu}}catch(t){if(Gd(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,n,a,r,s;try{if("email"in e){const{email:a,options:r}=e;let s=null,i=null;"pkce"===this.flowType&&([s,i]=await qd(this.storage,this.storageKey));const{error:o}=await uu(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:null!==(t=null===r||void 0===r?void 0:r.data)&&void 0!==t?t:{},create_user:null===(n=null===r||void 0===r?void 0:r.shouldCreateUser)||void 0===n||n,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken},code_challenge:s,code_challenge_method:i},redirectTo:null===r||void 0===r?void 0:r.emailRedirectTo});return{data:{user:null,session:null},error:o}}if("phone"in e){const{phone:t,options:n}=e,{data:i,error:o}=await uu(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(a=null===n||void 0===n?void 0:n.data)&&void 0!==a?a:{},create_user:null===(r=null===n||void 0===n?void 0:n.shouldCreateUser)||void 0===r||r,gotrue_meta_security:{captcha_token:null===n||void 0===n?void 0:n.captchaToken},channel:null!==(s=null===n||void 0===n?void 0:n.channel)&&void 0!==s?s:"sms"}});return{data:{user:null,session:null,messageId:null===i||void 0===i?void 0:i.message_id},error:o}}throw new tu("You must provide either an email or phone number.")}catch(i){if(Gd(i))return{data:{user:null,session:null},error:i};throw i}}async verifyOtp(e){var t,n;try{let a,r;"options"in e&&(a=null===(t=e.options)||void 0===t?void 0:t.redirectTo,r=null===(n=e.options)||void 0===n?void 0:n.captchaToken);const{data:s,error:i}=await uu(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:r}}),redirectTo:a,xform:hu});if(i)throw i;if(!s)throw new Error("An error occurred on token verification.");const o=s.session,l=s.user;return(null===o||void 0===o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(a){if(Gd(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(e){var t,n,a;try{let r=null,s=null;return"pkce"===this.flowType&&([r,s]=await qd(this.storage,this.storageKey)),await uu(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(n=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==n?n:void 0}),(null===(a=null===e||void 0===e?void 0:e.options)||void 0===a?void 0:a.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:r,code_challenge_method:s}),headers:this.headers,xform:fu})}catch(r){if(Gd(r))return{data:null,error:r};throw r}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._reauthenticate()))}async _reauthenticate(){try{return await this._useSession((async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new Zd;const{error:a}=await uu(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:a}}))}catch(e){if(Gd(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:n,type:a,options:r}=e,{error:s}=await uu(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken}},redirectTo:null===r||void 0===r?void 0:r.emailRedirectTo});return{data:{user:null,session:null},error:s}}if("phone"in e){const{phone:n,type:a,options:r}=e,{data:s,error:i}=await uu(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken}}});return{data:{user:null,session:null,messageId:null===s||void 0===s?void 0:s.message_id},error:i}}throw new tu("You must provide either an email or phone number and a type")}catch(t){if(Gd(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){await this.initializePromise;return await this._acquireLock(-1,(async()=>this._useSession((async e=>e))))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch(Uu){}})()),n}return await this.lock(`lock:${this.storageKey}`,e,(async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(Uu){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await Fd(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=!!e.expires_at&&1e3*e.expires_at-Date.now()<Pd;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.storage.isServer){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,n,a)=>(t||"user"!==n||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,n,a))})}return{data:{session:e},error:null}}const{session:a,error:r}=await this._callRefreshToken(e.refresh_token);return r?{data:{session:null},error:r}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;return await this._acquireLock(-1,(async()=>await this._getUser()))}async _getUser(e){try{return e?await uu(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:mu}):await this._useSession((async e=>{var t,n,a;const{data:r,error:s}=e;if(s)throw s;return(null===(t=r.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await uu(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(a=null===(n=r.session)||void 0===n?void 0:n.access_token)&&void 0!==a?a:void 0,xform:mu}):{data:{user:null},error:new Zd}}))}catch(t){if(Gd(t))return function(e){return Gd(e)&&"AuthSessionMissingError"===e.name}(t)&&(await this._removeSession(),await Bd(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._updateUser(e,t)))}async _updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await this._useSession((async n=>{const{data:a,error:r}=n;if(r)throw r;if(!a.session)throw new Zd;const s=a.session;let i=null,o=null;"pkce"===this.flowType&&null!=e.email&&([i,o]=await qd(this.storage,this.storageKey));const{data:l,error:c}=await uu(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null===t||void 0===t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:i,code_challenge_method:o}),jwt:s.access_token,xform:mu});if(c)throw c;return s.user=l.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),{data:{user:s.user},error:null}}))}catch(n){if(Gd(n))return{data:{user:null},error:n};throw n}}_decodeJWT(e){return Wd(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._setSession(e)))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Zd;const t=Date.now()/1e3;let n=t,a=!0,r=null;const s=Wd(e.access_token);if(s.exp&&(n=s.exp,a=n<=t),a){const{session:t,error:n}=await this._callRefreshToken(e.refresh_token);if(n)return{data:{user:null,session:null},error:n};if(!t)return{data:{user:null,session:null},error:null};r=t}else{const{data:a,error:s}=await this._getUser(e.access_token);if(s)throw s;r={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)}return{data:{user:r.user,session:r},error:null}}catch(t){if(Gd(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._refreshSession(e)))}async _refreshSession(e){try{return await this._useSession((async t=>{var n;if(!e){const{data:a,error:r}=t;if(r)throw r;e=null!==(n=a.session)&&void 0!==n?n:void 0}if(!(null===e||void 0===e?void 0:e.refresh_token))throw new Zd;const{session:a,error:r}=await this._callRefreshToken(e.refresh_token);return r?{data:{user:null,session:null},error:r}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}}))}catch(t){if(Gd(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Md())throw new nu("No browser detected.");if(e.error||e.error_description||e.error_code)throw new nu(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new au("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new nu("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new au("No code detected.");const{data:t,error:n}=await this._exchangeCodeForSession(e.code);if(n)throw n;const a=new URL(window.location.href);return a.searchParams.delete("code"),window.history.replaceState(window.history.state,"",a.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:r,refresh_token:s,expires_in:i,expires_at:o,token_type:l}=e;if(!r||!i||!s||!l)throw new nu("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(i);let u=c+d;o&&(u=parseInt(o));const h=u-c;1e3*h<=Td&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${d}s`);const p=u-d;c-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,u,c):c-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,u,c);const{data:m,error:f}=await this._getUser(r);if(f)throw f;const g={provider_token:n,provider_refresh_token:a,access_token:r,expires_in:d,expires_at:u,refresh_token:s,token_type:l,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:e.type},error:null}}catch(n){if(Gd(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Fd(this.storage,`${this.storageKey}-code-verifier`);return!(!e.code||!t)}async signOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._signOut(e)))}async _signOut(){let{scope:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this._useSession((async t=>{var n;const{data:a,error:r}=t;if(r)return{error:r};const s=null===(n=a.session)||void 0===n?void 0:n.access_token;if(s){const{error:t}=await this.admin.signOut(s,e);if(t&&(!function(e){return Gd(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status))return{error:t}}return"others"!==e&&(await this._removeSession(),await Bd(this.storage,`${this.storageKey}-code-verifier`)),{error:null}}))}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>{await this.initializePromise,await this._acquireLock(-1,(async()=>{this._emitInitialSession(t)}))})(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession((async t=>{var n,a;try{const{data:{session:a},error:r}=t;if(r)throw r;await(null===(n=this.stateChangeEmitters.get(e))||void 0===n?void 0:n.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(r){await(null===(a=this.stateChangeEmitters.get(e))||void 0===a?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",r),console.error(r)}}))}async resetPasswordForEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,a=null;"pkce"===this.flowType&&([n,a]=await qd(this.storage,this.storageKey,!0));try{return await uu(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(r){if(Gd(r))return{data:null,error:r};throw r}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(t){if(Gd(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:n,error:a}=await this._useSession((async t=>{var n,a,r,s,i;const{data:o,error:l}=t;if(l)throw l;const c=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(n=e.options)||void 0===n?void 0:n.redirectTo,scopes:null===(a=e.options)||void 0===a?void 0:a.scopes,queryParams:null===(r=e.options)||void 0===r?void 0:r.queryParams,skipBrowserRedirect:!0});return await uu(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(i=null===(s=o.session)||void 0===s?void 0:s.access_token)&&void 0!==i?i:void 0})}));if(a)throw a;return Md()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null===n||void 0===n?void 0:n.url),{data:{provider:e.provider,url:null===n||void 0===n?void 0:n.url},error:null}}catch(n){if(Gd(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession((async t=>{var n,a;const{data:r,error:s}=t;if(s)throw s;return await uu(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(a=null===(n=r.session)||void 0===n?void 0:n.access_token)&&void 0!==a?a:void 0})}))}catch(t){if(Gd(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await function(e,t){const n=new Promise(((n,a)=>{(async()=>{for(let r=0;r<1/0;r++)try{const a=await e(r);if(!t(r,null,a))return void n(a)}catch(Uu){if(!t(r,Uu))return void a(Uu)}})()}));return n}((async n=>(n>0&&await async function(e){return await new Promise((t=>{setTimeout((()=>t(null)),e)}))}(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await uu(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:hu}))),((e,t)=>{const a=200*Math.pow(2,e);return t&&su(t)&&Date.now()+a-n<Td}))}catch(n){if(this._debug(t,"error",n),Gd(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(t,"end")}}_isValidSession(e){return"object"===typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),Md()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const n=await Fd(this.storage,this.storageKey);if(this._debug(t,"session from storage",n),!this._isValidSession(n))return this._debug(t,"session is not valid"),void(null!==n&&await this._removeSession());const a=1e3*(null!==(e=n.expires_at)&&void 0!==e?e:1/0)-Date.now()<Pd;if(this._debug(t,`session has${a?"":" not"} expired with margin of 90000s`),a){if(this.autoRefreshToken&&n.refresh_token){const{error:e}=await this._callRefreshToken(n.refresh_token);e&&(console.error(e),su(e)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){return this._debug(t,"error",n),void console.error(n)}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new Zd;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Ud;const{data:t,error:n}=await this._refreshAccessToken(e);if(n)throw n;if(!t.session)throw new Zd;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const a={session:t.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(r){if(this._debug(a,"error",r),Gd(r)){const e={session:null,error:r};return su(r)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(n=this.refreshingDeferred)||void 0===n||n.reject(r),r}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const a=[],r=Array.from(this.stateChangeEmitters.values()).map((async n=>{try{await n.callback(e,t)}catch(Uu){a.push(Uu)}}));if(await Promise.all(r),a.length>0){for(let e=0;e<a.length;e+=1)console.error(a[e]);throw a[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await zd(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Bd(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Md()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(Uu){console.error("removing visibilitychange callback failed",Uu)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval((()=>this._autoRefreshTokenTick()),Td);this.autoRefreshTicker=e,e&&"object"===typeof e&&"function"===typeof e.unref?e.unref():"undefined"!==typeof Deno&&"function"===typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout((async()=>{await this.initializePromise,await this._autoRefreshTokenTick()}),0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,(async()=>{try{const e=Date.now();try{return await this._useSession((async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const a=Math.floor((1e3*n.expires_at-e)/Td);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),a<=3&&await this._callRefreshToken(n.refresh_token)}))}catch(Uu){console.error("Auto refresh tick failed with error. This is likely a transient error.",Uu)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(Uu){if(!(Uu.isAcquireTimeout||Uu instanceof ju))throw Uu;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Md()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,(async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")})))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const a=[`provider=${encodeURIComponent(t)}`];if((null===n||void 0===n?void 0:n.redirectTo)&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),(null===n||void 0===n?void 0:n.scopes)&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),"pkce"===this.flowType){const[e,t]=await qd(this.storage,this.storageKey),n=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});a.push(n.toString())}if(null===n||void 0===n?void 0:n.queryParams){const e=new URLSearchParams(n.queryParams);a.push(e.toString())}return(null===n||void 0===n?void 0:n.skipBrowserRedirect)&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession((async t=>{var n;const{data:a,error:r}=t;return r?{data:null,error:r}:await uu(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(n=null===a||void 0===a?void 0:a.session)||void 0===n?void 0:n.access_token})}))}catch(t){if(Gd(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession((async t=>{var n,a;const{data:r,error:s}=t;if(s)return{data:null,error:s};const i=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:o,error:l}=await uu(this.fetch,"POST",`${this.url}/factors`,{body:i,headers:this.headers,jwt:null===(n=null===r||void 0===r?void 0:r.session)||void 0===n?void 0:n.access_token});return l?{data:null,error:l}:("totp"===e.factorType&&(null===(a=null===o||void 0===o?void 0:o.totp)||void 0===a?void 0:a.qr_code)&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),{data:o,error:null})}))}catch(t){if(Gd(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var n;const{data:a,error:r}=t;if(r)return{data:null,error:r};const{data:s,error:i}=await uu(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(n=null===a||void 0===a?void 0:a.session)||void 0===n?void 0:n.access_token});return i?{data:null,error:i}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+s.expires_in},s)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",s),{data:s,error:i})}))}catch(t){if(Gd(t))return{data:null,error:t};throw t}}))}async _challenge(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var n;const{data:a,error:r}=t;return r?{data:null,error:r}:await uu(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:null===(n=null===a||void 0===a?void 0:a.session)||void 0===n?void 0:n.access_token})}))}catch(t){if(Gd(t))return{data:null,error:t};throw t}}))}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const n=(null===e||void 0===e?void 0:e.factors)||[],a=n.filter((e=>"totp"===e.factor_type&&"verified"===e.status)),r=n.filter((e=>"phone"===e.factor_type&&"verified"===e.status));return{data:{all:n,totp:a,phone:r},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,(async()=>await this._useSession((async e=>{var t,n;const{data:{session:a},error:r}=e;if(r)return{data:null,error:r};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const s=this._decodeJWT(a.access_token);let i=null;s.aal&&(i=s.aal);let o=i;(null!==(n=null===(t=a.user.factors)||void 0===t?void 0:t.filter((e=>"verified"===e.status)))&&void 0!==n?n:[]).length>0&&(o="aal2");return{data:{currentLevel:i,nextLevel:o,currentAuthenticationMethods:s.amr||[]},error:null}}))))}}Cu.nextInstanceID=0;const Au=Cu;class Tu extends Au{constructor(e){super(e)}}var Pu=function(e,t,n,a){return new(n||(n=Promise))((function(r,s){function i(e){try{l(a.next(e))}catch(Uu){s(Uu)}}function o(e){try{l(a.throw(e))}catch(Uu){s(Uu)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}l((a=a.apply(e,t||[])).next())}))};class Iu{constructor(e,t,n){var a,r,s;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const i=e.replace(/\/$/,"");this.realtimeUrl=`${i}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${i}/auth/v1`,this.storageUrl=`${i}/storage/v1`,this.functionsUrl=`${i}/functions/v1`;const o=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,l=function(e,t){const{db:n,auth:a,realtime:r,global:s}=e,{db:i,auth:o,realtime:l,global:c}=t,d={db:Object.assign(Object.assign({},i),n),auth:Object.assign(Object.assign({},o),a),realtime:Object.assign(Object.assign({},l),r),global:Object.assign(Object.assign({},c),s),accessToken:()=>Cd(this,void 0,void 0,(function*(){return""}))};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}(null!==n&&void 0!==n?n:{},{db:_d,realtime:jd,auth:Object.assign(Object.assign({},wd),{storageKey:o}),global:xd});this.storageKey=null!==(a=l.auth.storageKey)&&void 0!==a?a:"",this.headers=null!==(r=l.global.headers)&&void 0!==r?r:{},l.accessToken?(this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(s=l.auth)&&void 0!==s?s:{},this.headers,l.global.fetch),this.fetch=kd(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.rest=new fc(`${i}/rest/v1`,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),l.accessToken||this._listenForAuthEvents()}get functions(){return new pc(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new bd(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.rest.rpc(e,t,n)}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Pu(this,void 0,void 0,(function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return null!==(t=null===(e=n.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:null}))}_initSupabaseAuthClient(e,t,n){let{autoRefreshToken:a,persistSession:r,detectSessionInUrl:s,storage:i,storageKey:o,flowType:l,lock:c,debug:d}=e;const u={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Tu({url:this.authUrl,headers:Object.assign(Object.assign({},u),t),storageKey:o,autoRefreshToken:a,persistSession:r,detectSessionInUrl:s,storage:i,flowType:l,lock:c,debug:d,fetch:n,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Gc(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null===e||void 0===e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange(((e,t)=>{this._handleTokenChanged(e,"CLIENT",null===t||void 0===t?void 0:t.access_token)}))}_handleTokenChanged(e,t,n){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===n?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):this.changedAccessToken=n}}const Ou=(e,t,n)=>new Iu(e,t,n),Ru="https://ydnygntfkrleiseuciwq.supabase.co",Mu="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkbnlnbnRma3JsZWlzZXVjaXdxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzk5OTI0MDYsImV4cCI6MjA1NTU2ODQwNn0.B-dH2Kptzz1oyM4ynno_GjlvjpxL-HbNKC_st4bgf0A",Du=Ou(Ru,Mu),Lu="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkbnlnbnRma3JsZWlzZXVjaXdxIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTczOTk5MjQwNiwiZXhwIjoyMDU1NTY4NDA2fQ.TwhEGW9DK4DTQQRquT6Z9UW8T8UjLX-hp9uKdRjWAhs",$u=()=>(console.log("Using service role client"),Ou(Ru,Lu)),zu=()=>(console.log("Using service role client for storage operations"),$u().storage),Fu=async e=>{try{const{error:t}=await Du.from(e).select("*",{count:"exact",head:!0}).limit(1);return!t}catch(t){return console.warn(`Error verificando si la tabla ${e} existe:`,t),!1}},Bu=async()=>{console.info("Verificando estructura de la base de datos...");const e=await(async()=>{const e=Object.values($l),t=[];for(const n of e){const e=await Fu(n);t.push({name:n,exists:e})}return t})();console.group("Estado de tablas:"),e.forEach((e=>{e.exists?console.info(`\u2705 Tabla ${e.name}: OK`):console.warn(`\u274c Tabla ${e.name}: No existe`)})),console.groupEnd();const t=e.filter((e=>!e.exists));t.length>0?console.warn(`Se encontraron ${t.length} tablas faltantes. La aplicaci\xf3n podr\xeda no funcionar correctamente.`):console.info("Todas las tablas necesarias existen en la base de datos.")};let Uu={data:""},Wu=e=>"object"==typeof window?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||Uu,Vu=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Hu=/\/\*[^]*?\*\/|  +/g,qu=/\n+/g,Yu=(e,t)=>{let n="",a="",r="";for(let s in e){let i=e[s];"@"==s[0]?"i"==s[1]?n=s+" "+i+";":a+="f"==s[1]?Yu(i,s):s+"{"+Yu(i,"k"==s[1]?"":t)+"}":"object"==typeof i?a+=Yu(i,t?t.replace(/([^,])+/g,(e=>s.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,(t=>/&/.test(t)?t.replace(/&/g,e):e?e+" "+t:t)))):s):null!=i&&(s=/^--/.test(s)?s:s.replace(/[A-Z]/g,"-$&").toLowerCase(),r+=Yu.p?Yu.p(s,i):s+":"+i+";")}return n+(t&&r?t+"{"+r+"}":r)+a},Ju={},Gu=e=>{if("object"==typeof e){let t="";for(let n in e)t+=n+Gu(e[n]);return t}return e},Xu=(e,t,n,a,r)=>{let s=Gu(e),i=Ju[s]||(Ju[s]=(e=>{let t=0,n=11;for(;t<e.length;)n=101*n+e.charCodeAt(t++)>>>0;return"go"+n})(s));if(!Ju[i]){let t=s!==e?e:(e=>{let t,n,a=[{}];for(;t=Vu.exec(e.replace(Hu,""));)t[4]?a.shift():t[3]?(n=t[3].replace(qu," ").trim(),a.unshift(a[0][n]=a[0][n]||{})):a[0][t[1]]=t[2].replace(qu," ").trim();return a[0]})(e);Ju[i]=Yu(r?{["@keyframes "+i]:t}:t,n?"":"."+i)}let o=n&&Ju.g?Ju.g:null;return n&&(Ju.g=Ju[i]),((e,t,n,a)=>{a?t.data=t.data.replace(a,e):-1===t.data.indexOf(e)&&(t.data=n?e+t.data:t.data+e)})(Ju[i],t,a,o),i};function Ku(e){let t=this||{},n=e.call?e(t.p):e;return Xu(n.unshift?n.raw?((e,t,n)=>e.reduce(((e,a,r)=>{let s=t[r];if(s&&s.call){let e=s(n),t=e&&e.props&&e.props.className||/^go/.test(e)&&e;s=t?"."+t:e&&"object"==typeof e?e.props?"":Yu(e,""):!1===e?"":e}return e+a+(null==s?"":s)}),""))(n,[].slice.call(arguments,1),t.p):n.reduce(((e,n)=>Object.assign(e,n&&n.call?n(t.p):n)),{}):n,Wu(t.target),t.g,t.o,t.k)}Ku.bind({g:1});let Qu,Zu,eh,th=Ku.bind({k:1});function nh(e,t){let n=this||{};return function(){let a=arguments;function r(s,i){let o=Object.assign({},s),l=o.className||r.className;n.p=Object.assign({theme:Zu&&Zu()},o),n.o=/ *go\d+/.test(l),o.className=Ku.apply(n,a)+(l?" "+l:""),t&&(o.ref=i);let c=e;return e[0]&&(c=o.as||e,delete o.as),eh&&c[0]&&eh(o),Qu(c,o)}return t?t(r):r}}var ah=(e,t)=>(e=>"function"==typeof e)(e)?e(t):e,rh=(()=>{let e=0;return()=>(++e).toString()})(),sh=(()=>{let e;return()=>{if(void 0===e&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),ih=(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,20)};case 1:return{...e,toasts:e.toasts.map((e=>e.id===t.toast.id?{...e,...t.toast}:e))};case 2:let{toast:n}=t;return ih(e,{type:e.toasts.find((e=>e.id===n.id))?1:0,toast:n});case 3:let{toastId:a}=t;return{...e,toasts:e.toasts.map((e=>e.id===a||void 0===a?{...e,dismissed:!0,visible:!1}:e))};case 4:return void 0===t.toastId?{...e,toasts:[]}:{...e,toasts:e.toasts.filter((e=>e.id!==t.toastId))};case 5:return{...e,pausedAt:t.time};case 6:let r=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map((e=>({...e,pauseDuration:e.pauseDuration+r})))}}},oh=[],lh={toasts:[],pausedAt:void 0},ch=e=>{lh=ih(lh,e),oh.forEach((e=>{e(lh)}))},dh=e=>(t,n)=>{let a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"blank",n=arguments.length>2?arguments[2]:void 0;return{createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...n,id:(null==n?void 0:n.id)||rh()}}(t,e,n);return ch({type:2,toast:a}),a.id},uh=(e,t)=>dh("blank")(e,t);uh.error=dh("error"),uh.success=dh("success"),uh.loading=dh("loading"),uh.custom=dh("custom"),uh.dismiss=e=>{ch({type:3,toastId:e})},uh.remove=e=>ch({type:4,toastId:e}),uh.promise=(e,t,n)=>{let a=uh.loading(t.loading,{...n,...null==n?void 0:n.loading});return"function"==typeof e&&(e=e()),e.then((e=>{let r=t.success?ah(t.success,e):void 0;return r?uh.success(r,{id:a,...n,...null==n?void 0:n.success}):uh.dismiss(a),e})).catch((e=>{let r=t.error?ah(t.error,e):void 0;r?uh.error(r,{id:a,...n,...null==n?void 0:n.error}):uh.dismiss(a)})),e};new Map;var hh=th`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,ph=th`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,mh=th`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,fh=nh("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${hh} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${ph} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${mh} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,gh=th`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,vh=nh("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${gh} 1s linear infinite;
`,bh=th`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,yh=th`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,xh=nh("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${bh} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${yh} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,_h=nh("div")`
  position: absolute;
`,wh=nh("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,jh=th`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Nh=nh("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${jh} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Eh=e=>{let{toast:t}=e,{icon:n,type:a,iconTheme:s}=t;return void 0!==n?"string"==typeof n?r.createElement(Nh,null,n):n:"blank"===a?null:r.createElement(wh,null,r.createElement(vh,{...s}),"loading"!==a&&r.createElement(_h,null,"error"===a?r.createElement(fh,{...s}):r.createElement(xh,{...s})))},Sh=e=>`\n0% {transform: translate3d(0,${-200*e}%,0) scale(.6); opacity:.5;}\n100% {transform: translate3d(0,0,0) scale(1); opacity:1;}\n`,kh=e=>`\n0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}\n100% {transform: translate3d(0,${-150*e}%,-1px) scale(.6); opacity:0;}\n`,Ch=nh("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,Ah=nh("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`;r.memo((e=>{let{toast:t,position:n,style:a,children:s}=e,i=t.height?((e,t)=>{let n=e.includes("top")?1:-1,[a,r]=sh()?["0%{opacity:0;} 100%{opacity:1;}","0%{opacity:1;} 100%{opacity:0;}"]:[Sh(n),kh(n)];return{animation:t?`${th(a)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${th(r)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}})(t.position||n||"top-center",t.visible):{opacity:0},o=r.createElement(Eh,{toast:t}),l=r.createElement(Ah,{...t.ariaProps},ah(t.message,t));return r.createElement(Ch,{className:t.className,style:{...i,...a,...t.style}},"function"==typeof s?s({icon:o,message:l}):r.createElement(r.Fragment,null,o,l))}));!function(e,t,n,a){Yu.p=t,Qu=e,Zu=n,eh=a}(r.createElement);Ku`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`;let Th=function(e){return e.VALIDATION="VALIDATION",e.AUTHENTICATION="AUTHENTICATION",e.AUTHORIZATION="AUTHORIZATION",e.SERVER="SERVER",e.NETWORK="NETWORK",e.UPLOAD="UPLOAD",e.NOT_FOUND="NOT_FOUND",e.DATABASE="DATABASE",e.UNKNOWN="UNKNOWN",e}({});const Ph=(e,t,n,a)=>({type:e,message:t,details:n,originalError:a}),Ih=e=>e instanceof Error&&(e.message.includes("network")||e.message.includes("offline")||e.message.includes("failed to fetch")||e.message.includes("NetworkError")),Oh=e=>e instanceof Error&&(e.message.includes("500")||e.message.includes("server error")),Rh=e=>{if(e instanceof Error){if(e.message.includes("401")||e.message.includes("authentication"))return Ph(Th.AUTHENTICATION,"Authentication failed. Please log in again.",{},e);if(e.message.includes("403")||e.message.includes("permission"))return Ph(Th.AUTHORIZATION,"You do not have permission to perform this action.",{},e);if(e.message.includes("404")||e.message.includes("not found"))return Ph(Th.NOT_FOUND,"The requested resource was not found.",{},e);if(Ih(e))return Ph(Th.NETWORK,"A network error occurred. Please check your connection and try again.",{},e);if(Oh(e))return Ph(Th.SERVER,"A server error occurred. Please try again later.",{},e)}return Ph(Th.UNKNOWN,"An unexpected error occurred.",{},e)},Mh=(e,t,n)=>{if(console.error(`Error in ${t}:`,e),n&&console.error("Additional info:",n),e&&"object"===typeof e&&"type"in e){const t=e;console.error("Error type:",t.type),console.error("Error message:",t.message),t.details&&console.error("Error details:",t.details),t.originalError&&console.error("Original error:",t.originalError)}},Dh=e=>!(!e||!e.message)&&(e.message.includes("violates row-level security policy")||e.message.includes("permission denied")||e.message.includes("Unauthorized")||e.message.includes("403")),Lh=(e,t,n,a)=>{const r=Ph(Th.AUTHORIZATION,`No tienes permisos para ${e} este ${t}. Esto puede deberse a pol\xedticas de seguridad RLS en Supabase.`,{originalError:(null===a||void 0===a?void 0:a.message)||"Unknown error"});return Mh(r,`${e}${t}.RLS_VIOLATION`,{[`${t}Id`]:n}),r},$h=$l.DOCUMENTS,zh=e=>{if(!e)return;const t=e.replace(/[^0-9.-]/g,"").replace(/(\..*)\./g,"$1"),n=parseFloat(t);return isNaN(n)?void 0:n},Fh=e=>{var t;return null===e||void 0===e?null:"number"===typeof e?e:null!==(t=zh(e))&&void 0!==t?t:null},Bh=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"client-documents";try{console.log(`Verificando si el bucket ${e} existe...`);const r=zu(),{data:s,error:i}=await r.listBuckets();if(i){console.error("Error al listar buckets:",i);const{error:t}=await r.from(e).list();if(!t)return console.log(`El bucket ${e} existe y es accesible.`),!0;throw Ph(Th.UPLOAD,`Error al acceder al almacenamiento: ${i.message}`,{error:i})}if(null===s||void 0===s?void 0:s.some((t=>t.name===e)))return console.log(`El bucket ${e} ya existe.`),!0;console.log(`El bucket ${e} no existe. Intentando crearlo...`);const o=2;let l=0,c=null;for(;l<o;)try{const{data:a,error:s}=await r.createBucket(e,{public:!1});if(s){var t;if(console.error(`Error al crear el bucket ${e} (intento ${l+1}/${o}):`,s),c=s,null!==(t=s.message)&&void 0!==t&&t.includes("already exists"))return console.log(`El bucket ${e} ya existe (seg\xfan el mensaje de error).`),!0;throw s}console.log(`Bucket ${e} creado correctamente.`);try{const{error:t}=await r.from(e).list("",{limit:1});t?console.warn(`Advertencia: El bucket ${e} fue creado pero hay problemas para acceder a \xe9l: ${t.message}`):console.log(`Bucket ${e} creado y accesible correctamente.`)}catch(n){console.warn(`No se pudo verificar acceso al bucket ${e}:`,n)}return!0}catch(a){if(c=a,l++,l<o){const e=1e3*Math.pow(2,l-1);console.log(`Esperando ${e}ms antes de reintentar crear el bucket...`),await new Promise((t=>setTimeout(t,e)))}}throw c||new Error(`No se pudo crear el bucket ${e} despu\xe9s de ${o} intentos.`)}catch(a){try{const t=zu(),n=`test-${Date.now()}.txt`,a=new Blob(["test"],{type:"text/plain"});console.log(`Intentando escribir archivo de prueba en ${e}/${n} como \xfaltimo recurso...`);const{error:r}=await t.from(e).upload(n,a);if(!r)return console.log(`\xa1\xc9xito! El bucket ${e} existe y permite escritura.`),await t.from(e).remove([n]),!0}catch(r){console.error("Error en la prueba final de escritura en bucket:",r)}throw console.error(`Error al verificar/crear bucket ${e}:`,a),Ph(Th.UPLOAD,a instanceof Error?`Error al crear el bucket de almacenamiento: ${a.message}`:"Error desconocido al crear el bucket de almacenamiento",{bucketName:e,error:a})}},Uh=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(!e)throw new Error("Client ID is required for uploading documents");if(!t||!Array.isArray(t)||0===t.length)return[];try{let i="client-documents";console.log(`Iniciando proceso de subida de documentos para cliente ${e}`),console.log(`Total de documentos: ${t.length}`);let o=!1;try{o=await Bh(i),o&&console.log(`Bucket ${i} verificado y listo para su uso.`)}catch(a){console.error(`Error preparando el bucket ${i}:`,a),i="documents",console.log(`Intentando usar el bucket predeterminado '${i}' como alternativa...`);try{o=await Bh(i),o&&console.log(`Usando bucket alternativo '${i}' para la subida.`)}catch(r){throw console.error("No se pudo usar ning\xfan bucket para la subida:",r),Ph(Th.UPLOAD,"No se pudo preparar un bucket para subir documentos. Contacte al administrador.",{originalError:a})}}const l=zu(),c=[],d=[],u=t.filter((e=>e&&e.file&&e.file instanceof File&&e.category&&e.name));if(console.log(`Documentos v\xe1lidos para subida: ${u.length} de ${t.length}`),0===u.length)return console.warn("No hay documentos v\xe1lidos para subir. Se requiere archivo, categor\xeda y nombre."),[];for(let t=0;t<u.length;t++){const a=u[t];let r="",o=!1,h=0,p=null;for(console.log(`Procesando documento ${t+1}/${u.length}: "${a.name}" (${a.file.size} bytes)`);!o&&h<=n;){h++;try{const t=(new Date).getTime(),s=`${t}_${a.file.name.replace(/[^a-zA-Z0-9.-]/g,"_")}`,c=`${e}/${a.category}/${s}`;console.log(`Intento ${h}/${n+1}: Subiendo "${a.name}" a ${i}/${c}`);const{data:d,error:u}=await l.from(i).upload(c,a.file,{cacheControl:"3600",upsert:!0});if(u)throw console.error(`Error al subir archivo "${a.name}" (intento ${h}/${n+1}):`,u),p=u,u;const{data:m}=l.from(i).getPublicUrl(c);r=m.publicUrl,o=!0,console.log(`\u2705 Documento "${a.name}" subido exitosamente a ${i}/${c}`)}catch(s){if(p=s,s instanceof Error&&(console.error(`Detalles del error: ${s.message}`),s.stack&&console.error(`Stack: ${s.stack}`)),h<=n){const e=1e3*Math.pow(2,h-1);console.log(`Esperando ${e}ms antes de reintentar la subida...`),await new Promise((t=>setTimeout(t,e)))}else{console.error(`\u274c Fall\xf3 la subida de "${a.name}" despu\xe9s de ${h} intentos.`),d.push({name:a.name||a.file.name,error:s});const t=Ph(Th.UPLOAD,`Error al subir documento "${a.name||a.file.name}" despu\xe9s de ${n+1} intentos`,{documentName:a.name,clientId:e,category:a.category,attempts:h},s);Mh(t,"uploadClientDocuments")}}}if(o){const{file:e,...t}=a;c.push({...t,url:r})}}return d.length>0&&console.warn(`\u26a0\ufe0f ${d.length} documentos fallaron al subirse de un total de ${u.length}:`,d),console.log(`\ud83d\udcca Resumen: ${c.length} documentos subidos exitosamente, ${d.length} fallidos.`),c}catch(s){console.error("\u274c Error general en uploadClientDocuments:",s);let t="Error al subir documentos";throw s instanceof Error?t=s.message:"object"===typeof s&&null!==s&&"message"in s&&(t=s.message||t),Ph(Th.UPLOAD,t,{clientId:e,error:s})}},Wh="users",Vh=e=>{if(!e)throw console.error("Error: userData is undefined in mapUserToClient"),new Error("No se pudo procesar la informaci\xf3n del cliente, los datos son inv\xe1lidos");const t=e.name||[e.first_name,e.paternal_surname,e.maternal_surname].filter(Boolean).join(" ");return{id:e.id,created_at:e.created_at,last_login:e.last_login,name:t,first_name:e.first_name,paternal_surname:e.paternal_surname,maternal_surname:e.maternal_surname,email:e.email,phone:e.phone,birth_date:e.birth_date,company_id:e.company_id,rfc:e.rfc,curp:e.curp,advisor_id:e.advisor_id,address:e.address,city:e.city,state:e.state,postal_code:e.postal_code,gender:e.gender,marital_status:e.marital_status,employment_type:e.employment_type,employment_years:e.employment_years,monthly_income:e.monthly_income,additional_income:e.additional_income,monthly_expenses:e.monthly_expenses,other_loan_balances:e.other_loan_balances,bank_name:e.bank_name,bank_clabe:e.bank_clabe,bank_account_number:e.bank_account_number,bank_account_type:e.bank_account_type,bank_account_origin:e.bank_account_origin,street_number_ext:e.street_number_ext,street_number_int:e.street_number_int,neighborhood:e.neighborhood,home_phone:e.home_phone,birth_state:e.birth_state,nationality:e.nationality,job_position:e.job_position,employer_name:e.employer_name,employer_phone:e.employer_phone,employer_address:e.employer_address,employer_activity:e.employer_activity,mortgage_payment:e.mortgage_payment,rent_payment:e.rent_payment,dependent_persons:e.dependent_persons,income_frequency:e.income_frequency,payment_method:e.payment_method,credit_purpose:e.credit_purpose,spouse_paternal_surname:e.spouse_paternal_surname,spouse_maternal_surname:e.spouse_maternal_surname,reference1_name:e.reference1_name,reference1_relationship:e.reference1_relationship,reference1_address:e.reference1_address,reference1_phone:e.reference1_phone,reference2_name:e.reference2_name,reference2_relationship:e.reference2_relationship,reference2_address:e.reference2_address,reference2_phone:e.reference2_phone}},Hh=async e=>{try{const t=$u(),{data:n,error:a}=await t.from(Wh).select("id, email, first_name, paternal_surname, maternal_surname, phone, company_id, created_at, birth_date, rfc, curp, advisor_id, address, city, state, postal_code, gender, marital_status, employment_type, employment_years, monthly_income, additional_income, monthly_expenses, other_loan_balances, bank_name, bank_clabe, bank_account_number, bank_account_type, bank_account_origin, street_number_ext, street_number_int, neighborhood, home_phone, birth_state, nationality, job_position, employer_name, employer_phone, employer_address, employer_activity, mortgage_payment, rent_payment, dependent_persons, income_frequency, payment_method, credit_purpose, spouse_paternal_surname, spouse_maternal_surname, reference1_name, reference1_relationship, reference1_address, reference1_phone, reference2_name, reference2_relationship, reference2_address, reference2_phone, last_login").eq("id",e).single();if(a)throw Mh(a,"getClientById",{clientId:e}),Rh(a);if(!n){const t=Ph(Th.NOT_FOUND,`No se encontr\xf3 cliente con ID: ${e}`);throw Mh(t,"getClientById",{clientId:e}),t}return Vh(n)}catch(t){throw Mh(t,"getClientById",{clientId:e}),Rh(t)}};const qh=async(e,t,n)=>{try{const r={email:e.email,first_name:e.first_name||"",paternal_surname:e.paternal_surname||"",maternal_surname:e.maternal_surname||"",phone:e.phone,birth_date:e.birth_date,company_id:e.company_id,rfc:e.rfc,curp:e.curp,advisor_id:e.advisor_id,address:e.address,city:e.city,state:e.state,postal_code:e.postal_code,gender:e.gender,marital_status:e.marital_status,employment_type:e.employment_type,employment_years:e.employment_years,monthly_income:e.monthly_income,additional_income:e.additional_income,monthly_expenses:e.monthly_expenses,other_loan_balances:e.other_loan_balances,bank_name:e.bank_name,bank_clabe:e.bank_clabe,bank_account_number:e.bank_account_number,bank_account_type:e.bank_account_type,bank_account_origin:e.bank_account_origin,street_number_ext:e.street_number_ext,street_number_int:e.street_number_int,neighborhood:e.neighborhood,home_phone:e.home_phone,birth_state:e.birth_state,nationality:e.nationality,job_position:e.job_position,employer_name:e.employer_name,employer_phone:e.employer_phone,employer_address:e.employer_address,employer_activity:e.employer_activity,mortgage_payment:e.mortgage_payment,rent_payment:e.rent_payment,dependent_persons:e.dependent_persons,income_frequency:e.income_frequency,payment_method:e.payment_method,credit_purpose:e.credit_purpose,spouse_paternal_surname:e.spouse_paternal_surname,spouse_maternal_surname:e.spouse_maternal_surname,reference1_name:e.reference1_name,reference1_relationship:e.reference1_relationship,reference1_address:e.reference1_address,reference1_phone:e.reference1_phone,reference2_name:e.reference2_name,reference2_relationship:e.reference2_relationship,reference2_address:e.reference2_address,reference2_phone:e.reference2_phone};if(delete r.name,delete r.warningMessage,void 0!==r.employment_years){const e=Fh(r.employment_years);r.employment_years=null===e?void 0:e}if(void 0!==r.monthly_income){const e=Fh(r.monthly_income);r.monthly_income=null===e?void 0:e}if(void 0!==r.additional_income){const e=Fh(r.additional_income);r.additional_income=null===e?void 0:e}if(void 0!==r.monthly_expenses){const e=Fh(r.monthly_expenses);r.monthly_expenses=null===e?void 0:e}if(void 0!==r.other_loan_balances){const e=Fh(r.other_loan_balances);r.other_loan_balances=null===e?void 0:e}r.company_id||(console.warn("No company_id provided when creating client - using default company"),r.company_id="70b2aa97-a5b6-4b5e-91db-be8acbd3701a"),console.log("Creating client with sanitized data:",JSON.stringify(r));const s=$u(),{data:i,error:o,count:l}=await s.from(Wh).insert([r]).select();if(o){if(Dh(o))throw Lh("crear","cliente","nuevo",o);throw Mh(o,"createClient"),Rh(o)}if(!i||0===i.length||0===l){const e=Ph(Th.SERVER,"No se pudo crear el cliente. No se recibieron datos del servidor.");throw Mh(e,"createClient"),e}const c=Vh(i[0]);let d=null;if(t&&t.length>0&&n&&c.id)try{console.log(`Uploading ${t.length} documents for new client ${c.id}`),d=await Uh(c.id,t),d&&d.length>0?console.log(`${d.length} documents uploaded successfully during client creation`):(console.warn("No documents were successfully uploaded during client creation"),c.warningMessage="Se cre\xf3 el cliente, pero no se pudieron subir los documentos. Puede intentar agregarlos nuevamente m\xe1s tarde.")}catch(a){console.error("Error uploading documents during client creation:",a);const e=a instanceof Error?a.message:"Error desconocido";console.error(`Error detail: ${e}`),c.warningMessage=`Se cre\xf3 el cliente, pero hubo un problema al subir los documentos: ${e}. Puede intentar agregarlos nuevamente m\xe1s tarde.`}return c}catch(r){throw Mh(r,"createClient",{clientData:e}),Rh(r)}},Yh=async(e,t,n,a)=>{try{console.log(`Starting client update for ID ${e}`,t);const s={...t};if(delete s.name,delete s.warningMessage,"employment_years"in t){const e=Fh(t.employment_years);s.employment_years=null===e?void 0:e}if("monthly_income"in t){const e=Fh(t.monthly_income);s.monthly_income=null===e?void 0:e}if("additional_income"in t){const e=Fh(t.additional_income);s.additional_income=null===e?void 0:e}if("monthly_expenses"in t){const e=Fh(t.monthly_expenses);s.monthly_expenses=null===e?void 0:e}if("other_loan_balances"in t){const e=Fh(t.other_loan_balances);s.other_loan_balances=null===e?void 0:e}if("mortgage_payment"in t){const e=Fh(t.mortgage_payment);s.mortgage_payment=null===e?void 0:e}if("rent_payment"in t){const e=Fh(t.rent_payment);s.rent_payment=null===e?void 0:e}if("dependent_persons"in t){const e=Fh(t.dependent_persons);s.dependent_persons=null===e?void 0:e}Object.keys(s).forEach((e=>{const t=e;void 0===s[t]&&delete s[t]})),console.log(`Updating client ${e} with sanitized data:`,JSON.stringify(s));const i=$u(),{data:o,error:l}=await i.from(Wh).select("id").eq("id",e).single();if(l||!o){const t=Ph(Th.NOT_FOUND,`No se encontr\xf3 el cliente con ID ${e}. Verifique que el cliente exista.`);throw Mh(t,"updateClient",{clientId:e}),t}const{data:c,error:d,count:u}=await i.from(Wh).update(s).eq("id",e).select();if(d){if(Dh(d))throw Lh("actualizar","cliente",e,d);throw Mh(d,"updateClient",{clientId:e}),Rh(d)}if(!c||0===c.length||0===u)throw console.warn(`Update operation didn't affect any rows for client ${e}`),((e,t,n)=>{const a="update"===e?"actualizaci\xf3n":"delete"===e?"eliminaci\xf3n":e,r=Ph(Th.DATABASE,`La ${a} no tuvo efecto en la base de datos. Esto puede deberse a permisos insuficientes.`,{[`${t}Id`]:n});return Mh(r,`${e}${t}.NO_EFFECT`,{[`${t}Id`]:n}),r})("update","cliente",e);let h;if(c&&0!==c.length)h=Vh(c[0]);else{console.log(`No data returned when updating client with ID ${e}, fetching client data separately`);const{data:t,error:n}=await i.from(Wh).select("*").eq("id",e).single();if(n)throw console.error("Error fetching updated client:",n),n;h=Vh(t)}let p=null;if(n&&n.length>0&&a)try{console.log(`Uploading ${n.length} documents for client ${e}`),p=await Uh(e,n),p&&p.length>0?console.log(`${p.length} documents uploaded successfully during client update`):(console.warn("No documents were successfully uploaded during client update"),h.warningMessage="Se actualiz\xf3 el cliente, pero no se pudieron subir los documentos. Puede intentar agregarlos nuevamente m\xe1s tarde.")}catch(r){console.error(`Error uploading documents for client ${e}:`,r);const t=r instanceof Error?r.message:"Error desconocido";console.error(`Error detail: ${t}`),h.warningMessage=`Se actualiz\xf3 el cliente, pero hubo un problema al subir los documentos: ${t}. Puede intentar agregarlos nuevamente m\xe1s tarde.`}return console.log(`Client update complete for ID ${e}`),h}catch(s){throw Mh(s,"updateClient",{clientId:e,updates:t}),Rh(s)}},Jh=()=>{const{userCan:e}=Je(),{user:t}=Ue(),[n,a]=(0,r.useState)([]),[s,i]=(0,r.useState)(!0),[o,l]=(0,r.useState)(null),[c,d]=(0,r.useState)(0),[u,h]=(0,r.useState)({searchQuery:"",page:0,pageSize:10});(0,r.useEffect)((()=>{t&&"ADVISOR"===t.role?h((e=>({...e,advisor_id:t.id}))):t&&"COMPANY_ADMIN"===t.role&&h((e=>({...e,company_id:t.entityId})))}),[t]),(0,r.useEffect)((()=>{p()}),[u.page,u.pageSize,u.advisor_id,u.company_id]),(0,r.useEffect)((()=>{const e=setTimeout((()=>{0!==u.page?h((e=>({...e,page:0}))):p()}),500);return()=>clearTimeout(e)}),[u.searchQuery,u.dateFrom,u.dateTo]);const p=async()=>{try{var e;i(!0);const t=await(async e=>{try{let t=$u().from(Wh).select("id, email, first_name, paternal_surname, maternal_surname, phone, company_id, created_at, birth_date, rfc, curp, advisor_id, address, city, state, postal_code, gender, marital_status, employment_type, employment_years, monthly_income, additional_income, monthly_expenses, other_loan_balances, bank_name, bank_clabe, bank_account_number, bank_account_type, bank_account_origin, street_number_ext, street_number_int, neighborhood, home_phone, birth_state, nationality, job_position, employer_name, employer_phone, employer_address, employer_activity, mortgage_payment, rent_payment, dependent_persons, income_frequency, payment_method, credit_purpose, spouse_paternal_surname, spouse_maternal_surname, reference1_name, reference1_relationship, reference1_address, reference1_phone, reference2_name, reference2_relationship, reference2_address, reference2_phone, last_login",{count:"exact"});if(e&&(e.advisor_id&&(t=t.eq("advisor_id",e.advisor_id)),e.company_id&&(t=t.eq("company_id",e.company_id)),e.dateFrom&&(t=t.gte("created_at",e.dateFrom)),e.dateTo&&(t=t.lte("created_at",e.dateTo)),e.searchQuery&&(t=t.or(`first_name.ilike.%${e.searchQuery}%,paternal_surname.ilike.%${e.searchQuery}%,maternal_surname.ilike.%${e.searchQuery}%,email.ilike.%${e.searchQuery}%,phone.ilike.%${e.searchQuery}%,rfc.ilike.%${e.searchQuery}%,curp.ilike.%${e.searchQuery}%`)),void 0!==e.page&&e.pageSize)){const n=e.page*e.pageSize,a=n+e.pageSize-1;t=t.range(n,a)}t=t.order("created_at",{ascending:!1});const{data:n,error:a,count:r}=await t;if(a)throw Mh(a,"getClients",{filters:e}),Rh(a);return{clients:n?n.map(Vh):[],totalCount:r||0}}catch(o){throw Mh(o,"getClients",{filters:e}),Rh(o)}})(u);a(t.clients||[]),d(t.totalCount||0),0!==(null===(e=t.clients)||void 0===e?void 0:e.length)&&t.clients||0!==t.totalCount&&t.totalCount?l(null):l("No se pudieron cargar los clientes. La tabla de clientes no existe en la base de datos.")}catch(t){console.error("Error fetching clients:",t),l("No se pudieron cargar los clientes. Por favor intente nuevamente.")}finally{i(!1)}},m=e=>{const{name:t,value:n}=e.target;h((e=>({...e,[t]:n})))},f=u.page*u.pageSize+1,g=Math.min(f+n.length-1,c),v=Math.ceil(c/u.pageSize);return(0,Le.jsx)(_t,{children:(0,Le.jsxs)("div",{className:"p-6",children:[(0,Le.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6",children:[(0,Le.jsx)("h1",{className:"text-2xl font-bold mb-4 md:mb-0",children:"Clientes"}),e(Ve.CREATE_CLIENT)&&(0,Le.jsxs)(Te,{to:"/clients/new",className:"btn btn-primary",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Le.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})}),"Nuevo Cliente"]})]}),(0,Le.jsx)("div",{className:"card bg-base-100 shadow-xl mb-6",children:(0,Le.jsxs)("div",{className:"card-body",children:[(0,Le.jsx)("h2",{className:"card-title text-lg mb-4",children:"Filtros"}),(0,Le.jsx)("div",{className:"flex flex-col md:flex-row gap-4",children:(0,Le.jsxs)("div",{className:"form-control w-full",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Buscar"})}),(0,Le.jsxs)("div",{className:"input-group",children:[(0,Le.jsx)("input",{type:"text",placeholder:"Buscar por nombre, correo, tel\xe9fono, RFC o CURP...",className:"input input-bordered w-full",value:u.searchQuery,onChange:e=>{h((t=>({...t,searchQuery:e.target.value})))}}),(0,Le.jsx)("button",{className:"btn btn-square",onClick:()=>p(),children:(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})]})}),(0,Le.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 mt-4",children:[(0,Le.jsxs)("div",{className:"form-control w-full md:w-1/2",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Fecha Desde"})}),(0,Le.jsx)("input",{type:"date",name:"dateFrom",className:"input input-bordered w-full",value:u.dateFrom||"",onChange:m})]}),(0,Le.jsxs)("div",{className:"form-control w-full md:w-1/2",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Fecha Hasta"})}),(0,Le.jsx)("input",{type:"date",name:"dateTo",className:"input input-bordered w-full",value:u.dateTo||"",onChange:m})]})]})]})}),(0,Le.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,Le.jsx)("div",{className:"card-body",children:s?(0,Le.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,Le.jsx)("span",{className:"loading loading-spinner loading-lg"})}):o?(0,Le.jsxs)("div",{className:"alert alert-error",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,Le.jsx)("span",{children:o})]}):0===n.length?(0,Le.jsxs)("div",{children:[(0,Le.jsx)("p",{className:"text-center py-8 text-gray-500",children:"No se encontraron clientes con los filtros aplicados."}),!u.searchQuery&&!u.dateFrom&&!u.dateTo&&(0,Le.jsxs)("div",{className:"alert alert-info mt-4",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"stroke-current flex-shrink-0 w-6 h-6",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,Le.jsxs)("div",{children:[(0,Le.jsx)("h3",{className:"font-bold",children:"No hay clientes registrados"}),(0,Le.jsx)("div",{className:"text-sm",children:e(Ve.CREATE_CLIENT)?(0,Le.jsx)("span",{children:'Puede crear un nuevo cliente utilizando el bot\xf3n "Nuevo Cliente" en la parte superior.'}):(0,Le.jsx)("span",{children:"Contacte al administrador para registrar clientes en el sistema."})})]})]})]}):(0,Le.jsxs)(Le.Fragment,{children:[(0,Le.jsx)("div",{className:"overflow-x-auto",children:(0,Le.jsxs)("table",{className:"table w-full",children:[(0,Le.jsx)("thead",{children:(0,Le.jsxs)("tr",{children:[(0,Le.jsx)("th",{children:"Nombre"}),(0,Le.jsx)("th",{children:"Correo"}),(0,Le.jsx)("th",{children:"Tel\xe9fono"}),(0,Le.jsx)("th",{children:"RFC"}),(0,Le.jsx)("th",{children:"Fecha Registro"}),(0,Le.jsx)("th",{children:"Acciones"})]})}),(0,Le.jsx)("tbody",{children:n.map((t=>(0,Le.jsxs)("tr",{className:"hover",children:[(0,Le.jsx)("td",{children:t.name||[t.first_name,t.paternal_surname,t.maternal_surname].filter(Boolean).join(" ")}),(0,Le.jsx)("td",{children:t.email}),(0,Le.jsx)("td",{children:t.phone}),(0,Le.jsx)("td",{children:t.rfc||"-"}),(0,Le.jsx)("td",{children:new Date(t.created_at).toLocaleDateString()}),(0,Le.jsxs)("td",{className:"flex gap-2",children:[(0,Le.jsx)(Te,{to:`/clients/${t.id}`,className:"btn btn-sm btn-info",children:"Ver"}),e(Ve.EDIT_CLIENT)&&(0,Le.jsx)(Te,{to:`/clients/${t.id}/edit`,className:"btn btn-sm btn-secondary",children:"Editar"})]})]},t.id)))})]})}),(0,Le.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center mt-6",children:[(0,Le.jsx)("div",{className:"mb-4 md:mb-0",children:(0,Le.jsxs)("span",{className:"text-sm text-gray-500",children:["Mostrando ",f," a ",g," de ",c," clientes"]})}),(0,Le.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Le.jsx)("div",{className:"form-control",children:(0,Le.jsxs)("select",{className:"select select-bordered select-sm",value:u.pageSize,onChange:e=>{const t=parseInt(e.target.value);h((e=>({...e,pageSize:t,page:0})))},children:[(0,Le.jsx)("option",{value:10,children:"10 por p\xe1gina"}),(0,Le.jsx)("option",{value:25,children:"25 por p\xe1gina"}),(0,Le.jsx)("option",{value:50,children:"50 por p\xe1gina"}),(0,Le.jsx)("option",{value:100,children:"100 por p\xe1gina"})]})}),(0,Le.jsxs)("div",{className:"join",children:[(0,Le.jsx)("button",{className:"join-item btn btn-sm",onClick:()=>{u.page>0&&h((e=>({...e,page:e.page-1})))},disabled:0===u.page,children:"\xab"}),(0,Le.jsxs)("button",{className:"join-item btn btn-sm",children:["P\xe1gina ",u.page+1," de ",v]}),(0,Le.jsx)("button",{className:"join-item btn btn-sm",onClick:()=>{(u.page+1)*u.pageSize<c&&h((e=>({...e,page:e.page+1})))},disabled:(u.page+1)*u.pageSize>=c,children:"\xbb"})]})]})]})]})})})]})})};var Gh={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Xh=r.createContext&&r.createContext(Gh),Kh=function(){return Kh=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Kh.apply(this,arguments)},Qh=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n};function Zh(e){return e&&e.map((function(e,t){return r.createElement(e.tag,Kh({key:t},e.attr),Zh(e.child))}))}function ep(e){return function(t){return r.createElement(tp,Kh({attr:Kh({},e.attr)},t),Zh(e.child))}}function tp(e){var t=function(t){var n,a=e.attr,s=e.size,i=e.title,o=Qh(e,["attr","size","title"]),l=s||t.size||"1em";return t.className&&(n=t.className),e.className&&(n=(n?n+" ":"")+e.className),r.createElement("svg",Kh({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,a,o,{className:n,style:Kh(Kh({color:e.color||t.color},t.style),e.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),i&&r.createElement("title",null,i),e.children)};return void 0!==Xh?r.createElement(Xh.Consumer,null,(function(e){return t(e)})):t(Gh)}function np(e){return ep({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"20 6 9 17 4 12"}}]})(e)}function ap(e){return ep({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}},{tag:"polyline",attr:{points:"7 10 12 15 17 10"}},{tag:"line",attr:{x1:"12",y1:"15",x2:"12",y2:"3"}}]})(e)}function rp(e){return ep({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"}},{tag:"polyline",attr:{points:"13 2 13 9 20 9"}}]})(e)}function sp(e){return ep({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"}}]})(e)}function ip(e){return ep({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}},{tag:"polyline",attr:{points:"17 8 12 3 7 8"}},{tag:"line",attr:{x1:"12",y1:"3",x2:"12",y2:"15"}}]})(e)}function op(e){return ep({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"}},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"}}]})(e)}const lp=[{value:"masculino",label:"Masculino"},{value:"femenino",label:"Femenino"},{value:"otro",label:"Otro"},{value:"prefiero_no_decir",label:"Prefiero no decir"}],cp=[{value:"soltero",label:"Soltero/a"},{value:"casado",label:"Casado/a"},{value:"divorciado",label:"Divorciado/a"},{value:"viudo",label:"Viudo/a"},{value:"union_libre",label:"Uni\xf3n Libre"}],dp=[{value:"empleado",label:"Empleado"},{value:"autonomo",label:"Aut\xf3nomo / Freelance"},{value:"empresario",label:"Empresario"},{value:"jubilado",label:"Jubilado"},{value:"desempleado",label:"Desempleado"},{value:"estudiante",label:"Estudiante"},{value:"otro",label:"Otro"}],up=[{value:"semanal",label:"Semanal"},{value:"quincenal",label:"Quincenal"},{value:"mensual",label:"Mensual"},{value:"bimestral",label:"Bimestral"},{value:"trimestral",label:"Trimestral"},{value:"semestral",label:"Semestral"},{value:"anual",label:"Anual"},{value:"irregular",label:"Irregular"}],hp=[{value:"efectivo",label:"Efectivo"},{value:"transferencia",label:"Transferencia"},{value:"tarjeta",label:"Tarjeta de Cr\xe9dito/D\xe9bito"},{value:"cheque",label:"Cheque"},{value:"domiciliacion",label:"Domiciliaci\xf3n Bancaria"}],pp=[{value:"personal",label:"Gastos Personales"},{value:"negocio",label:"Negocio/Inversi\xf3n"},{value:"vivienda",label:"Vivienda"},{value:"auto",label:"Autom\xf3vil"},{value:"educacion",label:"Educaci\xf3n"},{value:"salud",label:"Salud"},{value:"deudas",label:"Consolidaci\xf3n de Deudas"},{value:"otro",label:"Otro"}],mp=[{value:"nomina",label:"N\xf3mina"},{value:"ahorro",label:"Ahorro"},{value:"cheques",label:"Cheques"},{value:"inversiones",label:"Inversiones"}],fp=[{value:"familiar",label:"Familiar"},{value:"amigo",label:"Amigo"},{value:"companero_trabajo",label:"Compa\xf1ero de Trabajo"},{value:"vecino",label:"Vecino"},{value:"otro",label:"Otro"}],gp=(e,t)=>{if(!t)return"-";const n=e.find((e=>e.value===t));return n?n.label:t},vp=e=>{if(!e)return"-";try{return new Date(e).toLocaleDateString("es-MX",{day:"2-digit",month:"2-digit",year:"numeric"})}catch(Uu){return e}},bp=e=>{if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]},yp=()=>{const{id:e}=ae(),t=ne(),{userCan:n}=Je(),[a,s]=(0,r.useState)(null),[i,o]=(0,r.useState)([]),[l,c]=(0,r.useState)([]),[d,u]=(0,r.useState)(!0),[h,p]=(0,r.useState)(!0),[m,f]=(0,r.useState)(null),[g,v]=(0,r.useState)(null),[b,y]=(0,r.useState)("personal");(0,r.useEffect)((()=>{e&&(x(e),_(e))}),[e]);const x=async e=>{try{u(!0);const t=await Hh(e);s(t);const n=await(async e=>{try{const n=await Hh(e).catch((t=>{throw console.error(`Error obteniendo cliente con ID ${e}:`,t),Rh(t)}));if(!n){const t=Ph(Th.NOT_FOUND,"El cliente no existe");return Mh(t,"getClientApplications",{clientId:e}),[]}const a=`\n      SELECT * FROM ${$l.APPLICATIONS}\n      WHERE client_name = '${t=n.name||"",t?t.replace(/'/g,"''"):""}'\n      ORDER BY created_at DESC\n    `;console.log(`Ejecutando consulta para obtener aplicaciones del cliente ${e}:`,a);const r=async e=>{try{const t=await fetch("http://localhost:3100/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e})});if(!t.ok)throw new Error(`Error en la respuesta HTTP: ${t.status} ${t.statusText}`);const n=await t.json();if(n.error)throw console.error("Error en la consulta SQL:",n.error),new Error(n.error);return n.data||[]}catch(g){throw console.error("Error ejecutando la consulta:",g),g}},s=await r(a);return console.log(`Aplicaciones encontradas para el cliente ${e}:`,s.length),s}catch(g){return Mh(g,"getClientApplications",{clientId:e}),console.error(`Error completo al obtener aplicaciones para cliente ${e}:`,g),[]}var t})(e);o(n),v(null)}catch(t){console.error("Error fetching client data:",t),v("No se pudieron cargar los datos del cliente. Por favor intente nuevamente.")}finally{u(!1)}},_=async e=>{try{p(!0),console.log(`Fetching documents for client ${e}`);const t=await(async e=>{const{data:t,error:n}=await Du.from($h).select("*").eq("client_id",e).order("created_at",{ascending:!1});if(n)throw console.error(`Error fetching documents for client ${e}:`,n),n;return t})(e);console.log("Documents retrieved:",t),c(t||[]),f(null)}catch(t){console.error("Error fetching client documents:",t),f("No se pudieron cargar los documentos del cliente.")}finally{p(!1)}},w=e=>{let{label:t,value:n}=e;return(0,Le.jsxs)("div",{className:"mb-3",children:[(0,Le.jsx)("p",{className:"text-sm text-gray-500",children:t}),(0,Le.jsx)("p",{className:"font-medium",children:n||"-"})]})},j=e=>{let{id:t,label:n,isActive:a}=e;return(0,Le.jsx)("button",{onClick:()=>y(t),className:"px-4 py-2 font-medium text-sm rounded-t-lg "+(a?"bg-white text-primary border-b-2 border-primary":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:n})};return(0,Le.jsx)(_t,{children:(0,Le.jsxs)("div",{className:"p-6",children:[(0,Le.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Le.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Le.jsxs)("button",{onClick:()=>t("/clients"),className:"btn btn-sm btn-outline",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Le.jsx)("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),"Volver a Clientes"]}),a&&(0,Le.jsxs)("h1",{className:"text-2xl font-bold",children:[a.first_name," ",a.paternal_surname," ",a.maternal_surname]})]}),a&&n(Ve.EDIT_CLIENT)&&(0,Le.jsxs)(Te,{to:`/clients/${e}/edit`,className:"btn btn-primary",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Le.jsx)("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})}),"Editar Cliente"]})]}),d?(0,Le.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,Le.jsx)("span",{className:"loading loading-spinner loading-lg"})}):g?(0,Le.jsxs)("div",{className:"alert alert-error",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,Le.jsx)("span",{children:g})]}):a?(0,Le.jsxs)("div",{className:"space-y-6",children:[(0,Le.jsxs)("div",{className:"flex space-x-1 overflow-x-auto pb-1",children:[(0,Le.jsx)(j,{id:"personal",label:"Informaci\xf3n Personal",isActive:"personal"===b}),(0,Le.jsx)(j,{id:"contact",label:"Contacto y Direcci\xf3n",isActive:"contact"===b}),(0,Le.jsx)(j,{id:"employment",label:"Empleo",isActive:"employment"===b}),(0,Le.jsx)(j,{id:"financial",label:"Informaci\xf3n Financiera",isActive:"financial"===b}),(0,Le.jsx)(j,{id:"family",label:"Informaci\xf3n Familiar",isActive:"family"===b}),(0,Le.jsx)(j,{id:"banking",label:"Datos Bancarios",isActive:"banking"===b}),(0,Le.jsx)(j,{id:"references",label:"Referencias",isActive:"references"===b}),(0,Le.jsx)(j,{id:"applications",label:"Solicitudes",isActive:"applications"===b}),(0,Le.jsx)(j,{id:"documents",label:"Documentos",isActive:"documents"===b})]}),(0,Le.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:["personal"===b&&(0,Le.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[(0,Le.jsxs)("div",{children:[(0,Le.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Datos B\xe1sicos"}),(0,Le.jsx)(w,{label:"Nombre Completo",value:`${a.first_name||""} ${a.paternal_surname||""} ${a.maternal_surname||""}`}),(0,Le.jsx)(w,{label:"Nombre(s)",value:a.first_name}),(0,Le.jsx)(w,{label:"Apellido Paterno",value:a.paternal_surname}),(0,Le.jsx)(w,{label:"Apellido Materno",value:a.maternal_surname}),(0,Le.jsx)(w,{label:"Fecha de Nacimiento",value:vp(a.birth_date)}),(0,Le.jsx)(w,{label:"Estado de Nacimiento",value:a.birth_state}),(0,Le.jsx)(w,{label:"Nacionalidad",value:a.nationality})]}),(0,Le.jsxs)("div",{children:[(0,Le.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Identificaci\xf3n"}),(0,Le.jsx)(w,{label:"RFC",value:a.rfc}),(0,Le.jsx)(w,{label:"CURP",value:a.curp}),(0,Le.jsx)(w,{label:"G\xe9nero",value:gp(lp,a.gender)}),(0,Le.jsx)(w,{label:"Estado Civil",value:gp(cp,a.marital_status)}),(0,Le.jsx)(w,{label:"Personas Dependientes",value:a.dependent_persons})]}),(0,Le.jsxs)("div",{children:[(0,Le.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Informaci\xf3n del Sistema"}),(0,Le.jsx)(w,{label:"ID del Cliente",value:a.id}),(0,Le.jsx)(w,{label:"Fecha de Registro",value:vp(a.created_at)}),(0,Le.jsx)(w,{label:"\xdaltimo Acceso",value:vp(a.last_login)}),(0,Le.jsx)(w,{label:"ID de Empresa",value:a.company_id}),(0,Le.jsx)(w,{label:"ID de Asesor",value:a.advisor_id})]})]}),"contact"===b&&(0,Le.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Le.jsxs)("div",{children:[(0,Le.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Contacto"}),(0,Le.jsx)(w,{label:"Email",value:a.email}),(0,Le.jsx)(w,{label:"Tel\xe9fono M\xf3vil",value:a.phone}),(0,Le.jsx)(w,{label:"Tel\xe9fono Fijo",value:a.home_phone})]}),(0,Le.jsxs)("div",{children:[(0,Le.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Direcci\xf3n"}),(0,Le.jsx)(w,{label:"Direcci\xf3n",value:a.address}),(0,Le.jsx)(w,{label:"N\xfamero Exterior",value:a.street_number_ext}),(0,Le.jsx)(w,{label:"N\xfamero Interior",value:a.street_number_int}),(0,Le.jsx)(w,{label:"Colonia",value:a.neighborhood}),(0,Le.jsx)(w,{label:"Ciudad",value:a.city}),(0,Le.jsx)(w,{label:"Estado",value:a.state}),(0,Le.jsx)(w,{label:"C\xf3digo Postal",value:a.postal_code})]})]}),"employment"===b&&(0,Le.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Le.jsxs)("div",{children:[(0,Le.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Datos Laborales"}),(0,Le.jsx)(w,{label:"Tipo de Empleo",value:gp(dp,a.employment_type)}),(0,Le.jsx)(w,{label:"A\xf1os de Empleo",value:a.employment_years}),(0,Le.jsx)(w,{label:"Puesto/Cargo",value:a.job_position})]}),(0,Le.jsxs)("div",{children:[(0,Le.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Informaci\xf3n del Empleador"}),(0,Le.jsx)(w,{label:"Nombre del Empleador",value:a.employer_name}),(0,Le.jsx)(w,{label:"Tel\xe9fono del Empleador",value:a.employer_phone}),(0,Le.jsx)(w,{label:"Direcci\xf3n del Empleador",value:a.employer_address}),(0,Le.jsx)(w,{label:"Actividad del Empleador",value:a.employer_activity})]})]}),"financial"===b&&(0,Le.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,Le.jsxs)("div",{children:[(0,Le.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Ingresos"}),(0,Le.jsx)(w,{label:"Ingreso Mensual",value:a.monthly_income?gt(a.monthly_income):"-"}),(0,Le.jsx)(w,{label:"Ingreso Adicional",value:a.additional_income?gt(a.additional_income):"-"}),(0,Le.jsx)(w,{label:"Frecuencia de Ingresos",value:gp(up,a.income_frequency)})]}),(0,Le.jsxs)("div",{children:[(0,Le.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Gastos"}),(0,Le.jsx)(w,{label:"Gastos Mensuales",value:a.monthly_expenses?gt(a.monthly_expenses):"-"}),(0,Le.jsx)(w,{label:"Pago de Hipoteca",value:a.mortgage_payment?gt(a.mortgage_payment):"-"}),(0,Le.jsx)(w,{label:"Pago de Renta",value:a.rent_payment?gt(a.rent_payment):"-"}),(0,Le.jsx)(w,{label:"Saldo de Otros Pr\xe9stamos",value:a.other_loan_balances?gt(a.other_loan_balances):"-"})]}),(0,Le.jsxs)("div",{children:[(0,Le.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Preferencias Financieras"}),(0,Le.jsx)(w,{label:"M\xe9todo de Pago Preferido",value:gp(hp,a.payment_method)}),(0,Le.jsx)(w,{label:"Prop\xf3sito de Cr\xe9dito",value:gp(pp,a.credit_purpose)})]})]}),"family"===b&&(0,Le.jsxs)("div",{children:[(0,Le.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Informaci\xf3n del C\xf3nyuge"}),(0,Le.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Le.jsx)(w,{label:"Apellido Paterno del C\xf3nyuge",value:a.spouse_paternal_surname}),(0,Le.jsx)(w,{label:"Apellido Materno del C\xf3nyuge",value:a.spouse_maternal_surname})]})]}),"banking"===b&&(0,Le.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:(0,Le.jsxs)("div",{children:[(0,Le.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Datos Bancarios"}),(0,Le.jsx)(w,{label:"Nombre del Banco",value:a.bank_name}),(0,Le.jsx)(w,{label:"CLABE Interbancaria",value:a.bank_clabe}),(0,Le.jsx)(w,{label:"N\xfamero de Cuenta",value:a.bank_account_number}),(0,Le.jsx)(w,{label:"Tipo de Cuenta",value:gp(mp,a.bank_account_type)}),(0,Le.jsx)(w,{label:"Origen de la Cuenta",value:a.bank_account_origin})]})}),"references"===b&&(0,Le.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Le.jsxs)("div",{children:[(0,Le.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Primera Referencia"}),(0,Le.jsx)(w,{label:"Nombre",value:a.reference1_name}),(0,Le.jsx)(w,{label:"Relaci\xf3n",value:gp(fp,a.reference1_relationship)}),(0,Le.jsx)(w,{label:"Direcci\xf3n",value:a.reference1_address}),(0,Le.jsx)(w,{label:"Tel\xe9fono",value:a.reference1_phone})]}),(0,Le.jsxs)("div",{children:[(0,Le.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Segunda Referencia"}),(0,Le.jsx)(w,{label:"Nombre",value:a.reference2_name}),(0,Le.jsx)(w,{label:"Relaci\xf3n",value:gp(fp,a.reference2_relationship)}),(0,Le.jsx)(w,{label:"Direcci\xf3n",value:a.reference2_address}),(0,Le.jsx)(w,{label:"Tel\xe9fono",value:a.reference2_phone})]})]}),"applications"===b&&(0,Le.jsxs)(Le.Fragment,{children:[(0,Le.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Le.jsx)("h3",{className:"text-lg font-semibold",children:"Solicitudes del Cliente"}),n(Ve.CREATE_APPLICATION)&&(0,Le.jsxs)(Te,{to:`/applications/new?client=${e}`,className:"btn btn-sm btn-primary",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Le.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})}),"Nueva Solicitud"]})]}),i&&0!==i.length?(0,Le.jsx)("div",{className:"overflow-x-auto",children:(0,Le.jsxs)("table",{className:"table w-full",children:[(0,Le.jsx)("thead",{children:(0,Le.jsxs)("tr",{children:[(0,Le.jsx)("th",{children:"ID"}),(0,Le.jsx)("th",{children:"Fecha"}),(0,Le.jsx)("th",{children:"Tipo"}),(0,Le.jsx)("th",{children:"Monto"}),(0,Le.jsx)("th",{children:"Estado"}),(0,Le.jsx)("th",{children:"Acciones"})]})}),(0,Le.jsx)("tbody",{children:i.map((e=>(0,Le.jsxs)("tr",{className:"hover",children:[(0,Le.jsxs)("td",{children:[e.id.substring(0,8),"..."]}),(0,Le.jsx)("td",{children:vp(e.created_at)}),(0,Le.jsx)("td",{children:e.application_type}),(0,Le.jsx)("td",{children:e.amount?gt(e.amount):"-"}),(0,Le.jsx)("td",{children:(0,Le.jsx)("span",{className:"badge "+("approved"===e.status?"badge-success":"rejected"===e.status?"badge-error":"in_review"===e.status?"badge-warning":"badge-info"),children:e.status})}),(0,Le.jsx)("td",{children:(0,Le.jsx)(Te,{to:`/applications/${e.id}`,className:"btn btn-xs btn-info",children:"Ver"})})]},e.id)))})]})}):(0,Le.jsxs)("div",{className:"flex flex-col items-center justify-center py-10 text-center",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 text-gray-300 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,Le.jsx)("p",{className:"text-gray-500 mb-4",children:"Este cliente no tiene solicitudes registradas."}),n(Ve.CREATE_APPLICATION)&&(0,Le.jsxs)(Te,{to:`/applications/new?client=${e}`,className:"btn btn-primary",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Le.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})}),"Crear Solicitud"]})]})]}),"documents"===b&&(0,Le.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Le.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Le.jsx)("h3",{className:"text-lg font-semibold",children:"Documentos del Cliente"}),n(Ve.EDIT_CLIENT)&&(0,Le.jsx)(Te,{to:`/clients/edit/${e}`,className:"btn btn-sm btn-primary",children:"Gestionar Documentos"})]}),h?(0,Le.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,Le.jsx)("span",{className:"loading loading-spinner loading-md"})}):m?(0,Le.jsxs)("div",{className:"alert alert-error",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,Le.jsx)("span",{children:m})]}):0===l.length?(0,Le.jsx)("div",{className:"text-center py-8",children:(0,Le.jsx)("p",{className:"text-gray-500",children:"No hay documentos asociados a este cliente."})}):(0,Le.jsx)("div",{className:"overflow-x-auto",children:(0,Le.jsxs)("table",{className:"table w-full",children:[(0,Le.jsx)("thead",{children:(0,Le.jsxs)("tr",{children:[(0,Le.jsx)("th",{children:"Nombre"}),(0,Le.jsx)("th",{children:"Categor\xeda"}),(0,Le.jsx)("th",{children:"Fecha de subida"}),(0,Le.jsx)("th",{children:"Tama\xf1o"}),(0,Le.jsx)("th",{children:"Acciones"})]})}),(0,Le.jsx)("tbody",{children:l.map((e=>(0,Le.jsxs)("tr",{children:[(0,Le.jsxs)("td",{className:"flex items-center gap-2",children:[(0,Le.jsx)(rp,{className:"text-primary"}),e.file_name||"Documento sin nombre"]}),(0,Le.jsx)("td",{children:e.category||"No especificada"}),(0,Le.jsx)("td",{children:vp(e.created_at)}),(0,Le.jsx)("td",{children:bp(e.file_size||0)}),(0,Le.jsx)("td",{children:(0,Le.jsx)("a",{href:"#",onClick:async t=>{t.preventDefault();const n=await(async e=>{try{const{data:t}=await Du.storage.from("documents").getPublicUrl(e);return t.publicUrl}catch(g){return console.error("Error getting document URL:",g),"#"}})(e.file_path);window.open(n,"_blank")},className:"btn btn-sm btn-ghost",title:"Descargar documento",children:(0,Le.jsx)(ap,{})})})]},e.id)))})]})})]})]})]}):(0,Le.jsxs)("div",{className:"alert alert-warning",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,Le.jsx)("span",{children:"Cliente no encontrado."})]})]})})},xp=e=>{let{categories:t,onDocumentAdded:n,onDocumentRemoved:a,existingDocuments:s,clientId:i}=e;const[o,l]=(0,r.useState)(""),[c,d]=(0,r.useState)(""),[u,h]=(0,r.useState)(null),[p,m]=(0,r.useState)(!1),[f,g]=(0,r.useState)(null),[v,b]=(0,r.useState)(!1),y=(0,r.useRef)(null);(0,r.useEffect)((()=>(console.log("DocumentUploader montado con clientId:",i),console.log("Documentos existentes:",s),()=>{u&&h(null)})),[i,s]);const x=e=>{const n=t.find((t=>t.value===e));return n?n.label:e},_=e=>{if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]},w=e=>{try{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?m(!0):"dragleave"===e.type&&m(!1)}catch(t){console.error("Error en evento de arrastre:",t),m(!1),g("Hubo un problema al procesar el evento de arrastre")}};return(0,Le.jsxs)("div",{className:"space-y-6",children:[(0,Le.jsx)("div",{className:"card bg-base-100 border border-gray-200",children:(0,Le.jsxs)("div",{className:"card-body",children:[(0,Le.jsx)("h3",{className:"card-title text-base mb-4",children:"Agregar Documento"}),(0,Le.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Le.jsxs)("div",{className:"form-control w-full",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Categor\xeda"})}),(0,Le.jsxs)("select",{value:o,onChange:e=>l(e.target.value),className:"select select-bordered w-full "+(f&&!o?"select-error":""),children:[(0,Le.jsx)("option",{value:"",children:"Seleccionar categor\xeda"}),t.map((e=>(0,Le.jsx)("option",{value:e.value,children:e.label},e.value)))]})]}),(0,Le.jsxs)("div",{className:"form-control w-full",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Nombre del Documento"})}),(0,Le.jsx)("input",{type:"text",value:c,onChange:e=>d(e.target.value),className:"input input-bordered w-full "+(f&&!c?"input-error":""),placeholder:"Ingresa un nombre descriptivo"})]})]}),(0,Le.jsxs)("div",{className:"mt-4 border-2 border-dashed rounded-lg p-6 text-center cursor-pointer transition-colors "+(p?"border-primary bg-primary/10":u?"border-success bg-success/10":"border-gray-300 hover:border-primary hover:bg-primary/5"),onClick:()=>{y.current&&y.current.click()},onDragEnter:w,onDragLeave:w,onDragOver:w,onDrop:e=>{try{if(e.preventDefault(),e.stopPropagation(),m(!1),e.dataTransfer.files&&e.dataTransfer.files[0]){if(h(e.dataTransfer.files[0]),!c){const t=e.dataTransfer.files[0].name.split(".")[0];d(t)}g(null)}}catch(t){console.error("Error al soltar el archivo:",t),g("Hubo un problema al procesar el archivo soltado")}},children:[(0,Le.jsx)("input",{ref:y,type:"file",className:"hidden",onChange:e=>{try{if(e.target&&e.target.files&&e.target.files.length>0){const n=e.target.files[0];if(!n)return void g("El archivo seleccionado no es v\xe1lido");if(n.size>10485760)return void g("El archivo es demasiado grande. El tama\xf1o m\xe1ximo es 10MB");if(h(n),!c)try{const e=n.name.split(".")[0];d(e)}catch(t){console.error("Error extracting filename:",t),d(`Documento-${(new Date).toISOString().substring(0,10)}`)}g(null)}}catch(t){console.error("Error al seleccionar el archivo:",t),g("Hubo un problema al procesar el archivo seleccionado")}},accept:"*/*"}),u?(0,Le.jsxs)("div",{className:"flex flex-col items-center",children:[(0,Le.jsx)(np,{className:"w-10 h-10 text-success mb-2"}),(0,Le.jsx)("p",{className:"font-semibold",children:u.name}),(0,Le.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:_(u.size)})]}):(0,Le.jsxs)("div",{className:"flex flex-col items-center",children:[(0,Le.jsx)(ip,{className:"w-10 h-10 text-gray-400 mb-2"}),(0,Le.jsx)("p",{className:"font-semibold",children:"Arrastra archivos aqu\xed o haz clic para seleccionar"}),(0,Le.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Se acepta cualquier formato de archivo"})]})]}),f&&(0,Le.jsxs)("div",{className:"alert alert-error mt-4",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,Le.jsx)("span",{children:f})]}),!i&&(0,Le.jsxs)("div",{className:"alert alert-info mt-4",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,Le.jsx)("span",{children:"Los documentos se guardar\xe1n temporalmente y se asociar\xe1n al cliente cuando complete el registro."})]}),(0,Le.jsx)("div",{className:"card-actions justify-end mt-4",children:(0,Le.jsxs)("button",{type:"button",className:"btn btn-primary",onClick:()=>{if(!v)try{if(b(!0),!o)return g("Selecciona una categor\xeda para el documento"),void b(!1);if(!c||!c.trim())return g("Ingresa un nombre para el documento"),void b(!1);if(!u)return g("Selecciona un archivo para subir"),void b(!1);i||console.log("Advertencia: clientId no est\xe1 definido, el documento se guardar\xe1 pero solo se asociar\xe1 al guardar el cliente");const e={file:u,category:o,name:c.trim()};n(e),setTimeout((()=>{l(""),d(""),h(null),g(null),y.current&&(y.current.value=""),b(!1)}),100)}catch(e){console.error("Error al procesar el documento:",e),g("Hubo un problema al agregar el documento. Por favor, intente de nuevo."),b(!1)}},disabled:!u||!o||!c,children:[(0,Le.jsx)(sp,{className:"mr-2"}),"Agregar Documento"]})})]})}),s.length>0&&(0,Le.jsx)("div",{className:"card bg-base-100 border border-gray-200",children:(0,Le.jsxs)("div",{className:"card-body",children:[(0,Le.jsxs)("h3",{className:"card-title text-base mb-4",children:["Documentos (",s.length,")"]}),(0,Le.jsx)("div",{className:"overflow-x-auto",children:(0,Le.jsxs)("table",{className:"table w-full",children:[(0,Le.jsx)("thead",{children:(0,Le.jsxs)("tr",{children:[(0,Le.jsx)("th",{children:"Nombre"}),(0,Le.jsx)("th",{children:"Categor\xeda"}),(0,Le.jsx)("th",{children:"Tama\xf1o"}),(0,Le.jsx)("th",{children:"Acciones"})]})}),(0,Le.jsx)("tbody",{children:s.map(((e,t)=>(0,Le.jsxs)("tr",{children:[(0,Le.jsxs)("td",{className:"flex items-center",children:[(0,Le.jsx)(rp,{className:"mr-2"}),e.name]}),(0,Le.jsx)("td",{children:x(e.category)}),(0,Le.jsx)("td",{children:_(e.file.size)}),(0,Le.jsx)("td",{children:(0,Le.jsx)("button",{type:"button",className:"btn btn-error btn-sm",onClick:()=>a(t),children:(0,Le.jsx)(op,{})})})]},t)))})]})})]})})]})},_p="http://localhost:3100",wp=[{value:"identificacion",label:"Identificaci\xf3n Oficial"},{value:"comprobante_domicilio",label:"Comprobante de Domicilio"},{value:"comprobante_ingresos",label:"Comprobante de Ingresos"},{value:"estados_cuenta",label:"Estados de Cuenta Bancarios"},{value:"rfc",label:"Constancia de Situaci\xf3n Fiscal (RFC)"},{value:"curp",label:"CURP"},{value:"otros",label:"Otros Documentos"}],jp=[{value:"empleado",label:"Empleado"},{value:"autonomo",label:"Aut\xf3nomo / Freelance"},{value:"empresario",label:"Empresario"},{value:"jubilado",label:"Jubilado"},{value:"desempleado",label:"Desempleado"},{value:"estudiante",label:"Estudiante"},{value:"otro",label:"Otro"}],Np=[{value:"soltero",label:"Soltero/a"},{value:"casado",label:"Casado/a"},{value:"divorciado",label:"Divorciado/a"},{value:"viudo",label:"Viudo/a"},{value:"union_libre",label:"Uni\xf3n Libre"}],Ep=[{value:"nomina",label:"N\xf3mina"},{value:"ahorro",label:"Ahorro"},{value:"cheques",label:"Cheques"},{value:"inversiones",label:"Inversiones"}],Sp=[{value:"semanal",label:"Semanal"},{value:"quincenal",label:"Quincenal"},{value:"mensual",label:"Mensual"},{value:"bimestral",label:"Bimestral"},{value:"trimestral",label:"Trimestral"},{value:"semestral",label:"Semestral"},{value:"anual",label:"Anual"},{value:"irregular",label:"Irregular"}],kp=[{value:"efectivo",label:"Efectivo"},{value:"transferencia",label:"Transferencia"},{value:"tarjeta",label:"Tarjeta de Cr\xe9dito/D\xe9bito"},{value:"cheque",label:"Cheque"},{value:"domiciliacion",label:"Domiciliaci\xf3n Bancaria"}],Cp=[{value:"personal",label:"Gastos Personales"},{value:"negocio",label:"Negocio/Inversi\xf3n"},{value:"vivienda",label:"Vivienda"},{value:"auto",label:"Autom\xf3vil"},{value:"educacion",label:"Educaci\xf3n"},{value:"salud",label:"Salud"},{value:"deudas",label:"Consolidaci\xf3n de Deudas"},{value:"otro",label:"Otro"}],Ap=[{value:"familiar",label:"Familiar"},{value:"amigo",label:"Amigo"},{value:"companero_trabajo",label:"Compa\xf1ero de Trabajo"},{value:"vecino",label:"Vecino"},{value:"otro",label:"Otro"}],Tp=e=>{let{initialData:t={},onSubmit:n,onSavePartial:a,isSubmitting:s}=e;const i=ne(),{user:o}=Ue(),[l,c]=(0,r.useState)({first_name:"",paternal_surname:"",maternal_surname:"",email:"",phone:"",address:"",city:"",state:"",postal_code:"",birth_date:"",gender:"",marital_status:"",employment_type:"",employment_years:void 0,rfc:"",curp:"",monthly_income:void 0,additional_income:void 0,monthly_expenses:void 0,other_loan_balances:void 0,bank_name:"",bank_clabe:"",bank_account_number:"",bank_account_type:"",bank_account_origin:"",company_id:"",street_number_ext:"",street_number_int:"",neighborhood:"",home_phone:"",birth_state:"",nationality:"",job_position:"",employer_name:"",employer_phone:"",employer_address:"",employer_activity:"",mortgage_payment:void 0,rent_payment:void 0,dependent_persons:void 0,income_frequency:"",payment_method:"",credit_purpose:"",spouse_paternal_surname:"",spouse_maternal_surname:"",reference1_name:"",reference1_relationship:"",reference1_address:"",reference1_phone:"",reference2_name:"",reference2_relationship:"",reference2_address:"",reference2_phone:"",...t}),[d,u]=(0,r.useState)({}),[h,p]=(0,r.useState)([]),[m,f]=(0,r.useState)(1),[g,v]=(0,r.useState)([]),[b,y]=(0,r.useState)(!0),[x,_]=(0,r.useState)(!1),[w,j]=(0,r.useState)(!1),N=(0,r.useMemo)((()=>(()=>{let e=0,t=0;const n=["first_name","paternal_surname","maternal_surname","email","phone","rfc","curp","birth_date","gender","marital_status","address","city","state","postal_code","company_id","street_number_ext","street_number_int","neighborhood","home_phone","birth_state","nationality","spouse_paternal_surname","spouse_maternal_surname","dependent_persons"];t+=n.length,e+=n.filter((e=>l[e])).length;const a=["employment_type","employment_years","job_position","employer_name","employer_phone","employer_address","employer_activity","monthly_income","additional_income","monthly_expenses","other_loan_balances","mortgage_payment","rent_payment","income_frequency","payment_method","credit_purpose"];t+=a.length,e+=a.filter((e=>void 0!==l[e]&&""!==l[e])).length;const r=["bank_name","bank_clabe","bank_account_number","bank_account_type","bank_account_origin","reference1_name","reference1_relationship","reference1_address","reference1_phone","reference2_name","reference2_relationship","reference2_address","reference2_phone"];return t+=r.length,e+=r.filter((e=>l[e])).length,Math.round(e/t*100)})()),[l.first_name,l.paternal_surname,l.maternal_surname]),E=e=>{const{name:t,value:n,type:a}=e.target;c((e=>({...e,[t]:"number"===a?""===n?void 0:parseFloat(n):n})))},S=e=>{p((t=>[...t,e]))},k=e=>{p((t=>t.filter(((t,n)=>n!==e))))},C=e=>{const{value:t}=e.target;c((e=>({...e,company_id:t})))};(0,r.useEffect)((()=>{(async()=>{try{y(!0);const e=await(async e=>{try{console.log("\ud83d\udd0d MCP Service: Ejecutando consulta:",e);const t=await fetch(`${_p}/query`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e})}),n=await t.json();if(console.log("\ud83d\udd0d MCP Service: Respuesta completa:",n),!t.ok)throw console.error("\ud83d\udd0d MCP Service: Error en la respuesta:",n),new Error(n.error||"Error executing query");return n.data?{data:n.data}:(Array.isArray(n)||console.log("\ud83d\udd0d MCP Service: Estructura de datos at\xedpica:",n),{data:n})}catch(t){return console.error("\ud83d\udd0d MCP Service: Error:",t),{error:t.message||"Error connecting to MCP server"}}})("SELECT id, name FROM companies ORDER BY name ASC");e&&e.data&&v(e.data)}catch(e){console.error("Error fetching companies:",e)}finally{y(!1)}})()}),[]);return(0,Le.jsx)("div",{className:"p-4",children:(0,Le.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{await n(l,h)}catch(t){console.error("Error submitting form:",t)}},children:[(0,Le.jsxs)("div",{className:"mb-6",children:[(0,Le.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,Le.jsx)("h2",{className:"text-xl font-bold",children:null!==t&&void 0!==t&&t.id?"Editar Cliente":"Nuevo Cliente"}),(0,Le.jsxs)("div",{className:"text-sm",children:["Paso ",m," de 4"]})]}),(0,Le.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5 mb-4",children:(0,Le.jsx)("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:`${N}%`}})})]}),(()=>{switch(m){case 1:return(0,Le.jsxs)("div",{className:"space-y-4",children:[(0,Le.jsx)("h3",{className:"text-lg font-bold",children:"Datos Personales"}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsxs)("span",{className:"label-text",children:["Empresa ",(0,Le.jsx)("span",{className:"text-error",children:"*"})]})}),(0,Le.jsxs)("select",{name:"company_id",value:l.company_id||"",onChange:C,className:"select select-bordered w-full "+(d.company_id?"select-error":""),disabled:b,children:[(0,Le.jsx)("option",{value:"",children:"Seleccionar empresa"}),g.map((e=>(0,Le.jsx)("option",{value:e.id,children:e.name},e.id)))]}),d.company_id&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.company_id}),b&&(0,Le.jsx)("span",{className:"text-sm mt-1",children:"Cargando empresas..."})]}),(0,Le.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsxs)("span",{className:"label-text",children:["Nombre(s) ",(0,Le.jsx)("span",{className:"text-error",children:"*"})]})}),(0,Le.jsx)("input",{type:"text",name:"first_name",className:"input input-bordered w-full "+(d.first_name?"input-error":""),value:l.first_name||"",onChange:E,placeholder:"Nombre(s)"}),d.first_name&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.first_name})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsxs)("span",{className:"label-text",children:["Apellido Paterno ",(0,Le.jsx)("span",{className:"text-error",children:"*"})]})}),(0,Le.jsx)("input",{type:"text",name:"paternal_surname",className:"input input-bordered w-full "+(d.paternal_surname?"input-error":""),value:l.paternal_surname||"",onChange:E,placeholder:"Apellido paterno"}),d.paternal_surname&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.paternal_surname})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Apellido Materno"})}),(0,Le.jsx)("input",{type:"text",name:"maternal_surname",className:"input input-bordered w-full "+(d.maternal_surname?"input-error":""),value:l.maternal_surname||"",onChange:E,placeholder:"Apellido materno"}),d.maternal_surname&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.maternal_surname})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsxs)("span",{className:"label-text",children:["Email ",(0,Le.jsx)("span",{className:"text-error",children:"*"})]})}),(0,Le.jsx)("input",{type:"email",name:"email",className:"input input-bordered w-full "+(d.email?"input-error":""),value:l.email||"",onChange:E,placeholder:"email@ejemplo.com"}),d.email&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.email})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsxs)("span",{className:"label-text",children:["Tel\xe9fono M\xf3vil ",(0,Le.jsx)("span",{className:"text-error",children:"*"})]})}),(0,Le.jsx)("input",{type:"tel",name:"phone",className:"input input-bordered w-full "+(d.phone?"input-error":""),value:l.phone||"",onChange:E,placeholder:"55 1234 5678"}),d.phone&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.phone})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Tel\xe9fono Fijo"})}),(0,Le.jsx)("input",{type:"tel",name:"home_phone",className:"input input-bordered w-full "+(d.home_phone?"input-error":""),value:l.home_phone||"",onChange:E,placeholder:"55 1234 5678"}),d.home_phone&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.home_phone})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"RFC"})}),(0,Le.jsx)("input",{type:"text",name:"rfc",className:"input input-bordered w-full "+(d.rfc?"input-error":""),value:l.rfc||"",onChange:E,placeholder:"XXXX000000XXX"}),d.rfc&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.rfc})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"CURP"})}),(0,Le.jsx)("input",{type:"text",name:"curp",className:"input input-bordered w-full "+(d.curp?"input-error":""),value:l.curp||"",onChange:E,placeholder:"XXXX000000XXXXXX00"}),d.curp&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.curp})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Fecha de Nacimiento"})}),(0,Le.jsx)("input",{type:"date",name:"birth_date",className:"input input-bordered w-full "+(d.birth_date?"input-error":""),value:l.birth_date||"",onChange:E}),d.birth_date&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.birth_date})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"G\xe9nero"})}),(0,Le.jsxs)("select",{name:"gender",className:"select select-bordered w-full "+(d.gender?"select-error":""),value:l.gender||"",onChange:E,children:[(0,Le.jsx)("option",{value:"",children:"Seleccionar"}),(0,Le.jsx)("option",{value:"masculino",children:"Masculino"}),(0,Le.jsx)("option",{value:"femenino",children:"Femenino"}),(0,Le.jsx)("option",{value:"otro",children:"Otro"}),(0,Le.jsx)("option",{value:"no_especificado",children:"Prefiero no especificar"})]}),d.gender&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.gender})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Estado Civil"})}),(0,Le.jsxs)("select",{name:"marital_status",className:"select select-bordered w-full "+(d.marital_status?"select-error":""),value:l.marital_status||"",onChange:E,children:[(0,Le.jsx)("option",{value:"",children:"Seleccionar"}),Np.map((e=>(0,Le.jsx)("option",{value:e.value,children:e.label},e.value)))]}),d.marital_status&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.marital_status})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Personas Dependientes"})}),(0,Le.jsx)("input",{type:"number",name:"dependent_persons",className:"input input-bordered w-full "+(d.dependent_persons?"input-error":""),value:void 0===l.dependent_persons?"":l.dependent_persons,onChange:E,min:"0",placeholder:"0"}),d.dependent_persons&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.dependent_persons})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Estado de Nacimiento"})}),(0,Le.jsx)("input",{type:"text",name:"birth_state",className:"input input-bordered w-full "+(d.birth_state?"input-error":""),value:l.birth_state||"",onChange:E,placeholder:"Estado de nacimiento"}),d.birth_state&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.birth_state})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Nacionalidad"})}),(0,Le.jsx)("input",{type:"text",name:"nationality",className:"input input-bordered w-full "+(d.nationality?"input-error":""),value:l.nationality||"",onChange:E,placeholder:"Mexicana"}),d.nationality&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.nationality})]})]}),"casado"===l.marital_status&&(0,Le.jsxs)("div",{className:"mt-4",children:[(0,Le.jsx)("h4",{className:"text-md font-semibold mb-2",children:"Informaci\xf3n del C\xf3nyuge"}),(0,Le.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Apellido Paterno del C\xf3nyuge"})}),(0,Le.jsx)("input",{type:"text",name:"spouse_paternal_surname",className:"input input-bordered w-full",value:l.spouse_paternal_surname||"",onChange:E,placeholder:"Apellido paterno del c\xf3nyuge"})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Apellido Materno del C\xf3nyuge"})}),(0,Le.jsx)("input",{type:"text",name:"spouse_maternal_surname",className:"input input-bordered w-full",value:l.spouse_maternal_surname||"",onChange:E,placeholder:"Apellido materno del c\xf3nyuge"})]})]})]}),(0,Le.jsxs)("div",{className:"mt-4",children:[(0,Le.jsx)("h4",{className:"text-md font-semibold mb-2",children:"Direcci\xf3n"}),(0,Le.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Calle y N\xfamero"})}),(0,Le.jsx)("input",{type:"text",name:"address",className:"input input-bordered w-full "+(d.address?"input-error":""),value:l.address||"",onChange:E,placeholder:"Calle y n\xfamero"}),d.address&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.address})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"N\xfamero Exterior"})}),(0,Le.jsx)("input",{type:"text",name:"street_number_ext",className:"input input-bordered w-full",value:l.street_number_ext||"",onChange:E,placeholder:"123"})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"N\xfamero Interior"})}),(0,Le.jsx)("input",{type:"text",name:"street_number_int",className:"input input-bordered w-full",value:l.street_number_int||"",onChange:E,placeholder:"A"})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Colonia"})}),(0,Le.jsx)("input",{type:"text",name:"neighborhood",className:"input input-bordered w-full",value:l.neighborhood||"",onChange:E,placeholder:"Colonia o fraccionamiento"})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Ciudad"})}),(0,Le.jsx)("input",{type:"text",name:"city",className:"input input-bordered w-full "+(d.city?"input-error":""),value:l.city||"",onChange:E,placeholder:"Ciudad"}),d.city&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.city})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Estado"})}),(0,Le.jsx)("input",{type:"text",name:"state",className:"input input-bordered w-full "+(d.state?"input-error":""),value:l.state||"",onChange:E,placeholder:"Estado"}),d.state&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.state})]}),(0,Le.jsxs)("div",{className:"form-control",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"C\xf3digo Postal"})}),(0,Le.jsx)("input",{type:"text",name:"postal_code",className:"input input-bordered w-full "+(d.postal_code?"input-error":""),value:l.postal_code||"",onChange:E,placeholder:"00000"}),d.postal_code&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.postal_code})]})]})]})]});case 2:return(0,Le.jsxs)("div",{className:"space-y-6",children:[(0,Le.jsx)("h3",{className:"text-lg font-semibold",children:"Informaci\xf3n Laboral"}),(0,Le.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Le.jsxs)("div",{className:"form-control w-full",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Tipo de Empleo"})}),(0,Le.jsxs)("select",{name:"employment_type",value:l.employment_type||"",onChange:E,className:"select select-bordered w-full "+(d.employment_type?"select-error":""),children:[(0,Le.jsx)("option",{value:"",children:"Seleccionar"}),jp.map((e=>(0,Le.jsx)("option",{value:e.value,children:e.label},e.value)))]}),d.employment_type&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.employment_type})]}),(0,Le.jsxs)("div",{className:"form-control w-full",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"A\xf1os en Empleo Actual"})}),(0,Le.jsx)("input",{type:"number",name:"employment_years",value:void 0===l.employment_years?"":l.employment_years,onChange:E,className:"input input-bordered w-full "+(d.employment_years?"input-error":""),placeholder:"0",min:"0",step:"1"}),d.employment_years&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.employment_years})]}),(0,Le.jsxs)("div",{className:"form-control w-full",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Puesto/Cargo"})}),(0,Le.jsx)("input",{type:"text",name:"job_position",value:l.job_position||"",onChange:E,className:"input input-bordered w-full "+(d.job_position?"input-error":""),placeholder:"Puesto o cargo"}),d.job_position&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.job_position})]}),(0,Le.jsxs)("div",{className:"form-control w-full",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Nombre del Empleador"})}),(0,Le.jsx)("input",{type:"text",name:"employer_name",value:l.employer_name||"",onChange:E,className:"input input-bordered w-full "+(d.employer_name?"input-error":""),placeholder:"Nombre de la empresa"}),d.employer_name&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.employer_name})]}),(0,Le.jsxs)("div",{className:"form-control w-full",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Tel\xe9fono del Empleador"})}),(0,Le.jsx)("input",{type:"tel",name:"employer_phone",value:l.employer_phone||"",onChange:E,className:"input input-bordered w-full "+(d.employer_phone?"input-error":""),placeholder:"55 1234 5678"}),d.employer_phone&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.employer_phone})]}),(0,Le.jsxs)("div",{className:"form-control w-full",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Direcci\xf3n del Empleador"})}),(0,Le.jsx)("input",{type:"text",name:"employer_address",value:l.employer_address||"",onChange:E,className:"input input-bordered w-full "+(d.employer_address?"input-error":""),placeholder:"Direcci\xf3n de la empresa"}),d.employer_address&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.employer_address})]}),(0,Le.jsxs)("div",{className:"form-control w-full",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Giro o Actividad"})}),(0,Le.jsx)("input",{type:"text",name:"employer_activity",value:l.employer_activity||"",onChange:E,className:"input input-bordered w-full "+(d.employer_activity?"input-error":""),placeholder:"Giro o actividad"}),d.employer_activity&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.employer_activity})]})]}),(0,Le.jsx)("h3",{className:"text-lg font-semibold mt-6",children:"Informaci\xf3n Financiera"}),(0,Le.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Le.jsxs)("div",{className:"form-control w-full",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Ingreso Mensual"})}),(0,Le.jsxs)("div",{className:"relative",children:[(0,Le.jsx)("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:"$"}),(0,Le.jsx)("input",{type:"number",name:"monthly_income",value:void 0===l.monthly_income?"":l.monthly_income,onChange:E,className:"input input-bordered w-full pl-7 "+(d.monthly_income?"input-error":""),placeholder:"0.00",min:"0",step:"0.01"})]}),d.monthly_income&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.monthly_income})]}),(0,Le.jsxs)("div",{className:"form-control w-full",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Ingresos Adicionales"})}),(0,Le.jsxs)("div",{className:"relative",children:[(0,Le.jsx)("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:"$"}),(0,Le.jsx)("input",{type:"number",name:"additional_income",value:void 0===l.additional_income?"":l.additional_income,onChange:E,className:"input input-bordered w-full pl-7 "+(d.additional_income?"input-error":""),placeholder:"0.00",min:"0",step:"0.01"})]}),d.additional_income&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.additional_income})]}),(0,Le.jsxs)("div",{className:"form-control w-full",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Frecuencia de Ingresos"})}),(0,Le.jsxs)("select",{name:"income_frequency",value:l.income_frequency||"",onChange:E,className:"select select-bordered w-full "+(d.income_frequency?"select-error":""),children:[(0,Le.jsx)("option",{value:"",children:"Seleccionar"}),Sp.map((e=>(0,Le.jsx)("option",{value:e.value,children:e.label},e.value)))]}),d.income_frequency&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.income_frequency})]}),(0,Le.jsxs)("div",{className:"form-control w-full",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"M\xe9todo de Pago Preferido"})}),(0,Le.jsxs)("select",{name:"payment_method",value:l.payment_method||"",onChange:E,className:"select select-bordered w-full "+(d.payment_method?"select-error":""),children:[(0,Le.jsx)("option",{value:"",children:"Seleccionar"}),kp.map((e=>(0,Le.jsx)("option",{value:e.value,children:e.label},e.value)))]}),d.payment_method&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.payment_method})]}),(0,Le.jsxs)("div",{className:"form-control w-full",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Prop\xf3sito del Cr\xe9dito"})}),(0,Le.jsxs)("select",{name:"credit_purpose",value:l.credit_purpose||"",onChange:E,className:"select select-bordered w-full "+(d.credit_purpose?"select-error":""),children:[(0,Le.jsx)("option",{value:"",children:"Seleccionar"}),Cp.map((e=>(0,Le.jsx)("option",{value:e.value,children:e.label},e.value)))]}),d.credit_purpose&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.credit_purpose})]}),(0,Le.jsxs)("div",{className:"form-control w-full",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Gastos Mensuales"})}),(0,Le.jsxs)("div",{className:"relative",children:[(0,Le.jsx)("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:"$"}),(0,Le.jsx)("input",{type:"number",name:"monthly_expenses",value:void 0===l.monthly_expenses?"":l.monthly_expenses,onChange:E,className:"input input-bordered w-full pl-7 "+(d.monthly_expenses?"input-error":""),placeholder:"0.00",min:"0",step:"0.01"})]}),d.monthly_expenses&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.monthly_expenses})]}),(0,Le.jsxs)("div",{className:"form-control w-full",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Pago de Hipoteca"})}),(0,Le.jsxs)("div",{className:"relative",children:[(0,Le.jsx)("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:"$"}),(0,Le.jsx)("input",{type:"number",name:"mortgage_payment",value:void 0===l.mortgage_payment?"":l.mortgage_payment,onChange:E,className:"input input-bordered w-full pl-7 "+(d.mortgage_payment?"input-error":""),placeholder:"0.00",min:"0",step:"0.01"})]}),d.mortgage_payment&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.mortgage_payment})]}),(0,Le.jsxs)("div",{className:"form-control w-full",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Pago de Renta"})}),(0,Le.jsxs)("div",{className:"relative",children:[(0,Le.jsx)("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:"$"}),(0,Le.jsx)("input",{type:"number",name:"rent_payment",value:void 0===l.rent_payment?"":l.rent_payment,onChange:E,className:"input input-bordered w-full pl-7 "+(d.rent_payment?"input-error":""),placeholder:"0.00",min:"0",step:"0.01"})]}),d.rent_payment&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.rent_payment})]}),(0,Le.jsxs)("div",{className:"form-control w-full",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Saldos de Otros Cr\xe9ditos"})}),(0,Le.jsxs)("div",{className:"relative",children:[(0,Le.jsx)("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:"$"}),(0,Le.jsx)("input",{type:"number",name:"other_loan_balances",value:void 0===l.other_loan_balances?"":l.other_loan_balances,onChange:E,className:"input input-bordered w-full pl-7 "+(d.other_loan_balances?"input-error":""),placeholder:"0.00",min:"0",step:"0.01"})]}),d.other_loan_balances&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.other_loan_balances})]})]})]});case 3:return(0,Le.jsxs)("div",{className:"space-y-6",children:[(0,Le.jsx)("h3",{className:"text-lg font-semibold",children:"Datos de la Cuenta Bancaria"}),(0,Le.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Le.jsxs)("div",{className:"form-control w-full",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Banco"})}),(0,Le.jsx)("input",{type:"text",name:"bank_name",value:l.bank_name||"",onChange:E,className:"input input-bordered w-full "+(d.bank_name?"input-error":""),placeholder:"Nombre del banco"}),d.bank_name&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.bank_name})]}),(0,Le.jsxs)("div",{className:"form-control w-full",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"CLABE Interbancaria"})}),(0,Le.jsx)("input",{type:"text",name:"bank_clabe",value:l.bank_clabe||"",onChange:E,className:"input input-bordered w-full "+(d.bank_clabe?"input-error":""),placeholder:"18 d\xedgitos",maxLength:18}),d.bank_clabe&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.bank_clabe})]}),(0,Le.jsxs)("div",{className:"form-control w-full",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"N\xfamero de Cuenta"})}),(0,Le.jsx)("input",{type:"text",name:"bank_account_number",value:l.bank_account_number||"",onChange:E,className:"input input-bordered w-full "+(d.bank_account_number?"input-error":""),placeholder:"N\xfamero de cuenta"}),d.bank_account_number&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.bank_account_number})]}),(0,Le.jsxs)("div",{className:"form-control w-full",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Tipo de Cuenta"})}),(0,Le.jsxs)("select",{name:"bank_account_type",value:l.bank_account_type||"",onChange:E,className:"select select-bordered w-full "+(d.bank_account_type?"select-error":""),children:[(0,Le.jsx)("option",{value:"",children:"Seleccionar"}),Ep.map((e=>(0,Le.jsx)("option",{value:e.value,children:e.label},e.value)))]}),d.bank_account_type&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.bank_account_type})]}),(0,Le.jsxs)("div",{className:"form-control w-full",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Origen de la Cuenta"})}),(0,Le.jsx)("input",{type:"text",name:"bank_account_origin",value:l.bank_account_origin||"",onChange:E,className:"input input-bordered w-full "+(d.bank_account_origin?"input-error":""),placeholder:"Ej: N\xf3mina, Personal"}),d.bank_account_origin&&(0,Le.jsx)("span",{className:"text-error text-sm mt-1",children:d.bank_account_origin})]})]}),(0,Le.jsx)("h3",{className:"text-lg font-semibold mt-6",children:"Referencias"}),(0,Le.jsxs)("div",{children:[(0,Le.jsx)("h4",{className:"text-md font-medium mb-2",children:"Referencia #1"}),(0,Le.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Le.jsxs)("div",{className:"form-control w-full",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Nombre Completo"})}),(0,Le.jsx)("input",{type:"text",name:"reference1_name",value:l.reference1_name||"",onChange:E,className:"input input-bordered w-full",placeholder:"Nombre de la referencia"})]}),(0,Le.jsxs)("div",{className:"form-control w-full",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Relaci\xf3n/Parentesco"})}),(0,Le.jsxs)("select",{name:"reference1_relationship",value:l.reference1_relationship||"",onChange:E,className:"select select-bordered w-full",children:[(0,Le.jsx)("option",{value:"",children:"Seleccionar"}),Ap.map((e=>(0,Le.jsx)("option",{value:e.value,children:e.label},e.value)))]})]}),(0,Le.jsxs)("div",{className:"form-control w-full",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Tel\xe9fono"})}),(0,Le.jsx)("input",{type:"tel",name:"reference1_phone",value:l.reference1_phone||"",onChange:E,className:"input input-bordered w-full",placeholder:"55 1234 5678"})]}),(0,Le.jsxs)("div",{className:"form-control w-full",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Direcci\xf3n"})}),(0,Le.jsx)("input",{type:"text",name:"reference1_address",value:l.reference1_address||"",onChange:E,className:"input input-bordered w-full",placeholder:"Direcci\xf3n de la referencia"})]})]})]}),(0,Le.jsxs)("div",{children:[(0,Le.jsx)("h4",{className:"text-md font-medium mb-2",children:"Referencia #2"}),(0,Le.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Le.jsxs)("div",{className:"form-control w-full",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Nombre Completo"})}),(0,Le.jsx)("input",{type:"text",name:"reference2_name",value:l.reference2_name||"",onChange:E,className:"input input-bordered w-full",placeholder:"Nombre de la referencia"})]}),(0,Le.jsxs)("div",{className:"form-control w-full",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Relaci\xf3n/Parentesco"})}),(0,Le.jsxs)("select",{name:"reference2_relationship",value:l.reference2_relationship||"",onChange:E,className:"select select-bordered w-full",children:[(0,Le.jsx)("option",{value:"",children:"Seleccionar"}),Ap.map((e=>(0,Le.jsx)("option",{value:e.value,children:e.label},e.value)))]})]}),(0,Le.jsxs)("div",{className:"form-control w-full",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Tel\xe9fono"})}),(0,Le.jsx)("input",{type:"tel",name:"reference2_phone",value:l.reference2_phone||"",onChange:E,className:"input input-bordered w-full",placeholder:"55 1234 5678"})]}),(0,Le.jsxs)("div",{className:"form-control w-full",children:[(0,Le.jsx)("label",{className:"label",children:(0,Le.jsx)("span",{className:"label-text",children:"Direcci\xf3n"})}),(0,Le.jsx)("input",{type:"text",name:"reference2_address",value:l.reference2_address||"",onChange:E,className:"input input-bordered w-full",placeholder:"Direcci\xf3n de la referencia"})]})]})]})]});case 4:return(0,Le.jsxs)("div",{className:"space-y-6",children:[(0,Le.jsx)("h3",{className:"text-lg font-semibold",children:"Documentos"}),(0,Le.jsx)(xp,{onDocumentAdded:S,onDocumentRemoved:k,existingDocuments:h,categories:wp})]});default:return null}})(),(0,Le.jsxs)("div",{className:"mt-8 flex justify-between",children:[m>1&&(0,Le.jsx)("button",{type:"button",onClick:()=>{m>1&&f((e=>e-1))},className:"btn btn-outline",disabled:x||s,children:"Anterior"}),(0,Le.jsxs)("div",{className:"flex space-x-2 ml-auto",children:[m>1&&m<4&&a&&(0,Le.jsx)("button",{type:"button",className:"btn btn-outline btn-secondary",onClick:async()=>{if(a)try{_(!0),console.log("\ud83d\udd0d [ClientForm] Guardando datos antes de salir:",l),await a(l,m),console.log("\ud83d\udd0d [ClientForm] Datos guardados exitosamente"),i("/clients")}catch(e){console.error("Error al guardar datos antes de salir:",e)}finally{_(!1)}},disabled:x||s,children:x?"Guardando...":"Guardar y Salir"}),m<4?(0,Le.jsx)("button",{type:"button",onClick:async()=>{if(m<4){if(a)try{_(!0),console.log("\ud83d\udd0d [ClientForm] Llamando a onSavePartial con datos:",l);const e=await a(l,m);console.log(`\ud83d\udd0d [ClientForm] Datos guardados para secci\xf3n ${m}, resultado:`,e),e&&c((t=>{const n={...t,...e};return console.log("\ud83d\udd0d [ClientForm] Datos de formulario actualizados con el resultado:",n),n}))}catch(e){return void console.error("Error al guardar datos parciales:",e)}finally{_(!1)}f((e=>e+1))}},className:"btn btn-primary",disabled:x||s,children:x?"Guardando...":"Siguiente"}):(0,Le.jsx)("button",{type:"submit",className:"btn btn-success",disabled:s||x,children:s?"Guardando...":"Guardar Cliente"})]})]})]})})},Pp="70b2aa97-a5b6-4b5e-91db-be8acbd3701a",Ip=()=>{const e=ne(),{user:t}=Ue(),[n,a]=(0,r.useState)(!1),[s,i]=(0,r.useState)(!1),[o,l]=(0,r.useState)(null),[c,d]=(0,r.useState)(null),[u,h]=(0,r.useState)(null),[p,m]=(0,r.useState)(null),[f,g]=(0,r.useState)([]);ee();(0,r.useEffect)((()=>{try{const e=localStorage.getItem("draftClient"),t=localStorage.getItem("temporaryClientId"),n=localStorage.getItem("temporaryDocuments");e&&(console.log("Recuperando datos del cliente del localStorage:",e),h(JSON.parse(e))),t&&(console.log("Recuperando ID de cliente temporal:",t),m(t)),n&&console.log("Recuperando documentos temporales del localStorage")}catch(Uu){console.error("Error loading draft from localStorage:",Uu)}}),[]);const v=(e,t)=>{const n={};switch(e.id&&(n.id=e.id),e.company_id&&(n.company_id=e.company_id),e.advisor_id&&(n.advisor_id=e.advisor_id),t){case 1:["first_name","paternal_surname","maternal_surname","email","phone","rfc","curp","birth_date","gender","marital_status","address","city","state","postal_code"].forEach((t=>{t in e&&(n[t]=e[t])}));break;case 2:["employment_type","employment_years","monthly_income","additional_income","monthly_expenses","other_loan_balances"].forEach((t=>{t in e&&(n[t]=e[t])}));break;case 3:["bank_name","bank_clabe","bank_account_number","bank_account_type","bank_account_origin"].forEach((t=>{t in e&&(n[t]=e[t])}));break;default:console.warn(`\ud83d\udd0d Paso desconocido para guardado parcial: ${t}`)}return n};return(0,Le.jsx)(_t,{children:(0,Le.jsxs)("div",{className:"p-6",children:[(0,Le.jsxs)("div",{className:"flex items-center mb-6",children:[(0,Le.jsxs)("button",{onClick:()=>e("/clients"),className:"btn btn-sm btn-outline mr-4",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Le.jsx)("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),"Volver"]}),(0,Le.jsx)("h1",{className:"text-2xl font-bold",children:"Nuevo Cliente"})]}),o&&(0,Le.jsx)("div",{className:"mb-4",children:(0,Le.jsxs)("div",{className:"alert alert-error",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,Le.jsx)("span",{children:o}),(0,Le.jsx)("button",{onClick:()=>l(null),className:"ml-auto",children:"\xd7"})]})}),c&&(0,Le.jsx)("div",{className:"mb-4",children:(0,Le.jsxs)("div",{className:"alert alert-success",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,Le.jsx)("span",{children:c}),(0,Le.jsx)("button",{onClick:()=>d(null),className:"ml-auto",children:"\xd7"})]})}),p&&(0,Le.jsx)("div",{className:"mb-4",children:(0,Le.jsxs)("div",{className:"alert alert-info",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,Le.jsx)("span",{children:"Cliente guardado como borrador. Complete y env\xede el formulario para finalizar."})]})}),(0,Le.jsx)(Tp,{initialData:u||void 0,onSubmit:async(n,r)=>{a(!0),l(null),console.log("Submitting client data:",n);try{const s={...n};let i;if(t&&"ADVISOR"===t.role&&(s.advisor_id=t.id),s.company_id?console.log("Using company_id selected in form:",s.company_id):(console.log("No company selected in form, applying default/user company logic"),t?"COMPANY_ADMIN"===t.role?(s.company_id=t.entityId,console.log("Using company_id from COMPANY_ADMIN user:",s.company_id)):(s.company_id=Pp,console.log("Using default company_id for user with role:",t.role)):(s.company_id=Pp,console.log("No user context, using default company_id"))),p?(console.log(`Updating temporary client with ID ${p}`),i=await Yh(p,s,r,null===t||void 0===t?void 0:t.id),console.log("Client updated successfully:",i)):(console.log("Creando nuevo cliente sin ID temporal"),i=await qh(s,r,null===t||void 0===t?void 0:t.id),console.log("Client created successfully:",i)),i.warningMessage)return d(i.warningMessage),void a(!1);console.log("Client created/updated successfully:",i),localStorage.removeItem("draftClient"),localStorage.removeItem("clientFormStep"),localStorage.removeItem("temporaryClientId"),localStorage.removeItem("temporaryDocuments"),e("/clients")}catch(o){console.error("Error al crear cliente:",o),l(o.message||"Error al crear el cliente. Por favor, intente de nuevo.")}finally{a(!1)}},onSavePartial:async(e,n)=>{try{i(!0),l(null),console.log(`Saving partial data for step ${n}:`,e);const r=v(e,n);t&&"ADVISOR"===t.role&&!r.advisor_id&&(r.advisor_id=t.id),r.company_id||(t&&"COMPANY_ADMIN"===t.role?r.company_id=t.entityId:r.company_id=Pp);const s={...u,...r};h(s);try{if(p){console.log(`Updating temporary client with ID ${p}`);const e=await Yh(p,r);if(console.log("Client updated successfully:",e),!e)throw new Error("No se recibi\xf3 respuesta despu\xe9s de la actualizaci\xf3n");e.warningMessage?d(e.warningMessage):d(`Los datos de la secci\xf3n ${n} se han guardado correctamente.`),setTimeout((()=>{d(null)}),3e3)}else if(1===n){if(console.log("Creating temporary client"),!r.first_name||!r.paternal_surname)return l("Debe proporcionar al menos nombre y apellido paterno para guardar."),i(!1),null;const e=await qh(r,[],null===t||void 0===t?void 0:t.id);if(console.log("Temporary client created successfully:",e),!e||!e.id)throw new Error("No se recibi\xf3 un ID de cliente despu\xe9s de la creaci\xf3n");m(e.id),localStorage.setItem("temporaryClientId",e.id)}else console.log("No se puede guardar en Supabase sin haber completado el paso 1 primero");return localStorage.setItem("draftClient",JSON.stringify(s)),s}catch(Uu){console.error("Error saving to Supabase:",Uu),Uu.message&&console.error("Error message:",Uu.message),Uu.cause&&console.error("Error cause:",Uu.cause),Uu.stack&&console.error("Error stack:",Uu.stack),(Uu.code||Uu.details||Uu.hint)&&console.error("Supabase error details:",{code:Uu.code,details:Uu.details,hint:Uu.hint}),l(`Error al guardar los datos en el servidor: ${Uu.message||"Error desconocido"}`);try{localStorage.setItem("draftClient",JSON.stringify(s))}catch(a){console.error("Error saving to localStorage:",a)}return null}}catch(o){return console.error("Error saving partial data:",o),l("Error al guardar los datos parciales."),null}finally{i(!1)}},isSubmitting:n})]})})},Op=()=>{const{id:e}=ae(),t=ne(),{user:n}=Ue(),[a,s]=(0,r.useState)(null),[i,o]=(0,r.useState)(!0),[l,c]=(0,r.useState)(!1),[d,u]=(0,r.useState)(null),[h,p]=(0,r.useState)(null);(0,r.useEffect)((()=>{e&&m(e)}),[e]);const m=async e=>{try{o(!0),console.log(`Fetching client data for ID ${e}`);const t=await Hh(e);t?(console.log("Client data retrieved successfully:",t),s(t)):u("No se encontr\xf3 el cliente especificado.")}catch(t){console.error("Error al obtener datos del cliente:",t),u("Error al cargar los datos del cliente. Por favor, intente de nuevo.")}finally{o(!1)}},f=(e,t)=>{const n={};switch(e.id&&(n.id=e.id),e.company_id&&(n.company_id=e.company_id),e.advisor_id&&(n.advisor_id=e.advisor_id),t){case 1:["first_name","paternal_surname","maternal_surname","email","phone","rfc","curp","birth_date","gender","marital_status","address","city","state","postal_code"].forEach((t=>{t in e&&(n[t]=e[t])}));break;case 2:["employment_type","employment_years","monthly_income","additional_income","monthly_expenses","other_loan_balances"].forEach((t=>{t in e&&(n[t]=e[t])}));break;case 3:["bank_name","bank_clabe","bank_account_number","bank_account_type","bank_account_origin"].forEach((t=>{t in e&&(n[t]=e[t])}));break;default:console.warn(`\ud83d\udd0d Paso desconocido para guardado parcial: ${t}`)}return n};return i?(0,Le.jsx)(_t,{children:(0,Le.jsx)("div",{className:"p-6 flex justify-center",children:(0,Le.jsx)("span",{className:"loading loading-spinner loading-lg"})})}):d||!a?(0,Le.jsx)(_t,{children:(0,Le.jsxs)("div",{className:"p-6",children:[(0,Le.jsxs)("div",{className:"alert alert-error",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,Le.jsx)("span",{children:d||"No se encontr\xf3 el cliente solicitado."})]}),(0,Le.jsx)("div",{className:"mt-4",children:(0,Le.jsx)("button",{onClick:()=>t("/clients"),className:"btn btn-primary",children:"Volver a Clientes"})})]})}):(0,Le.jsx)(_t,{children:(0,Le.jsxs)("div",{className:"p-6",children:[(0,Le.jsxs)("div",{className:"flex items-center mb-6",children:[(0,Le.jsxs)("button",{onClick:()=>t("/clients"),className:"btn btn-sm btn-outline mr-4",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Le.jsx)("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),"Volver"]}),(0,Le.jsx)("h1",{className:"text-2xl font-bold",children:"Editar Cliente"})]}),d&&(0,Le.jsx)("div",{className:"mb-4",children:(0,Le.jsxs)("div",{className:"alert alert-error",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,Le.jsx)("span",{children:d}),(0,Le.jsx)("button",{onClick:()=>u(null),className:"ml-auto",children:"\xd7"})]})}),h&&(0,Le.jsx)("div",{className:"mb-4",children:(0,Le.jsxs)("div",{className:"alert alert-success",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Le.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,Le.jsx)("span",{children:h}),(0,Le.jsx)("button",{onClick:()=>p(null),className:"ml-auto",children:"\xd7"})]})}),(0,Le.jsx)(Tp,{initialData:a,onSubmit:async(a,r)=>{if(e)try{c(!0),u(null),p(null),console.log("Updating client data first...",a);const s=await Yh(e,a,r,null===n||void 0===n?void 0:n.id);if(console.log("Client data successfully updated",s),s.warningMessage)return void p(s.warningMessage);console.log("Client update complete"),t("/clients")}catch(d){console.error("Error al actualizar cliente:",d),d.message&&(d.message.includes("pol\xedticas de seguridad RLS")||d.message.includes("permisos")||d.message.includes("Unauthorized")||d.message.includes("No tienes permisos"))?u(`Error de permisos: ${d.message}. Contacte al administrador para verificar las pol\xedticas de seguridad de la base de datos.`):d.message&&d.message.includes("actualizaci\xf3n no tuvo efecto")?u(`${d.message} Contacte al administrador para verificar si tiene los permisos necesarios.`):u(d.message||"Error al guardar los cambios. Por favor, intente de nuevo."),window.scrollTo(0,0)}finally{c(!1)}},onSavePartial:async(e,t)=>{try{if(console.log(`\ud83d\udd0d Guardando datos parciales del cliente en paso ${t}...`),console.log("\ud83d\udd0d Datos a guardar:",e),c(!0),u(null),!a||!a.id)throw new Error("No se encontr\xf3 el ID del cliente para actualizaci\xf3n parcial");const r={id:a.id,...f(e,t)};!r.company_id&&a.company_id&&(r.company_id=a.company_id),!r.advisor_id&&a.advisor_id&&(r.advisor_id=a.advisor_id),console.log("\ud83d\udd0d Datos finales a enviar a Supabase:",r);try{const e=await Yh(a.id,r);if(console.log(`\ud83d\udd0d Actualizaci\xf3n exitosa para secci\xf3n ${t}:`,e),!e)throw new Error("No se recibi\xf3 respuesta despu\xe9s de la actualizaci\xf3n");const n={...a,...r,...e};return s(n),console.log("\ud83d\udd0d Cliente actualizado en estado local:",n),e.warningMessage?p(e.warningMessage):p(`Se guardaron los datos de la secci\xf3n ${t} correctamente`),setTimeout((()=>{p(null)}),3e3),console.log("\ud83d\udd0d Datos completos a devolver al formulario:",n),1===t&&n?(console.log("\ud83d\udd0d Verificando campos financieros para el paso 2:"),console.log("employment_type:",n.employment_type),console.log("employment_years:",n.employment_years),console.log("monthly_income:",n.monthly_income),console.log("additional_income:",n.additional_income),console.log("monthly_expenses:",n.monthly_expenses),console.log("other_loan_balances:",n.other_loan_balances)):2===t&&n&&(console.log("\ud83d\udd0d Verificando campos bancarios para el paso 3:"),console.log("bank_name:",n.bank_name),console.log("bank_clabe:",n.bank_clabe),console.log("bank_account_number:",n.bank_account_number),console.log("bank_account_type:",n.bank_account_type),console.log("bank_account_origin:",n.bank_account_origin)),n}catch(n){throw console.error(`\ud83d\udd0d Error al actualizar cliente en paso ${t}:`,n),n.message&&console.error("Error message:",n.message),n.cause&&console.error("Error cause:",n.cause),n.stack&&console.error("Error stack:",n.stack),(n.code||n.details||n.hint)&&console.error("Supabase error details:",{code:n.code,details:n.details,hint:n.hint}),n.message&&(n.message.includes("pol\xedticas de seguridad RLS")||n.message.includes("permisos")||n.message.includes("Unauthorized")||n.message.includes("No tienes permisos"))?u(`Error de permisos al guardar la secci\xf3n ${t}: ${n.message}. \n            Contacte al administrador para verificar las pol\xedticas de seguridad de la base de datos.`):n.message&&n.message.includes("actualizaci\xf3n no tuvo efecto")?u(`${n.message} Contacte al administrador para verificar si tiene los permisos necesarios.`):u(`Error al guardar la secci\xf3n ${t}: ${n.message||"Error desconocido"}`),n}}catch(d){return console.error(`\ud83d\udd0d Error en handleSavePartial en paso ${t}:`,d),document.getElementById("error-message")||u(d.message||`Error al guardar la secci\xf3n ${t}. Por favor, intente nuevamente.`),setTimeout((()=>{d.message===u&&u(null)}),6e3),null}finally{c(!1)}},isSubmitting:l})]})})},Rp=()=>{const{userCan:e}=Je();return e(Ve.VIEW_REPORTS)?(0,Le.jsx)(_t,{children:(0,Le.jsxs)("div",{className:"p-6",children:[(0,Le.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Reportes"}),(0,Le.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,Le.jsx)("div",{className:"card-body",children:(0,Le.jsx)("p",{className:"text-center py-12 text-gray-500",children:"Esta p\xe1gina est\xe1 en desarrollo."})})})]})}):(0,Le.jsx)(_t,{children:(0,Le.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,Le.jsxs)("div",{className:"text-center",children:[(0,Le.jsx)("h2",{className:"text-2xl font-bold text-gray-700",children:"Acceso Restringido"}),(0,Le.jsx)("p",{className:"text-gray-500 mt-2",children:"No tienes permisos para ver esta p\xe1gina."})]})})})},Mp=()=>{const{userCan:e}=Je();return e(Ve.VIEW_ADVISORS)?(0,Le.jsx)(_t,{children:(0,Le.jsxs)("div",{className:"p-6",children:[(0,Le.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6",children:[(0,Le.jsx)("h1",{className:"text-2xl font-bold mb-4 md:mb-0",children:"Usuarios"}),e(Ve.CREATE_ADVISOR)&&(0,Le.jsxs)(Te,{to:"/users/new",className:"btn btn-primary",children:[(0,Le.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Le.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})}),"Nuevo Usuario"]})]}),(0,Le.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,Le.jsx)("div",{className:"card-body",children:(0,Le.jsx)("p",{className:"text-center py-12 text-gray-500",children:"Esta p\xe1gina est\xe1 en desarrollo."})})})]})}):(0,Le.jsx)(_t,{children:(0,Le.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,Le.jsxs)("div",{className:"text-center",children:[(0,Le.jsx)("h2",{className:"text-2xl font-bold text-gray-700",children:"Acceso Restringido"}),(0,Le.jsx)("p",{className:"text-gray-500 mt-2",children:"No tienes permisos para ver esta p\xe1gina."})]})})})},Dp=()=>{const{id:e}=ae(),t=!!e;return(0,Le.jsx)(_t,{children:(0,Le.jsxs)("div",{className:"p-6",children:[(0,Le.jsx)("h1",{className:"text-2xl font-bold mb-6",children:t?"Editar Usuario":"Nuevo Usuario"}),(0,Le.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,Le.jsxs)("div",{className:"card-body",children:[t?(0,Le.jsxs)("p",{children:["Formulario de edici\xf3n para usuario ID: ",e]}):(0,Le.jsx)("p",{children:"Formulario para nuevo usuario"}),(0,Le.jsx)("p",{className:"text-gray-500",children:"Esta p\xe1gina est\xe1 en desarrollo."})]})})]})})},Lp=()=>{const{userCan:e}=Je();return e(Ve.VIEW_DASHBOARD)?(0,Le.jsx)(_t,{children:(0,Le.jsxs)("div",{className:"p-6",children:[(0,Le.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Configuraci\xf3n"}),(0,Le.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,Le.jsx)("div",{className:"card-body",children:(0,Le.jsx)("p",{className:"text-center py-12 text-gray-500",children:"Esta p\xe1gina est\xe1 en desarrollo."})})})]})}):(0,Le.jsx)(_t,{children:(0,Le.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,Le.jsxs)("div",{className:"text-center",children:[(0,Le.jsx)("h2",{className:"text-2xl font-bold text-gray-700",children:"Acceso Restringido"}),(0,Le.jsx)("p",{className:"text-gray-500 mt-2",children:"No tienes permisos para ver esta p\xe1gina."})]})})})},$p=()=>(0,Le.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-base-200",children:(0,Le.jsxs)("div",{className:"text-center p-8",children:[(0,Le.jsx)("h1",{className:"text-8xl font-bold text-primary",children:"404"}),(0,Le.jsx)("h2",{className:"text-2xl font-bold my-4",children:"P\xe1gina No Encontrada"}),(0,Le.jsx)("p",{className:"mb-6 text-gray-600",children:"Lo sentimos, la p\xe1gina que buscas no existe o ha sido movida."}),(0,Le.jsx)(Te,{to:"/",className:"btn btn-primary",children:"Volver al Inicio"})]})}),zp=()=>(0,Le.jsx)(_t,{children:(0,Le.jsxs)("div",{className:"p-6",children:[(0,Le.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Empresas"}),(0,Le.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,Le.jsx)("div",{className:"card-body",children:(0,Le.jsx)("p",{className:"text-lg text-center py-10",children:"La secci\xf3n de Empresas est\xe1 en desarrollo. Estar\xe1 disponible pr\xf3ximamente."})})})]})}),Fp=()=>{const{notifications:e,markAsRead:t,markAllAsRead:n,clearNotifications:a}=nt();return(0,Le.jsx)(_t,{children:(0,Le.jsxs)("div",{className:"p-6",children:[(0,Le.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Le.jsx)("h1",{className:"text-2xl font-bold",children:"Notificaciones"}),(0,Le.jsxs)("div",{className:"flex gap-2",children:[(0,Le.jsx)("button",{onClick:n,className:"btn btn-sm btn-outline",children:"Marcar todas como le\xeddas"}),(0,Le.jsx)("button",{onClick:a,className:"btn btn-sm btn-outline btn-error",children:"Limpiar notificaciones"})]})]}),(0,Le.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,Le.jsx)("div",{className:"card-body",children:0===e.length?(0,Le.jsx)("p",{className:"text-center py-10 text-gray-500",children:"No tienes notificaciones."}):(0,Le.jsx)("div",{className:"space-y-4",children:e.map((e=>(0,Le.jsxs)("div",{className:"border-b border-base-200 p-4 "+(e.read?"":"bg-base-200"),children:[(0,Le.jsxs)("div",{className:"flex justify-between items-start",children:[(0,Le.jsx)("h3",{className:"font-semibold",children:e.title}),(0,Le.jsx)("span",{className:"text-xs text-gray-500",children:new Date(e.createdAt).toLocaleString()})]}),(0,Le.jsx)("p",{className:"mt-2",children:e.message}),!e.read&&(0,Le.jsx)("button",{onClick:()=>t(e.id),className:"btn btn-xs btn-ghost mt-2",children:"Marcar como le\xedda"})]},e.id)))})})})]})})},Bp=()=>{const{userId:e}=ae(),{user:t}=(ne(),Ue()),[n,a]=(0,r.useState)(e||null),[s,i]=(0,r.useState)(!0),[o,l]=(0,r.useState)(null);return(0,Le.jsx)(_t,{children:(0,Le.jsxs)("div",{className:"p-6",children:[(0,Le.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Mensajes"}),(0,Le.jsx)("div",{className:"card bg-base-100 shadow-xl",children:(0,Le.jsx)("div",{className:"card-body",children:(0,Le.jsx)("p",{className:"text-lg text-center py-10",children:"El sistema de mensajer\xeda est\xe1 en mantenimiento. Estar\xe1 disponible pr\xf3ximamente."})})})]})})},Up=()=>((0,r.useEffect)((()=>{Bu().catch((e=>{console.error("Error verificando estructura de base de datos:",e)}))}),[]),(0,r.useEffect)((()=>{const e=()=>{document.documentElement.setAttribute("data-user-interacted","true")},t=["click","keydown","mousedown","touchstart"];return t.forEach((t=>{document.addEventListener(t,e,{once:!0})})),()=>{t.forEach((t=>{document.removeEventListener(t,e)}))}}),[]),(0,Le.jsx)(ke,{children:(0,Le.jsx)(We,{children:(0,Le.jsx)(Ge,{children:(0,Le.jsx)(at,{children:(0,Le.jsxs)(_e,{children:[(0,Le.jsx)(ye,{path:"/login",element:(0,Le.jsx)(it,{})}),(0,Le.jsx)(ye,{path:"/",element:(0,Le.jsx)(be,{to:"/dashboard",replace:!0})}),(0,Le.jsx)(ye,{path:"/dashboard",element:(0,Le.jsx)(rt,{children:(0,Le.jsx)(Bl,{})})}),(0,Le.jsx)(ye,{path:"/applications",element:(0,Le.jsx)(rt,{children:(0,Le.jsx)(ec,{})})}),(0,Le.jsx)(ye,{path:"/applications/kanban",element:(0,Le.jsx)(rt,{children:(0,Le.jsx)(ac,{})})}),(0,Le.jsx)(ye,{path:"/applications/new",element:(0,Le.jsx)(rt,{children:(0,Le.jsx)(ic,{})})}),(0,Le.jsx)(ye,{path:"/applications/:id",element:(0,Le.jsx)(rt,{children:(0,Le.jsx)(rc,{})})}),(0,Le.jsx)(ye,{path:"/applications/:id/edit",element:(0,Le.jsx)(rt,{children:(0,Le.jsx)(ic,{})})}),(0,Le.jsx)(ye,{path:"/clients",element:(0,Le.jsx)(rt,{children:(0,Le.jsx)(Jh,{})})}),(0,Le.jsx)(ye,{path:"/clients/new",element:(0,Le.jsx)(rt,{children:(0,Le.jsx)(Ip,{})})}),(0,Le.jsx)(ye,{path:"/clients/:id",element:(0,Le.jsx)(rt,{children:(0,Le.jsx)(yp,{})})}),(0,Le.jsx)(ye,{path:"/clients/:id/edit",element:(0,Le.jsx)(rt,{children:(0,Le.jsx)(Op,{})})}),(0,Le.jsx)(ye,{path:"/reports",element:(0,Le.jsx)(rt,{children:(0,Le.jsx)(Rp,{})})}),(0,Le.jsx)(ye,{path:"/users",element:(0,Le.jsx)(rt,{children:(0,Le.jsx)(Mp,{})})}),(0,Le.jsx)(ye,{path:"/users/new",element:(0,Le.jsx)(rt,{children:(0,Le.jsx)(Dp,{})})}),(0,Le.jsx)(ye,{path:"/users/:id/edit",element:(0,Le.jsx)(rt,{children:(0,Le.jsx)(Dp,{})})}),(0,Le.jsx)(ye,{path:"/settings",element:(0,Le.jsx)(rt,{children:(0,Le.jsx)(Lp,{})})}),(0,Le.jsx)(ye,{path:"/companies",element:(0,Le.jsx)(rt,{children:(0,Le.jsx)(zp,{})})}),(0,Le.jsx)(ye,{path:"/notifications",element:(0,Le.jsx)(rt,{children:(0,Le.jsx)(Fp,{})})}),(0,Le.jsx)(ye,{path:"/messages",element:(0,Le.jsx)(rt,{children:(0,Le.jsx)(Bp,{})})}),(0,Le.jsx)(ye,{path:"/messages/:userId",element:(0,Le.jsx)(rt,{children:(0,Le.jsx)(Bp,{})})}),(0,Le.jsx)(ye,{path:"*",element:(0,Le.jsx)($p,{})})]})})})})})),Wp=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,453)).then((t=>{let{getCLS:n,getFID:a,getFCP:r,getLCP:s,getTTFB:i}=t;n(e),a(e),r(e),s(e),i(e)}))};i.createRoot(document.getElementById("root")).render((0,Le.jsx)(r.StrictMode,{children:(0,Le.jsx)(Up,{})})),Wp()})();
//# sourceMappingURL=main.903fb880.js.map