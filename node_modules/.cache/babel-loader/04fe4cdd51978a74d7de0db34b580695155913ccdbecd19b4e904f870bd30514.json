{"ast":null,"code":"import React,{useState}from'react';import{useNavigate}from'react-router-dom';import{useAuth}from'../contexts/AuthContext';import MainLayout from'../components/layout/MainLayout';import ClientForm from'../components/clients/ClientForm';import{createClient}from'../services/clientService';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const NewClient=()=>{const navigate=useNavigate();const{user}=useAuth();const[isSubmitting,setIsSubmitting]=useState(false);const handleSubmit=async(data,documents)=>{try{setIsSubmitting(true);// Si el usuario es asesor o admin de empresa, asignar los IDs correspondientes\nconst clientData={...data};if(user){if(user.role==='ADVISOR'){clientData.advisor_id=user.id;}else if(user.role==='COMPANY_ADMIN'){clientData.company_id=user.entityId;}}// Crear el cliente\nawait createClient(clientData,documents,user===null||user===void 0?void 0:user.id);// Redireccionar a la lista de clientes\nnavigate('/clients');}catch(error){console.error('Error al crear cliente:',error);// Puedes mostrar un mensaje de error aquí\n}finally{setIsSubmitting(false);}};return/*#__PURE__*/_jsx(MainLayout,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center mb-6\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>navigate('/clients'),className:\"btn btn-sm btn-outline mr-4\",children:[/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-5 w-5 mr-1\",viewBox:\"0 0 20 20\",fill:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z\",clipRule:\"evenodd\"})}),\"Volver\"]}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold\",children:\"Nuevo Cliente\"})]}),/*#__PURE__*/_jsx(ClientForm,{onSubmit:handleSubmit,isSubmitting:isSubmitting})]})});};export default NewClient;","map":{"version":3,"names":["React","useState","useNavigate","useAuth","MainLayout","ClientForm","createClient","jsx","_jsx","jsxs","_jsxs","NewClient","navigate","user","isSubmitting","setIsSubmitting","handleSubmit","data","documents","clientData","role","advisor_id","id","company_id","entityId","error","console","children","className","onClick","xmlns","viewBox","fill","fillRule","d","clipRule","onSubmit"],"sources":["/Users/diegogg98/NEW CRM MAR18/src/pages/NewClient.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuth } from '../contexts/AuthContext';\nimport MainLayout from '../components/layout/MainLayout';\nimport ClientForm from '../components/clients/ClientForm';\nimport { Client, ClientDocument, createClient } from '../services/clientService';\n\nconst NewClient: React.FC = () => {\n  const navigate = useNavigate();\n  const { user } = useAuth();\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  const handleSubmit = async (data: Partial<Client>, documents: ClientDocument[]) => {\n    try {\n      setIsSubmitting(true);\n      \n      // Si el usuario es asesor o admin de empresa, asignar los IDs correspondientes\n      const clientData: Partial<Client> = { ...data };\n      \n      if (user) {\n        if (user.role === 'ADVISOR') {\n          clientData.advisor_id = user.id;\n        } else if (user.role === 'COMPANY_ADMIN') {\n          clientData.company_id = user.entityId;\n        }\n      }\n      \n      // Crear el cliente\n      await createClient(clientData as Omit<Client, 'id' | 'created_at'>, documents, user?.id);\n      \n      // Redireccionar a la lista de clientes\n      navigate('/clients');\n    } catch (error) {\n      console.error('Error al crear cliente:', error);\n      // Puedes mostrar un mensaje de error aquí\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  return (\n    <MainLayout>\n      <div className=\"p-6\">\n        <div className=\"flex items-center mb-6\">\n          <button \n            onClick={() => navigate('/clients')} \n            className=\"btn btn-sm btn-outline mr-4\"\n          >\n            <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5 mr-1\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n              <path fillRule=\"evenodd\" d=\"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z\" clipRule=\"evenodd\" />\n            </svg>\n            Volver\n          </button>\n          <h1 className=\"text-2xl font-bold\">Nuevo Cliente</h1>\n        </div>\n        \n        <ClientForm \n          onSubmit={handleSubmit}\n          isSubmitting={isSubmitting}\n        />\n      </div>\n    </MainLayout>\n  );\n};\n\nexport default NewClient; "],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,KAAQ,OAAO,CACvC,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,OAASC,OAAO,KAAQ,yBAAyB,CACjD,MAAO,CAAAC,UAAU,KAAM,iCAAiC,CACxD,MAAO,CAAAC,UAAU,KAAM,kCAAkC,CACzD,OAAiCC,YAAY,KAAQ,2BAA2B,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEjF,KAAM,CAAAC,SAAmB,CAAGA,CAAA,GAAM,CAChC,KAAM,CAAAC,QAAQ,CAAGV,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAEW,IAAK,CAAC,CAAGV,OAAO,CAAC,CAAC,CAC1B,KAAM,CAACW,YAAY,CAAEC,eAAe,CAAC,CAAGd,QAAQ,CAAC,KAAK,CAAC,CAEvD,KAAM,CAAAe,YAAY,CAAG,KAAAA,CAAOC,IAAqB,CAAEC,SAA2B,GAAK,CACjF,GAAI,CACFH,eAAe,CAAC,IAAI,CAAC,CAErB;AACA,KAAM,CAAAI,UAA2B,CAAG,CAAE,GAAGF,IAAK,CAAC,CAE/C,GAAIJ,IAAI,CAAE,CACR,GAAIA,IAAI,CAACO,IAAI,GAAK,SAAS,CAAE,CAC3BD,UAAU,CAACE,UAAU,CAAGR,IAAI,CAACS,EAAE,CACjC,CAAC,IAAM,IAAIT,IAAI,CAACO,IAAI,GAAK,eAAe,CAAE,CACxCD,UAAU,CAACI,UAAU,CAAGV,IAAI,CAACW,QAAQ,CACvC,CACF,CAEA;AACA,KAAM,CAAAlB,YAAY,CAACa,UAAU,CAAuCD,SAAS,CAAEL,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAES,EAAE,CAAC,CAExF;AACAV,QAAQ,CAAC,UAAU,CAAC,CACtB,CAAE,MAAOa,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,yBAAyB,CAAEA,KAAK,CAAC,CAC/C;AACF,CAAC,OAAS,CACRV,eAAe,CAAC,KAAK,CAAC,CACxB,CACF,CAAC,CAED,mBACEP,IAAA,CAACJ,UAAU,EAAAuB,QAAA,cACTjB,KAAA,QAAKkB,SAAS,CAAC,KAAK,CAAAD,QAAA,eAClBjB,KAAA,QAAKkB,SAAS,CAAC,wBAAwB,CAAAD,QAAA,eACrCjB,KAAA,WACEmB,OAAO,CAAEA,CAAA,GAAMjB,QAAQ,CAAC,UAAU,CAAE,CACpCgB,SAAS,CAAC,6BAA6B,CAAAD,QAAA,eAEvCnB,IAAA,QAAKsB,KAAK,CAAC,4BAA4B,CAACF,SAAS,CAAC,cAAc,CAACG,OAAO,CAAC,WAAW,CAACC,IAAI,CAAC,cAAc,CAAAL,QAAA,cACtGnB,IAAA,SAAMyB,QAAQ,CAAC,SAAS,CAACC,CAAC,CAAC,uIAAuI,CAACC,QAAQ,CAAC,SAAS,CAAE,CAAC,CACrL,CAAC,SAER,EAAQ,CAAC,cACT3B,IAAA,OAAIoB,SAAS,CAAC,oBAAoB,CAAAD,QAAA,CAAC,eAAa,CAAI,CAAC,EAClD,CAAC,cAENnB,IAAA,CAACH,UAAU,EACT+B,QAAQ,CAAEpB,YAAa,CACvBF,YAAY,CAAEA,YAAa,CAC5B,CAAC,EACC,CAAC,CACI,CAAC,CAEjB,CAAC,CAED,cAAe,CAAAH,SAAS","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}