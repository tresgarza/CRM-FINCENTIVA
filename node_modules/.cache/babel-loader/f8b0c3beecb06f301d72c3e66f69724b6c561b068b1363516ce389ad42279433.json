{"ast":null,"code":"import React,{useEffect,useState}from'react';import{Pie}from'react-chartjs-2';import{Chart as ChartJS,ArcElement,Tooltip,Legend,Title}from'chart.js';import{STATUS_COLORS,STATUS_LABELS}from'../../../utils/constants/statuses';// Registrar componentes necesarios de Chart.js\nimport{jsx as _jsx}from\"react/jsx-runtime\";ChartJS.register(ArcElement,Tooltip,Legend,Title);const StatusDistributionChart=_ref=>{let{data,title='Distribución por Estado',height=240,showLegend=true,className=''}=_ref;const[chartData,setChartData]=useState({labels:[],datasets:[{data:[],backgroundColor:[],borderColor:[],borderWidth:1}]});useEffect(()=>{if(!data||data.length===0)return;// Agrupar estados similares\nconst groupedData={};data.forEach(item=>{// Normalizar el status para agrupar (pending, PENDING, Pendiente, etc.)\nlet normalizedStatus=item.status.toLowerCase();if(normalizedStatus.includes('pend')||normalizedStatus==='new'||normalizedStatus==='solicitud'||normalizedStatus==='simulación'){normalizedStatus='pending';}else if(normalizedStatus.includes('review')||normalizedStatus.includes('proceso')){normalizedStatus='in_review';}else if(normalizedStatus.includes('apro')){normalizedStatus='approved';}else if(normalizedStatus.includes('recha')){normalizedStatus='rejected';}else if(normalizedStatus.includes('comple')){normalizedStatus='completed';}else if(normalizedStatus.includes('cancel')){normalizedStatus='cancelled';}else if(normalizedStatus.includes('disper')){normalizedStatus='por_dispersar';}if(!groupedData[normalizedStatus]){groupedData[normalizedStatus]=0;}groupedData[normalizedStatus]+=item.count;});// Crear arrays para el gráfico\nconst statuses=Object.keys(groupedData);const counts=Object.values(groupedData);// Usar colores y etiquetas definidos en constantes\nconst colors=statuses.map(status=>{const colorKey=status.toUpperCase();return STATUS_COLORS[colorKey]||'#cccccc';});const labels=statuses.map(status=>{const labelKey=status.toUpperCase();return STATUS_LABELS[labelKey]||status;});setChartData({labels,datasets:[{data:counts,backgroundColor:colors,borderColor:colors.map(color=>color),borderWidth:1}]});},[data]);const options={responsive:true,maintainAspectRatio:false,plugins:{legend:{display:showLegend,position:'right',labels:{boxWidth:15,padding:15,font:{size:12}}},title:{display:!!title,text:title,font:{size:16}},tooltip:{callbacks:{label:context=>{const label=context.label||'';const value=context.raw||0;const total=context.chart.data.datasets[0].data.reduce((a,b)=>a+b,0);const percentage=Math.round(value/total*100);return`${label}: ${value} (${percentage}%)`;}}}}};return/*#__PURE__*/_jsx(\"div\",{className:`chart-container ${className}`,style:{height:`${height}px`},children:data&&data.length>0?/*#__PURE__*/_jsx(Pie,{data:chartData,options:options}):/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center h-full bg-base-200 rounded-lg\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:\"Sin datos disponibles\"})})});};export default StatusDistributionChart;","map":{"version":3,"names":["React","useEffect","useState","Pie","Chart","ChartJS","ArcElement","Tooltip","Legend","Title","STATUS_COLORS","STATUS_LABELS","jsx","_jsx","register","StatusDistributionChart","_ref","data","title","height","showLegend","className","chartData","setChartData","labels","datasets","backgroundColor","borderColor","borderWidth","length","groupedData","forEach","item","normalizedStatus","status","toLowerCase","includes","count","statuses","Object","keys","counts","values","colors","map","colorKey","toUpperCase","labelKey","color","options","responsive","maintainAspectRatio","plugins","legend","display","position","boxWidth","padding","font","size","text","tooltip","callbacks","label","context","value","raw","total","chart","reduce","a","b","percentage","Math","round","style","children"],"sources":["/Users/diegogg98/NEW CRM MAR18/src/components/ui/charts/StatusDistributionChart.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { Pie } from 'react-chartjs-2';\nimport { Chart as ChartJS, ArcElement, Tooltip, Legend, Title } from 'chart.js';\nimport { STATUS_COLORS, STATUS_LABELS } from '../../../utils/constants/statuses';\n\n// Registrar componentes necesarios de Chart.js\nChartJS.register(ArcElement, Tooltip, Legend, Title);\n\ninterface StatusDistributionChartProps {\n  data: {\n    status: string;\n    count: number;\n  }[];\n  title?: string;\n  height?: number;\n  showLegend?: boolean;\n  className?: string;\n}\n\nconst StatusDistributionChart: React.FC<StatusDistributionChartProps> = ({\n  data,\n  title = 'Distribución por Estado',\n  height = 240,\n  showLegend = true,\n  className = '',\n}) => {\n  const [chartData, setChartData] = useState<any>({\n    labels: [],\n    datasets: [\n      {\n        data: [],\n        backgroundColor: [],\n        borderColor: [],\n        borderWidth: 1,\n      },\n    ],\n  });\n\n  useEffect(() => {\n    if (!data || data.length === 0) return;\n\n    // Agrupar estados similares\n    const groupedData: Record<string, number> = {};\n    \n    data.forEach((item) => {\n      // Normalizar el status para agrupar (pending, PENDING, Pendiente, etc.)\n      let normalizedStatus = item.status.toLowerCase();\n      \n      if (normalizedStatus.includes('pend') || normalizedStatus === 'new' || normalizedStatus === 'solicitud' || normalizedStatus === 'simulación') {\n        normalizedStatus = 'pending';\n      } else if (normalizedStatus.includes('review') || normalizedStatus.includes('proceso')) {\n        normalizedStatus = 'in_review';\n      } else if (normalizedStatus.includes('apro')) {\n        normalizedStatus = 'approved';\n      } else if (normalizedStatus.includes('recha')) {\n        normalizedStatus = 'rejected';\n      } else if (normalizedStatus.includes('comple')) {\n        normalizedStatus = 'completed';\n      } else if (normalizedStatus.includes('cancel')) {\n        normalizedStatus = 'cancelled';\n      } else if (normalizedStatus.includes('disper')) {\n        normalizedStatus = 'por_dispersar';\n      }\n      \n      if (!groupedData[normalizedStatus]) {\n        groupedData[normalizedStatus] = 0;\n      }\n      groupedData[normalizedStatus] += item.count;\n    });\n    \n    // Crear arrays para el gráfico\n    const statuses = Object.keys(groupedData);\n    const counts = Object.values(groupedData);\n    \n    // Usar colores y etiquetas definidos en constantes\n    const colors = statuses.map(status => {\n      const colorKey = status.toUpperCase() as keyof typeof STATUS_COLORS;\n      return STATUS_COLORS[colorKey] || '#cccccc';\n    });\n    \n    const labels = statuses.map(status => {\n      const labelKey = status.toUpperCase() as keyof typeof STATUS_LABELS;\n      return STATUS_LABELS[labelKey] || status;\n    });\n    \n    setChartData({\n      labels,\n      datasets: [\n        {\n          data: counts,\n          backgroundColor: colors,\n          borderColor: colors.map(color => color),\n          borderWidth: 1,\n        },\n      ],\n    });\n  }, [data]);\n\n  const options = {\n    responsive: true,\n    maintainAspectRatio: false,\n    plugins: {\n      legend: {\n        display: showLegend,\n        position: 'right' as const,\n        labels: {\n          boxWidth: 15,\n          padding: 15,\n          font: {\n            size: 12,\n          },\n        },\n      },\n      title: {\n        display: !!title,\n        text: title,\n        font: {\n          size: 16,\n        },\n      },\n      tooltip: {\n        callbacks: {\n          label: (context: any) => {\n            const label = context.label || '';\n            const value = context.raw || 0;\n            const total = context.chart.data.datasets[0].data.reduce((a: number, b: number) => a + b, 0);\n            const percentage = Math.round((value / total) * 100);\n            return `${label}: ${value} (${percentage}%)`;\n          },\n        },\n      },\n    },\n  };\n\n  return (\n    <div className={`chart-container ${className}`} style={{ height: `${height}px` }}>\n      {data && data.length > 0 ? (\n        <Pie data={chartData} options={options} />\n      ) : (\n        <div className=\"flex items-center justify-center h-full bg-base-200 rounded-lg\">\n          <p className=\"text-sm text-gray-500\">Sin datos disponibles</p>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default StatusDistributionChart; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}