{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import DocumentUploader from'../documents/DocumentUploader';import{useAuth}from'../../contexts/AuthContext';import{executeQuery}from'../../services/mcpService';// Interfaz para documentos\n// Props para el componente\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";// Categor칤as de documentos predefinidas\nconst DOCUMENT_CATEGORIES=[{value:'identificacion',label:'Identificaci칩n Oficial'},{value:'comprobante_domicilio',label:'Comprobante de Domicilio'},{value:'comprobante_ingresos',label:'Comprobante de Ingresos'},{value:'estados_cuenta',label:'Estados de Cuenta Bancarios'},{value:'rfc',label:'Constancia de Situaci칩n Fiscal (RFC)'},{value:'curp',label:'CURP'},{value:'otros',label:'Otros Documentos'}];// Tipos de empleo\nconst EMPLOYMENT_TYPES=[{value:'empleado',label:'Empleado'},{value:'autonomo',label:'Aut칩nomo / Freelance'},{value:'empresario',label:'Empresario'},{value:'jubilado',label:'Jubilado'},{value:'desempleado',label:'Desempleado'},{value:'estudiante',label:'Estudiante'},{value:'otro',label:'Otro'}];// Estados civiles\nconst MARITAL_STATUS_TYPES=[{value:'soltero',label:'Soltero/a'},{value:'casado',label:'Casado/a'},{value:'divorciado',label:'Divorciado/a'},{value:'viudo',label:'Viudo/a'},{value:'union_libre',label:'Uni칩n Libre'}];// Tipos de cuenta bancaria\nconst BANK_ACCOUNT_TYPES=[{value:'nomina',label:'N칩mina'},{value:'ahorro',label:'Ahorro'},{value:'cheques',label:'Cheques'},{value:'inversiones',label:'Inversiones'}];const ClientForm=_ref=>{let{initialData={},onSubmit,onSavePartial,isSubmitting}=_ref;const navigate=useNavigate();const{user}=useAuth();// Estado para los datos del formulario\nconst[formData,setFormData]=useState({first_name:'',paternal_surname:'',maternal_surname:'',email:'',phone:'',address:'',city:'',state:'',postal_code:'',birth_date:'',gender:'',marital_status:'',employment_type:'',employment_years:undefined,rfc:'',curp:'',monthly_income:undefined,additional_income:undefined,monthly_expenses:undefined,other_loan_balances:undefined,bank_name:'',bank_clabe:'',bank_account_number:'',bank_account_type:'',bank_account_origin:'',company_id:'',...initialData});// Estado para errores de validaci칩n\nconst[errors,setErrors]=useState({});// Estado para documentos\nconst[documents,setDocuments]=useState([]);// Estado para el paso actual del formulario\nconst[currentStep,setCurrentStep]=useState(1);// Estado para empresas\nconst[companies,setCompanies]=useState([]);const[loadingCompanies,setLoadingCompanies]=useState(true);// Calcular el progreso de llenado de formulario\nconst calculateProgress=()=>{let filledFields=0;let totalFields=0;// Paso 1: Datos Personales B치sicos\nconst step1Fields=['first_name','paternal_surname','maternal_surname','email','phone','rfc','curp','birth_date','gender','marital_status','address','city','state','postal_code','company_id'];totalFields+=step1Fields.length;filledFields+=step1Fields.filter(field=>formData[field]).length;// Paso 2: Detalles Financieros\nconst step2Fields=['employment_type','employment_years','monthly_income','additional_income','monthly_expenses','other_loan_balances'];totalFields+=step2Fields.length;filledFields+=step2Fields.filter(field=>formData[field]!==undefined&&formData[field]!=='').length;// Paso 3: Datos Bancarios\nconst step3Fields=['bank_name','bank_clabe','bank_account_number','bank_account_type','bank_account_origin'];totalFields+=step3Fields.length;filledFields+=step3Fields.filter(field=>formData[field]).length;// Calcular porcentaje\nreturn Math.round(filledFields/totalFields*100);};// State for progress\nconst[progress,setProgress]=useState(()=>calculateProgress());// Update progress when form data changes\nuseEffect(()=>{setProgress(calculateProgress());},[formData]);// Fetch companies on component mount\nuseEffect(()=>{const fetchCompanies=async()=>{try{console.log('Obteniendo lista de empresas...');setLoadingCompanies(true);const response=await executeQuery('SELECT id, name FROM companies ORDER BY name ASC');console.log('Respuesta de empresas:',response);if(response&&response.data){setCompanies(response.data);console.log('Empresas cargadas:',response.data.length);}else{console.error('No se pudieron cargar las empresas');}}catch(err){console.error('Error al cargar empresas:',err);}finally{setLoadingCompanies(false);}};fetchCompanies();},[]);// Manejar cambios en el formulario\nconst handleChange=e=>{const{name,value,type}=e.target;// Convertir a n칰mero si es un campo num칠rico\nif(type==='number'){setFormData(prev=>({...prev,[name]:value===''?undefined:parseFloat(value)}));}else{setFormData(prev=>({...prev,[name]:value}));}// Limpiar error si existe\nif(errors[name]){setErrors(prev=>{const newErrors={...prev};delete newErrors[name];return newErrors;});}};// Manejar documentos agregados\nconst handleDocumentAdded=document=>{setDocuments(prev=>[...prev,document]);};// Manejar documentos eliminados\nconst handleDocumentRemoved=index=>{setDocuments(prev=>prev.filter((_,i)=>i!==index));};// Handle company selection\nconst handleCompanyChange=e=>{const{value}=e.target;console.log('Empresa seleccionada:',value);setFormData(prev=>({...prev,company_id:value}));if(errors.company_id){setErrors(prev=>{const newErrors={...prev};delete newErrors.company_id;return newErrors;});}};// Validar datos antes de enviar\nconst validateForm=()=>{var _formData$first_name,_formData$paternal_su;const newErrors={};// Validar campos obligatorios solo para el paso 1 (datos personales b치sicos)\nif(!((_formData$first_name=formData.first_name)!==null&&_formData$first_name!==void 0&&_formData$first_name.trim())){newErrors.first_name='El nombre es obligatorio';}if(!((_formData$paternal_su=formData.paternal_surname)!==null&&_formData$paternal_su!==void 0&&_formData$paternal_su.trim())){newErrors.paternal_surname='El apellido paterno es obligatorio';}// Validate company_id is selected\nif(!formData.company_id){newErrors.company_id='Debe seleccionar una empresa';}// Validar formato de email solo si se ha ingresado algo\nif(formData.email&&!/\\S+@\\S+\\.\\S+/.test(formData.email)){newErrors.email='El correo electr칩nico no es v치lido';}// Validar RFC solo si se ha ingresado algo\nif(formData.rfc&&!/^([A-Z칌&]{3,4})(\\d{6})([A-Z\\d]{3})$/.test(formData.rfc.toUpperCase())){newErrors.rfc='El RFC no tiene un formato v치lido';}// Validar CURP solo si se ha ingresado algo\nif(formData.curp&&!/^([A-Z][AEIOUX][A-Z]{2}\\d{2}(?:0[1-9]|1[0-2])(?:0[1-9]|[12]\\d|3[01])[HM](?:AS|B[CS]|C[CLMSH]|D[FG]|G[TR]|HG|JC|M[CNS]|N[ETL]|OC|PL|Q[TR]|S[PLR]|T[CSL]|VZ|YN|ZS)[B-DF-HJ-NP-TV-Z]{3}[A-Z\\d])(\\d)$/.test(formData.curp.toUpperCase())){newErrors.curp='La CURP no tiene un formato v치lido';}// Validar CLABE solo si se ha ingresado algo\nif(formData.bank_clabe&&!/^\\d{18}$/.test(formData.bank_clabe)){newErrors.bank_clabe='La CLABE debe tener 18 d칤gitos';}// Establecer errores\nsetErrors(newErrors);// Solo requerimos que los campos de nombre y apellido paterno est칠n completos para el env칤o\nreturn!newErrors.first_name&&!newErrors.paternal_surname;};// Validar solo los campos relevantes para el paso actual\nconst validateCurrentStep=()=>{console.log('游댌 Validando paso actual:',currentStep);console.log('游댌 Datos actuales:',formData);const newErrors={};if(currentStep===1){var _formData$first_name2,_formData$paternal_su2;// Validar que se haya seleccionado una empresa\nif(!formData.company_id){newErrors.company_id='Debe seleccionar una empresa';console.log('游댌 Error: No se ha seleccionado empresa');}// Validar campos obligatorios\nif(!((_formData$first_name2=formData.first_name)!==null&&_formData$first_name2!==void 0&&_formData$first_name2.trim())){newErrors.first_name='El nombre es obligatorio';console.log('游댌 Error: Nombre obligatorio no proporcionado');}if(!((_formData$paternal_su2=formData.paternal_surname)!==null&&_formData$paternal_su2!==void 0&&_formData$paternal_su2.trim())){newErrors.paternal_surname='El apellido paterno es obligatorio';console.log('游댌 Error: Apellido paterno obligatorio no proporcionado');}// Validar email, RFC y CURP solo si se han ingresado\nif(formData.email&&!/\\S+@\\S+\\.\\S+/.test(formData.email)){newErrors.email='El correo electr칩nico no es v치lido';}if(formData.rfc&&!/^([A-Z칌&]{3,4})(\\d{6})([A-Z\\d]{3})$/.test(formData.rfc.toUpperCase())){newErrors.rfc='El RFC no tiene un formato v치lido';}if(formData.curp&&!/^([A-Z][AEIOUX][A-Z]{2}\\d{2}(?:0[1-9]|1[0-2])(?:0[1-9]|[12]\\d|3[01])[HM](?:AS|B[CS]|C[CLMSH]|D[FG]|G[TR]|HG|JC|M[CNS]|N[ETL]|OC|PL|Q[TR]|S[PLR]|T[CSL]|VZ|YN|ZS)[B-DF-HJ-NP-TV-Z]{3}[A-Z\\d])(\\d)$/.test(formData.curp.toUpperCase())){newErrors.curp='La CURP no tiene un formato v치lido';}}else if(currentStep===3){// Validar CLABE solo si se ha ingresado\nif(formData.bank_clabe&&!/^\\d{18}$/.test(formData.bank_clabe)){newErrors.bank_clabe='La CLABE debe tener 18 d칤gitos';}}console.log('游댌 Errores de validaci칩n:',newErrors);setErrors(newErrors);return Object.keys(newErrors).length===0;};// Manejar env칤o del formulario\nconst handleSubmit=async e=>{var _formData$first_name3,_formData$paternal_su3;e.preventDefault();console.log('游댌 [ClientForm] Iniciando env칤o completo del formulario');console.log('游댌 [ClientForm] Datos a enviar:',formData);// Only validate first name and paternal surname\nconst nameErrors={};if(!((_formData$first_name3=formData.first_name)!==null&&_formData$first_name3!==void 0&&_formData$first_name3.trim())){nameErrors['first_name']='El nombre es obligatorio';}if(!((_formData$paternal_su3=formData.paternal_surname)!==null&&_formData$paternal_su3!==void 0&&_formData$paternal_su3.trim())){nameErrors['paternal_surname']='El apellido paterno es obligatorio';}if(Object.keys(nameErrors).length>0){setErrors(nameErrors);alert('Por favor, completa al menos el nombre y apellido paterno para guardar');setCurrentStep(1);// Go back to personal data section\nreturn;}try{// Process form data to ensure numeric fields are correctly formatted\nconst processedData={...formData};// Ensure numeric fields are properly converted to numbers\nif(processedData.employment_years!==undefined&&processedData.employment_years!==null){if(typeof processedData.employment_years==='string'){processedData.employment_years=parseInt(processedData.employment_years,10);console.log('游댌 [ClientForm] Converted employment_years to number:',processedData.employment_years);}}// Convert other numeric fields if they're strings\n['monthly_income','additional_income','monthly_expenses','other_loan_balances'].forEach(field=>{const key=field;if(processedData[key]!==undefined&&processedData[key]!==null){if(typeof processedData[key]==='string'){processedData[key]=parseFloat(processedData[key]);console.log(`游댌 [ClientForm] Converted ${field} to number:`,processedData[key]);}}});console.log('游댌 [ClientForm] Enviando datos procesados:',processedData);// Show loader during submission\nawait onSubmit(processedData,documents);console.log('游댌 [ClientForm] Formulario enviado exitosamente');// Clean up localStorage on successful submission\nlocalStorage.removeItem('clientFormData');localStorage.removeItem('clientFormStep');console.log('游댌 [ClientForm] Datos de localStorage limpiados despu칠s de env칤o exitoso');}catch(error){console.error('游댌 [ClientForm] Error al guardar cliente:',error);alert(`Error al guardar: ${error.message||'Error desconocido'}`);}};// Avanzar al siguiente paso\nconst nextStep=()=>{// Always allow navigation forward regardless of validation\nif(currentStep<4){// Save the current state to localStorage for recovery in case of crash\ntry{localStorage.setItem('clientFormData',JSON.stringify(formData));localStorage.setItem('clientFormStep',String(currentStep+1));}catch(err){console.error('Error saving form state:',err);}setCurrentStep(prev=>prev+1);}};// Try to recover form data on component mount\nuseEffect(()=>{console.log('游댌 [ClientForm] Inicializando formulario con datos iniciales:',initialData);try{// First set the form with initial data from the database\n// Deep copy initialData to avoid reference issues\nconst initialFormData={...initialData};// Debug numeric fields to ensure they are correct\nif(initialFormData.employment_years!==undefined){console.log('游댌 [ClientForm] employment_years tipo:',typeof initialFormData.employment_years,'valor:',initialFormData.employment_years);}if(initialFormData.monthly_income!==undefined){console.log('游댌 [ClientForm] monthly_income tipo:',typeof initialFormData.monthly_income,'valor:',initialFormData.monthly_income);}// Initialize form with initialData from server\nsetFormData(initialFormData);// Then check for saved data in localStorage - only if we're in edit mode\nif(initialData.id){const savedData=localStorage.getItem('clientFormData');const savedStep=localStorage.getItem('clientFormStep');console.log('游댌 [ClientForm] Datos guardados en localStorage:',savedData);console.log('游댌 [ClientForm] Paso guardado en localStorage:',savedStep);// Only use localStorage data if we're editing the same client\nif(savedData){try{const parsedData=JSON.parse(savedData);console.log('游댌 [ClientForm] Aplicando datos de localStorage sobre datos iniciales:',parsedData);// Make sure we're only loading localStorage data for the correct client\nif(parsedData.id===initialData.id){console.log('游댌 [ClientForm] ID coincide, aplicando datos de localStorage');// Update the form data with saved data\nsetFormData(current=>{const mergedData={...current,...parsedData};console.log('游댌 [ClientForm] Datos finales despu칠s de fusionar:',mergedData);return mergedData;});// Set the current step\nif(savedStep){const step=parseInt(savedStep,10);if(step>0&&step<=4){console.log('游댌 [ClientForm] Estableciendo paso actual a:',step);setCurrentStep(step);}}}else{console.log('游댌 [ClientForm] ID no coincide, ignorando datos de localStorage');// Clear localStorage since we're editing a different client\nlocalStorage.removeItem('clientFormData');localStorage.removeItem('clientFormStep');}}catch(parseError){console.error('Error parsing saved form data:',parseError);// Clear potentially corrupted localStorage data\nlocalStorage.removeItem('clientFormData');localStorage.removeItem('clientFormStep');}}}}catch(err){console.error('Error recovering form state:',err);setCurrentStep(1);}// Calculate initial progress\nsetProgress(calculateProgress());},[initialData]);// Save current section and exit\nconst handleSaveAndExit=async()=>{try{// Log the saving attempt\nconsole.log(`Saving client data at step ${currentStep} and exiting...`);console.log('Form data being saved:',formData);// Show saving indicator\nsetSectionSubmitting(true);if(onSavePartial){const result=await onSavePartial(formData,currentStep);console.log(`Successfully saved data for section ${currentStep}`,result);// Update form data with the result to ensure consistency\nif(result){setFormData(prevData=>({...prevData,...result}));// Give visual feedback before navigating away\nsetTimeout(()=>{// Clear local storage after successful save\nlocalStorage.removeItem('clientFormData');localStorage.removeItem('clientFormStep');// Navigate back to clients list\nnavigate('/clients');},1000);}}else{// Fallback to full save if partial saving not provided\nawait onSubmit(formData,documents);console.log('Successfully saved all client data');// Clear local storage after successful save\nlocalStorage.removeItem('clientFormData');localStorage.removeItem('clientFormStep');// Navigate back to clients list\nnavigate('/clients');}}catch(error){console.error(`Error saving client data at step ${currentStep}:`,error);// Create a more detailed error message for the user\nlet errorMessage='Error al guardar: ';if(error.message){errorMessage+=error.message;}else if(error.code){errorMessage+=`Error de base de datos (${error.code})`;}else{errorMessage+='Error desconocido al guardar los datos';}alert(errorMessage);}finally{setSectionSubmitting(false);}};// Handle save and continue action \nconst handleSaveAndContinue=async()=>{if(currentStep>=4)return;try{console.log(`游댌 [ClientForm] Iniciando guardado del paso ${currentStep} y continuando...`);console.log('游댌 [ClientForm] Datos actuales del formulario:',formData);// Validate current step\nif(!validateCurrentStep()){console.log('游댌 [ClientForm] Validaci칩n fallida para el paso actual');return;}// Show saving indicator\nsetSectionSubmitting(true);if(onSavePartial){console.log('游댌 [ClientForm] Llamando a onSavePartial con datos:',formData);// Save the data for the current step\nconst result=await onSavePartial(formData,currentStep);console.log(`游댌 [ClientForm] Datos guardados para secci칩n ${currentStep}, resultado:`,result);// Update form data with the result to ensure consistency\nif(result){setFormData(prevData=>{const updatedData={...prevData,...result};console.log('游댌 [ClientForm] Formulario actualizado con datos del servidor:',updatedData);return updatedData;});}}// Save current state to localStorage\ntry{localStorage.setItem('clientFormData',JSON.stringify(formData));localStorage.setItem('clientFormStep',String(currentStep+1));console.log('游댌 [ClientForm] Guardado en localStorage - pr칩ximo paso:',currentStep+1);}catch(err){console.error('Error saving form state:',err);}// Continue to next step\nsetCurrentStep(prev=>{const nextStep=prev+1;console.log('游댌 [ClientForm] Avanzando al paso:',nextStep);return nextStep;});}catch(error){console.error(`游댌 [ClientForm] Error guardando datos del paso ${currentStep}:`,error);alert(`Error al guardar: ${error.message||'Error desconocido'}`);}finally{setSectionSubmitting(false);}};// Retroceder al paso anterior con m치s logs\nconst prevStep=()=>{console.log('游댌 Intentando retroceder del paso',currentStep);if(currentStep>1){// Guardar estado actual en localStorage con el paso anterior\ntry{localStorage.setItem('clientFormData',JSON.stringify(formData));localStorage.setItem('clientFormStep',String(currentStep-1));console.log('游댌 Actualizando localStorage con paso anterior:',currentStep-1);}catch(err){console.error('Error guardando estado del formulario:',err);}// Establecer el paso anterior\nsetCurrentStep(prev=>{const newStep=prev-1;console.log('游댌 Estableciendo nuevo paso:',newStep);return newStep;});}else{console.log('游댌 Ya estamos en el primer paso, no se puede retroceder m치s');}};// Add a state for section saving\nconst[sectionSubmitting,setSectionSubmitting]=useState(false);// Funci칩n para reiniciar el formulario\nconst resetForm=()=>{console.log('游댌 Reiniciando formulario...');// Limpiar localStorage\nlocalStorage.removeItem('clientFormData');localStorage.removeItem('clientFormStep');// Resetear el formulario al estado inicial\nsetFormData({first_name:'',paternal_surname:'',maternal_surname:'',email:'',phone:'',address:'',city:'',state:'',postal_code:'',birth_date:'',gender:'',marital_status:'',employment_type:'',employment_years:undefined,rfc:'',curp:'',monthly_income:undefined,additional_income:undefined,monthly_expenses:undefined,other_loan_balances:undefined,bank_name:'',bank_clabe:'',bank_account_number:'',bank_account_type:'',bank_account_origin:'',company_id:'',...initialData});// Volver al paso 1\nsetCurrentStep(1);// Limpiar errores\nsetErrors({});console.log('游댌 Formulario reiniciado correctamente');};// Renderizado condicional de pasos\nconst renderStep=()=>{console.log('游댌 [ClientForm] Renderizando paso',currentStep,'con datos:',formData);console.log('Empresas disponibles:',companies.length);switch(currentStep){case 1:console.log('游댌 ClientForm: Entrando en caso 1 - Datos Personales');return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-bold\",children:\"Datos Personales\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-control\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"label-text\",children:[\"Empresa \",/*#__PURE__*/_jsx(\"span\",{className:\"text-error\",children:\"*\"})]})}),/*#__PURE__*/_jsxs(\"select\",{name:\"company_id\",value:formData.company_id||'',onChange:handleCompanyChange,className:`select select-bordered w-full ${errors.company_id?'select-error':''}`,disabled:loadingCompanies,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Seleccionar empresa\"}),companies.map(company=>/*#__PURE__*/_jsx(\"option\",{value:company.id,children:company.name},company.id))]}),errors.company_id&&/*#__PURE__*/_jsx(\"span\",{className:\"text-error text-sm mt-1\",children:errors.company_id}),loadingCompanies&&/*#__PURE__*/_jsx(\"span\",{className:\"text-sm mt-1\",children:\"Cargando empresas...\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-control\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"label-text\",children:[\"Nombre(s) \",/*#__PURE__*/_jsx(\"span\",{className:\"text-error\",children:\"*\"})]})}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"first_name\",className:`input input-bordered w-full ${errors.first_name?'input-error':''}`,value:formData.first_name||'',onChange:handleChange,placeholder:\"Nombre(s)\"}),errors.first_name&&/*#__PURE__*/_jsx(\"span\",{className:\"text-error text-sm mt-1\",children:errors.first_name})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-control\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"label-text\",children:[\"Apellido Paterno \",/*#__PURE__*/_jsx(\"span\",{className:\"text-error\",children:\"*\"})]})}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"paternal_surname\",className:`input input-bordered w-full ${errors.paternal_surname?'input-error':''}`,value:formData.paternal_surname||'',onChange:handleChange,placeholder:\"Apellido Paterno\"}),errors.paternal_surname&&/*#__PURE__*/_jsx(\"span\",{className:\"text-error text-sm mt-1\",children:errors.paternal_surname})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-control\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:/*#__PURE__*/_jsx(\"span\",{className:\"label-text\",children:\"Apellido Materno\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"maternal_surname\",className:\"input input-bordered w-full\",value:formData.maternal_surname||'',onChange:handleChange,placeholder:\"Apellido Materno\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-control\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:/*#__PURE__*/_jsx(\"span\",{className:\"label-text\",children:\"Correo Electr\\xF3nico\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",name:\"email\",className:`input input-bordered w-full ${errors.email?'input-error':''}`,value:formData.email||'',onChange:handleChange,placeholder:\"correo@ejemplo.com\"}),errors.email&&/*#__PURE__*/_jsx(\"span\",{className:\"text-error text-sm mt-1\",children:errors.email})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-control\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:/*#__PURE__*/_jsx(\"span\",{className:\"label-text\",children:\"Tel\\xE9fono\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",name:\"phone\",className:\"input input-bordered w-full\",value:formData.phone||'',onChange:handleChange,placeholder:\"(123) 456-7890\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-control\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:/*#__PURE__*/_jsx(\"span\",{className:\"label-text\",children:\"RFC\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"rfc\",className:`input input-bordered w-full ${errors.rfc?'input-error':''}`,value:formData.rfc||'',onChange:handleChange,placeholder:\"ABCD123456XXX\"}),errors.rfc&&/*#__PURE__*/_jsx(\"span\",{className:\"text-error text-sm mt-1\",children:errors.rfc})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-control\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:/*#__PURE__*/_jsx(\"span\",{className:\"label-text\",children:\"CURP\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"curp\",className:`input input-bordered w-full ${errors.curp?'input-error':''}`,value:formData.curp||'',onChange:handleChange,placeholder:\"ABCD123456HDFXXX01\"}),errors.curp&&/*#__PURE__*/_jsx(\"span\",{className:\"text-error text-sm mt-1\",children:errors.curp})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-control\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:/*#__PURE__*/_jsx(\"span\",{className:\"label-text\",children:\"Fecha de Nacimiento\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"birth_date\",className:\"input input-bordered w-full\",value:formData.birth_date||'',onChange:handleChange})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-control\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:/*#__PURE__*/_jsx(\"span\",{className:\"label-text\",children:\"G\\xE9nero\"})}),/*#__PURE__*/_jsxs(\"select\",{name:\"gender\",className:\"select select-bordered w-full\",value:formData.gender||'',onChange:handleChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Seleccionar...\"}),/*#__PURE__*/_jsx(\"option\",{value:\"masculino\",children:\"Masculino\"}),/*#__PURE__*/_jsx(\"option\",{value:\"femenino\",children:\"Femenino\"}),/*#__PURE__*/_jsx(\"option\",{value:\"otro\",children:\"Otro\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-control\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:/*#__PURE__*/_jsx(\"span\",{className:\"label-text\",children:\"Estado Civil\"})}),/*#__PURE__*/_jsxs(\"select\",{name:\"marital_status\",className:\"select select-bordered w-full\",value:formData.marital_status||'',onChange:handleChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Seleccionar...\"}),MARITAL_STATUS_TYPES.map(option=>/*#__PURE__*/_jsx(\"option\",{value:option.value,children:option.label},option.value))]})]})]});case 2:return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold\",children:\"Detalles Financieros y Balance\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-control w-full\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:/*#__PURE__*/_jsx(\"span\",{className:\"label-text\",children:\"Tipo de Empleo\"})}),/*#__PURE__*/_jsxs(\"select\",{name:\"employment_type\",value:formData.employment_type||'',onChange:handleChange,className:`select select-bordered w-full ${errors.employment_type?'select-error':''}`,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Seleccionar tipo de empleo\"}),EMPLOYMENT_TYPES.map(option=>/*#__PURE__*/_jsx(\"option\",{value:option.value,children:option.label},option.value))]}),errors.employment_type&&/*#__PURE__*/_jsx(\"span\",{className:\"text-error text-xs mt-1\",children:errors.employment_type})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-control w-full\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:/*#__PURE__*/_jsx(\"span\",{className:\"label-text\",children:\"Antig\\xFCedad (a\\xF1os)\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"employment_years\",value:formData.employment_years||'',onChange:handleChange,className:`input input-bordered w-full ${errors.employment_years?'input-error':''}`,placeholder:\"A\\xF1os de antig\\xFCedad\",min:\"0\"}),errors.employment_years&&/*#__PURE__*/_jsx(\"span\",{className:\"text-error text-xs mt-1\",children:errors.employment_years})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-control w-full\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:/*#__PURE__*/_jsx(\"span\",{className:\"label-text\",children:\"Ingreso Mensual ($)\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"monthly_income\",value:formData.monthly_income||'',onChange:handleChange,className:`input input-bordered w-full ${errors.monthly_income?'input-error':''}`,placeholder:\"0.00\",min:\"0\",step:\"0.01\"}),errors.monthly_income&&/*#__PURE__*/_jsx(\"span\",{className:\"text-error text-xs mt-1\",children:errors.monthly_income})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-control w-full\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:/*#__PURE__*/_jsx(\"span\",{className:\"label-text\",children:\"Ingresos Adicionales ($)\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"additional_income\",value:formData.additional_income||'',onChange:handleChange,className:`input input-bordered w-full ${errors.additional_income?'input-error':''}`,placeholder:\"0.00\",min:\"0\",step:\"0.01\"}),errors.additional_income&&/*#__PURE__*/_jsx(\"span\",{className:\"text-error text-xs mt-1\",children:errors.additional_income})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-control w-full\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:/*#__PURE__*/_jsx(\"span\",{className:\"label-text\",children:\"Gastos Mensuales ($)\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"monthly_expenses\",value:formData.monthly_expenses||'',onChange:handleChange,className:`input input-bordered w-full ${errors.monthly_expenses?'input-error':''}`,placeholder:\"0.00\",min:\"0\",step:\"0.01\"}),errors.monthly_expenses&&/*#__PURE__*/_jsx(\"span\",{className:\"text-error text-xs mt-1\",children:errors.monthly_expenses})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-control w-full\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:/*#__PURE__*/_jsx(\"span\",{className:\"label-text\",children:\"Saldos de Otros Cr\\xE9ditos ($)\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"other_loan_balances\",value:formData.other_loan_balances||'',onChange:handleChange,className:`input input-bordered w-full ${errors.other_loan_balances?'input-error':''}`,placeholder:\"0.00\",min:\"0\",step:\"0.01\"}),errors.other_loan_balances&&/*#__PURE__*/_jsx(\"span\",{className:\"text-error text-xs mt-1\",children:errors.other_loan_balances})]})]})]});case 3:return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold\",children:\"Datos de la Cuenta Bancaria\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-control w-full\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:/*#__PURE__*/_jsx(\"span\",{className:\"label-text\",children:\"Banco\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"bank_name\",value:formData.bank_name||'',onChange:handleChange,className:`input input-bordered w-full ${errors.bank_name?'input-error':''}`,placeholder:\"Nombre del banco\"}),errors.bank_name&&/*#__PURE__*/_jsx(\"span\",{className:\"text-error text-xs mt-1\",children:errors.bank_name})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-control w-full\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:/*#__PURE__*/_jsx(\"span\",{className:\"label-text\",children:\"CLABE\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"bank_clabe\",value:formData.bank_clabe||'',onChange:handleChange,className:`input input-bordered w-full ${errors.bank_clabe?'input-error':''}`,placeholder:\"18 d\\xEDgitos\"}),errors.bank_clabe&&/*#__PURE__*/_jsx(\"span\",{className:\"text-error text-xs mt-1\",children:errors.bank_clabe})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-control w-full\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:/*#__PURE__*/_jsx(\"span\",{className:\"label-text\",children:\"N\\xFAmero de Cuenta\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"bank_account_number\",value:formData.bank_account_number||'',onChange:handleChange,className:`input input-bordered w-full ${errors.bank_account_number?'input-error':''}`,placeholder:\"N\\xFAmero de cuenta\"}),errors.bank_account_number&&/*#__PURE__*/_jsx(\"span\",{className:\"text-error text-xs mt-1\",children:errors.bank_account_number})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-control w-full\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:/*#__PURE__*/_jsx(\"span\",{className:\"label-text\",children:\"Tipo de Cuenta\"})}),/*#__PURE__*/_jsxs(\"select\",{name:\"bank_account_type\",value:formData.bank_account_type||'',onChange:handleChange,className:`select select-bordered w-full ${errors.bank_account_type?'select-error':''}`,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Seleccionar tipo de cuenta\"}),BANK_ACCOUNT_TYPES.map(option=>/*#__PURE__*/_jsx(\"option\",{value:option.value,children:option.label},option.value))]}),errors.bank_account_type&&/*#__PURE__*/_jsx(\"span\",{className:\"text-error text-xs mt-1\",children:errors.bank_account_type})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-control w-full\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:/*#__PURE__*/_jsx(\"span\",{className:\"label-text\",children:\"Origen de la Cuenta (Estado)\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"bank_account_origin\",value:formData.bank_account_origin||'',onChange:handleChange,className:`input input-bordered w-full ${errors.bank_account_origin?'input-error':''}`,placeholder:\"Estado donde se abri\\xF3 la cuenta\"}),errors.bank_account_origin&&/*#__PURE__*/_jsx(\"span\",{className:\"text-error text-xs mt-1\",children:errors.bank_account_origin})]})]})]});case 4:return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold\",children:\"Documentos\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:\"Sube los documentos del cliente. Todos los formatos son aceptados.\"}),/*#__PURE__*/_jsx(DocumentUploader,{categories:DOCUMENT_CATEGORIES,onDocumentAdded:handleDocumentAdded,onDocumentRemoved:handleDocumentRemoved,existingDocuments:documents,clientId:initialData===null||initialData===void 0?void 0:initialData.id})]});default:return null;}};return/*#__PURE__*/_jsxs(\"div\",{className:\"p-2 md:p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-full mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm font-medium text-gray-500 mb-1\",children:[\"Completado: \",progress,\"%\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-gray-200 rounded-full h-2.5\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-primary h-2.5 rounded-full\",style:{width:`${progress}%`}})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-6\",children:/*#__PURE__*/_jsxs(\"ul\",{className:\"steps steps-horizontal w-full\",children:[/*#__PURE__*/_jsx(\"li\",{className:`step ${currentStep>=1?'step-primary':''}`,children:\"Datos Personales\"}),/*#__PURE__*/_jsx(\"li\",{className:`step ${currentStep>=2?'step-primary':''}`,children:\"Datos Financieros\"}),/*#__PURE__*/_jsx(\"li\",{className:`step ${currentStep>=3?'step-primary':''}`,children:\"Datos Bancarios\"}),/*#__PURE__*/_jsx(\"li\",{className:`step ${currentStep>=4?'step-primary':''}`,children:\"Documentos\"})]})}),Object.keys(errors).length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"alert alert-error mb-4\",id:\"error-message\",children:[/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"stroke-current shrink-0 h-6 w-6\",fill:\"none\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-bold\",children:\"Por favor corrige los siguientes errores:\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"list-disc ml-5 mt-1\",children:Object.entries(errors).map(_ref2=>{let[field,message]=_ref2;return/*#__PURE__*/_jsx(\"li\",{children:message},field);})})]})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[renderStep(),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap justify-between mt-6\",children:[currentStep>1&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-outline btn-primary\",onClick:prevStep,disabled:isSubmitting,children:\"Anterior\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2\",children:[currentStep===1&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-ghost\",onClick:()=>navigate('/clients'),disabled:isSubmitting,children:\"Cancelar\"}),currentStep>1&&currentStep<4&&onSavePartial&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-outline btn-secondary\",onClick:handleSaveAndExit,disabled:isSubmitting,children:isSubmitting?'Guardando...':'Guardar y Salir'}),currentStep<4&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-primary\",onClick:currentStep<3?handleSaveAndContinue:nextStep,disabled:isSubmitting,children:isSubmitting?'Guardando...':currentStep===3?'Siguiente':'Guardar y Continuar'}),currentStep===4&&/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-success\",disabled:isSubmitting,children:isSubmitting?'Guardando...':'Guardar Cliente'})]})]})]})]});};export default ClientForm;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","DocumentUploader","useAuth","executeQuery","jsx","_jsx","jsxs","_jsxs","DOCUMENT_CATEGORIES","value","label","EMPLOYMENT_TYPES","MARITAL_STATUS_TYPES","BANK_ACCOUNT_TYPES","ClientForm","_ref","initialData","onSubmit","onSavePartial","isSubmitting","navigate","user","formData","setFormData","first_name","paternal_surname","maternal_surname","email","phone","address","city","state","postal_code","birth_date","gender","marital_status","employment_type","employment_years","undefined","rfc","curp","monthly_income","additional_income","monthly_expenses","other_loan_balances","bank_name","bank_clabe","bank_account_number","bank_account_type","bank_account_origin","company_id","errors","setErrors","documents","setDocuments","currentStep","setCurrentStep","companies","setCompanies","loadingCompanies","setLoadingCompanies","calculateProgress","filledFields","totalFields","step1Fields","length","filter","field","step2Fields","step3Fields","Math","round","progress","setProgress","fetchCompanies","console","log","response","data","error","err","handleChange","e","name","type","target","prev","parseFloat","newErrors","handleDocumentAdded","document","handleDocumentRemoved","index","_","i","handleCompanyChange","validateForm","_formData$first_name","_formData$paternal_su","trim","test","toUpperCase","validateCurrentStep","_formData$first_name2","_formData$paternal_su2","Object","keys","handleSubmit","_formData$first_name3","_formData$paternal_su3","preventDefault","nameErrors","alert","processedData","parseInt","forEach","key","localStorage","removeItem","message","nextStep","setItem","JSON","stringify","String","initialFormData","id","savedData","getItem","savedStep","parsedData","parse","current","mergedData","step","parseError","handleSaveAndExit","setSectionSubmitting","result","prevData","setTimeout","errorMessage","code","handleSaveAndContinue","updatedData","prevStep","newStep","sectionSubmitting","resetForm","renderStep","className","children","onChange","disabled","map","company","placeholder","option","min","categories","onDocumentAdded","onDocumentRemoved","existingDocuments","clientId","style","width","xmlns","fill","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","entries","_ref2","onClick"],"sources":["/Users/diegogg98/NEW CRM MAR18/src/components/clients/ClientForm.tsx"],"sourcesContent":["import React, { FC, useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { Client } from '../../services/clientService';\nimport DocumentUploader from '../documents/DocumentUploader';\nimport { useAuth } from '../../contexts/AuthContext';\nimport { executeQuery } from '../../services/mcpService';\n\n// Interfaz para documentos\ninterface ClientDocument {\n  id?: string;\n  file: File;\n  category: string;\n  name: string;\n}\n\n// Props para el componente\ninterface ClientFormProps {\n  initialData?: Partial<Client>;\n  onSubmit: (data: Partial<Client>, documents: ClientDocument[]) => Promise<void>;\n  onSavePartial?: (data: Partial<Client>, step: number) => Promise<any>;\n  isSubmitting: boolean;\n}\n\n// Categor칤as de documentos predefinidas\nconst DOCUMENT_CATEGORIES = [\n  { value: 'identificacion', label: 'Identificaci칩n Oficial' },\n  { value: 'comprobante_domicilio', label: 'Comprobante de Domicilio' },\n  { value: 'comprobante_ingresos', label: 'Comprobante de Ingresos' },\n  { value: 'estados_cuenta', label: 'Estados de Cuenta Bancarios' },\n  { value: 'rfc', label: 'Constancia de Situaci칩n Fiscal (RFC)' },\n  { value: 'curp', label: 'CURP' },\n  { value: 'otros', label: 'Otros Documentos' },\n];\n\n// Tipos de empleo\nconst EMPLOYMENT_TYPES = [\n  { value: 'empleado', label: 'Empleado' },\n  { value: 'autonomo', label: 'Aut칩nomo / Freelance' },\n  { value: 'empresario', label: 'Empresario' },\n  { value: 'jubilado', label: 'Jubilado' },\n  { value: 'desempleado', label: 'Desempleado' },\n  { value: 'estudiante', label: 'Estudiante' },\n  { value: 'otro', label: 'Otro' },\n];\n\n// Estados civiles\nconst MARITAL_STATUS_TYPES = [\n  { value: 'soltero', label: 'Soltero/a' },\n  { value: 'casado', label: 'Casado/a' },\n  { value: 'divorciado', label: 'Divorciado/a' },\n  { value: 'viudo', label: 'Viudo/a' },\n  { value: 'union_libre', label: 'Uni칩n Libre' },\n];\n\n// Tipos de cuenta bancaria\nconst BANK_ACCOUNT_TYPES = [\n  { value: 'nomina', label: 'N칩mina' },\n  { value: 'ahorro', label: 'Ahorro' },\n  { value: 'cheques', label: 'Cheques' },\n  { value: 'inversiones', label: 'Inversiones' },\n];\n\nconst ClientForm: React.FC<ClientFormProps> = ({ initialData = {}, onSubmit, onSavePartial, isSubmitting }) => {\n  const navigate = useNavigate();\n  const { user } = useAuth();\n  \n  // Estado para los datos del formulario\n  const [formData, setFormData] = useState<Partial<Client>>({\n    first_name: '',\n    paternal_surname: '',\n    maternal_surname: '',\n    email: '',\n    phone: '',\n    address: '',\n    city: '',\n    state: '',\n    postal_code: '',\n    birth_date: '',\n    gender: '',\n    marital_status: '',\n    employment_type: '',\n    employment_years: undefined,\n    rfc: '',\n    curp: '',\n    monthly_income: undefined,\n    additional_income: undefined,\n    monthly_expenses: undefined,\n    other_loan_balances: undefined,\n    bank_name: '',\n    bank_clabe: '',\n    bank_account_number: '',\n    bank_account_type: '',\n    bank_account_origin: '',\n    company_id: '',\n    ...initialData,\n  });\n\n  // Estado para errores de validaci칩n\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  \n  // Estado para documentos\n  const [documents, setDocuments] = useState<ClientDocument[]>([]);\n  \n  // Estado para el paso actual del formulario\n  const [currentStep, setCurrentStep] = useState(1);\n  \n  // Estado para empresas\n  const [companies, setCompanies] = useState<{id: string, name: string}[]>([]);\n  const [loadingCompanies, setLoadingCompanies] = useState(true);\n  \n  // Calcular el progreso de llenado de formulario\n  const calculateProgress = () => {\n    let filledFields = 0;\n    let totalFields = 0;\n    \n    // Paso 1: Datos Personales B치sicos\n    const step1Fields = ['first_name', 'paternal_surname', 'maternal_surname', 'email', 'phone', 'rfc', 'curp', 'birth_date', 'gender', 'marital_status', 'address', 'city', 'state', 'postal_code', 'company_id'];\n    totalFields += step1Fields.length;\n    filledFields += step1Fields.filter(field => formData[field as keyof Partial<Client>]).length;\n    \n    // Paso 2: Detalles Financieros\n    const step2Fields = ['employment_type', 'employment_years', 'monthly_income', 'additional_income', 'monthly_expenses', 'other_loan_balances'];\n    totalFields += step2Fields.length;\n    filledFields += step2Fields.filter(field => formData[field as keyof Partial<Client>] !== undefined && formData[field as keyof Partial<Client>] !== '').length;\n    \n    // Paso 3: Datos Bancarios\n    const step3Fields = ['bank_name', 'bank_clabe', 'bank_account_number', 'bank_account_type', 'bank_account_origin'];\n    totalFields += step3Fields.length;\n    filledFields += step3Fields.filter(field => formData[field as keyof Partial<Client>]).length;\n    \n    // Calcular porcentaje\n    return Math.round((filledFields / totalFields) * 100);\n  };\n  \n  // State for progress\n  const [progress, setProgress] = useState(() => calculateProgress());\n  \n  // Update progress when form data changes\n  useEffect(() => {\n    setProgress(calculateProgress());\n  }, [formData]);\n  \n  // Fetch companies on component mount\n  useEffect(() => {\n    const fetchCompanies = async () => {\n      try {\n        console.log('Obteniendo lista de empresas...');\n        setLoadingCompanies(true);\n        \n        const response = await executeQuery('SELECT id, name FROM companies ORDER BY name ASC');\n        console.log('Respuesta de empresas:', response);\n        \n        if (response && response.data) {\n          setCompanies(response.data);\n          console.log('Empresas cargadas:', response.data.length);\n        } else {\n          console.error('No se pudieron cargar las empresas');\n        }\n      } catch (err) {\n        console.error('Error al cargar empresas:', err);\n      } finally {\n        setLoadingCompanies(false);\n      }\n    };\n\n    fetchCompanies();\n  }, []);\n  \n  // Manejar cambios en el formulario\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement>) => {\n    const { name, value, type } = e.target as HTMLInputElement;\n    \n    // Convertir a n칰mero si es un campo num칠rico\n    if (type === 'number') {\n      setFormData(prev => ({\n        ...prev,\n        [name]: value === '' ? undefined : parseFloat(value)\n      }));\n    } else {\n      setFormData(prev => ({\n        ...prev,\n        [name]: value\n      }));\n    }\n    \n    // Limpiar error si existe\n    if (errors[name]) {\n      setErrors(prev => {\n        const newErrors = { ...prev };\n        delete newErrors[name];\n        return newErrors;\n      });\n    }\n  };\n  \n  // Manejar documentos agregados\n  const handleDocumentAdded = (document: ClientDocument) => {\n    setDocuments(prev => [...prev, document]);\n  };\n  \n  // Manejar documentos eliminados\n  const handleDocumentRemoved = (index: number) => {\n    setDocuments(prev => prev.filter((_, i) => i !== index));\n  };\n  \n  // Handle company selection\n  const handleCompanyChange = (e: React.ChangeEvent<HTMLSelectElement>) => {\n    const { value } = e.target;\n    console.log('Empresa seleccionada:', value);\n    \n    setFormData(prev => ({\n      ...prev,\n      company_id: value\n    }));\n    \n    if (errors.company_id) {\n      setErrors(prev => {\n        const newErrors = { ...prev };\n        delete newErrors.company_id;\n        return newErrors;\n      });\n    }\n  };\n  \n  // Validar datos antes de enviar\n  const validateForm = () => {\n    const newErrors: Record<string, string> = {};\n    \n    // Validar campos obligatorios solo para el paso 1 (datos personales b치sicos)\n    if (!formData.first_name?.trim()) {\n      newErrors.first_name = 'El nombre es obligatorio';\n    }\n    \n    if (!formData.paternal_surname?.trim()) {\n      newErrors.paternal_surname = 'El apellido paterno es obligatorio';\n    }\n    \n    // Validate company_id is selected\n    if (!formData.company_id) {\n      newErrors.company_id = 'Debe seleccionar una empresa';\n    }\n    \n    // Validar formato de email solo si se ha ingresado algo\n    if (formData.email && !/\\S+@\\S+\\.\\S+/.test(formData.email)) {\n      newErrors.email = 'El correo electr칩nico no es v치lido';\n    }\n    \n    // Validar RFC solo si se ha ingresado algo\n    if (formData.rfc && !/^([A-Z칌&]{3,4})(\\d{6})([A-Z\\d]{3})$/.test(formData.rfc.toUpperCase())) {\n      newErrors.rfc = 'El RFC no tiene un formato v치lido';\n    }\n    \n    // Validar CURP solo si se ha ingresado algo\n    if (formData.curp && !/^([A-Z][AEIOUX][A-Z]{2}\\d{2}(?:0[1-9]|1[0-2])(?:0[1-9]|[12]\\d|3[01])[HM](?:AS|B[CS]|C[CLMSH]|D[FG]|G[TR]|HG|JC|M[CNS]|N[ETL]|OC|PL|Q[TR]|S[PLR]|T[CSL]|VZ|YN|ZS)[B-DF-HJ-NP-TV-Z]{3}[A-Z\\d])(\\d)$/.test(formData.curp.toUpperCase())) {\n      newErrors.curp = 'La CURP no tiene un formato v치lido';\n    }\n    \n    // Validar CLABE solo si se ha ingresado algo\n    if (formData.bank_clabe && !/^\\d{18}$/.test(formData.bank_clabe)) {\n      newErrors.bank_clabe = 'La CLABE debe tener 18 d칤gitos';\n    }\n    \n    // Establecer errores\n    setErrors(newErrors);\n    \n    // Solo requerimos que los campos de nombre y apellido paterno est칠n completos para el env칤o\n    return !newErrors.first_name && !newErrors.paternal_surname;\n  };\n  \n  // Validar solo los campos relevantes para el paso actual\n  const validateCurrentStep = () => {\n    console.log('游댌 Validando paso actual:', currentStep);\n    console.log('游댌 Datos actuales:', formData);\n    \n    const newErrors: Record<string, string> = {};\n    \n    if (currentStep === 1) {\n      // Validar que se haya seleccionado una empresa\n      if (!formData.company_id) {\n        newErrors.company_id = 'Debe seleccionar una empresa';\n        console.log('游댌 Error: No se ha seleccionado empresa');\n      }\n      \n      // Validar campos obligatorios\n      if (!formData.first_name?.trim()) {\n        newErrors.first_name = 'El nombre es obligatorio';\n        console.log('游댌 Error: Nombre obligatorio no proporcionado');\n      }\n      \n      if (!formData.paternal_surname?.trim()) {\n        newErrors.paternal_surname = 'El apellido paterno es obligatorio';\n        console.log('游댌 Error: Apellido paterno obligatorio no proporcionado');\n      }\n      \n      // Validar email, RFC y CURP solo si se han ingresado\n      if (formData.email && !/\\S+@\\S+\\.\\S+/.test(formData.email)) {\n        newErrors.email = 'El correo electr칩nico no es v치lido';\n      }\n      \n      if (formData.rfc && !/^([A-Z칌&]{3,4})(\\d{6})([A-Z\\d]{3})$/.test(formData.rfc.toUpperCase())) {\n        newErrors.rfc = 'El RFC no tiene un formato v치lido';\n      }\n      \n      if (formData.curp && !/^([A-Z][AEIOUX][A-Z]{2}\\d{2}(?:0[1-9]|1[0-2])(?:0[1-9]|[12]\\d|3[01])[HM](?:AS|B[CS]|C[CLMSH]|D[FG]|G[TR]|HG|JC|M[CNS]|N[ETL]|OC|PL|Q[TR]|S[PLR]|T[CSL]|VZ|YN|ZS)[B-DF-HJ-NP-TV-Z]{3}[A-Z\\d])(\\d)$/.test(formData.curp.toUpperCase())) {\n        newErrors.curp = 'La CURP no tiene un formato v치lido';\n      }\n    } else if (currentStep === 3) {\n      // Validar CLABE solo si se ha ingresado\n      if (formData.bank_clabe && !/^\\d{18}$/.test(formData.bank_clabe)) {\n        newErrors.bank_clabe = 'La CLABE debe tener 18 d칤gitos';\n      }\n    }\n    \n    console.log('游댌 Errores de validaci칩n:', newErrors);\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n  \n  // Manejar env칤o del formulario\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    console.log('游댌 [ClientForm] Iniciando env칤o completo del formulario');\n    console.log('游댌 [ClientForm] Datos a enviar:', formData);\n    \n    // Only validate first name and paternal surname\n    const nameErrors: Record<string, string> = {};\n    if (!formData.first_name?.trim()) {\n      nameErrors['first_name'] = 'El nombre es obligatorio';\n    }\n    \n    if (!formData.paternal_surname?.trim()) {\n      nameErrors['paternal_surname'] = 'El apellido paterno es obligatorio';\n    }\n    \n    if (Object.keys(nameErrors).length > 0) {\n      setErrors(nameErrors);\n      alert('Por favor, completa al menos el nombre y apellido paterno para guardar');\n      setCurrentStep(1); // Go back to personal data section\n      return;\n    }\n    \n    try {\n      // Process form data to ensure numeric fields are correctly formatted\n      const processedData = {...formData};\n      \n      // Ensure numeric fields are properly converted to numbers\n      if (processedData.employment_years !== undefined && processedData.employment_years !== null) {\n        if (typeof processedData.employment_years === 'string') {\n          processedData.employment_years = parseInt(processedData.employment_years, 10);\n          console.log('游댌 [ClientForm] Converted employment_years to number:', processedData.employment_years);\n        }\n      }\n      \n      // Convert other numeric fields if they're strings\n      ['monthly_income', 'additional_income', 'monthly_expenses', 'other_loan_balances'].forEach(field => {\n        const key = field as keyof typeof processedData;\n        if (processedData[key] !== undefined && processedData[key] !== null) {\n          if (typeof processedData[key] === 'string') {\n            processedData[key] = parseFloat(processedData[key] as string) as any;\n            console.log(`游댌 [ClientForm] Converted ${field} to number:`, processedData[key]);\n          }\n        }\n      });\n      \n      console.log('游댌 [ClientForm] Enviando datos procesados:', processedData);\n      \n      // Show loader during submission\n      await onSubmit(processedData, documents);\n      console.log('游댌 [ClientForm] Formulario enviado exitosamente');\n      \n      // Clean up localStorage on successful submission\n      localStorage.removeItem('clientFormData');\n      localStorage.removeItem('clientFormStep');\n      console.log('游댌 [ClientForm] Datos de localStorage limpiados despu칠s de env칤o exitoso');\n    } catch (error: any) {\n      console.error('游댌 [ClientForm] Error al guardar cliente:', error);\n      alert(`Error al guardar: ${error.message || 'Error desconocido'}`);\n    }\n  };\n  \n  // Avanzar al siguiente paso\n  const nextStep = () => {\n    // Always allow navigation forward regardless of validation\n    if (currentStep < 4) {\n      // Save the current state to localStorage for recovery in case of crash\n      try {\n        localStorage.setItem('clientFormData', JSON.stringify(formData));\n        localStorage.setItem('clientFormStep', String(currentStep + 1));\n      } catch (err) {\n        console.error('Error saving form state:', err);\n      }\n      \n      setCurrentStep(prev => prev + 1);\n    }\n  };\n  \n  // Try to recover form data on component mount\n  useEffect(() => {\n    console.log('游댌 [ClientForm] Inicializando formulario con datos iniciales:', initialData);\n    \n    try {\n      // First set the form with initial data from the database\n      // Deep copy initialData to avoid reference issues\n      const initialFormData = {...initialData};\n      \n      // Debug numeric fields to ensure they are correct\n      if (initialFormData.employment_years !== undefined) {\n        console.log('游댌 [ClientForm] employment_years tipo:', typeof initialFormData.employment_years, 'valor:', initialFormData.employment_years);\n      }\n      if (initialFormData.monthly_income !== undefined) {\n        console.log('游댌 [ClientForm] monthly_income tipo:', typeof initialFormData.monthly_income, 'valor:', initialFormData.monthly_income);\n      }\n      \n      // Initialize form with initialData from server\n      setFormData(initialFormData);\n      \n      // Then check for saved data in localStorage - only if we're in edit mode\n      if (initialData.id) {\n        const savedData = localStorage.getItem('clientFormData');\n        const savedStep = localStorage.getItem('clientFormStep');\n        \n        console.log('游댌 [ClientForm] Datos guardados en localStorage:', savedData);\n        console.log('游댌 [ClientForm] Paso guardado en localStorage:', savedStep);\n        \n        // Only use localStorage data if we're editing the same client\n        if (savedData) {\n          try {\n            const parsedData = JSON.parse(savedData);\n            console.log('游댌 [ClientForm] Aplicando datos de localStorage sobre datos iniciales:', parsedData);\n            \n            // Make sure we're only loading localStorage data for the correct client\n            if (parsedData.id === initialData.id) {\n              console.log('游댌 [ClientForm] ID coincide, aplicando datos de localStorage');\n              \n              // Update the form data with saved data\n              setFormData(current => {\n                const mergedData = {...current, ...parsedData};\n                console.log('游댌 [ClientForm] Datos finales despu칠s de fusionar:', mergedData);\n                return mergedData;\n              });\n              \n              // Set the current step\n              if (savedStep) {\n                const step = parseInt(savedStep, 10);\n                if (step > 0 && step <= 4) {\n                  console.log('游댌 [ClientForm] Estableciendo paso actual a:', step);\n                  setCurrentStep(step);\n                }\n              }\n            } else {\n              console.log('游댌 [ClientForm] ID no coincide, ignorando datos de localStorage');\n              // Clear localStorage since we're editing a different client\n              localStorage.removeItem('clientFormData');\n              localStorage.removeItem('clientFormStep');\n            }\n          } catch (parseError) {\n            console.error('Error parsing saved form data:', parseError);\n            // Clear potentially corrupted localStorage data\n            localStorage.removeItem('clientFormData');\n            localStorage.removeItem('clientFormStep');\n          }\n        }\n      }\n    } catch (err) {\n      console.error('Error recovering form state:', err);\n      setCurrentStep(1);\n    }\n    \n    // Calculate initial progress\n    setProgress(calculateProgress());\n  }, [initialData]);\n  \n  // Save current section and exit\n  const handleSaveAndExit = async () => {\n    try {\n      // Log the saving attempt\n      console.log(`Saving client data at step ${currentStep} and exiting...`);\n      console.log('Form data being saved:', formData);\n      \n      // Show saving indicator\n      setSectionSubmitting(true);\n      \n      if (onSavePartial) {\n        const result = await onSavePartial(formData, currentStep);\n        console.log(`Successfully saved data for section ${currentStep}`, result);\n        \n        // Update form data with the result to ensure consistency\n        if (result) {\n          setFormData(prevData => ({...prevData, ...result}));\n          \n          // Give visual feedback before navigating away\n          setTimeout(() => {\n            // Clear local storage after successful save\n            localStorage.removeItem('clientFormData');\n            localStorage.removeItem('clientFormStep');\n            \n            // Navigate back to clients list\n            navigate('/clients');\n          }, 1000);\n        }\n      } else {\n        // Fallback to full save if partial saving not provided\n        await onSubmit(formData, documents);\n        console.log('Successfully saved all client data');\n        \n        // Clear local storage after successful save\n        localStorage.removeItem('clientFormData');\n        localStorage.removeItem('clientFormStep');\n        \n        // Navigate back to clients list\n        navigate('/clients');\n      }\n    } catch (error: any) {\n      console.error(`Error saving client data at step ${currentStep}:`, error);\n      \n      // Create a more detailed error message for the user\n      let errorMessage = 'Error al guardar: ';\n      if (error.message) {\n        errorMessage += error.message;\n      } else if (error.code) {\n        errorMessage += `Error de base de datos (${error.code})`;\n      } else {\n        errorMessage += 'Error desconocido al guardar los datos';\n      }\n      \n      alert(errorMessage);\n    } finally {\n      setSectionSubmitting(false);\n    }\n  };\n  \n  // Handle save and continue action \n  const handleSaveAndContinue = async () => {\n    if (currentStep >= 4) return;\n    \n    try {\n      console.log(`游댌 [ClientForm] Iniciando guardado del paso ${currentStep} y continuando...`);\n      console.log('游댌 [ClientForm] Datos actuales del formulario:', formData);\n      \n      // Validate current step\n      if (!validateCurrentStep()) {\n        console.log('游댌 [ClientForm] Validaci칩n fallida para el paso actual');\n        return;\n      }\n      \n      // Show saving indicator\n      setSectionSubmitting(true);\n      \n      if (onSavePartial) {\n        console.log('游댌 [ClientForm] Llamando a onSavePartial con datos:', formData);\n        // Save the data for the current step\n        const result = await onSavePartial(formData, currentStep);\n        console.log(`游댌 [ClientForm] Datos guardados para secci칩n ${currentStep}, resultado:`, result);\n        \n        // Update form data with the result to ensure consistency\n        if (result) {\n          setFormData(prevData => {\n            const updatedData = {...prevData, ...result};\n            console.log('游댌 [ClientForm] Formulario actualizado con datos del servidor:', updatedData);\n            return updatedData;\n          });\n        }\n      }\n      \n      // Save current state to localStorage\n      try {\n        localStorage.setItem('clientFormData', JSON.stringify(formData));\n        localStorage.setItem('clientFormStep', String(currentStep + 1));\n        console.log('游댌 [ClientForm] Guardado en localStorage - pr칩ximo paso:', currentStep + 1);\n      } catch (err) {\n        console.error('Error saving form state:', err);\n      }\n      \n      // Continue to next step\n      setCurrentStep(prev => {\n        const nextStep = prev + 1;\n        console.log('游댌 [ClientForm] Avanzando al paso:', nextStep);\n        return nextStep;\n      });\n      \n    } catch (error: any) {\n      console.error(`游댌 [ClientForm] Error guardando datos del paso ${currentStep}:`, error);\n      alert(`Error al guardar: ${error.message || 'Error desconocido'}`);\n    } finally {\n      setSectionSubmitting(false);\n    }\n  };\n  \n  // Retroceder al paso anterior con m치s logs\n  const prevStep = () => {\n    console.log('游댌 Intentando retroceder del paso', currentStep);\n    if (currentStep > 1) {\n      // Guardar estado actual en localStorage con el paso anterior\n      try {\n        localStorage.setItem('clientFormData', JSON.stringify(formData));\n        localStorage.setItem('clientFormStep', String(currentStep - 1));\n        console.log('游댌 Actualizando localStorage con paso anterior:', currentStep - 1);\n      } catch (err) {\n        console.error('Error guardando estado del formulario:', err);\n      }\n      \n      // Establecer el paso anterior\n      setCurrentStep(prev => {\n        const newStep = prev - 1;\n        console.log('游댌 Estableciendo nuevo paso:', newStep);\n        return newStep;\n      });\n    } else {\n      console.log('游댌 Ya estamos en el primer paso, no se puede retroceder m치s');\n    }\n  };\n  \n  // Add a state for section saving\n  const [sectionSubmitting, setSectionSubmitting] = useState(false);\n  \n  // Funci칩n para reiniciar el formulario\n  const resetForm = () => {\n    console.log('游댌 Reiniciando formulario...');\n    \n    // Limpiar localStorage\n    localStorage.removeItem('clientFormData');\n    localStorage.removeItem('clientFormStep');\n    \n    // Resetear el formulario al estado inicial\n    setFormData({\n      first_name: '',\n      paternal_surname: '',\n      maternal_surname: '',\n      email: '',\n      phone: '',\n      address: '',\n      city: '',\n      state: '',\n      postal_code: '',\n      birth_date: '',\n      gender: '',\n      marital_status: '',\n      employment_type: '',\n      employment_years: undefined,\n      rfc: '',\n      curp: '',\n      monthly_income: undefined,\n      additional_income: undefined,\n      monthly_expenses: undefined,\n      other_loan_balances: undefined,\n      bank_name: '',\n      bank_clabe: '',\n      bank_account_number: '',\n      bank_account_type: '',\n      bank_account_origin: '',\n      company_id: '',\n      ...initialData,\n    });\n    \n    // Volver al paso 1\n    setCurrentStep(1);\n    \n    // Limpiar errores\n    setErrors({});\n    \n    console.log('游댌 Formulario reiniciado correctamente');\n  };\n  \n  // Renderizado condicional de pasos\n  const renderStep = () => {\n    console.log('游댌 [ClientForm] Renderizando paso', currentStep, 'con datos:', formData);\n    console.log('Empresas disponibles:', companies.length);\n    \n    switch (currentStep) {\n      case 1:\n        console.log('游댌 ClientForm: Entrando en caso 1 - Datos Personales');\n        return (\n          <div className=\"space-y-4\">\n            <h3 className=\"text-lg font-bold\">Datos Personales</h3>\n            \n            {/* Company Selector */}\n            <div className=\"form-control\">\n              <label className=\"label\">\n                <span className=\"label-text\">Empresa <span className=\"text-error\">*</span></span>\n              </label>\n              <select\n                name=\"company_id\"\n                value={formData.company_id || ''}\n                onChange={handleCompanyChange}\n                className={`select select-bordered w-full ${errors.company_id ? 'select-error' : ''}`}\n                disabled={loadingCompanies}\n              >\n                <option value=\"\">Seleccionar empresa</option>\n                {companies.map(company => (\n                  <option key={company.id} value={company.id}>\n                    {company.name}\n                  </option>\n                ))}\n              </select>\n              {errors.company_id && <span className=\"text-error text-sm mt-1\">{errors.company_id}</span>}\n              {loadingCompanies && <span className=\"text-sm mt-1\">Cargando empresas...</span>}\n            </div>\n            \n            <div className=\"form-control\">\n              <label className=\"label\">\n                <span className=\"label-text\">Nombre(s) <span className=\"text-error\">*</span></span>\n              </label>\n              <input\n                type=\"text\"\n                name=\"first_name\"\n                className={`input input-bordered w-full ${errors.first_name ? 'input-error' : ''}`}\n                value={formData.first_name || ''}\n                onChange={handleChange}\n                placeholder=\"Nombre(s)\"\n              />\n              {errors.first_name && <span className=\"text-error text-sm mt-1\">{errors.first_name}</span>}\n            </div>\n            \n            <div className=\"form-control\">\n              <label className=\"label\">\n                <span className=\"label-text\">Apellido Paterno <span className=\"text-error\">*</span></span>\n              </label>\n              <input\n                type=\"text\"\n                name=\"paternal_surname\"\n                className={`input input-bordered w-full ${errors.paternal_surname ? 'input-error' : ''}`}\n                value={formData.paternal_surname || ''}\n                onChange={handleChange}\n                placeholder=\"Apellido Paterno\"\n              />\n              {errors.paternal_surname && <span className=\"text-error text-sm mt-1\">{errors.paternal_surname}</span>}\n            </div>\n            \n            <div className=\"form-control\">\n              <label className=\"label\">\n                <span className=\"label-text\">Apellido Materno</span>\n              </label>\n              <input\n                type=\"text\"\n                name=\"maternal_surname\"\n                className=\"input input-bordered w-full\"\n                value={formData.maternal_surname || ''}\n                onChange={handleChange}\n                placeholder=\"Apellido Materno\"\n              />\n            </div>\n            \n            <div className=\"form-control\">\n              <label className=\"label\">\n                <span className=\"label-text\">Correo Electr칩nico</span>\n              </label>\n              <input\n                type=\"email\"\n                name=\"email\"\n                className={`input input-bordered w-full ${errors.email ? 'input-error' : ''}`}\n                value={formData.email || ''}\n                onChange={handleChange}\n                placeholder=\"correo@ejemplo.com\"\n              />\n              {errors.email && <span className=\"text-error text-sm mt-1\">{errors.email}</span>}\n            </div>\n            \n            <div className=\"form-control\">\n              <label className=\"label\">\n                <span className=\"label-text\">Tel칠fono</span>\n              </label>\n              <input\n                type=\"tel\"\n                name=\"phone\"\n                className=\"input input-bordered w-full\"\n                value={formData.phone || ''}\n                onChange={handleChange}\n                placeholder=\"(123) 456-7890\"\n              />\n            </div>\n            \n            <div className=\"form-control\">\n              <label className=\"label\">\n                <span className=\"label-text\">RFC</span>\n              </label>\n              <input\n                type=\"text\"\n                name=\"rfc\"\n                className={`input input-bordered w-full ${errors.rfc ? 'input-error' : ''}`}\n                value={formData.rfc || ''}\n                onChange={handleChange}\n                placeholder=\"ABCD123456XXX\"\n              />\n              {errors.rfc && <span className=\"text-error text-sm mt-1\">{errors.rfc}</span>}\n            </div>\n            \n            <div className=\"form-control\">\n              <label className=\"label\">\n                <span className=\"label-text\">CURP</span>\n              </label>\n              <input\n                type=\"text\"\n                name=\"curp\"\n                className={`input input-bordered w-full ${errors.curp ? 'input-error' : ''}`}\n                value={formData.curp || ''}\n                onChange={handleChange}\n                placeholder=\"ABCD123456HDFXXX01\"\n              />\n              {errors.curp && <span className=\"text-error text-sm mt-1\">{errors.curp}</span>}\n            </div>\n            \n            <div className=\"form-control\">\n              <label className=\"label\">\n                <span className=\"label-text\">Fecha de Nacimiento</span>\n              </label>\n              <input\n                type=\"date\"\n                name=\"birth_date\"\n                className=\"input input-bordered w-full\"\n                value={formData.birth_date || ''}\n                onChange={handleChange}\n              />\n            </div>\n            \n            <div className=\"form-control\">\n              <label className=\"label\">\n                <span className=\"label-text\">G칠nero</span>\n              </label>\n              <select\n                name=\"gender\"\n                className=\"select select-bordered w-full\"\n                value={formData.gender || ''}\n                onChange={handleChange}\n              >\n                <option value=\"\">Seleccionar...</option>\n                <option value=\"masculino\">Masculino</option>\n                <option value=\"femenino\">Femenino</option>\n                <option value=\"otro\">Otro</option>\n              </select>\n            </div>\n            \n            <div className=\"form-control\">\n              <label className=\"label\">\n                <span className=\"label-text\">Estado Civil</span>\n              </label>\n              <select\n                name=\"marital_status\"\n                className=\"select select-bordered w-full\"\n                value={formData.marital_status || ''}\n                onChange={handleChange}\n              >\n                <option value=\"\">Seleccionar...</option>\n                {MARITAL_STATUS_TYPES.map(option => (\n                  <option key={option.value} value={option.value}>\n                    {option.label}\n                  </option>\n                ))}\n              </select>\n            </div>\n          </div>\n        );\n      \n      case 2:\n        return (\n          <div className=\"space-y-6\">\n            <h3 className=\"text-lg font-semibold\">Detalles Financieros y Balance</h3>\n            \n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div className=\"form-control w-full\">\n                <label className=\"label\">\n                  <span className=\"label-text\">Tipo de Empleo</span>\n                </label>\n                <select\n                  name=\"employment_type\"\n                  value={formData.employment_type || ''}\n                  onChange={handleChange}\n                  className={`select select-bordered w-full ${errors.employment_type ? 'select-error' : ''}`}\n                >\n                  <option value=\"\">Seleccionar tipo de empleo</option>\n                  {EMPLOYMENT_TYPES.map(option => (\n                    <option key={option.value} value={option.value}>{option.label}</option>\n                  ))}\n                </select>\n                {errors.employment_type && <span className=\"text-error text-xs mt-1\">{errors.employment_type}</span>}\n              </div>\n              \n              <div className=\"form-control w-full\">\n                <label className=\"label\">\n                  <span className=\"label-text\">Antig칲edad (a침os)</span>\n                </label>\n                <input\n                  type=\"number\"\n                  name=\"employment_years\"\n                  value={formData.employment_years || ''}\n                  onChange={handleChange}\n                  className={`input input-bordered w-full ${errors.employment_years ? 'input-error' : ''}`}\n                  placeholder=\"A침os de antig칲edad\"\n                  min=\"0\"\n                />\n                {errors.employment_years && <span className=\"text-error text-xs mt-1\">{errors.employment_years}</span>}\n              </div>\n              \n              <div className=\"form-control w-full\">\n                <label className=\"label\">\n                  <span className=\"label-text\">Ingreso Mensual ($)</span>\n                </label>\n                <input\n                  type=\"number\"\n                  name=\"monthly_income\"\n                  value={formData.monthly_income || ''}\n                  onChange={handleChange}\n                  className={`input input-bordered w-full ${errors.monthly_income ? 'input-error' : ''}`}\n                  placeholder=\"0.00\"\n                  min=\"0\"\n                  step=\"0.01\"\n                />\n                {errors.monthly_income && <span className=\"text-error text-xs mt-1\">{errors.monthly_income}</span>}\n              </div>\n              \n              <div className=\"form-control w-full\">\n                <label className=\"label\">\n                  <span className=\"label-text\">Ingresos Adicionales ($)</span>\n                </label>\n                <input\n                  type=\"number\"\n                  name=\"additional_income\"\n                  value={formData.additional_income || ''}\n                  onChange={handleChange}\n                  className={`input input-bordered w-full ${errors.additional_income ? 'input-error' : ''}`}\n                  placeholder=\"0.00\"\n                  min=\"0\"\n                  step=\"0.01\"\n                />\n                {errors.additional_income && <span className=\"text-error text-xs mt-1\">{errors.additional_income}</span>}\n              </div>\n              \n              <div className=\"form-control w-full\">\n                <label className=\"label\">\n                  <span className=\"label-text\">Gastos Mensuales ($)</span>\n                </label>\n                <input\n                  type=\"number\"\n                  name=\"monthly_expenses\"\n                  value={formData.monthly_expenses || ''}\n                  onChange={handleChange}\n                  className={`input input-bordered w-full ${errors.monthly_expenses ? 'input-error' : ''}`}\n                  placeholder=\"0.00\"\n                  min=\"0\"\n                  step=\"0.01\"\n                />\n                {errors.monthly_expenses && <span className=\"text-error text-xs mt-1\">{errors.monthly_expenses}</span>}\n              </div>\n              \n              <div className=\"form-control w-full\">\n                <label className=\"label\">\n                  <span className=\"label-text\">Saldos de Otros Cr칠ditos ($)</span>\n                </label>\n                <input\n                  type=\"number\"\n                  name=\"other_loan_balances\"\n                  value={formData.other_loan_balances || ''}\n                  onChange={handleChange}\n                  className={`input input-bordered w-full ${errors.other_loan_balances ? 'input-error' : ''}`}\n                  placeholder=\"0.00\"\n                  min=\"0\"\n                  step=\"0.01\"\n                />\n                {errors.other_loan_balances && <span className=\"text-error text-xs mt-1\">{errors.other_loan_balances}</span>}\n              </div>\n            </div>\n          </div>\n        );\n      \n      case 3:\n        return (\n          <div className=\"space-y-6\">\n            <h3 className=\"text-lg font-semibold\">Datos de la Cuenta Bancaria</h3>\n            \n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div className=\"form-control w-full\">\n                <label className=\"label\">\n                  <span className=\"label-text\">Banco</span>\n                </label>\n                <input\n                  type=\"text\"\n                  name=\"bank_name\"\n                  value={formData.bank_name || ''}\n                  onChange={handleChange}\n                  className={`input input-bordered w-full ${errors.bank_name ? 'input-error' : ''}`}\n                  placeholder=\"Nombre del banco\"\n                />\n                {errors.bank_name && <span className=\"text-error text-xs mt-1\">{errors.bank_name}</span>}\n              </div>\n              \n              <div className=\"form-control w-full\">\n                <label className=\"label\">\n                  <span className=\"label-text\">CLABE</span>\n                </label>\n                <input\n                  type=\"text\"\n                  name=\"bank_clabe\"\n                  value={formData.bank_clabe || ''}\n                  onChange={handleChange}\n                  className={`input input-bordered w-full ${errors.bank_clabe ? 'input-error' : ''}`}\n                  placeholder=\"18 d칤gitos\"\n                />\n                {errors.bank_clabe && <span className=\"text-error text-xs mt-1\">{errors.bank_clabe}</span>}\n              </div>\n              \n              <div className=\"form-control w-full\">\n                <label className=\"label\">\n                  <span className=\"label-text\">N칰mero de Cuenta</span>\n                </label>\n                <input\n                  type=\"text\"\n                  name=\"bank_account_number\"\n                  value={formData.bank_account_number || ''}\n                  onChange={handleChange}\n                  className={`input input-bordered w-full ${errors.bank_account_number ? 'input-error' : ''}`}\n                  placeholder=\"N칰mero de cuenta\"\n                />\n                {errors.bank_account_number && <span className=\"text-error text-xs mt-1\">{errors.bank_account_number}</span>}\n              </div>\n              \n              <div className=\"form-control w-full\">\n                <label className=\"label\">\n                  <span className=\"label-text\">Tipo de Cuenta</span>\n                </label>\n                <select\n                  name=\"bank_account_type\"\n                  value={formData.bank_account_type || ''}\n                  onChange={handleChange}\n                  className={`select select-bordered w-full ${errors.bank_account_type ? 'select-error' : ''}`}\n                >\n                  <option value=\"\">Seleccionar tipo de cuenta</option>\n                  {BANK_ACCOUNT_TYPES.map(option => (\n                    <option key={option.value} value={option.value}>{option.label}</option>\n                  ))}\n                </select>\n                {errors.bank_account_type && <span className=\"text-error text-xs mt-1\">{errors.bank_account_type}</span>}\n              </div>\n              \n              <div className=\"form-control w-full\">\n                <label className=\"label\">\n                  <span className=\"label-text\">Origen de la Cuenta (Estado)</span>\n                </label>\n                <input\n                  type=\"text\"\n                  name=\"bank_account_origin\"\n                  value={formData.bank_account_origin || ''}\n                  onChange={handleChange}\n                  className={`input input-bordered w-full ${errors.bank_account_origin ? 'input-error' : ''}`}\n                  placeholder=\"Estado donde se abri칩 la cuenta\"\n                />\n                {errors.bank_account_origin && <span className=\"text-error text-xs mt-1\">{errors.bank_account_origin}</span>}\n              </div>\n            </div>\n          </div>\n        );\n      \n      case 4:\n        return (\n          <div className=\"space-y-6\">\n            <h3 className=\"text-lg font-semibold\">Documentos</h3>\n            <p className=\"text-sm text-gray-500\">Sube los documentos del cliente. Todos los formatos son aceptados.</p>\n            \n            <DocumentUploader \n              categories={DOCUMENT_CATEGORIES}\n              onDocumentAdded={handleDocumentAdded}\n              onDocumentRemoved={handleDocumentRemoved}\n              existingDocuments={documents}\n              clientId={initialData?.id}\n            />\n          </div>\n        );\n      \n      default:\n        return null;\n    }\n  };\n  \n  return (\n    <div className=\"p-2 md:p-4\">\n      {/* Progress Bar */}\n      <div className=\"w-full mb-6\">\n        <div className=\"text-sm font-medium text-gray-500 mb-1\">\n          Completado: {progress}%\n        </div>\n        <div className=\"w-full bg-gray-200 rounded-full h-2.5\">\n          <div \n            className=\"bg-primary h-2.5 rounded-full\" \n            style={{ width: `${progress}%` }}\n          ></div>\n        </div>\n      </div>\n      \n      {/* Step Indicator */}\n      <div className=\"mb-6\">\n        <ul className=\"steps steps-horizontal w-full\">\n          <li className={`step ${currentStep >= 1 ? 'step-primary' : ''}`}>Datos Personales</li>\n          <li className={`step ${currentStep >= 2 ? 'step-primary' : ''}`}>Datos Financieros</li>\n          <li className={`step ${currentStep >= 3 ? 'step-primary' : ''}`}>Datos Bancarios</li>\n          <li className={`step ${currentStep >= 4 ? 'step-primary' : ''}`}>Documentos</li>\n        </ul>\n      </div>\n\n      {/* Error Display */}\n      {Object.keys(errors).length > 0 && (\n        <div className=\"alert alert-error mb-4\" id=\"error-message\">\n          <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"stroke-current shrink-0 h-6 w-6\" fill=\"none\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z\" />\n          </svg>\n          <div>\n            <h3 className=\"font-bold\">Por favor corrige los siguientes errores:</h3>\n            <ul className=\"list-disc ml-5 mt-1\">\n              {Object.entries(errors).map(([field, message]) => (\n                <li key={field}>{message}</li>\n              ))}\n            </ul>\n          </div>\n        </div>\n      )}\n      \n      <form onSubmit={handleSubmit}>\n        {renderStep()}\n        \n        {/* Navigation Buttons */}\n        <div className=\"flex flex-wrap justify-between mt-6\">\n          {currentStep > 1 && (\n            <button \n              type=\"button\"\n              className=\"btn btn-outline btn-primary\"\n              onClick={prevStep}\n              disabled={isSubmitting}\n            >\n              Anterior\n            </button>\n          )}\n          \n          <div className=\"flex space-x-2\">\n            {/* Cancel Button (Step 1 only) */}\n            {currentStep === 1 && (\n              <button \n                type=\"button\"\n                className=\"btn btn-ghost\"\n                onClick={() => navigate('/clients')}\n                disabled={isSubmitting}\n              >\n                Cancelar\n              </button>\n            )}\n\n            {/* \"Save and Exit\" button for intermediate steps */}\n            {currentStep > 1 && currentStep < 4 && onSavePartial && (\n              <button \n                type=\"button\"\n                className=\"btn btn-outline btn-secondary\"\n                onClick={handleSaveAndExit}\n                disabled={isSubmitting}\n              >\n                {isSubmitting ? 'Guardando...' : 'Guardar y Salir'}\n              </button>\n            )}\n\n            {/* Next step button (steps 1-3) */}\n            {currentStep < 4 && (\n              <button \n                type=\"button\" \n                className=\"btn btn-primary\"\n                onClick={currentStep < 3 ? handleSaveAndContinue : nextStep}\n                disabled={isSubmitting}\n              >\n                {isSubmitting ? 'Guardando...' : currentStep === 3 ? 'Siguiente' : 'Guardar y Continuar'}\n              </button>\n            )}\n            \n            {/* Submit button (step 4) */}\n            {currentStep === 4 && (\n              <button \n                type=\"submit\" \n                className=\"btn btn-success\"\n                disabled={isSubmitting}\n              >\n                {isSubmitting ? 'Guardando...' : 'Guardar Cliente'}\n              </button>\n            )}\n          </div>\n        </div>\n      </form>\n    </div>\n  );\n};\n\nexport default ClientForm; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}